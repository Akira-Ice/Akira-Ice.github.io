<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>uni-app-note</title>
      <link href="/2023/09/22/uni-app/uni-app-note/"/>
      <url>/2023/09/22/uni-app/uni-app-note/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h1><h2 id="æ ¸å¿ƒ"><a href="#æ ¸å¿ƒ" class="headerlink" title="æ ¸å¿ƒ"></a>æ ¸å¿ƒ</h2><blockquote><p>ç»Ÿä¸€è§„åˆ™ -&gt; å¤šç«¯è½¬ä¹‰</p></blockquote><h2 id="é€»è¾‘å±‚å’Œæ¸²æŸ“å±‚åˆ†ç¦»"><a href="#é€»è¾‘å±‚å’Œæ¸²æŸ“å±‚åˆ†ç¦»" class="headerlink" title="é€»è¾‘å±‚å’Œæ¸²æŸ“å±‚åˆ†ç¦»"></a>é€»è¾‘å±‚å’Œæ¸²æŸ“å±‚åˆ†ç¦»</h2><p>åŸç”Ÿï¼šjsã€cssã€html -&gt; webview -&gt; render -&gt; webï¼ŒåŠ è½½æ¸²æŸ“ç›¸äº’é˜»å¡ï¼ŒæŠ¢å èµ„æºï¼Œæ€§èƒ½å·®ã€‚</p><p>å°ç¨‹åºã€appï¼šé€»è¾‘å±‚å•ç‹¬é…ç½® js å¼•æ“ï¼Œæ¸²æŸ“å±‚ä»æ˜¯ webviewã€‚</p><blockquote><p>æ³¨æ„å°ç¨‹åºå’Œ app çš„é€»è¾‘å±‚éƒ½ä¸æ”¯æŒæµè§ˆå™¨ä¸“ç”¨çš„ windowã€dom ç­‰ APIã€‚app åªèƒ½åœ¨æ¸²æŸ“å±‚æ“ä½œ windowã€domï¼Œå³ renderjsã€‚</p></blockquote><h1 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€uniCloud              äº‘ç©ºé—´ç›®å½•ï¼Œé˜¿é‡Œäº‘ä¸ºuniCloud-aliyun,è…¾è®¯äº‘ä¸ºuniCloud-tcbï¼ˆè¯¦è§uniCloudï¼‰</span><br><span class="line">â”‚â”€components            ç¬¦åˆvueç»„ä»¶è§„èŒƒçš„uni-appç»„ä»¶ç›®å½•*</span><br><span class="line">â”‚  â””â”€comp-a.vue         å¯å¤ç”¨çš„aç»„ä»¶</span><br><span class="line">â”œâ”€utssdk                å­˜æ”¾utsæ–‡ä»¶</span><br><span class="line">â”œâ”€pages                 ä¸šåŠ¡é¡µé¢æ–‡ä»¶å­˜æ”¾çš„ç›®å½•*</span><br><span class="line">â”‚  â”œâ”€index</span><br><span class="line">â”‚  â”‚  â””â”€index.vue       indexé¡µé¢</span><br><span class="line">â”‚  â””â”€list</span><br><span class="line">â”‚     â””â”€list.vue        listé¡µé¢</span><br><span class="line">â”œâ”€static                å­˜æ”¾åº”ç”¨å¼•ç”¨çš„æœ¬åœ°é™æ€èµ„æºï¼ˆå¦‚å›¾ç‰‡ã€è§†é¢‘ç­‰ï¼‰çš„ç›®å½•ï¼Œæ³¨æ„ï¼šé™æ€èµ„æºåªèƒ½å­˜æ”¾äºæ­¤*</span><br><span class="line">â”œâ”€uni_modules           å­˜æ”¾[uni_module](/uni_modules)*</span><br><span class="line">â”œâ”€platforms             å­˜æ”¾å„å¹³å°ä¸“ç”¨é¡µé¢çš„ç›®å½•ï¼Œè¯¦è§</span><br><span class="line">â”œâ”€nativeplugins         AppåŸç”Ÿè¯­è¨€æ’ä»¶</span><br><span class="line">â”œâ”€nativeResources       Appç«¯åŸç”Ÿèµ„æºç›®å½•</span><br><span class="line">â”‚  â”œâ”€android            AndroidåŸç”Ÿèµ„æºç›®å½•</span><br><span class="line">|  â””â”€ios                iOSåŸç”Ÿèµ„æºç›®å½•</span><br><span class="line">â”œâ”€hybrid                Appç«¯å­˜æ”¾æœ¬åœ°htmlæ–‡ä»¶çš„ç›®å½•ï¼Œè¯¦è§</span><br><span class="line">|-windows               æ‹“å±•çª—å£ï¼šleftWindowã€topWindowã€rightWindow</span><br><span class="line">â”œâ”€wxcomponents          å­˜æ”¾å°ç¨‹åºç»„ä»¶çš„ç›®å½•ï¼Œè¯¦è§</span><br><span class="line">â”œâ”€unpackage             éå·¥ç¨‹ä»£ç ï¼Œä¸€èˆ¬å­˜æ”¾è¿è¡Œæˆ–å‘è¡Œçš„ç¼–è¯‘ç»“æœ</span><br><span class="line">â”œâ”€AndroidManifest.xml   AndroidåŸç”Ÿåº”ç”¨æ¸…å•æ–‡ä»¶</span><br><span class="line">â”œâ”€Info.plist            iOSåŸç”Ÿåº”ç”¨é…ç½®æ–‡ä»¶</span><br><span class="line">â”œâ”€main.js               Vueåˆå§‹åŒ–å…¥å£æ–‡ä»¶*</span><br><span class="line">â”œâ”€App.vue               åº”ç”¨é…ç½®ï¼Œç”¨æ¥é…ç½®Appå…¨å±€æ ·å¼ä»¥åŠç›‘å¬ åº”ç”¨ç”Ÿå‘½å‘¨æœŸ*</span><br><span class="line">â”œâ”€manifest.json         é…ç½®åº”ç”¨åç§°ã€appidã€logoã€ç‰ˆæœ¬ç­‰æ‰“åŒ…ä¿¡æ¯ï¼Œè¯¦è§*</span><br><span class="line">â”œâ”€pages.json            é…ç½®é¡µé¢è·¯ç”±ã€å¯¼èˆªæ¡ã€é€‰é¡¹å¡ç­‰é¡µé¢ç±»ä¿¡æ¯ï¼Œè¯¦è§*</span><br><span class="line">â””â”€uni.scss              è¿™é‡Œæ˜¯uni-appå†…ç½®çš„å¸¸ç”¨æ ·å¼å˜é‡*</span><br></pre></td></tr></table></figure><blockquote><p>static ç›®å½•ä¸‹æ–‡ä»¶ä¼šç›´æ¥å¤åˆ¶åˆ°æ‰“åŒ…ç›®å½•ï¼Œä¸ä¼šè¿›è¡Œç¼–è¯‘å¤„ç†ï¼Œé™¤éè¢«å¼•ç”¨ã€‚</p></blockquote><h1 id="é¡µé¢"><a href="#é¡µé¢" class="headerlink" title="é¡µé¢"></a>é¡µé¢</h1><h2 id="é¡µé¢åŠ è½½æ—¶åº"><a href="#é¡µé¢åŠ è½½æ—¶åº" class="headerlink" title="é¡µé¢åŠ è½½æ—¶åº"></a>é¡µé¢åŠ è½½æ—¶åº</h2><p>uni-app -&gt; pages.json -&gt; template -&gt; vnode -&gt; onLoad(data) -&gt; [start animation] -&gt; [vnode to dom] -&gt; onReady -&gt; [end animation]</p><h2 id="é¡µé¢ç”Ÿå‘½å‘¨æœŸ"><a href="#é¡µé¢ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="é¡µé¢ç”Ÿå‘½å‘¨æœŸ"></a>é¡µé¢ç”Ÿå‘½å‘¨æœŸ</h2><p>onShowã€onHideï¼šè¿›å…¥ã€ç¦»å¼€ï¼Œé‡å¤è§¦å‘ã€‚</p><p>onReachBottomï¼šè§¦åº•äº‹ä»¶ï¼ˆpages.json -&gt; onReachBottomDistanceï¼‰ã€‚</p><p>onPageScrollï¼šæ»šåŠ¨äº‹ä»¶ <code>(&#123;scrollTop&#125;) =&gt; void</code>ã€‚</p><h2 id="ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ"><a href="#ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ"></a>ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</h2><p>åŸ Vue ç”Ÿå‘½å‘¨æœŸï¼ŒbeforeUpdateã€updated ä»… H5 é¡µé¢æ”¯æŒ</p><h2 id="é¡µé¢é€šä¿¡"><a href="#é¡µé¢é€šä¿¡" class="headerlink" title="é¡µé¢é€šä¿¡"></a>é¡µé¢é€šä¿¡</h2><p><a href="https://uniapp.dcloud.net.cn/tutorial/page.html#%E9%A1%B5%E9%9D%A2%E9%80%9A%E8%AE%AF">åŒ Vue è‡ªå®šä¹‰äº‹ä»¶</a>ã€‚</p><p><a href="https://uniapp.dcloud.net.cn/api/window/communication.html">é¡µé¢é€šä¿¡ API</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">handleUpdate</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data.<span class="property">msg</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">uni.$emit(<span class="string">&quot;update&quot;</span>, &#123; <span class="attr">msg</span>: <span class="string">&quot;é¡µé¢æ›´æ–°&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line">uni.$on(<span class="string">&quot;update&quot;</span>, handleUpdate);</span><br><span class="line"></span><br><span class="line">uni.$once(<span class="string">&quot;update&quot;</span>, handleUpdate);</span><br><span class="line"></span><br><span class="line">uni.$off(<span class="string">&quot;update&quot;</span>, <span class="variable language_">this</span>.<span class="property">update</span>);</span><br></pre></td></tr></table></figure><h2 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h2><p><a href="https://uniapp.dcloud.net.cn/collocation/pages#pages">pages.json</a> ä¸­é…ç½®ã€‚</p><h3 id="è·¯ç”±è·³è½¬"><a href="#è·¯ç”±è·³è½¬" class="headerlink" title="è·¯ç”±è·³è½¬"></a>è·¯ç”±è·³è½¬</h3><p>è·³è½¬æ–¹å¼ï¼š<a href="https://uniapp.dcloud.net.cn/component/navigator">navigator</a>ã€<a href="https://uniapp.dcloud.net.cn/api/router">API</a>ã€‚</p><h1 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h1><p>å°ºå¯¸å•ä½ï¼šrpxã€‚</p><p>å†…è”æ ·å¼ï¼šå¤šä¸ºåŠ¨æ€æ ·å¼ï¼Œé™æ€æ ·å¼é€šè¿‡ class å½¢å¼ç¼–å†™ï¼Œé¿å…å†…è”é™æ€æ ·å¼å½±å“æ¸²æŸ“ã€‚</p><p><code>::after ::before</code>ï¼šä»…åœ¨ Vue é¡µé¢ç”Ÿæ•ˆã€‚</p><p>uni-app æä¾›å†…ç½® css å˜é‡ï¼š</p><table><thead><tr><th>CSS å˜é‡</th><th>æè¿°</th><th>App</th><th>å°ç¨‹åº</th><th>H5</th></tr></thead><tbody><tr><td>â€“status-bar-height</td><td>ç³»ç»ŸçŠ¶æ€æ é«˜åº¦</td><td>ç³»ç»ŸçŠ¶æ€æ é«˜åº¦ã€nvue æ³¨æ„è§ä¸‹</td><td>25px</td><td>0</td></tr><tr><td>â€“window-top</td><td>å†…å®¹åŒºåŸŸè·ç¦»é¡¶éƒ¨çš„è·ç¦»</td><td>0</td><td>0</td><td>NavigationBar çš„é«˜åº¦</td></tr><tr><td>â€“window-bottom</td><td>å†…å®¹åŒºåŸŸè·ç¦»åº•éƒ¨çš„è·ç¦»</td><td>0</td><td>0</td><td>TabBar çš„é«˜åº¦</td></tr></tbody></table><p><strong>æ³¨æ„ï¼š</strong></p><ol><li><p>uni-app ä¸­ä¸èƒ½ä½¿ç”¨ * ã€‚</p></li><li><p>body -&gt; page || divã€ulã€li -&gt; view || spanã€font -&gt; textã€a -&gt; navigatorã€img -&gt; imageã€‚</p></li><li><p>NavigationBar å¯¼èˆªæ é«˜åº¦å›ºå®š 44pxï¼ˆä¸å¯æ›´æ”¹ï¼‰ã€‚</p></li><li><p>TabBar åº•éƒ¨é€‰é¡¹å¡é«˜åº¦å›ºå®š 50pxã€‚</p></li><li><p>100vh åŒ…å«å¯¼èˆªæ çš„é«˜åº¦ï¼Œä½¿ç”¨æ—¶éœ€è¦å‡å»å¯¼èˆªæ å’Œ tabBar é«˜åº¦ï¼Œéƒ¨åˆ†æµè§ˆå™¨è¿˜åŒ…å«æµè§ˆå™¨æ“ä½œæ é«˜åº¦ï¼Œä½¿ç”¨æ—¶è¯·æ³¨æ„ã€‚</p></li><li><p>æœ¬åœ°èƒŒæ™¯å›¾ç‰‡çš„å¼•ç”¨è·¯å¾„æ¨èä½¿ç”¨ä»¥ ~@ å¼€å¤´çš„ç»å¯¹è·¯å¾„ã€‚</p></li><li><p>å¾®ä¿¡å°ç¨‹åºä»…æ”¯æŒ class é€‰æ‹©å™¨ã€‚</p></li><li><p>å°ç¨‹åºä¸æ”¯æŒåœ¨ css ä¸­å¼•ç”¨æ–‡ä»¶ï¼ŒåŒ…æ‹¬å›¾ç‰‡å’Œå­—ä½“ï¼Œéœ€è¦è½¬ä¸º base64 ä½¿ç”¨ã€‚</p></li><li><p>å¾®ä¿¡å°ç¨‹åºä¸æ”¯æŒç›¸å¯¹è·¯å¾„ã€‚</p></li><li><p>å°ç¨‹åºå’Œ H5 æ­£å¸¸ï¼Œä½† APP å¼‚å¸¸ï¼Œé€šå¸¸æ˜¯ css å…¼å®¹æ€§é—®é¢˜ã€‚ï¼ˆå°ç¨‹åºä¸å­˜åœ¨æµè§ˆå™¨å…¼å®¹é—®é¢˜ï¼Œå…¶å†…ç½®å¾ˆå¤§çš„å®šåˆ¶ webviewï¼‰</p></li><li><p>å„å®¶å°ç¨‹åºæµè§ˆå™¨å†…æ ¸ä¸åŒï¼Œå¯èƒ½å­˜åœ¨ css å…¼å®¹æ€§é—®é¢˜ï¼Œ<a href="https://ask.dcloud.net.cn/article/1318">ç»†èŠ‚å‚è€ƒ</a>ã€‚</p></li></ol><h1 id="JS"><a href="#JS" class="headerlink" title="JS"></a>JS</h1><ol><li><p>åŸç”Ÿç»„ä»¶å±‚çº§é—®é¢˜ H5 æ²¡æœ‰åŸç”Ÿç»„ä»¶æ¦‚å¿µé—®é¢˜ï¼Œé H5 ç«¯æœ‰åŸç”Ÿç»„ä»¶å¹¶å¼•å‘äº†åŸç”Ÿç»„ä»¶å±‚çº§é«˜äºå‰ç«¯ç»„ä»¶çš„æ¦‚å¿µï¼Œè¦é®æŒ¡ videoã€map ç­‰åŸç”Ÿç»„ä»¶ï¼Œè¯·ä½¿ç”¨ cover-view ç»„ä»¶ã€‚</p></li><li><p>é H5 ç«¯ä¸æ”¯æŒ APIï¼šdocumentã€cookieã€windowã€locationã€navigatorã€localstorageã€websqlã€indexdbã€webgl ç­‰å¯¹è±¡ã€‚</p></li><li><p>APP ç«¯é€šè¿‡ renderJS æ“ä½œ windowã€document åº“ã€‚</p></li></ol><blockquote><p>å°ç¨‹åºå’Œ App çš„ js è¿è¡Œåœ¨ jscore ä¸‹è€Œä¸æ˜¯æµè§ˆå™¨é‡Œï¼Œæ²¡æœ‰æµè§ˆå™¨ä¸“ç”¨çš„ js å¯¹è±¡ã€‚è‹¥ä¸‰æ–¹åº“ä¸­ä½¿ç”¨åˆ°è¿™äº› API éœ€è¦åœ¨æ’ä»¶å¸‚åœºå¯»æ‰¾æ›¿ä»£å“ã€‚<br>APP ç«¯å¯åœ¨ <a href="https://uniapp.dcloud.io/tutorial/renderjs">renderJS</a> ä¸­æ“ä½œæµè§ˆå™¨å¯¹è±¡ã€‚</p></blockquote><h1 id="API"><a href="#API" class="headerlink" title="API"></a>API</h1><h2 id="getApp"><a href="#getApp" class="headerlink" title="getApp()"></a>getApp()</h2><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="attr">getApp</span>: &lt;<span class="title class_">AnyObject</span>&gt;<span class="function">(<span class="params">opts?: App.GetAppOption</span>) =&gt;</span> <span class="title class_">App</span>.<span class="property">AppInstance</span>&lt;<span class="title class_">AnyObject</span>&gt; &amp; <span class="title class_">AnyObject</span>;</span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">AppInstance</span>&lt;T <span class="keyword">extends</span> <span class="title class_">AnyObject</span> = &#123;&#125;&gt; &#123;</span><br><span class="line">  globalData?: <span class="title class_">AnyObject</span>;</span><br><span class="line">  onLaunch?(options?: <span class="title class_">LaunchShowOption</span>): <span class="built_in">void</span>;</span><br><span class="line">  onShow?(options?: <span class="title class_">LaunchShowOption</span>): <span class="built_in">void</span>;</span><br><span class="line">  onHide?(): <span class="built_in">void</span>;</span><br><span class="line">  onError?(<span class="attr">error</span>: <span class="built_in">string</span>): <span class="built_in">void</span>;</span><br><span class="line">  onPageNotFound?(<span class="attr">options</span>: <span class="title class_">PageNotFoundOption</span>): <span class="built_in">void</span>;</span><br><span class="line">  onUnhandledRejection?(<span class="attr">options</span>: <span class="title class_">UniNamespace</span>.<span class="property">OnUnhandledRejectionCallbackResult</span>): <span class="built_in">void</span>;</span><br><span class="line">  onThemeChange?(<span class="attr">options</span>: <span class="title class_">UniNamespace</span>.<span class="property">OnThemeChangeCallbackResult</span>): <span class="built_in">void</span>;</span><br><span class="line">  onUniNViewMessage?(<span class="attr">options</span>: <span class="title class_">AnyObject</span>): <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨äºè·å–å½“å‰åº”ç”¨å®ä¾‹ï¼Œä¸€èˆ¬ç”¨äºè·å– globalDataï¼Œå…¨å±€æ•°æ®ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="title function_">getApp</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(app.<span class="property">globalData</span>);</span><br><span class="line">app.<span class="title function_">doSomething</span>(); <span class="comment">// è°ƒç”¨ App.vue methods ä¸­çš„ doSomething æ–¹æ³•</span></span><br></pre></td></tr></table></figure><p>globalData åŸæœ¬æ˜¯å°ç¨‹åºä¸­çš„æ¦‚å¿µï¼Œuni-app å¼•å…¥ååœ¨ H5ã€APP ç­‰å¹³å°éƒ½å®ç°äº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  globalData: &#123;</span><br><span class="line">    text: &quot;text&quot;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">/*æ¯ä¸ªé¡µé¢å…¬å…±css */</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h2 id="getCurrentPages"><a href="#getCurrentPages" class="headerlink" title="getCurrentPages()"></a>getCurrentPages()</h2><p><code>getCurrentPages: &lt;&#123;&#125;&gt;() =&gt; Page.PageInstance&lt;AnyObject, &#123;&#125;&gt;[]</code></p><p><code>instance: &#123;route?: string, $getAppWebview?:  () =&gt; PlusWebviewWebviewObject,$vm?: any;&#125;</code></p><p>ç”¨äºè·å–å½“å‰é¡µé¢æ ˆçš„å®ä¾‹ï¼Œä»¥æ•°ç»„å½¢å¼æŒ‰æ ˆçš„é¡ºåºç»™å‡ºï¼Œæ•°ç»„ä¸­çš„å…ƒç´ ä¸ºé¡µé¢å®ä¾‹ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ ä¸ºé¦–é¡µï¼Œæœ€åä¸€ä¸ªå…ƒç´ ä¸ºå½“å‰é¡µé¢ã€‚</p><h2 id="getAppWebview"><a href="#getAppWebview" class="headerlink" title="$getAppWebview()"></a>$getAppWebview()</h2><p>åœ¨ getCurrentPages()è·å¾—çš„é¡µé¢é‡Œå†…ç½®äº†ä¸€ä¸ªæ–¹æ³• $getAppWebview() å¯ä»¥å¾—åˆ°å½“å‰ webview çš„å¯¹è±¡å®ä¾‹ï¼Œä»è€Œå®ç°å¯¹ webview æ›´å¼ºå¤§çš„æ§åˆ¶ï¼Œå¯å‚è€ƒï¼š<a href="http://www.html5plus.org/doc/zh_cn/webview.html#plus.webview.WebviewObject">WebviewObject</a></p><p><strong>æ­¤æ–¹æ³•ä»… App æ”¯æŒ</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> pages = <span class="title function_">getCurrentPages</span>();</span><br><span class="line"><span class="keyword">var</span> page = pages[pages.<span class="property">length</span> - <span class="number">1</span>];</span><br><span class="line"><span class="comment">// #ifdef APP-PLUS</span></span><br><span class="line"><span class="keyword">var</span> currentWebview = page.$getAppWebview();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(currentWebview.<span class="property">id</span>); <span class="comment">//è·å¾—å½“å‰webviewçš„id</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(currentWebview.<span class="title function_">isVisible</span>()); <span class="comment">//æŸ¥è¯¢å½“å‰webviewæ˜¯å¦å¯è§</span></span><br><span class="line"><span class="comment">// #endif</span></span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><h2 id="å¿«é€Ÿå…¥é—¨"><a href="#å¿«é€Ÿå…¥é—¨" class="headerlink" title="å¿«é€Ÿå…¥é—¨"></a>å¿«é€Ÿå…¥é—¨</h2><ol><li><p><a href="https://ask.dcloud.net.cn/article/36174">H5(Vue) è½¬ uni-app</a></p></li><li><p><a href="https://uniapp.dcloud.net.cn/tutorial/migration-to-vue3.html">Vu2 è½¬ Vue3</a></p></li><li><p><a href="https://uniapp.dcloud.net.cn/tutorial/page.html#lifecycle">é¡µé¢ç”Ÿå‘½å‘¨æœŸ</a></p></li><li><p><a href="https://ask.dcloud.net.cn/article/35489">UI ç»„ä»¶åº“</a></p></li><li><p><a href="https://uniapp.dcloud.net.cn/component/">uni-appç»„ä»¶</a></p></li></ol><h2 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h2><ol><li><a href="https://uniapp.dcloud.net.cn/tutorial/page.html#pagefaq">é¡µé¢åŠ è½½å¸¸è§é—®é¢˜</a></li></ol><h2 id="å¯¼èˆªæ "><a href="#å¯¼èˆªæ " class="headerlink" title="å¯¼èˆªæ "></a>å¯¼èˆªæ </h2><ol><li><p><a href="https://ask.dcloud.net.cn/article/34921">å¯¼èˆªæ å¼€å‘æŒ‡å—</a></p></li><li><p><a href="https://ext.dcloud.net.cn/plugin?id=1765">å¯¼èˆªæ ç¤ºä¾‹</a></p></li></ol><h2 id="æ•°æ®é€šä¿¡"><a href="#æ•°æ®é€šä¿¡" class="headerlink" title="æ•°æ®é€šä¿¡"></a>æ•°æ®é€šä¿¡</h2><ol><li><p><a href="https://ask.dcloud.net.cn/article/35021">å…¨å±€æ•°æ®æµæ–¹æ¡ˆ</a></p></li><li><p><a href="https://uniapp.dcloud.net.cn/tutorial/page.html#%E9%A1%B5%E9%9D%A2%E9%80%9A%E8%AE%AF">é¡µé¢é€šä¿¡æ–¹æ¡ˆ</a>ã€‚</p></li><li><p><a href="https://uniapp.dcloud.net.cn/api/window/communication.html">é¡µé¢é€šä¿¡ API</a></p></li><li><p><a href="https://ask.dcloud.net.cn/article/1318">å°ç¨‹åºæµè§ˆå™¨å†…æ ¸ç»†èŠ‚å‚è€ƒ</a>ã€‚</p></li></ol><h2 id="API-æ–‡æ¡£"><a href="#API-æ–‡æ¡£" class="headerlink" title="API æ–‡æ¡£"></a>API æ–‡æ¡£</h2><ol><li><p><a href="https://uniapp.dcloud.net.cn/collocation/pages#pages">pages.json</a> ä¸­é…ç½®ã€‚</p></li><li><p><a href="https://uniapp.dcloud.net.cn/component/navigator">navigator</a></p></li><li><p><a href="https://uniapp.dcloud.net.cn/api/router">API</a></p></li><li><p><a href="https://uniapp.dcloud.io/tutorial/renderjs">renderJS</a></p></li><li><p><a href="http://www.html5plus.org/doc/zh_cn/webview.html#plus.webview.WebviewObject">WebviewObject</a></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> uni-app </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Note </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UmiJS-v4</title>
      <link href="/2023/08/02/React/Umi/"/>
      <url>/2023/08/02/React/Umi/</url>
      
        <content type="html"><![CDATA[<h1 id="API"><a href="#API" class="headerlink" title="API"></a>API</h1><p><a href="https://umijs.org/docs/api/api">API</a></p><h1 id="è®¾è®¡æ€è·¯"><a href="#è®¾è®¡æ€è·¯" class="headerlink" title="è®¾è®¡æ€è·¯"></a>è®¾è®¡æ€è·¯</h1><p>è®¾è®¡æ€è·¯åŒ…æ‹¬:</p><ol><li><p>æŠ€æœ¯æ”¶æ•›</p></li><li><p>æ’ä»¶å’Œæ’ä»¶é›†</p></li><li><p>import all in umi</p></li><li><p>ç¼–è¯‘æ—¶æ¡†æ¶</p></li><li><p>ä¾èµ–é¢„æ‰“åŒ…</p></li><li><p>é»˜è®¤å¿«</p></li><li><p>çº¦æŸä¸å¼€æ”¾</p></li></ol><p><a href="https://mp.weixin.qq.com/s?__biz=MjM5NDgyODI4MQ==&mid=2247484533&idx=1&sn=9b15a67b88ebc95476fce1798eb49146">4-7 è¯¦è§</a></p><h2 id="æŠ€æœ¯æ”¶æ•›"><a href="#æŠ€æœ¯æ”¶æ•›" class="headerlink" title="æŠ€æœ¯æ”¶æ•›"></a>æŠ€æœ¯æ”¶æ•›</h2><ol><li><p>æœ¯æ ˆæ”¶æ•›</p></li><li><p>ä¾èµ–æ”¶æ•›</p></li></ol><p><img src="https://img.alicdn.com/tfs/TB1hE8ywrr1gK0jSZFDXXb9yVXa-1227-620.png"></p><h2 id="æ’ä»¶å’Œæ’ä»¶é›†"><a href="#æ’ä»¶å’Œæ’ä»¶é›†" class="headerlink" title="æ’ä»¶å’Œæ’ä»¶é›†"></a>æ’ä»¶å’Œæ’ä»¶é›†</h2><p>æ‹“å±•ä¸€ç±»ä¸šåŠ¡ï¼Œè€Œä¸ä»…ä»…æ˜¯æ‹“å±•æŸä¸€åŠŸèƒ½ã€‚</p><p><img src="https://img.alicdn.com/tfs/TB1mrhuwqL7gK0jSZFBXXXZZpXa-956-728.png"></p><h2 id="import-all-in-umi"><a href="#import-all-in-umi" class="headerlink" title="import all in umi"></a>import all in umi</h2><p>æ‰€æœ‰çš„å¯¼å…¥éƒ½ä» umi ä¸­è¿›è¡Œå¯¼å‡ºï¼Œå‡å°‘ import æ•°é‡ã€‚</p><p><code>import &#123; connect, useModel, useIntl, useRequest, MicroApp, ... &#125; from &#39;umi&#39;;</code></p><h1 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ config</span><br><span class="line">â”‚   â””â”€â”€ config.ts</span><br><span class="line">â”œâ”€â”€ dist</span><br><span class="line">â”œâ”€â”€ mock</span><br><span class="line">â”‚   â””â”€â”€ app.tsï½œtsx</span><br><span class="line">â”œâ”€â”€ src</span><br><span class="line">â”‚   â”œâ”€â”€ .umi</span><br><span class="line">â”‚   â”œâ”€â”€ .umi-production</span><br><span class="line">â”‚   â”œâ”€â”€ layouts</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ BasicLayout.tsx</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ index.less</span><br><span class="line">â”‚   â”œâ”€â”€ models</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ global.ts</span><br><span class="line">â”‚   â”‚   â””â”€â”€ index.ts</span><br><span class="line">â”‚   â”œâ”€â”€ pages</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ index.less</span><br><span class="line">â”‚   â”‚   â””â”€â”€ index.tsx</span><br><span class="line">â”‚   â”œâ”€â”€ utils // æ¨èç›®å½•</span><br><span class="line">â”‚   â”‚   â””â”€â”€ index.ts</span><br><span class="line">â”‚   â”œâ”€â”€ services // æ¨èç›®å½•</span><br><span class="line">â”‚   â”‚   â””â”€â”€ api.ts</span><br><span class="line">â”‚   â”œâ”€â”€ app.(ts|tsx)</span><br><span class="line">â”‚   â”œâ”€â”€ global.ts</span><br><span class="line">â”‚   â”œâ”€â”€ global.(css|less|sass|scss)</span><br><span class="line">â”‚   â”œâ”€â”€ overrides.(css|less|sass|scss)</span><br><span class="line">â”‚   â”œâ”€â”€ favicon.(ico|gif|png|jpg|jpeg|svg|avif|webp)</span><br><span class="line">â”‚   â””â”€â”€ loading.(tsx|jsx)</span><br><span class="line">â”œâ”€â”€ node_modules</span><br><span class="line">â”‚   â””â”€â”€ .cache</span><br><span class="line">â”‚       â”œâ”€â”€ bundler-webpack</span><br><span class="line">â”‚       â”œâ”€â”€ mfsu</span><br><span class="line">â”‚       â””â”€â”€ mfsu-deps</span><br><span class="line">â”œâ”€â”€ .<span class="built_in">env</span></span><br><span class="line">â”œâ”€â”€ plugin.ts</span><br><span class="line">â”œâ”€â”€ .umirc.ts // ä¸ config/config æ–‡ä»¶ 2 é€‰ä¸€</span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ tsconfig.json</span><br><span class="line">â””â”€â”€ typings.d.ts</span><br></pre></td></tr></table></figure><h1 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h1><h2 id="é…ç½®å¼è·¯ç”±"><a href="#é…ç½®å¼è·¯ç”±" class="headerlink" title="é…ç½®å¼è·¯ç”±"></a>é…ç½®å¼è·¯ç”±</h2><p>åŒ Vue-Router è·¯ç”±é…ç½®åŸºæœ¬ä¸€è‡´ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** .umirc.ts or config/config.js */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    <span class="comment">/** åµŒå¥—è·¯ç”± &amp; layout */</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="string">&quot;@/layouts/index&quot;</span>,</span><br><span class="line">      <span class="attr">routes</span>: [</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">&quot;/list&quot;</span>, <span class="attr">component</span>: <span class="string">&quot;list&quot;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">&quot;/admin&quot;</span>, <span class="attr">component</span>: <span class="string">&quot;admin&quot;</span> &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">/** redirect */</span></span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">&quot;/err&quot;</span>, <span class="attr">redirect</span>: <span class="string">&quot;/list&quot;</span> &#125;,</span><br><span class="line">    <span class="comment">/** wrapper */</span></span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">&quot;/user&quot;</span>, <span class="attr">component</span>: <span class="string">&quot;user&quot;</span>, <span class="attr">wrappers</span>: [<span class="string">&quot;@/wrappers/auth&quot;</span>] &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** src/wrappers/auth */</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Navigate</span>, <span class="title class_">Outlet</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;umi&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (props) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; isLogin &#125; = <span class="title function_">useAuth</span>();</span><br><span class="line">  <span class="keyword">if</span> (isLogin) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Outlet</span> /&gt;</span></span>;</span><br><span class="line">  &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Navigate</span> <span class="attr">to</span>=<span class="string">&quot;/login&quot;</span> /&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>wrappers ä¸­çš„æ¯ä¸ªç»„ä»¶ä¼šç»™å½“å‰çš„è·¯ç”±ç»„ä»¶å¢åŠ ä¸€å±‚åµŒå¥—è·¯ç”±ï¼Œå¦‚æœä½ å¸Œæœ›è·¯ç”±ç»“æ„ä¸å‘ç”Ÿå˜åŒ–ï¼Œæ¨èä½¿ç”¨é«˜é˜¶ç»„ä»¶ã€‚å…ˆåœ¨é«˜é˜¶ç»„ä»¶ä¸­å®ç° wrapper ä¸­çš„é€»è¾‘ï¼Œç„¶åä½¿ç”¨è¯¥é«˜é˜¶ç»„ä»¶è£…é¥°å¯¹åº”çš„è·¯ç”±ç»„ä»¶ã€‚</p></blockquote><h2 id="çº¦å®šå¼è·¯ç”±"><a href="#çº¦å®šå¼è·¯ç”±" class="headerlink" title="çº¦å®šå¼è·¯ç”±"></a>çº¦å®šå¼è·¯ç”±</h2><p>é€šè¿‡æ–‡ä»¶ç›®å½•çš„ç»“æ„ç”Ÿæˆè·¯ç”±è¡¨ã€‚</p><p>æ¯”å¦‚ä»¥ä¸‹æ–‡ä»¶ç»“æ„ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">  â””â”€â”€ pages</span><br><span class="line">    â”œâ”€â”€ index.tsx</span><br><span class="line">    â””â”€â”€ users.tsx</span><br></pre></td></tr></table></figure><p>ä¼šå¾—åˆ°ä»¥ä¸‹è·¯ç”±é…ç½®ï¼Œ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>, <span class="attr">component</span>: <span class="string">&quot;@/pages/index&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&quot;/users&quot;</span>, <span class="attr">component</span>: <span class="string">&quot;@/pages/users&quot;</span> &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è·¯ç”±"><a href="#åŠ¨æ€è·¯ç”±" class="headerlink" title="åŠ¨æ€è·¯ç”±"></a>åŠ¨æ€è·¯ç”±</h2><p>çº¦å®šï¼Œå¸¦ $ å‰ç¼€çš„ç›®å½•æˆ–æ–‡ä»¶ä¸ºåŠ¨æ€è·¯ç”±ã€‚è‹¥ $ åä¸æŒ‡å®šå‚æ•°åï¼Œåˆ™ä»£è¡¨ * é€šé…ï¼Œæ¯”å¦‚ä»¥ä¸‹ç›®å½•ç»“æ„ï¼š</p><ol><li><p>src&#x2F;pages&#x2F;users&#x2F;$id.tsx ä¼šæˆä¸º &#x2F;users&#x2F;:id</p></li><li><p>src&#x2F;pages&#x2F;users&#x2F;$id&#x2F;settings.tsx ä¼šæˆä¸º &#x2F;users&#x2F;:id&#x2F;settings</p></li></ol><p>ä¸¾ä¸ªå®Œæ•´çš„ä¾‹å­ï¼Œæ¯”å¦‚ä»¥ä¸‹æ–‡ä»¶ç»“æ„ï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+ pages/</span><br><span class="line">  + foo/</span><br><span class="line">    - <span class="variable">$slug</span>.tsx</span><br><span class="line">  + <span class="variable">$bar</span>/</span><br><span class="line">    - $.tsx</span><br><span class="line">  - index.tsx</span><br></pre></td></tr></table></figure><p>ä¼šç”Ÿæˆè·¯ç”±é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&quot;/&quot;</span>, <span class="attr">component</span>: <span class="string">&quot;@/pages/index.tsx&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&quot;/foo/:slug&quot;</span>, <span class="attr">component</span>: <span class="string">&quot;@/pages/foo/$slug.tsx&quot;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">&quot;/:bar/*&quot;</span>, <span class="attr">component</span>: <span class="string">&quot;@/pages/$bar/$.tsx&quot;</span> &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="è·¯ç”±è·³è½¬"><a href="#è·¯ç”±è·³è½¬" class="headerlink" title="è·¯ç”±è·³è½¬"></a>è·¯ç”±è·³è½¬</h2><h3 id="History"><a href="#History" class="headerlink" title="History"></a>History</h3><p>å’Œ history ç›¸å…³çš„æ“ä½œï¼Œç”¨äºè·å–å½“å‰è·¯ç”±ä¿¡æ¯ã€æ‰§è¡Œè·¯ç”±è·³è½¬ã€ç›‘å¬è·¯ç”±å˜æ›´ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; history &#125; <span class="keyword">from</span> <span class="string">&quot;umi&quot;</span>;</span><br><span class="line"></span><br><span class="line">history.<span class="title function_">push</span>(<span class="string">&quot;/list&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** string */</span></span><br><span class="line">history.<span class="title function_">push</span>(<span class="string">&quot;/list?a=b&amp;c=d#anchor&quot;</span>, state);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** object */</span></span><br><span class="line">history.<span class="title function_">push</span>(</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">pathname</span>: <span class="string">&quot;/list&quot;</span>,</span><br><span class="line">    <span class="attr">search</span>: <span class="string">&quot;?a=b&amp;c=d&quot;</span>,</span><br><span class="line">    <span class="attr">hash</span>: <span class="string">&quot;anchor&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/** historyState */</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">some</span>: <span class="string">&quot;state-data&quot;</span>,</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">history.<span class="title function_">push</span>(&#123;&#125;, state);</span><br><span class="line"></span><br><span class="line">history.<span class="title function_">back</span>();</span><br><span class="line">history.<span class="title function_">go</span>(-<span class="number">1</span>);</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨æ„ï¼šhistory.push å’Œ history.replace éœ€è¦ä½¿ç”¨ state éœ€å°† state ä½œä¸ºè¿™ä¸¤ä¸ª API çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’</p></blockquote><h3 id="Link-ç»„ä»¶è·³è½¬"><a href="#Link-ç»„ä»¶è·³è½¬" class="headerlink" title="Link ç»„ä»¶è·³è½¬"></a>Link ç»„ä»¶è·³è½¬</h3><p><code>&lt;Link&gt;</code> æ˜¯ React ç»„ä»¶ï¼Œæ˜¯å¸¦è·¯ç”±è·³è½¬åŠŸèƒ½çš„ <code>&lt;a&gt;</code> å…ƒç´ ã€‚</p><p>ç±»å‹å®šä¹‰å¦‚ä¸‹ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">function</span> <span class="title function_">Link</span>(<span class="params">props: &#123;</span></span><br><span class="line"><span class="params">  /** é¢„åŠ è½½ */</span></span><br><span class="line"><span class="params">  prefetch?: <span class="built_in">boolean</span>;</span></span><br><span class="line"><span class="params">  to: <span class="built_in">string</span> | Partial&lt;&#123; pathname: <span class="built_in">string</span>; search: <span class="built_in">string</span>; hash: <span class="built_in">string</span> &#125;&gt;;</span></span><br><span class="line"><span class="params">  replace?: <span class="built_in">boolean</span>;</span></span><br><span class="line"><span class="params">  state?: <span class="built_in">any</span>;</span></span><br><span class="line"><span class="params">  /** &lt;Link&gt; -&gt; &lt;a&gt; */</span></span><br><span class="line"><span class="params">  reloadDocument?: <span class="built_in">boolean</span>;</span></span><br><span class="line"><span class="params">&#125;</span>): <span class="title class_">React</span>.<span class="property">ReactElement</span>;</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ï¼š</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Link</span> &#125; <span class="keyword">from</span> <span class="string">&quot;umi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">IndexPage</span>(<span class="params">&#123; user &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&#123;user.id&#125;</span>&gt;</span>&#123;user.name&#125;<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è·¯ç”±å‚æ•°è·å–"><a href="#è·¯ç”±å‚æ•°è·å–" class="headerlink" title="è·¯ç”±å‚æ•°è·å–"></a>è·¯ç”±å‚æ•°è·å–</h2><p>è·¯ç”±ç›¸å…³å‚æ•°æœ‰ï¼šrouteMatchã€locationã€paramsã€queryã€‚</p><h3 id="match"><a href="#match" class="headerlink" title="match"></a>match</h3><p><code>useMatch</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> match = <span class="title function_">useMatch</span>(<span class="string">&#x27;/comp/:id&#x27;</span>)</span><br><span class="line"><span class="comment">// match</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;params&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: <span class="string">&quot;paramId&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;pathname&quot;</span>: <span class="string">&quot;/comp/paramId/&quot;</span>,</span><br><span class="line">  <span class="string">&quot;pathnameBase&quot;</span>: <span class="string">&quot;/comp/paramId&quot;</span>,</span><br><span class="line">  <span class="string">&quot;pattern&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;path&quot;</span>: <span class="string">&quot;/comp/:id&quot;</span>,</span><br><span class="line">  <span class="string">&quot;caseSensitive&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="string">&quot;end&quot;</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="location"><a href="#location" class="headerlink" title="location"></a>location</h3><p><code>useLocation</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> location = <span class="title function_">useLocation</span>();</span><br><span class="line"><span class="comment">// location</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;pathname&quot;</span>: <span class="string">&quot;/path/&quot;</span>,</span><br><span class="line"><span class="string">&quot;search&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line"><span class="string">&quot;hash&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line"><span class="string">&quot;state&quot;</span>: <span class="literal">null</span>,</span><br><span class="line"><span class="string">&quot;key&quot;</span>: <span class="string">&quot;default&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ğŸš¨<br>æ¨èä½¿ç”¨ useLocation, è€Œä¸æ˜¯ç›´æ¥è®¿é—® history.location. ä¸¤è€…çš„åŒºåˆ«æ˜¯ pathname çš„éƒ¨åˆ†ã€‚ history.location.pathname æ˜¯å®Œæ•´çš„æµè§ˆå™¨çš„è·¯å¾„åï¼›è€Œ useLocation ä¸­è¿”å›çš„ pathname æ˜¯ç›¸å¯¹é¡¹ç›®é…ç½®çš„ base çš„è·¯å¾„ã€‚</p><p>ä¸¾ä¾‹ï¼šé¡¹ç›®å¦‚æœé…ç½® base: â€˜&#x2F;testbaseâ€™, å½“å‰æµè§ˆå™¨åœ°å€ä¸º <a href="https://localhost:8000/testbase/page/apple">https://localhost:8000/testbase/page/apple</a></p><p>history.location.pathname ä¸º &#x2F;testbase&#x2F;page&#x2F;apple</p><p>useLocation().pathname ä¸º &#x2F;page&#x2F;apple</p></blockquote><h3 id="Params"><a href="#Params" class="headerlink" title="Params"></a>Params</h3><p><code>useParams</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·¯ç”±é…ç½® /comp/:id</span></span><br><span class="line"><span class="comment">// å½“å‰ location /comp/paramId</span></span><br><span class="line"><span class="keyword">const</span> params = <span class="title function_">useParams</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// params</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;id&quot;</span>: <span class="string">&quot;paramId&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="query"><a href="#query" class="headerlink" title="query"></a>query</h3><p><code>useSearchParams</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å½“å‰ location /comp?a=b;</span></span><br><span class="line"><span class="keyword">const</span> [searchParams, setSearchParams] = <span class="title function_">useSearchParams</span>();</span><br><span class="line">searchParams.<span class="title function_">get</span>(<span class="string">&#x27;a&#x27;</span>) <span class="comment">// b</span></span><br><span class="line">searchParams.<span class="title function_">toString</span>() <span class="comment">// a=b</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">setSearchParams</span>(&#123;<span class="attr">a</span>:<span class="string">&#x27;c&#x27;</span>,<span class="attr">d</span>:<span class="string">&#x27;e&#x27;</span>&#125;) <span class="comment">// location å˜æˆ /comp?a=c&amp;d=e</span></span><br><span class="line">searchParams çš„ api å‚è€ƒ</span><br></pre></td></tr></table></figure><h1 id="Mock"><a href="#Mock" class="headerlink" title="Mock"></a>Mock</h1><p>ç¤ºä¾‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ./mock/users.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// è¿”å›å€¼å¯ä»¥æ˜¯æ•°ç»„å½¢å¼ GET é»˜è®¤å¯ä»¥çœç•¥</span></span><br><span class="line">  <span class="string">&quot;GET /api/users&quot;</span>: [</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;foo&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&quot;bar&quot;</span> &#125;,</span><br><span class="line">  ],</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿”å›å€¼ä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡å½¢å¼</span></span><br><span class="line">  <span class="string">&quot;GET /api/users/1&quot;</span>: &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;foo&quot;</span> &#125;,</span><br><span class="line">  <span class="string">&quot;POST /api/users&quot;</span>: &#123; <span class="attr">result</span>: <span class="string">&quot;true&quot;</span> &#125;,</span><br><span class="line">  <span class="string">&quot;PUT /api/users/1&quot;</span>: &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;new-foo&quot;</span> &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>defineMock</code> å¼€å¯ ts æç¤ºã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineMock &#125; <span class="keyword">from</span> <span class="string">&quot;umi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineMock</span>(&#123;</span><br><span class="line">  <span class="string">&quot;/api/users&quot;</span>: [</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;foo&quot;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&quot;bar&quot;</span> &#125;,</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;/api/users/1&quot;</span>: &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&quot;foo&quot;</span> &#125;,</span><br><span class="line">  <span class="string">&quot;GET /api/users/2&quot;</span>: <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">status</span>(<span class="number">200</span>).<span class="title function_">json</span>(&#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&quot;bar&quot;</span> &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>å¼•å…¥ Mock.js ç”Ÿæˆæ•°æ®ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mockjs <span class="keyword">from</span> <span class="string">&quot;mockjs&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// ä½¿ç”¨ mockjs ç­‰ä¸‰æ–¹åº“</span></span><br><span class="line">  <span class="string">&quot;GET /api/tags&quot;</span>: mockjs.<span class="title function_">mock</span>(&#123;</span><br><span class="line">    <span class="string">&quot;list|100&quot;</span>: [&#123; <span class="attr">name</span>: <span class="string">&quot;@city&quot;</span>, <span class="string">&quot;value|1-100&quot;</span>: <span class="number">50</span>, <span class="string">&quot;type|0-2&quot;</span>: <span class="number">1</span> &#125;],</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="ä»£ç†"><a href="#ä»£ç†" class="headerlink" title="ä»£ç†"></a>ä»£ç†</h1><p>åŒ vite ä¸€æ ·ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">proxy</span>: &#123;</span><br><span class="line">    <span class="string">&quot;/api&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">target</span>: <span class="string">&quot;http://jsonplaceholder.typicode.com/&quot;</span>,</span><br><span class="line">      <span class="attr">changeOrigin</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">pathRewrite</span>: &#123; <span class="string">&quot;^/api&quot;</span>: <span class="string">&quot;&quot;</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="æ•°æ®é¢„åŠ è½½"><a href="#æ•°æ®é¢„åŠ è½½" class="headerlink" title="æ•°æ®é¢„åŠ è½½"></a>æ•°æ®é¢„åŠ è½½</h1><p>Umi ä¼šè‡ªåŠ¨æ ¹æ®å½“å‰è·¯ç”±æˆ–å‡†å¤‡è·³è½¬çš„è·¯ç”±ï¼Œå¹¶è¡Œåœ°å‘èµ·ä»–ä»¬çš„æ•°æ®è¯·æ±‚ï¼Œå› æ­¤å½“è·¯ç”±ç»„ä»¶åŠ è½½å®Œæˆåï¼Œå·²ç»æœ‰é©¬ä¸Šå¯ä»¥ä½¿ç”¨çš„æ•°æ®äº†ã€‚</p><p>é…ç½®å¼€å¯ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** .umirc.ts */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">clientLoader</span>: &#123;&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ–¹å¼:</p><p>åœ¨è·¯ç”±æ–‡ä»¶ä¸­ï¼Œé™¤äº†é»˜è®¤å¯¼å‡ºçš„é¡µé¢ç»„ä»¶å¤–ï¼Œå†å¯¼å‡ºä¸€ä¸ª clientLoader å‡½æ•°ï¼Œå¹¶ä¸”åœ¨è¯¥å‡½æ•°å†…å®Œæˆè·¯ç”±æ•°æ®åŠ è½½çš„é€»è¾‘ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** pages/.../some_page.tsx */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; useClientLoaderData &#125; <span class="keyword">from</span> <span class="string">&quot;umi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">SomePage</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; data &#125; = <span class="title function_">useClientLoaderData</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;data&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">clientLoader</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;/api/data&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å¾®ç”Ÿæˆå™¨"><a href="#å¾®ç”Ÿæˆå™¨" class="headerlink" title="å¾®ç”Ÿæˆå™¨"></a>å¾®ç”Ÿæˆå™¨</h1><p>Umi ä¸­å†…ç½®äº†ä¼—å¤šå¾®ç”Ÿæˆå™¨ï¼ŒååŠ©ä½ åœ¨å¼€å‘ä¸­å¿«é€Ÿçš„å®Œæˆä¸€äº›ç¹ççš„å·¥ä½œã€‚</p><ol><li><p>é¡µé¢ç”Ÿæˆå™¨</p></li><li><p>ç»„ä»¶ç”Ÿæˆå™¨</p></li><li><p>RouteAPI ç”Ÿæˆå™¨</p></li><li><p>Mock ç”Ÿæˆå™¨</p></li><li><p>Prettier é…ç½®ç”Ÿæˆå™¨</p></li><li><p>Jest é…ç½®ç”Ÿæˆå™¨</p></li><li><p>Tailwind CSS é…ç½®ç”Ÿæˆå™¨</p></li><li><p>DvaJS é…ç½®ç”Ÿæˆå™¨</p></li><li><p>Precommit é…ç½®ç”Ÿæˆå™¨</p></li></ol><h1 id="Umi-Max"><a href="#Umi-Max" class="headerlink" title="Umi Max"></a>Umi Max</h1><p>Umi Proï¼Œå†…ç½®å¾ˆå¤šæ’ä»¶ã€‚</p><h2 id="Layout"><a href="#Layout" class="headerlink" title="Layout"></a>Layout</h2><p>é›†æˆ Ant Design çš„ Layoutï¼ˆProLayoutï¼‰ã€‚</p><h3 id="å¯ç”¨æ–¹å¼"><a href="#å¯ç”¨æ–¹å¼" class="headerlink" title="å¯ç”¨æ–¹å¼"></a>å¯ç”¨æ–¹å¼</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** config/config.ts */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">layout</span>: &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&quot;your app title&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="æ„å»ºæ—¶é…ç½®"><a href="#æ„å»ºæ—¶é…ç½®" class="headerlink" title="æ„å»ºæ—¶é…ç½®"></a>æ„å»ºæ—¶é…ç½®</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** config/config.ts */</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineConfig &#125; <span class="keyword">from</span> <span class="string">&quot;umi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">defineConfig</span>(&#123;</span><br><span class="line">  <span class="attr">layout</span>: &#123;</span><br><span class="line">    <span class="comment">/** æ˜¾ç¤ºåœ¨å¸ƒå±€å·¦ä¸Šè§’çš„äº§å“åï¼Œé»˜è®¤å€¼ä¸ºåŒ…åã€‚ */</span></span><br><span class="line">    <span class="attr">title</span>: <span class="string">&quot;Ant Design&quot;</span>,</span><br><span class="line">    <span class="comment">/** æ˜¯å¦å¼€å§‹å›½é™…åŒ–é…ç½®ã€‚ */</span></span><br><span class="line">    <span class="attr">locale</span>: <span class="literal">false</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="è¿è¡Œæ—¶é…ç½®"><a href="#è¿è¡Œæ—¶é…ç½®" class="headerlink" title="è¿è¡Œæ—¶é…ç½®"></a>è¿è¡Œæ—¶é…ç½®</h3><p>è¿è¡Œæ—¶é…ç½®å†™åœ¨ <code>src/app.tsx</code> ä¸­ï¼Œkey ä¸º <code>layout</code>ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">RunTimeLayoutConfig</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@umijs/max&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">layout</span>: <span class="title class_">RunTimeLayoutConfig</span> = <span class="function">(<span class="params">initialState</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">/** æ˜¾ç¤ºåœ¨å¸ƒå±€å·¦ä¸Šè§’çš„äº§å“åï¼Œé»˜è®¤å€¼ä¸ºåŒ…å */</span></span><br><span class="line">    <span class="attr">title</span>: <span class="string">&quot;Ant Design&quot;</span>,</span><br><span class="line">    <span class="comment">/** æ˜¾ç¤ºåœ¨å¸ƒå±€å·¦ä¸Šè§’äº§å“åå‰çš„äº§å“ Logo */</span></span><br><span class="line">    <span class="attr">logo</span>: <span class="string">&quot;https://img.alicdn.com/tfs/TB1YHEpwUT1gK0jSZFhXXaAtVXa-28-27.svg&quot;</span>,</span><br><span class="line">    <span class="comment">/** ç”¨äºè¿è¡Œæ—¶é…ç½®é»˜è®¤ Layout çš„ UI ä¸­ï¼Œç‚¹å‡»é€€å‡ºç™»å½•çš„å¤„ç†é€»è¾‘ï¼Œé»˜è®¤ä¸åšå¤„ç† */</span></span><br><span class="line">    <span class="attr">logout</span>: <span class="function">(<span class="params">initialState: <span class="built_in">any</span></span>) =&gt;</span> &#123;&#125;</span><br><span class="line">    <span class="comment">/** å‘ç”Ÿé”™è¯¯åçš„å›è°ƒï¼ˆå¯åšä¸€äº›é”™è¯¯æ—¥å¿—ä¸ŠæŠ¥ï¼Œæ‰“ç‚¹ç­‰ï¼‰ */</span></span><br><span class="line">    <span class="attr">onError</span>: <span class="function">(<span class="params">error: <span class="built_in">Error</span>, info: <span class="built_in">any</span></span>) =&gt;</span> &#123;&#125;;</span><br><span class="line">    <span class="comment">/** å‘ç”Ÿé”™è¯¯åå±•ç¤ºçš„ç»„ä»¶ */</span></span><br><span class="line">    <span class="title class_">ErrorComponent</span>: <span class="function">(<span class="params">error: <span class="built_in">Error</span></span>) =&gt;</span> <span class="title class_">React</span>.<span class="property">ReactElement</span>&lt;<span class="built_in">any</span>&gt;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å…¶ä»–å±æ€§è§ï¼šhttps://procomponents.ant.design/components/layout#prolayout</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="æ‹“å±•è·¯ç”±é…ç½®"><a href="#æ‹“å±•è·¯ç”±é…ç½®" class="headerlink" title="æ‹“å±•è·¯ç”±é…ç½®"></a>æ‹“å±•è·¯ç”±é…ç½®</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config/route.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">routes</span>: <span class="title class_">IBestAFSRoute</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/welcome&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="string">&quot;IndexPage&quot;</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;æ¬¢è¿&quot;</span>, <span class="comment">// å…¼å®¹æ­¤å†™æ³•</span></span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&quot;testicon&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ›´å¤šåŠŸèƒ½æŸ¥çœ‹</span></span><br><span class="line">    <span class="comment">// https://beta-pro.ant.design/docs/advanced-menu</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ–°é¡µé¢æ‰“å¼€</span></span><br><span class="line">    <span class="attr">target</span>: <span class="string">&quot;_blank&quot;</span>,</span><br><span class="line">    <span class="comment">// ä¸å±•ç¤ºé¡¶æ </span></span><br><span class="line">    <span class="attr">headerRender</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// ä¸å±•ç¤ºé¡µè„š</span></span><br><span class="line">    <span class="attr">footerRender</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// ä¸å±•ç¤ºèœå•</span></span><br><span class="line">    <span class="attr">menuRender</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// ä¸å±•ç¤ºèœå•é¡¶æ </span></span><br><span class="line">    <span class="attr">menuHeaderRender</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="comment">// æƒé™é…ç½®ï¼Œéœ€è¦ä¸ plugin-access æ’ä»¶é…åˆä½¿ç”¨</span></span><br><span class="line">    <span class="attr">access</span>: <span class="string">&quot;canRead&quot;</span>,</span><br><span class="line">    <span class="comment">// éšè—å­èœå•</span></span><br><span class="line">    <span class="attr">hideChildrenInMenu</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// éšè—è‡ªå·±å’Œå­èœå•</span></span><br><span class="line">    <span class="attr">hideInMenu</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// åœ¨é¢åŒ…å±‘ä¸­éšè—</span></span><br><span class="line">    <span class="attr">hideInBreadcrumb</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">// å­é¡¹å¾€ä¸Šæï¼Œä»æ—§å±•ç¤º,</span></span><br><span class="line">    <span class="attr">flatMenu</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="antd"><a href="#antd" class="headerlink" title="antd"></a>antd</h2><p>æ•´åˆ antd ç»„ä»¶åº“ã€‚</p><h3 id="å¯ç”¨æ–¹å¼-1"><a href="#å¯ç”¨æ–¹å¼-1" class="headerlink" title="å¯ç”¨æ–¹å¼"></a>å¯ç”¨æ–¹å¼</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** config/config.ts */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">antd</span>: &#123;</span><br><span class="line">    <span class="comment">/** é…ç½® antd çš„ configProvider */</span></span><br><span class="line">    <span class="attr">configProvider</span>: &#123;&#125;,</span><br><span class="line">    <span class="comment">/** å¼€å¯æš—è‰²ä¸»é¢˜ */</span></span><br><span class="line">    <span class="attr">dark</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">/** å¼€å¯ç´§å‡‘ä¸»é¢˜ */</span></span><br><span class="line">    <span class="attr">compact</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">/** é…ç½® antd çš„ babel-plugin-import æŒ‰éœ€åŠ è½½ */</span></span><br><span class="line">    <span class="attr">import</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">/** é…ç½®ä½¿ç”¨ antd çš„æ ·å¼ï¼Œé»˜è®¤ less */</span></span><br><span class="line">    <span class="attr">style</span>: <span class="string">&quot;less&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** ---antd.v5--- */</span></span><br><span class="line">    <span class="comment">/** é…ç½® antd@5 çš„ theme tokenï¼Œç­‰åŒäºé…ç½® configProvider.themeï¼Œä¸”è¯¥é…ç½®é¡¹æ‹¥æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ */</span></span><br><span class="line">    <span class="attr">theme</span>: &#123;&#125;,</span><br><span class="line">    <span class="comment">/** é…ç½® antd çš„ App åŒ…è£¹ç»„ä»¶ï¼Œè¯·æ³¨æ„ antd@5.1.0 ~ 5.2.3 ä»…èƒ½é€šè¿‡ appConfig: &#123;&#125; å¯ç”¨ï¼Œåªæœ‰ antd &gt;=5.3.0 æ‰æ”¯æŒæ›´å¤š App é…ç½®é¡¹ç›® */</span></span><br><span class="line">    <span class="attr">appConfig</span>: &#123;&#125;,</span><br><span class="line">    <span class="comment">/** é…ç½® antd çš„ DatePickerã€TimePickerã€Calendar ç»„ä»¶æ˜¯å¦ä½¿ç”¨ moment ä½œä¸ºæ—¥æœŸå¤„ç†åº“ï¼Œé»˜è®¤ä¸º false */</span></span><br><span class="line">    <span class="attr">momentPicker</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="comment">/** é…ç½® antd çš„ StyleProvider ç»„ä»¶ï¼Œè¯¥ç»„ä»¶ç”¨äºå…¼å®¹ä½ç‰ˆæœ¬æµè§ˆå™¨ï¼Œå¦‚ IE11ã€‚å½“ä½ çš„é¡¹ç›®é…ç½®äº† legacy æˆ–è€… targets åŒ…å« ie æ—¶ï¼Œä¼šè‡ªåŠ¨è¿›è¡Œé™çº§å¤„ç†ï¼Œä¸éœ€è¦æ‰‹åŠ¨é…ç½®ã€‚ */</span></span><br><span class="line">    <span class="attr">styleProvider</span>: &#123;</span><br><span class="line">      <span class="attr">hashPriority</span>: <span class="string">&quot;high&quot;</span>,</span><br><span class="line">      <span class="attr">legacyTransformer</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p><a href="https://ant.design/components/config-provider-cn?theme=dark">configProvider</a> å±æ€§æ³¨å…¥ã€‚</p></blockquote><h2 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h2><p><code>@umi/max</code> å†…ç½®äº†æ•°æ®æµç®¡ç†æ’ä»¶ï¼Œå®ƒæ˜¯ä¸€ç§åŸºäº <code>hooks</code> èŒƒå¼çš„è½»é‡çº§æ•°æ®ç®¡ç†æ–¹æ¡ˆï¼Œå¯ä»¥åœ¨ Umi é¡¹ç›®ä¸­ç®¡ç†å…¨å±€çš„å…±äº«æ•°æ®ã€‚</p><h3 id="Create-Model"><a href="#Create-Model" class="headerlink" title="Create Model"></a>Create Model</h3><p>çº¦å®šå¼ç›®å½•ç»“æ„ï¼š</p><ol><li><p><code>src/models/xxx.&#123;js,jsx,ts,tsx&#125;</code></p></li><li><p><code>src/pages/xxx/models/xxx.&#123;js,jsx,ts,tsx&#125;</code></p></li></ol><blockquote><p>æ³¨æ„ namespace éœ€è¦å…¨å±€å”¯ä¸€ã€‚</p></blockquote><h3 id="Use-Model"><a href="#Use-Model" class="headerlink" title="Use Model"></a>Use Model</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** src/components/Username/index.tsx */</span></span><br><span class="line"><span class="keyword">import</span> &#123; useModel &#125; <span class="keyword">from</span> <span class="string">&#x27;umi&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Page</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; user, loading &#125; = <span class="title function_">useModel</span>(<span class="string">&#x27;userModel&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** æ•°æ®è¿‡æ»¤ */</span></span><br><span class="line">  <span class="keyword">const</span> &#123; add, minus &#125; = <span class="title function_">useModel</span>(<span class="string">&#x27;counterModel&#x27;</span>, <span class="function">(<span class="params">model</span>) =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">add</span>: model.<span class="property">increment</span>,</span><br><span class="line">    <span class="attr">minus</span>: model.<span class="property">decrement</span>,</span><br><span class="line">  &#125;));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &#123;loading ? <span class="language-xml"><span class="tag">&lt;&gt;</span><span class="tag">&lt;/&gt;</span></span>: <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;user.username&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&#125;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Global-Init-State"><a href="#Global-Init-State" class="headerlink" title="Global Init State"></a>Global Init State</h3><p>åœ¨ <code>src/app.js</code> å†…æš´éœ² <code>getInitialState</code> æ–¹æ³•ã€‚</p><p>ç¤ºä¾‹ï¼š</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** src/app.ts [createInitState] */</span></span><br><span class="line"><span class="keyword">import</span> &#123; fetchInitialData &#125; <span class="keyword">from</span> <span class="string">&quot;@/services/initial&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getInitialState</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> initialData = <span class="keyword">await</span> <span class="title function_">fetchInitialData</span>();</span><br><span class="line">  <span class="keyword">return</span> initialData;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** src/page/xxxComponent.jsx [useInitState] */</span></span><br><span class="line"><span class="keyword">import</span> &#123; useModel &#125; <span class="keyword">from</span> <span class="string">&quot;umi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Page</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; initialState, loading, error, refresh, setInitialState &#125; = <span class="title function_">useModel</span>(<span class="string">&quot;@@initialState&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;&gt;</span>&#123;initialState&#125;<span class="tag">&lt;/&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>å¯¹è±¡å±æ€§</th><th>ç±»å‹</th><th>ä»‹ç»</th></tr></thead><tbody><tr><td>initialState</td><td>any</td><td>å¯¼å‡ºçš„ getInitialState() æ–¹æ³•çš„è¿”å›å€¼</td></tr><tr><td>loading</td><td>boolean</td><td>getInitialState() æˆ– refresh() æ–¹æ³•æ˜¯å¦æ­£åœ¨è¿›è¡Œä¸­ã€‚åœ¨é¦–æ¬¡è·å–åˆ°åˆå§‹çŠ¶æ€å‰ï¼Œé¡µé¢å…¶ä»–éƒ¨åˆ†çš„æ¸²æŸ“éƒ½ä¼šè¢«é˜»æ­¢</td></tr><tr><td>error</td><td>Error</td><td>å¦‚æœå¯¼å‡ºçš„ getInitialState() æ–¹æ³•è¿è¡Œæ—¶æŠ¥é”™ï¼ŒæŠ¥é”™çš„é”™è¯¯ä¿¡æ¯</td></tr><tr><td>refresh</td><td>() &#x3D;&gt; void</td><td>é‡æ–°æ‰§è¡Œ getInitialState æ–¹æ³•ï¼Œå¹¶è·å–æ–°çš„å…¨å±€åˆå§‹çŠ¶æ€</td></tr><tr><td>setInitialState</td><td>(state: any) &#x3D;&gt; void</td><td>æ‰‹åŠ¨è®¾ç½® initialState çš„å€¼ï¼Œæ‰‹åŠ¨è®¾ç½®å®Œæ¯•ä¼šå°† loading ç½®ä¸º false</td></tr></tbody></table><h2 id="Request"><a href="#Request" class="headerlink" title="Request"></a>Request</h2><p>å®ƒåŸºäº axios å’Œ ahooks çš„ useRequest æä¾›äº†ä¸€å¥—ç»Ÿä¸€çš„ç½‘ç»œè¯·æ±‚å’Œé”™è¯¯å¤„ç†æ–¹æ¡ˆï¼Œä¸»è¦ hooks æœ‰ï¼š<code>request</code>ã€<code>useRequest</code></p><h3 id="æ„å»ºæ—¶é…ç½®-1"><a href="#æ„å»ºæ—¶é…ç½®-1" class="headerlink" title="æ„å»ºæ—¶é…ç½®"></a>æ„å»ºæ—¶é…ç½®</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** config/config.js */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">request</span>: &#123;</span><br><span class="line">    <span class="comment">/** è¯·æ±‚è¿”å›æ•°æ®è§£æ„ */</span></span><br><span class="line">    <span class="attr">dataField</span>: <span class="string">&quot;data&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="è¿è¡Œæ—¶é…ç½®-1"><a href="#è¿è¡Œæ—¶é…ç½®-1" class="headerlink" title="è¿è¡Œæ—¶é…ç½®"></a>è¿è¡Œæ—¶é…ç½®</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** src/app.ts */</span></span><br><span class="line"><span class="keyword">import</span> type &#123; <span class="title class_">RequestConfig</span> &#125; <span class="keyword">from</span> <span class="string">&quot;umi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="attr">request</span>: <span class="title class_">RequestConfig</span> = &#123;</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">1000</span>,</span><br><span class="line">  <span class="comment">/** è¯·æ±‚ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æ–¹æ¡ˆ */</span></span><br><span class="line">  <span class="attr">errorConfig</span>: &#123;</span><br><span class="line">    <span class="title function_">errorHandler</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="title function_">errorThrower</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/** æ‹¦æˆªå™¨ */</span></span><br><span class="line">  <span class="attr">requestInterceptors</span>: [],</span><br><span class="line">  <span class="comment">/** å“åº”å™¨ */</span></span><br><span class="line">  <span class="attr">responseInterceptors</span>: [],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="API-request"><a href="#API-request" class="headerlink" title="API-request"></a>API-request</h3><p>é€šè¿‡ <code>import &#123; request &#125; from &#39;@@/plugin-request&#39;</code> ä½ å¯ä»¥ä½¿ç”¨å†…ç½®çš„è¯·æ±‚æ–¹æ³•ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">request</span>(<span class="string">&quot;/api/user&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">params</span>: &#123; <span class="attr">name</span>: <span class="number">1</span> &#125;,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">2000</span>,</span><br><span class="line">  <span class="comment">// other axios options</span></span><br><span class="line">  <span class="attr">skipErrorHandler</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">getResponse</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">requestInterceptors</span>: [],</span><br><span class="line">  <span class="attr">responseInterceptors</span>: [],</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="API-useRequest"><a href="#API-useRequest" class="headerlink" title="API-useRequest"></a>API-useRequest</h3><p>æ’ä»¶å†…ç½®äº† @ahooksjs&#x2F;useRequest ï¼Œä½ å¯ä»¥åœ¨ç»„ä»¶å†…é€šè¿‡è¯¥ Hook ç®€å•ä¾¿æ·çš„æ¶ˆè´¹æ•°æ®ã€‚</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useRequest &#125; <span class="keyword">from</span> <span class="string">&quot;umi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Page</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; data, error, loading &#125; = <span class="title function_">useRequest</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> services.<span class="title function_">getUserList</span>(<span class="string">&quot;/api/test&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">if</span> (loading) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>loading...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (error) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;error.message&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;data.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸Šé¢ä»£ç ä¸­ data å¹¶ä¸æ˜¯ä½ åç«¯è¿”å›çš„æ•°æ®ï¼Œè€Œæ˜¯å…¶å†…éƒ¨çš„ dataï¼Œï¼ˆå› ä¸ºæ„å»ºæ—¶é…ç½®é»˜è®¤æ˜¯ â€˜dataâ€™)ã€‚</p></blockquote><p><a href="https://umijs.org/docs/max/request#umi3-%E5%88%B0-umi4"><strong>Umi3 -&gt; Umi4 å˜åŒ–</strong></a></p><h2 id="Access"><a href="#Access" class="headerlink" title="Access"></a>Access</h2><p>æƒé™ç®¡ç†ã€‚</p><h3 id="å¯ç”¨æ–¹å¼-2"><a href="#å¯ç”¨æ–¹å¼-2" class="headerlink" title="å¯ç”¨æ–¹å¼"></a>å¯ç”¨æ–¹å¼</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">access</span>: &#123;&#125;,</span><br><span class="line">  <span class="comment">/** access æ’ä»¶ä¾èµ– initial State æ‰€ä»¥éœ€è¦åŒæ—¶å¼€å¯ */</span></span><br><span class="line">  <span class="attr">initialState</span>: &#123;&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="æƒé™å®šä¹‰"><a href="#æƒé™å®šä¹‰" class="headerlink" title="æƒé™å®šä¹‰"></a>æƒé™å®šä¹‰</h3><p>æˆ‘ä»¬çº¦å®šäº† <code>src/access.ts</code> ä¸ºæˆ‘ä»¬çš„æƒé™å®šä¹‰æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶éœ€è¦é»˜è®¤å¯¼å‡ºä¸€ä¸ªæ–¹æ³•ï¼Œå¯¼å‡ºçš„æ–¹æ³•ä¼šåœ¨é¡¹ç›®åˆå§‹åŒ–æ—¶è¢«æ‰§è¡Œã€‚è¯¥æ–¹æ³•éœ€è¦è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡çš„æ¯ä¸€ä¸ªå€¼å°±å¯¹åº”å®šä¹‰äº†ä¸€æ¡æƒé™ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** src/access.ts */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> (<span class="params">initialState</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; userId, role &#125; = initialState;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">canReadFoo</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">canUpdateFoo</span>: role === <span class="string">&quot;admin&quot;</span>,</span><br><span class="line">    <span class="attr">canDeleteFoo</span>: <span class="function">(<span class="params">foo</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> foo.<span class="property">ownerId</span> === userId;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è·¯ç”±é…ç½®"><a href="#è·¯ç”±é…ç½®" class="headerlink" title="è·¯ç”±é…ç½®"></a>è·¯ç”±é…ç½®</h3><p>è·¯ç”±é…ç½®ä¸­é€šè¿‡ access é™å®šæƒé™ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/pageA&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="string">&quot;PageA&quot;</span>,</span><br><span class="line">    <span class="comment">/** æƒé™å®šä¹‰è¿”å›å€¼çš„æŸä¸ª key */</span></span><br><span class="line">    <span class="attr">access</span>: <span class="string">&quot;canReadPageA&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="API-useAccess"><a href="#API-useAccess" class="headerlink" title="API-useAccess"></a>API-useAccess</h3><p>ç»„ä»¶ä¸­è·å–æƒé™ç›¸å…³ä¿¡æ¯ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** src/page/xxxComponent */</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAccess &#125; <span class="keyword">from</span> <span class="string">&quot;umi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">PageA</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; foo &#125; = props;</span><br><span class="line">  <span class="keyword">const</span> access = <span class="title function_">useAccess</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (access.<span class="property">canReadFoo</span>) &#123;</span><br><span class="line">    <span class="comment">// å¦‚æœå¯ä»¥è¯»å– Fooï¼Œåˆ™...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;&gt;</span>TODO<span class="tag">&lt;/&gt;</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">PageA</span>;</span><br></pre></td></tr></table></figure><h3 id="API-Access"><a href="#API-Access" class="headerlink" title="API-Access"></a>API-Access</h3><p>æƒé™æ§åˆ¶ç»„ä»¶ï¼Œæ”¯æŒçš„å±æ€§å¦‚ä¸‹ï¼š</p><ol><li><p>accessible</p></li><li><p>fallback</p></li><li><p>children</p></li></ol><p>ç¤ºä¾‹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useAccess, <span class="title class_">Access</span> &#125; <span class="keyword">from</span> <span class="string">&quot;umi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">PageA</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; foo &#125; = props;</span><br><span class="line">  <span class="comment">/** access çš„æˆå‘˜: canReadFoo, canUpdateFoo, canDeleteFoo */</span></span><br><span class="line">  <span class="keyword">const</span> access = <span class="title function_">useAccess</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (access.<span class="property">canReadFoo</span>) &#123;</span><br><span class="line">    <span class="comment">/** å¦‚æœå¯ä»¥è¯»å– Fooï¼Œåˆ™... */</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Access</span> <span class="attr">accessible</span>=<span class="string">&#123;access.canReadFoo&#125;</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">div</span>&gt;</span>Can not read foo content.<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        Foo content.</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Access</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Access</span> <span class="attr">accessible</span>=<span class="string">&#123;access.canUpdateFoo&#125;</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">div</span>&gt;</span>Can not update foo.<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        Update foo.</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Access</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Access</span> <span class="attr">accessible</span>=<span class="string">&#123;access.canDeleteFoo(foo)&#125;</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">div</span>&gt;</span>Can not delete foo.<span class="tag">&lt;/<span class="name">div</span>&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        Delete foo.</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Access</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="å›½é™…åŒ–"><a href="#å›½é™…åŒ–" class="headerlink" title="å›½é™…åŒ–"></a>å›½é™…åŒ–</h2><p>çº¦å®šåœ¨ src&#x2F;locales ç›®å½•ä¸‹å¼•å…¥å¤šè¯­è¨€æ–‡ä»¶ï¼Œç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">src</span><br><span class="line">  + locales</span><br><span class="line">    + zh-CN.ts</span><br><span class="line">    + en-US.ts</span><br><span class="line">  pages</span><br></pre></td></tr></table></figure><h3 id="å¯ç”¨æ–¹å¼-3"><a href="#å¯ç”¨æ–¹å¼-3" class="headerlink" title="å¯ç”¨æ–¹å¼"></a>å¯ç”¨æ–¹å¼</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** config/config.js */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">locale</span>: &#123;</span><br><span class="line">    <span class="comment">// é»˜è®¤ä½¿ç”¨ src/locales/zh-CN.ts ä½œä¸ºå¤šè¯­è¨€æ–‡ä»¶</span></span><br><span class="line">    <span class="attr">default</span>: <span class="string">&quot;zh-CN&quot;</span>,</span><br><span class="line">    <span class="attr">baseSeparator</span>: <span class="string">&quot;-&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** src/locales/zh-CN.ts */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">welcome</span>: <span class="string">&#x27;æ¬¢è¿å…‰ä¸´ Umi çš„ä¸–ç•Œï¼&#x27;</span>,</span><br><span class="line">  ...</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** src/locales/en-US.ts */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">welcome</span>: <span class="string">&quot;Welcome to Umi&#x27;s world!&quot;</span>,</span><br><span class="line">  ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="FormattedMessage"><a href="#FormattedMessage" class="headerlink" title="FormattedMessage"></a>FormattedMessage</h3><p>é€šè¿‡ UmiMax é¢„åˆ¶çš„ <code>&lt;FormattedMessage /&gt;</code> ç»„ä»¶å®ç°æ¸²æŸ“ã€‚</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">FormattedMessage</span> &#125; <span class="keyword">from</span> <span class="string">&quot;umi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Page</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">FormattedMessage</span> <span class="attr">id</span>=<span class="string">&quot;welcome&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¸²æŸ“ç»“æœï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- zh-CN --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>æ¬¢è¿å…‰ä¸´ Umi çš„ä¸–ç•Œï¼<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- en-US --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Welcome to Umi&#x27;s world!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ç»„ä»¶å‚æ•°ä½¿ç”¨"><a href="#ç»„ä»¶å‚æ•°ä½¿ç”¨" class="headerlink" title="ç»„ä»¶å‚æ•°ä½¿ç”¨"></a>ç»„ä»¶å‚æ•°ä½¿ç”¨</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Alert</span> &#125; <span class="keyword">from</span> <span class="string">&quot;antd&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useIntl &#125; <span class="keyword">from</span> <span class="string">&quot;umi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Page</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> intl = <span class="title function_">useIntl</span>();</span><br><span class="line">  <span class="keyword">const</span> msg = intl.<span class="title function_">formatMessage</span>(&#123;</span><br><span class="line">    <span class="attr">id</span>: <span class="string">&quot;welcome&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Alert</span> <span class="attr">message</span>=<span class="string">&#123;msg&#125;</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ‡æ¢è¯­è¨€"><a href="#åˆ‡æ¢è¯­è¨€" class="headerlink" title="åˆ‡æ¢è¯­è¨€"></a>åˆ‡æ¢è¯­è¨€</h3><p>æ–¹å¼ï¼š</p><ol><li><p><code>&lt;SelectLang /&gt;</code></p></li><li><p><code>setLocale()</code></p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** SelectLang UmiMax é¢„è®¾çš„åˆ‡æ¢è¯­è¨€ç»„ä»¶ */</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">SelectLang</span> &#125; <span class="keyword">from</span> <span class="string">&quot;umi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Page</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">SelectLang</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** ç¼–ç¨‹å¼è°ƒç”¨ */</span></span><br><span class="line"><span class="keyword">import</span> &#123; setLocale &#125; <span class="keyword">from</span> <span class="string">&quot;umi&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** åˆ‡æ¢æ—¶åˆ·æ–°é¡µé¢ */</span></span><br><span class="line"><span class="title function_">setLocale</span>(<span class="string">&quot;en-US&quot;</span>);</span><br><span class="line"><span class="comment">/** åˆ‡æ¢æ—¶ä¸åˆ·æ–°é¡µé¢ */</span></span><br><span class="line"><span class="title function_">setLocale</span>(<span class="string">&quot;en-US&quot;</span>, <span class="literal">false</span>);</span><br></pre></td></tr></table></figure><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** config/config.js */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">locale</span>: &#123;</span><br><span class="line">    <span class="attr">antd</span>: <span class="literal">false</span>, <span class="comment">// å¦‚æœé¡¹ç›®ä¾èµ–ä¸­åŒ…å« `antd`ï¼Œåˆ™é»˜è®¤ä¸º true</span></span><br><span class="line">    <span class="attr">baseNavigator</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">baseSeparator</span>: <span class="string">&quot;-&quot;</span>,</span><br><span class="line">    <span class="attr">default</span>: <span class="string">&quot;zh-CN&quot;</span>,</span><br><span class="line">    <span class="attr">title</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">useLocalStorage</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>é…ç½®çš„è¯¦ç»†ä»‹ç»å¦‚ä¸‹ï¼š</p><table><thead><tr><th>é…ç½®é¡¹</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>ä»‹ç»</th></tr></thead><tbody><tr><td>antd</td><td>Boolean</td><td>falseï¼›</td><td>å¦‚æœé¡¹ç›®åŒ…å« antd ä¾èµ–ï¼Œåˆ™ä¸º true antd çš„å›½é™…åŒ–æ”¯æŒã€‚æ›´å¤šä»‹ç»å¯å‚è§æ­¤æ–‡æ¡£ã€‚</td></tr><tr><td>baseNavigator</td><td>Boolean</td><td>true</td><td>å¼€å¯æµè§ˆå™¨è¯­è¨€æ£€æµ‹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“å‰è¯­è¨€ç¯å¢ƒçš„è¯†åˆ«æŒ‰ç…§ï¼šlocalStorage ä¸­ umi*locale å€¼ &gt; æµè§ˆå™¨æ£€æµ‹ &gt; default è®¾ç½®çš„é»˜è®¤è¯­è¨€ &gt; zh-CN</td></tr><tr><td>baseSeparator</td><td>String</td><td>-</td><td>è¯­è¨€ï¼ˆLanguageï¼‰ä¸å›½å®¶ï¼ˆCountryï¼‰ ä¹‹é—´çš„åˆ†å‰²ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸º -ï¼Œè¿”å›çš„è¯­è¨€åŠç›®å½•æ–‡ä»¶ä¸º zh-CNã€en-US å’Œ sk ç­‰ã€‚è‹¥æŒ‡å®šä¸º *ï¼Œåˆ™ default é»˜è®¤ä¸º zh_CNã€‚</td></tr><tr><td>default</td><td>String</td><td>zh-CN</td><td>é¡¹ç›®é»˜è®¤è¯­è¨€ã€‚å½“æ£€æµ‹ä¸åˆ°å…·ä½“è¯­è¨€æ—¶ï¼Œä½¿ç”¨ default è®¾ç½®çš„é»˜è®¤è¯­è¨€ã€‚</td></tr><tr><td>title</td><td>Boolean</td><td>false</td><td>å¼€å¯æ ‡é¢˜å›½é™…åŒ–ã€‚</td></tr><tr><td>useLocalStorage</td><td>Boolean</td><td>true</td><td>è‡ªåŠ¨ä½¿ç”¨ localStorage ä¿å­˜å½“å‰ä½¿ç”¨çš„è¯­è¨€ã€‚</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
          <category> Umi </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ReduxNote</title>
      <link href="/2023/07/28/React/Redux/"/>
      <url>/2023/07/28/React/Redux/</url>
      
        <content type="html"><![CDATA[<p>Redux æ˜¯ JavaScript åº”ç”¨çš„çŠ¶æ€å®¹å™¨ï¼Œæä¾›å¯é¢„æµ‹çš„çŠ¶æ€ç®¡ç†ã€‚</p><h1 id="å¿«é€Ÿå…¥é—¨"><a href="#å¿«é€Ÿå…¥é—¨" class="headerlink" title="å¿«é€Ÿå…¥é—¨"></a>å¿«é€Ÿå…¥é—¨</h1><p>å·¥å…·åŒ…ï¼š<a href="https://redux-toolkit.js.org/api/configureStore">é…ç½® store</a>ã€<a href="https://redux-toolkit.js.org/api/createreducer">åˆ›å»º Reducer å¹¶ç¼–å†™ immutable æ›´æ–°é€»è¾‘</a>ã€<a href="https://redux-toolkit.js.org/api/createslice">åˆ›å»ºæ•´ä¸ª State çš„ â€œsliceâ€</a></p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Toolkit - 1</span></span><br><span class="line">yarn add @reduxjs/toolkit</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Redux core lib - 2</span></span><br><span class="line">yarn add redux</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">create React Redux app</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Redux + Plain JS template</span></span><br><span class="line">npx create-react-app my-app --template redux</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Redux + TypeScript template</span></span><br><span class="line">npx create-react-app my-app --template redux-typescript</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="åŸºç¡€ç¤ºä¾‹"><a href="#åŸºç¡€ç¤ºä¾‹" class="headerlink" title="åŸºç¡€ç¤ºä¾‹"></a>åŸºç¡€ç¤ºä¾‹</h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** redux */</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&quot;redux&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** reducer*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">counterReducer</span>(<span class="params">state = &#123; value: <span class="number">0</span> &#125;, action</span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;counter/incremented&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">value</span>: state.<span class="property">value</span> + <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;counter/decremented&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> &#123; <span class="attr">value</span>: state.<span class="property">value</span> - <span class="number">1</span> &#125;;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** createStore */</span></span><br><span class="line"><span class="keyword">let</span> store = <span class="title function_">createStore</span>(counterReducer);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** subscribe */</span></span><br><span class="line">store.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(store.<span class="title function_">getState</span>()));</span><br><span class="line"></span><br><span class="line"><span class="comment">/** dispatch */</span></span><br><span class="line">store.<span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&quot;counter/incremented&quot;</span> &#125;);</span><br><span class="line">store.<span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&quot;counter/incremented&quot;</span> &#125;);</span><br><span class="line">store.<span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&quot;counter/decremented&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** redux-toolkit */</span></span><br><span class="line"><span class="comment">/** 1. createSlice -&gt; &#123; reducers, actions &#125; */</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSlice &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> counterSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;counter&quot;</span>,</span><br><span class="line">  <span class="attr">initialState</span>: &#123;</span><br><span class="line">    <span class="attr">value</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/** reducers */</span></span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="attr">increment</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">value</span> += <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">decrement</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">value</span> -= <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">incrementByAmount</span>: <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">value</span> += action.<span class="property">payload</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** actions */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; increment, decrement, incrementByAmount &#125; = counterSlice.<span class="property">actions</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">incrementAsync</span> = (<span class="params">amount</span>) =&gt; <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">incrementByAmount</span>(amount));</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** getter */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">selectCount</span> = (<span class="params">state</span>) =&gt; state.<span class="property">counter</span>.<span class="property">value</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> counterSlice.<span class="property">reducer</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 2. createStore */</span></span><br><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@reduxjs/toolkit&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> counterReducer <span class="keyword">from</span> <span class="string">&#x27;../features/counter/counterSlice&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123;</span><br><span class="line">    <span class="attr">counter</span>: counterReducer,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** useStore */</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.css&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span>;</span><br><span class="line"><span class="comment">/** store &amp; Provider */</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./app/store&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span>,</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** use in component */</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useSelector, useDispatch &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  decrement,</span><br><span class="line">  increment,</span><br><span class="line">  incrementByAmount,</span><br><span class="line">  incrementAsync,</span><br><span class="line">  selectCount,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&#x27;./counterSlice&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">Counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> count = <span class="title function_">useSelector</span>(selectCount);</span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; dispatch(increment())&#125;&#125;&gt;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="åˆ›å»º-Redux-Store"><a href="#åˆ›å»º-Redux-Store" class="headerlink" title="åˆ›å»º Redux Store"></a>åˆ›å»º Redux Store</h1><p><code>configureStore(&#123; reducer: &#123;&#125; &#125;) -&gt; action</code></p><p>reducer ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨ï¼Œå„ä¸ªåŠŸèƒ½æ¨¡å—çš„ reducer ä»¥åŠ stateã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; configureStore &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> counterReducer <span class="keyword">from</span> <span class="string">&quot;../features/counter/counterSlice&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">configureStore</span>(&#123;</span><br><span class="line">  <span class="attr">reducer</span>: &#123;</span><br><span class="line">    <span class="attr">counter</span>: counterReducer,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="åˆ›å»º-Redux-Slice"><a href="#åˆ›å»º-Redux-Slice" class="headerlink" title="åˆ›å»º Redux Slice"></a>åˆ›å»º Redux Slice</h1><p><strong>â€œsliceâ€ æ˜¯åº”ç”¨ä¸­å•ä¸ªåŠŸèƒ½çš„ Redux reducer é€»è¾‘å’Œ action çš„é›†åˆ</strong>, é€šå¸¸ä¸€èµ·å®šä¹‰åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚è¯¥åç§°æ¥è‡ªäºå°†æ ¹ Redux çŠ¶æ€å¯¹è±¡æ‹†åˆ†ä¸ºå¤šä¸ªçŠ¶æ€ â€œsliceâ€ã€‚</p><p><code>toolkit -&gt; createSlice -&gt; &#123; reducers, action_string, action_createFunction, action_object &#125;</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createSlice &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> counterSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;counter&quot;</span>,</span><br><span class="line">  <span class="attr">initialState</span>: &#123;</span><br><span class="line">    <span class="attr">value</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="attr">increment</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">value</span> += <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">decrement</span>: <span class="function">(<span class="params">state</span>) =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">value</span> -= <span class="number">1</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">incrementByAmount</span>: <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">value</span> += action.<span class="property">payload</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; increment, decrement, incrementByAmount &#125; = counterSlice.<span class="property">actions</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> counterSlice.<span class="property">reducer</span>;</span><br></pre></td></tr></table></figure><p>åŸåˆ™ä¸Šä¸èƒ½åœ¨ Redux ä¸­ç›´æ¥ä¿®æ”¹ stateï¼Œä½† toolkit åº“é›†æˆäº† immer.js è¿›è€Œç®€åŒ–è¦†å†™è¿‡ç¨‹ã€‚</p><h2 id="Thunk-å¼‚æ­¥"><a href="#Thunk-å¼‚æ­¥" class="headerlink" title="Thunk å¼‚æ­¥"></a>Thunk å¼‚æ­¥</h2><p>thunk æ˜¯ä¸€ç§ç‰¹å®šç±»å‹çš„ Redux å‡½æ•°ï¼Œå¯ä»¥åŒ…å«å¼‚æ­¥é€»è¾‘ã€‚Thunk æ˜¯ä½¿ç”¨ä¸¤ä¸ªå‡½æ•°ç¼–å†™çš„ï¼š</p><ol><li><p>ä¸€ä¸ªå†…éƒ¨ thunk å‡½æ•°ï¼Œå®ƒä»¥ dispatch å’Œ getState ä½œä¸ºå‚æ•°</p></li><li><p>å¤–éƒ¨åˆ›å»ºè€…å‡½æ•°ï¼Œå®ƒåˆ›å»ºå¹¶è¿”å› thunk å‡½æ•°</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">incrementAsync</span> = (<span class="params">amount</span>) =&gt; <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">incrementByAmount</span>(amount));</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="prepare-æ„é€ -action"><a href="#prepare-æ„é€ -action" class="headerlink" title="prepare æ„é€  action"></a>prepare æ„é€  action</h2><p>å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ­£ç¡®çš„å†…å®¹æ¨¡æ¿å»æ„é€ ï¼ˆprepareï¼‰action å¯¹è±¡ï¼Œä¾‹å¦‚æ·»åŠ æ–‡ç« æ—¶éœ€è¦æ·»åŠ å”¯ä¸€çš„ idï¼Œé€šè¿‡ prepare å¯åœ¨ slice ä¸­è¿›è¡Œæ·»åŠ ï¼Œä¸éœ€è¦å¤–éƒ¨å†åšå¤„ç†ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** slice */</span></span><br><span class="line"><span class="keyword">const</span> postsSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;posts&quot;</span>,</span><br><span class="line">  initialState,</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="attr">postAdded</span>: &#123;</span><br><span class="line">      <span class="title function_">reducer</span>(<span class="params">state, action</span>) &#123;</span><br><span class="line">        state.<span class="title function_">push</span>(action.<span class="property">payload</span>);</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="title function_">prepare</span>(<span class="params">title, content</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          <span class="attr">payload</span>: &#123;</span><br><span class="line">            <span class="attr">id</span>: <span class="title function_">nanoid</span>(),</span><br><span class="line">            title,</span><br><span class="line">            content,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// other reducers here</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** xxComponent */</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">onSavePostClicked</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (title &amp;&amp; content) &#123;</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">postAdded</span>(title, content));</span><br><span class="line">    <span class="title function_">setTitle</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="title function_">setContent</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="extraReducers"><a href="#extraReducers" class="headerlink" title="extraReducers"></a>extraReducers</h2><p>extraReducers é€‰é¡¹æ˜¯ä¸€ä¸ªæ¥æ”¶åä¸º builder çš„å‚æ•°çš„å‡½æ•°ã€‚</p><p>builder å¯¹è±¡æä¾›äº†ä¸€äº›æ–¹æ³•ï¼Œè®©æˆ‘ä»¬å¯ä»¥å®šä¹‰é¢å¤–çš„ case reducerï¼Œè¿™äº› reducer å°†å“åº”åœ¨ slice ä¹‹å¤–å®šä¹‰çš„ actionã€‚</p><p>æˆ‘ä»¬å°†ä½¿ç”¨ builder.addCase(actionCreator, reducer) æ¥å¤„ç†å¼‚æ­¥ thunk dispatch çš„æ¯ä¸ª actionã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> fetchPosts = <span class="title function_">createAsyncThunk</span>(<span class="string">&quot;posts/fetchPosts&quot;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> client.<span class="title function_">get</span>(<span class="string">&quot;/fakeApi/posts&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> response.<span class="property">data</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> postsSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;posts&quot;</span>,</span><br><span class="line">  initialState,</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="comment">// omit existing reducers here</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">extraReducers</span>(<span class="params">builder</span>) &#123;</span><br><span class="line">    builder</span><br><span class="line">      .<span class="title function_">addCase</span>(fetchPosts.<span class="property">pending</span>, <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">status</span> = <span class="string">&quot;loading&quot;</span>;</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">addCase</span>(fetchPosts.<span class="property">fulfilled</span>, <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">status</span> = <span class="string">&quot;succeeded&quot;</span>;</span><br><span class="line">        <span class="comment">// Add any fetched posts to the array</span></span><br><span class="line">        state.<span class="property">posts</span> = state.<span class="property">posts</span>.<span class="title function_">concat</span>(action.<span class="property">payload</span>);</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">addCase</span>(fetchPosts.<span class="property">rejected</span>, <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">status</span> = <span class="string">&quot;failed&quot;</span>;</span><br><span class="line">        state.<span class="property">error</span> = action.<span class="property">error</span>.<span class="property">message</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="å…¨å±€æ³¨å…¥-stote"><a href="#å…¨å±€æ³¨å…¥-stote" class="headerlink" title="å…¨å±€æ³¨å…¥ stote"></a>å…¨å±€æ³¨å…¥ stote</h1><p>ä»»ä½•è°ƒç”¨ useSelector æˆ– useDispatch çš„ React ç»„ä»¶éƒ½å¯ä»¥è®¿é—® <code>&lt;Provider&gt;</code> ä¸­çš„ storeã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./index.css&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&quot;./app/store&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Provider</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> serviceWorker <span class="keyword">from</span> <span class="string">&quot;./serviceWorker&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span>,</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h1 id="æ¥æ”¶-store-amp-dispatch"><a href="#æ¥æ”¶-store-amp-dispatch" class="headerlink" title="æ¥æ”¶ store &amp; dispatch"></a>æ¥æ”¶ store &amp; dispatch</h1><p>æ¥æ”¶ store ä»¥åŠ dispatch çš„æœ‰ä¸¤ç§æ–¹å¼ï¼šHooks APIã€Connect APIã€‚</p><blockquote><p>connect still works and is supported in React-Redux 8.x. However, <a href="https://react-redux.js.org/api/hooks">we recommend using the hooks API as the default</a>.</p></blockquote><h2 id="Hooks-API"><a href="#Hooks-API" class="headerlink" title="Hooks API"></a>Hooks API</h2><p>Hooks æ–¹å¼ç›´æ¥é€šè¿‡ useDispatch å’Œ useSelector è·å– state ä»¥åŠ dispatchã€‚</p><p><strong>useDispatch &amp; useSelector :</strong></p><p>React ç»„ä»¶ä½¿ç”¨ useSelector é’©å­ä» store è¯»å–æ•°æ®</p><ol><li><p>é€‰æ‹©å™¨å‡½æ•°æ¥æ”¶æ•´ä¸ª state å¯¹è±¡ï¼Œå¹¶ä¸”è¿”å›éœ€è¦çš„éƒ¨åˆ†æ•°æ®</p></li><li><p>æ¯å½“ Redux store æ›´æ–°æ—¶ï¼Œé€‰æ‹©å™¨å°†é‡æ–°è¿è¡Œï¼Œå¦‚æœå®ƒä»¬è¿”å›çš„æ•°æ®å‘ç”Ÿæ›´æ”¹ï¼Œåˆ™ç»„ä»¶å°†é‡æ–°æ¸²æŸ“</p></li></ol><p>React ç»„ä»¶ä½¿ç”¨ useDispatch é’©å­ dispatch action æ¥æ›´æ–° store</p><ol><li><p>createSlice å°†ä¸ºæˆ‘ä»¬æ·»åŠ åˆ° slice çš„æ¯ä¸ª reducer å‡½æ•°ç”Ÿæˆ action creator å‡½æ•°</p></li><li><p>åœ¨ç»„ä»¶ä¸­è°ƒç”¨ dispatch(someActionCreator()) æ¥ dispatch action</p></li><li><p>Reducers å°†è¿è¡Œï¼Œæ£€æŸ¥æ­¤ action æ˜¯å¦ç›¸å…³ï¼Œå¹¶åœ¨é€‚å½“æ—¶è¿”å›æ–°çŠ¶æ€</p></li><li><p>è¡¨å•è¾“å…¥å€¼ç­‰ä¸´æ—¶æ•°æ®åº”ä¿ç•™ä¸º React ç»„ä»¶çŠ¶æ€ã€‚å½“ç”¨æˆ·å®Œæˆè¡¨å•æ—¶ï¼Œdispatch ä¸€ä¸ª Redux action æ¥æ›´æ–° storeã€‚</p></li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useSelector, useDispatch &#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">selectCount</span> = (<span class="params">state</span>) =&gt; state.<span class="property">counter</span>.<span class="property">value</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> counter = <span class="title function_">useSelector</span>(selectCount);</span><br><span class="line">  <span class="keyword">const</span> dispatch = <span class="title function_">useDispatch</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          dispatch(&#123; type: &quot;xxx&quot; &#125;);</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        &#123;counter&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Connect-API"><a href="#Connect-API" class="headerlink" title="Connect API"></a>Connect API</h2><p>é€šè¿‡ Connect å‡½æ•°å°† store ä»¥åŠ dispatch æ³¨å…¥åˆ°ç»„ä»¶çš„ props ä¸­ã€‚</p><p><code>function connect(mapStateToProps?, mapDispatchToProps?, mergeProps?, options?)</code></p><p>å‚æ•°ï¼š</p><ol><li><p>mapStateToProps?: Function</p></li><li><p>mapDispatchToProps?: Function | Object</p></li><li><p>mergeProps?: Function</p></li><li><p>options?: Object</p></li></ol><blockquote><ol><li><p>mapStateToProps -&gt; ä¼ é€’ state åˆ° propsï¼Œéœ€è¦è¿”å›ä¸€ä¸ªå¯¹è±¡ç”¨äºåˆå¹¶åˆ° props ä¸­ã€‚</p></li><li><p>mapDispatchToPorps -&gt; ä¼ é€’ dispatch åˆ° propsï¼ˆé€šå¸¸ä¸éœ€è¦ä¼ é€’ï¼Œredux å†…éƒ¨ä¼šè‡ªåŠ¨å›ä¼ ä¸€ä¸ª dispatch åˆ° propsï¼‰ã€‚</p></li></ol></blockquote><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&quot;react-redux&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          porps.dispatch(&#123; type: &quot;xxx&quot; &#125;);</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        &#123;props.state&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mapStateToPorps</span>(<span class="params">state</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">connect</span>(mapStateToPorps)(<span class="title class_">App</span>);</span><br></pre></td></tr></table></figure><h1 id="Middleware"><a href="#Middleware" class="headerlink" title="Middleware"></a>Middleware</h1><p>Redux æœ‰å¤šç§å¼‚æ­¥ middlewareï¼Œæ¯ä¸€ç§éƒ½å…è®¸ä½ ä½¿ç”¨ä¸åŒçš„è¯­æ³•ç¼–å†™é€»è¾‘ã€‚æœ€å¸¸è§çš„å¼‚æ­¥ middleware æ˜¯ redux-thunkï¼Œå®ƒå¯ä»¥è®©ä½ ç¼–å†™å¯èƒ½ç›´æ¥åŒ…å«å¼‚æ­¥é€»è¾‘çš„æ™®é€šå‡½æ•°ã€‚</p><p><img src="https://cn.redux.js.org/assets/images/ReduxAsyncDataFlowDiagram-d97ff38a0f4da0f327163170ccc13e80.gif"></p><p>Redux ä½¿ç”¨å«åšâ€œ middleware â€è¿™æ ·çš„æ’ä»¶æ¨¡å¼æ¥å¼€å‘å¼‚æ­¥é€»è¾‘</p><ol><li><p>å®˜æ–¹çš„å¤„ç†å¼‚æ­¥ middleware å« redux-thunkï¼ŒåŒ…å«åœ¨ Redux Toolkit ä¸­</p></li><li><p>Thunk å‡½æ•°æ¥æ”¶ dispatch å’Œ getState ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å¼‚æ­¥é€»è¾‘ä¸­ä½¿ç”¨å®ƒä»¬</p></li></ol><h2 id="thunk"><a href="#thunk" class="headerlink" title="thunk"></a>thunk</h2><p>thunk æ¥æ”¶ dispatch å’Œ getState ä½œä¸ºå‚æ•°ï¼Œå¯è¿›è¡Œå†æ¬¡ dispatchã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** ReduxSlice */</span></span><br><span class="line"><span class="keyword">import</span> &#123; createSlice &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> counterSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;counter&quot;</span>,</span><br><span class="line">  <span class="attr">initialState</span>: &#123;</span><br><span class="line">    <span class="attr">value</span>: <span class="number">0</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="attr">incrementByAmount</span>: <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">      state.<span class="property">value</span> += action.<span class="property">payload</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> &#123; incrementByAmount &#125; = counterSlice.<span class="property">actions</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** thunk */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">incrementAsync</span> = (<span class="params">amount</span>) =&gt; <span class="function">(<span class="params">dispatch</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="title function_">incrementByAmount</span>(amount));</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> counterSlice.<span class="property">reducer</span>;</span><br></pre></td></tr></table></figure><h2 id="createAsyncThunk"><a href="#createAsyncThunk" class="headerlink" title="createAsyncThunk"></a>createAsyncThunk</h2><p><code>createAsyncThunk(actionString: string, callback: () =&gt; Promise)</code></p><p>thunk ç”Ÿæˆå™¨ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createSlice, createAsyncThunk &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; client &#125; <span class="keyword">from</span> <span class="string">&quot;../../api/client&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialState = &#123;</span><br><span class="line">  <span class="attr">posts</span>: [],</span><br><span class="line">  <span class="attr">status</span>: <span class="string">&quot;idle&quot;</span>,</span><br><span class="line">  <span class="attr">error</span>: <span class="literal">null</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> fetchPosts = <span class="title function_">createAsyncThunk</span>(<span class="string">&quot;posts/fetchPosts&quot;</span>, <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> client.<span class="title function_">get</span>(<span class="string">&quot;/fakeApi/posts&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> response.<span class="property">data</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> addNewPost = <span class="title function_">createAsyncThunk</span>(<span class="string">&quot;posts/addNewPost&quot;</span>, <span class="keyword">async</span> (initialPost) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> client.<span class="title function_">post</span>(<span class="string">&quot;/fakeApi/posts&quot;</span>, initialPost);</span><br><span class="line">  <span class="keyword">return</span> response.<span class="property">data</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> postsSlice = <span class="title function_">createSlice</span>(&#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;posts&quot;</span>,</span><br><span class="line">  initialState,</span><br><span class="line">  <span class="attr">reducers</span>: &#123;</span><br><span class="line">    <span class="comment">// omit other reducer</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">extraReducers</span>(<span class="params">builder</span>) &#123;</span><br><span class="line">    builder</span><br><span class="line">      .<span class="title function_">addCase</span>(fetchPosts.<span class="property">pending</span>, <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">status</span> = <span class="string">&quot;loading&quot;</span>;</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">addCase</span>(fetchPosts.<span class="property">fulfilled</span>, <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">status</span> = <span class="string">&quot;succeeded&quot;</span>;</span><br><span class="line">        <span class="comment">// Add any fetched posts to the array</span></span><br><span class="line">        state.<span class="property">posts</span> = state.<span class="property">posts</span>.<span class="title function_">concat</span>(action.<span class="property">payload</span>);</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">addCase</span>(fetchPosts.<span class="property">rejected</span>, <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">status</span> = <span class="string">&quot;failed&quot;</span>;</span><br><span class="line">        state.<span class="property">error</span> = action.<span class="property">error</span>.<span class="property">message</span>;</span><br><span class="line">      &#125;)</span><br><span class="line">      .<span class="title function_">addCase</span>(addNewPost.<span class="property">fulfilled</span>, <span class="function">(<span class="params">state, action</span>) =&gt;</span> &#123;</span><br><span class="line">        state.<span class="property">posts</span>.<span class="title function_">push</span>(action.<span class="property">payload</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> postsSlice.<span class="property">reducer</span>;</span><br></pre></td></tr></table></figure><h1 id="åŸåˆ™"><a href="#åŸåˆ™" class="headerlink" title="åŸåˆ™"></a>åŸåˆ™</h1><ol><li><p>å¿…é¡»ä¾èµ– state å’Œ action å‚æ•°å»è®¡ç®—å‡ºä¸€ä¸ªæ–° state</p></li><li><p>å¿…é¡»é€šè¿‡æ‹·è´æ—§ state çš„æ–¹å¼å»åš ä¸å¯å˜æ›´æ–° (immutable updates)</p></li><li><p>ä¸èƒ½åŒ…å«ä»»ä½•å¼‚æ­¥é€»è¾‘æˆ–å…¶ä»–å‰¯ä½œç”¨</p></li><li><p>Redux Toolkit çš„ createSlice API å†…éƒ¨ä½¿ç”¨äº† Immer åº“æ‰è¾¾åˆ°è¡¨é¢ä¸Šç›´æ¥ä¿®æ”¹ï¼ˆâ€mutatingâ€ï¼‰state ä¹Ÿå®ç°ä¸å¯å˜æ›´æ–°ï¼ˆimmutable updatesï¼‰çš„æ•ˆæœ</p></li></ol><blockquote><p>Redux action å’Œ state åº”è¯¥åªèƒ½åŒ…å«æ™®é€šçš„ JS å€¼ï¼Œå¦‚å¯¹è±¡ã€æ•°ç»„å’ŒåŸºæœ¬ç±»å‹ã€‚ä¸è¦å°†ç±»å®ä¾‹ã€å‡½æ•°æˆ–å…¶ä»–ä¸å¯åºåˆ—åŒ–çš„å€¼æ”¾å…¥ Reduxï¼ã€‚</p></blockquote><h1 id="æ€§èƒ½ä¼˜åŒ–"><a href="#æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="æ€§èƒ½ä¼˜åŒ–"></a>æ€§èƒ½ä¼˜åŒ–</h1><p><a href="https://cn.redux.js.org/tutorials/essentials/part-6-performance-normalization">æ€§èƒ½ä¸æ•°æ®èŒƒå¼åŒ–</a></p><ol><li><p>è®°å¿†åŒ– selector</p></li><li><p>meno()</p></li><li><p>èŒƒå¼åŒ–æ•°æ®</p></li></ol><h2 id="è®°å¿†åŒ–-Selector"><a href="#è®°å¿†åŒ–-Selector" class="headerlink" title="è®°å¿†åŒ– Selector"></a>è®°å¿†åŒ– Selector</h2><p>é€šè¿‡ createSelector åˆ›å»ºè®°å¿†åŒ– selectorã€‚</p><p>æ¥å—å¤šä¸ª selectorï¼ˆå‰é¢ç§°ä½œâ€™è¾“å…¥ selectorâ€˜ï¼Œæœ€åä¸€ä¸ªç§°ä½œâ€™è¾“å‡º selectorâ€˜ï¼‰ï¼Œæœ€åä¸€ä¸ªä½œä¸ºè¾“å‡º selectorï¼Œè¿›è€Œåˆ›å»ºè®°å¿†åŒ– selectorã€‚</p><p>åœ¨ä½¿ç”¨ useSelector æ—¶ï¼Œä¼šå°†æ‰€æœ‰çš„å‚æ•°ä¼ é€’ç»™æ‰€æœ‰çš„â€™è¾“å…¥ selectorâ€˜ï¼Œæœ€åå°†æ‰€æœ‰çš„â€™è¾“å…¥ selectorâ€˜çš„è¿”å›å€¼ä½œä¸ºå‚æ•°ä¼ å…¥â€™è¾“å‡º selectorâ€˜ï¼Œè¿›è€Œåªå¯¹æœ€åçš„å‚æ•°è¿›è¡Œä¾èµ–è¿½è¸ªã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createSelector &#125; <span class="keyword">from</span> <span class="string">&quot;@reduxjs/toolkit&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">shopItemsSelector</span> = (<span class="params">state</span>) =&gt; state.<span class="property">shop</span>.<span class="property">items</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">taxPercentSelector</span> = (<span class="params">state</span>) =&gt; state.<span class="property">shop</span>.<span class="property">taxPercent</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> subtotalSelector = <span class="title function_">createSelector</span>(shopItemsSelector, <span class="function">(<span class="params">items</span>) =&gt;</span> items.<span class="title function_">reduce</span>(<span class="function">(<span class="params">subtotal, item</span>) =&gt;</span> subtotal + item.<span class="property">value</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> taxSelector = <span class="title function_">createSelector</span>(subtotalSelector, taxPercentSelector, <span class="function">(<span class="params">subtotal, taxPercent</span>) =&gt;</span> subtotal * (taxPercent / <span class="number">100</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> totalSelector = <span class="title function_">createSelector</span>(subtotalSelector, taxSelector, <span class="function">(<span class="params">subtotal, tax</span>) =&gt;</span> (&#123; <span class="attr">total</span>: subtotal + tax &#125;));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> exampleState = &#123;</span><br><span class="line">  <span class="attr">shop</span>: &#123;</span><br><span class="line">    <span class="attr">taxPercent</span>: <span class="number">8</span>,</span><br><span class="line">    <span class="attr">items</span>: [</span><br><span class="line">      &#123; <span class="attr">name</span>: <span class="string">&quot;apple&quot;</span>, <span class="attr">value</span>: <span class="number">1.2</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">name</span>: <span class="string">&quot;orange&quot;</span>, <span class="attr">value</span>: <span class="number">0.95</span> &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">subtotalSelector</span>(exampleState)); <span class="comment">// 2.15</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">taxSelector</span>(exampleState)); <span class="comment">// 0.172</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">totalSelector</span>(exampleState)); <span class="comment">// &#123; total: 2.322 &#125;</span></span><br></pre></td></tr></table></figure><h2 id="èŒƒå¼åŒ–æ•°æ®"><a href="#èŒƒå¼åŒ–æ•°æ®" class="headerlink" title="èŒƒå¼åŒ–æ•°æ®"></a>èŒƒå¼åŒ–æ•°æ®</h2><p>â€œèŒƒå¼åŒ–æ•°æ®â€æ˜¯æŒ‡ï¼š</p><ol><li><p>æˆ‘ä»¬ state ä¸­çš„æ¯ä¸ªç‰¹å®šæ•°æ®åªæœ‰ä¸€ä¸ªå‰¯æœ¬ï¼Œä¸å­˜åœ¨é‡å¤ã€‚</p></li><li><p>å·²èŒƒå¼åŒ–çš„æ•°æ®ä¿å­˜åœ¨æŸ¥æ‰¾è¡¨ä¸­ï¼Œå…¶ä¸­é¡¹ç›® ID æ˜¯é”®ï¼Œé¡¹æœ¬èº«æ˜¯å€¼ã€‚</p></li><li><p>ä¹Ÿå¯èƒ½æœ‰ä¸€ä¸ªç‰¹å®šé¡¹ç”¨äºä¿å­˜æ‰€æœ‰ ID çš„æ•°ç»„ã€‚</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">users</span>: &#123;</span><br><span class="line">    <span class="attr">ids</span>: [<span class="string">&quot;user1&quot;</span>, <span class="string">&quot;user2&quot;</span>, <span class="string">&quot;user3&quot;</span>],</span><br><span class="line">    <span class="attr">entities</span>: &#123;</span><br><span class="line">      <span class="string">&quot;user1&quot;</span>: &#123;<span class="attr">id</span>: <span class="string">&quot;user1&quot;</span>, firstName, lastName&#125;,</span><br><span class="line">      <span class="string">&quot;user2&quot;</span>: &#123;<span class="attr">id</span>: <span class="string">&quot;user2&quot;</span>, firstName, lastName&#125;,</span><br><span class="line">      <span class="string">&quot;user3&quot;</span>: &#123;<span class="attr">id</span>: <span class="string">&quot;user3&quot;</span>, firstName, lastName&#125;,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Redux-Toolkit æä¾› <a href="https://cn.redux.js.org/tutorials/essentials/part-6-performance-normalization#%E4%BD%BF%E7%94%A8-createentityadapter-%E7%AE%A1%E7%90%86%E8%8C%83%E5%BC%8F%E5%8C%96-state">createEntityAdapter</a> è¿›è¡ŒèŒƒå¼åŒ–ç®¡ç† state æ•°æ®ã€‚</p><h1 id="Redux-å†…éƒ¨-Store"><a href="#Redux-å†…éƒ¨-Store" class="headerlink" title="Redux å†…éƒ¨ Store"></a>Redux å†…éƒ¨ Store</h1><p>å®é™…é€»è¾‘ï¼š</p><ol><li><p>store å†…éƒ¨æœ‰å½“å‰çš„ state å€¼å’Œ reducer å‡½æ•°</p></li><li><p>getState è¿”å›å½“å‰ state å€¼</p></li><li><p>subscribe ä¿å­˜ä¸€ä¸ªç›‘å¬å›è°ƒæ•°ç»„å¹¶è¿”å›ä¸€ä¸ªå‡½æ•°æ¥ç§»é™¤æ–°çš„å›è°ƒ</p></li><li><p>dispatch è°ƒç”¨ reducerï¼Œä¿å­˜ stateï¼Œå¹¶è¿è¡Œç›‘å¬å™¨</p></li><li><p>store åœ¨å¯åŠ¨æ—¶ dispatch ä¸€ä¸ª action æ¥åˆå§‹åŒ– reducers çš„ state</p></li><li><p>store API æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢æœ‰ {dispatch, subscribe, getState}</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createStore</span>(<span class="params">reducer, preloadedState</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> state = preloadedState;</span><br><span class="line">  <span class="keyword">const</span> listeners = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">getState</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> state;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">subscribe</span>(<span class="params">listener</span>) &#123;</span><br><span class="line">    listeners.<span class="title function_">push</span>(listener);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> <span class="title function_">unsubscribe</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> index = listeners.<span class="title function_">indexOf</span>(listener);</span><br><span class="line">      listeners.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">dispatch</span>(<span class="params">action</span>) &#123;</span><br><span class="line">    state = <span class="title function_">reducer</span>(state, action);</span><br><span class="line">    listeners.<span class="title function_">forEach</span>(<span class="function">(<span class="params">listener</span>) =&gt;</span> <span class="title function_">listener</span>());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">dispatch</span>(&#123; <span class="attr">type</span>: <span class="string">&quot;@@redux/INIT&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; dispatch, subscribe, getState &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>React Note</title>
      <link href="/2023/07/20/React/ReactNote/"/>
      <url>/2023/07/20/React/ReactNote/</url>
      
        <content type="html"><![CDATA[<h1 id="ReactNote"><a href="#ReactNote" class="headerlink" title="ReactNote"></a>ReactNote</h1><h2 id="handleEvent"><a href="#handleEvent" class="headerlink" title="handleEvent"></a>handleEvent</h2><p>å‰¯ä½œç”¨å‡½æ•°</p><p><strong>stopEvent</strong></p><p>react æ›´è´´è¿‘åŸç”Ÿ JSã€‚</p><p>é˜»æ­¢äº‹ä»¶ä¼ æ’­ï¼š</p><ol><li><p>é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼š<code>e.stopPropagation()</code></p></li><li><p>é˜»æ­¢åŸç”Ÿäº‹ä»¶ï¼š<code>e.preventDefault()</code></p></li></ol><h2 id="state"><a href="#state" class="headerlink" title="state"></a>state</h2><p><strong>ç‰¹æ€§</strong>ï¼šå¼‚æ­¥æ›´æ–°ã€åˆå¹¶ï¼ˆ<strong>æ‰¹å¤„ç†</strong>ï¼‰ã€é¡¶å±‚è°ƒç”¨ã€‚</p><p><strong>å¼‚æ­¥æ›´æ–°</strong>ï¼šæ— è®ºæ˜¯å¦è°ƒç”¨æ›´æ–°å‡½æ•°ï¼Œå½“å‰ä½œç”¨åŸŸæ‹¿åˆ°çš„ state å€¼æ°¸è¿œæ˜¯å½“å‰çš„å¿«ç…§å€¼ã€‚</p><p><strong>React ä¼šä½¿ state çš„å€¼å§‹ç»ˆâ€å›ºå®šâ€œåœ¨ä¸€æ¬¡æ¸²æŸ“çš„å„ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°å†…éƒ¨ã€‚</strong></p><h3 id="useState"><a href="#useState" class="headerlink" title="useState"></a>useState</h3><p><code>useState&lt;T&gt;(initState: T): [state: T, setState: (state: T) =&gt; void]</code></p><p><strong>setState(callback) æ›´æ–°å‡½æ•°</strong>ï¼šå½“ä¼ é€’çš„æ˜¯å‡½æ•°æ—¶ï¼ŒReact ä¼šå°†æ­¤å‡½æ•°åŠ å…¥é˜Ÿåˆ—ã€‚</p><p><strong>setState(n+1) å€¼è¦†ç›–</strong>ï¼šæ‹¿åˆ° n çš„å€¼å§‹ç»ˆæ˜¯å½“å‰ç»„ä»¶çš„å¿«ç…§å€¼ã€‚</p><blockquote><p>æ³¨æ„ï¼šçŠ¶æ€å€¼åœ¨è°ƒç”¨æ›´æ–°å‡½æ•°æ—¶å§‹ç»ˆå˜åŒ–ï¼Œè€Œå½“å‰ç»„ä»¶å¿«ç…§å€¼å§‹ç»ˆä¸å˜ã€‚</p></blockquote><h3 id="update-queue"><a href="#update-queue" class="headerlink" title="update queue"></a>update queue</h3><p><strong>æ›´æ–°é˜Ÿåˆ—ï¼š</strong> çŠ¶æ€å€¼ã€æ›´æ–°å‡½æ•°ï¼Œæœ€ç»ˆæ›´æ–°ç»“æœä» useState ä¸­è¿”å›å‡ºå»ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getFinalState</span>(<span class="params">baseState, queue</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> finalState = baseState;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> update <span class="keyword">of</span> queue) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> update === <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">      <span class="comment">// è°ƒç”¨æ›´æ–°å‡½æ•°</span></span><br><span class="line">      finalState = <span class="title function_">update</span>(finalState);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// æ›¿æ¢ä¸‹ä¸€ä¸ª state</span></span><br><span class="line">      finalState = update;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> finalState;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [number, setNumber] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;number&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          let k = 0;</span></span><br><span class="line"><span class="language-xml">          setNumber(number + 5);</span></span><br><span class="line"><span class="language-xml">          setNumber((n) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">            alert(k++);</span></span><br><span class="line"><span class="language-xml">            return n + 1;</span></span><br><span class="line"><span class="language-xml">          &#125;); // è¿™é‡Œçš„alertä¼šæ‰§è¡Œä¸¤æ¬¡</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        å¢åŠ æ•°å­—</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>alert æ‰§è¡Œä¸¤æ¬¡åŸå› ï¼š<strong>æµè§ˆå™¨ä¸¥æ ¼æ¨¡å¼å¯¼è‡´çš„</strong>ã€‚ï¼ˆåªä¼šåœ¨ DEV ç¯å¢ƒä¸‹ï¼‰</p><p><img src="https://s2.loli.net/2023/07/25/TfFjse3wzObItoh.png"></p><p><strong>React ä¼šç­‰åˆ°äº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„</strong> æ‰€æœ‰ <strong>ä»£ç éƒ½è¿è¡Œå®Œæ¯•å†å¤„ç†ä½ çš„ state æ›´æ–°ã€‚</strong></p><p>å†…éƒ¨ä¼šæœ‰ä¸€ä¸ªæ•°ç»„å­˜å‚¨ç»„ä»¶çš„æ‰€æœ‰ state æ•°æ® ä»¥åŠ setState æ›´æ–°å‡½æ•°ã€‚</p><h3 id="useState-simulation"><a href="#useState-simulation" class="headerlink" title="useState simulation"></a>useState simulation</h3><p><strong><code>useState </code>æ¨¡æ‹Ÿ</strong>ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> componentHooks = [];</span><br><span class="line"><span class="keyword">let</span> currentHookIndex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// useState åœ¨ React ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼ˆç®€åŒ–ç‰ˆï¼‰</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useState</span>(<span class="params">initialState</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> pair = componentHooks[currentHookIndex];</span><br><span class="line">  <span class="keyword">if</span> (pair) &#123;</span><br><span class="line">    <span class="comment">// è¿™ä¸æ˜¯ç¬¬ä¸€æ¬¡æ¸²æŸ“</span></span><br><span class="line">    <span class="comment">// æ‰€ä»¥ state pair å·²ç»å­˜åœ¨</span></span><br><span class="line">    <span class="comment">// å°†å…¶è¿”å›å¹¶ä¸ºä¸‹ä¸€æ¬¡ hook çš„è°ƒç”¨åšå‡†å¤‡</span></span><br><span class="line">    currentHookIndex++;</span><br><span class="line">    <span class="keyword">return</span> pair;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿™æ˜¯æˆ‘ä»¬ç¬¬ä¸€æ¬¡è¿›è¡Œæ¸²æŸ“</span></span><br><span class="line">  <span class="comment">// æ‰€ä»¥æ–°å»ºä¸€ä¸ª state pair ç„¶åå­˜å‚¨å®ƒ</span></span><br><span class="line">  pair = [initialState, setState];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">setState</span>(<span class="params">nextState</span>) &#123;</span><br><span class="line">    <span class="comment">// å½“ç”¨æˆ·å‘èµ· state çš„å˜æ›´ï¼Œ</span></span><br><span class="line">    <span class="comment">// æŠŠæ–°çš„å€¼æ”¾å…¥ pair ä¸­</span></span><br><span class="line">    pair[<span class="number">0</span>] = nextState;</span><br><span class="line">    <span class="title function_">updateDOM</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å­˜å‚¨è¿™ä¸ª pair ç”¨äºå°†æ¥çš„æ¸²æŸ“</span></span><br><span class="line">  <span class="comment">// å¹¶ä¸”ä¸ºä¸‹ä¸€æ¬¡ hook çš„è°ƒç”¨åšå‡†å¤‡</span></span><br><span class="line">  componentHooks[currentHookIndex] = pair;</span><br><span class="line">  currentHookIndex++;</span><br><span class="line">  <span class="keyword">return</span> pair;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Gallery</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// æ¯æ¬¡è°ƒç”¨ useState() éƒ½ä¼šå¾—åˆ°æ–°çš„ pair</span></span><br><span class="line">  <span class="keyword">const</span> [index, setIndex] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">const</span> [showMore, setShowMore] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleNextClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">setIndex</span>(index + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleMoreClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">setShowMore</span>(!showMore);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> sculpture = sculptureList[index];</span><br><span class="line">  <span class="comment">// è¿™ä¸ªä¾‹å­æ²¡æœ‰ä½¿ç”¨ Reactï¼Œæ‰€ä»¥</span></span><br><span class="line">  <span class="comment">// è¿”å›ä¸€ä¸ªå¯¹è±¡è€Œä¸æ˜¯ JSX</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">onNextClick</span>: handleNextClick,</span><br><span class="line">    <span class="attr">onMoreClick</span>: handleMoreClick,</span><br><span class="line">    <span class="attr">header</span>: <span class="string">`<span class="subst">$&#123;sculpture.name&#125;</span> by <span class="subst">$&#123;sculpture.artist&#125;</span>`</span>,</span><br><span class="line">    <span class="attr">counter</span>: <span class="string">`<span class="subst">$&#123;index + <span class="number">1</span>&#125;</span> of <span class="subst">$&#123;sculptureList.length&#125;</span>`</span>,</span><br><span class="line">    <span class="attr">more</span>: <span class="string">`<span class="subst">$&#123;showMore ? <span class="string">&quot;Hide&quot;</span> : <span class="string">&quot;Show&quot;</span>&#125;</span> details`</span>,</span><br><span class="line">    <span class="attr">description</span>: showMore ? sculpture.<span class="property">description</span> : <span class="literal">null</span>,</span><br><span class="line">    <span class="attr">imageSrc</span>: sculpture.<span class="property">url</span>,</span><br><span class="line">    <span class="attr">imageAlt</span>: sculpture.<span class="property">alt</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">updateDOM</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// åœ¨æ¸²æŸ“ç»„ä»¶ä¹‹å‰</span></span><br><span class="line">  <span class="comment">// é‡ç½®å½“å‰ Hook çš„ä¸‹æ ‡</span></span><br><span class="line">  currentHookIndex = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> output = <span class="title class_">Gallery</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ›´æ–° DOM ä»¥åŒ¹é…è¾“å‡ºç»“æœ</span></span><br><span class="line">  <span class="comment">// è¿™éƒ¨åˆ†å·¥ä½œç”± React ä¸ºä½ å®Œæˆ</span></span><br><span class="line">  nextButton.<span class="property">onclick</span> = output.<span class="property">onNextClick</span>;</span><br><span class="line">  header.<span class="property">textContent</span> = output.<span class="property">header</span>;</span><br><span class="line">  moreButton.<span class="property">onclick</span> = output.<span class="property">onMoreClick</span>;</span><br><span class="line">  moreButton.<span class="property">textContent</span> = output.<span class="property">more</span>;</span><br><span class="line">  image.<span class="property">src</span> = output.<span class="property">imageSrc</span>;</span><br><span class="line">  image.<span class="property">alt</span> = output.<span class="property">imageAlt</span>;</span><br><span class="line">  <span class="keyword">if</span> (output.<span class="property">description</span> !== <span class="literal">null</span>) &#123;</span><br><span class="line">    description.<span class="property">textContent</span> = output.<span class="property">description</span>;</span><br><span class="line">    description.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    description.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> nextButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;nextButton&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> header = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;header&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> moreButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;moreButton&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> description = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;description&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> image = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;image&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> sculptureList = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Homenaje a la NeurocirugÃ­a&quot;</span>,</span><br><span class="line">    <span class="attr">artist</span>: <span class="string">&quot;Marta Colvin Andrade&quot;</span>,</span><br><span class="line">    <span class="attr">description</span>:</span><br><span class="line">      <span class="string">&quot;Although Colvin is predominantly known for abstract themes that allude to pre-Hispanic symbols, this gigantic sculpture, an homage to neurosurgery, is one of her most recognizable public art pieces.&quot;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;https://i.imgur.com/Mx7dA2Y.jpg&quot;</span>,</span><br><span class="line">    <span class="attr">alt</span>: <span class="string">&quot;A bronze statue of two crossed hands delicately holding a human brain in their fingertips.&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Floralis GenÃ©rica&quot;</span>,</span><br><span class="line">    <span class="attr">artist</span>: <span class="string">&quot;Eduardo Catalano&quot;</span>,</span><br><span class="line">    <span class="attr">description</span>:</span><br><span class="line">      <span class="string">&quot;This enormous (75 ft. or 23m) silver flower is located in Buenos Aires. It is designed to move, closing its petals in the evening or when strong winds blow and opening them in the morning.&quot;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&quot;https://i.imgur.com/ZF6s192m.jpg&quot;</span>,</span><br><span class="line">    <span class="attr">alt</span>: <span class="string">&quot;A gigantic metallic flower sculpture with reflective mirror-like petals and strong stamens.&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ UI åŒ¹é…å½“å‰ state</span></span><br><span class="line"><span class="title function_">updateDOM</span>();</span><br></pre></td></tr></table></figure><p><code>setState -&gt; updateDOM -&gt; render</code></p><p><code>snapshop -&gt; setState -&gt; render -&gt; new snapshop</code></p><p><code>reRender: reCall the Function -&gt; return new JSX -&gt; diff -&gt; patch -&gt; react update UI</code></p><h3 id="object-update"><a href="#object-update" class="headerlink" title="object update"></a>object update</h3><p><strong>åœ¨ React ä¸­å°†æ‰€æœ‰çš„æ•°æ®è§†ä¸º ä¸å¯å˜æ•°æ® æˆ– åªè¯» ã€‚</strong></p><p>å°¤å…¶æ˜¯<strong>å¼•ç”¨ç±»å‹</strong>ã€‚</p><p><strong>å¯¹è±¡å±•å¼€ &amp; è¦†ç›–</strong>ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">setPerson</span>(&#123;</span><br><span class="line">  ...person, <span class="comment">// å¤åˆ¶ä¸Šä¸€ä¸ª person ä¸­çš„æ‰€æœ‰å­—æ®µ</span></span><br><span class="line">  <span class="attr">firstName</span>: e.<span class="property">target</span>.<span class="property">value</span>, <span class="comment">// ä½†æ˜¯è¦†ç›– firstName å­—æ®µ</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>åµŒå¥—å¯¹è±¡</strong>ï¼š</p><p>æ›´æ–°åµŒå¥—å¯¹è±¡ï¼Œéœ€è¦å¤šæ¬¡å±•å¼€ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> nextArtwork = &#123; ...person.<span class="property">artwork</span>, <span class="attr">city</span>: <span class="string">&quot;New Delhi&quot;</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> nextPerson = &#123; ...person, <span class="attr">artwork</span>: nextArtwork &#125;;</span><br><span class="line"><span class="title function_">setPerson</span>(nextPerson);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** or */</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">setPerson</span>(&#123;</span><br><span class="line">  ...person, <span class="comment">// å¤åˆ¶å…¶å®ƒå­—æ®µçš„æ•°æ®</span></span><br><span class="line">  <span class="attr">artwork</span>: &#123;</span><br><span class="line">    <span class="comment">// æ›¿æ¢ artwork å­—æ®µ</span></span><br><span class="line">    ...person.<span class="property">artwork</span>, <span class="comment">// å¤åˆ¶ä¹‹å‰ person.artwork ä¸­çš„æ•°æ®</span></span><br><span class="line">    <span class="attr">city</span>: <span class="string">&quot;New Delhi&quot;</span>, <span class="comment">// ä½†æ˜¯å°† city çš„å€¼æ›¿æ¢ä¸º New Delhiï¼</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="array-update"><a href="#array-update" class="headerlink" title="array update"></a>array update</h3><table><thead><tr><th></th><th>change arr</th><th>return new arr</th></tr></thead><tbody><tr><td>add</td><td>pushã€unshift</td><td>concatã€[â€¦arr]</td></tr><tr><td>del</td><td>popã€shiftã€splice</td><td>filterã€slice</td></tr><tr><td>rep</td><td>spliceã€arr[i] &#x3D; xx</td><td>map</td></tr><tr><td>sor</td><td>reverseã€sort</td><td>clone and sort</td></tr></tbody></table><p>åŒå¯¹è±¡ä¸€æ ·ï¼Œä¹Ÿè¦çœ‹åšä¸å¯å˜æ•°æ®ã€‚</p><p>æ•°ç»„ä¸­çš„å¯¹è±¡ï¼Œå®é™…ä¸Šå­˜å‚¨çš„ä¹Ÿæ˜¯å¯¹è±¡çš„åœ°å€ï¼Œæ‰€ä»¥ç›´æ¥ä¿®æ”¹ä¹Ÿæ˜¯ä¸å¯ä»¥çš„ï¼Œå¯ä»¥ä½¿ç”¨ map ç”Ÿæˆæ–°çš„æ•°ç»„è¿›è¡Œæ›´æ–°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">setMyList</span>(</span><br><span class="line">  myList.<span class="title function_">map</span>(<span class="function">(<span class="params">artwork</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (artwork.<span class="property">id</span> === artworkId) &#123;</span><br><span class="line">      <span class="comment">// åˆ›å»ºåŒ…å«å˜æ›´çš„*æ–°*å¯¹è±¡</span></span><br><span class="line">      <span class="keyword">return</span> &#123; ...artwork, <span class="attr">seen</span>: nextSeen &#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// æ²¡æœ‰å˜æ›´</span></span><br><span class="line">      <span class="keyword">return</span> artwork;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">);</span><br><span class="line"><span class="title function_">updateMyTodos</span>(<span class="function">(<span class="params">draft</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> artwork = draft.<span class="title function_">find</span>(<span class="function">(<span class="params">a</span>) =&gt;</span> a.<span class="property">id</span> === artworkId);</span><br><span class="line">  artwork.<span class="property">seen</span> = nextSeen;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="Immer"><a href="#Immer" class="headerlink" title="Immer"></a>Immer</h3><p><strong>Immer ç®€åŒ–æ›´æ–°</strong>ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">updatePerson</span>(<span class="function">(<span class="params">draft</span>) =&gt;</span> &#123;</span><br><span class="line">  draft.<span class="property">artwork</span>.<span class="property">city</span> = <span class="string">&quot;Lagos&quot;</span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>ç”± Immer æä¾›çš„ <code>draft</code> æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„å¯¹è±¡ï¼Œè¢«ç§°ä¸º <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy">Proxy</a>ï¼Œå®ƒä¼šè®°å½•ä½ ç”¨å®ƒæ‰€è¿›è¡Œçš„æ“ä½œã€‚è¿™å°±æ˜¯ä½ èƒ½å¤Ÿéšå¿ƒæ‰€æ¬²åœ°ç›´æ¥ä¿®æ”¹å¯¹è±¡çš„åŸå› æ‰€åœ¨ï¼ä»åŸç†ä¸Šè¯´ï¼ŒImmer ä¼šå¼„æ¸…æ¥š <code>draft</code> å¯¹è±¡çš„å“ªäº›éƒ¨åˆ†è¢«æ”¹å˜äº†ï¼Œå¹¶ä¼šä¾ç…§ä½ çš„ä¿®æ”¹åˆ›å»ºå‡ºä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ã€‚</p></blockquote><h3 id="flushSync"><a href="#flushSync" class="headerlink" title="flushSync"></a>flushSync</h3><p>åŒæ­¥æ›´æ–° stateï¼Œå°†ç›´æ¥æ›´æ–° DOMã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; flushSync &#125; <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">flushSync</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">setTodos</span>([...todos, newTodo]);</span><br><span class="line">&#125;);</span><br><span class="line">listRef.<span class="property">current</span>.<span class="property">lastChild</span>.<span class="title function_">scrollIntoView</span>();</span><br></pre></td></tr></table></figure><h2 id="render"><a href="#render" class="headerlink" title="render"></a>render</h2><p><code>createRoot -&gt; render</code></p><p><strong>React ä»…åœ¨æ¸²æŸ“ä¹‹é—´å­˜åœ¨å·®å¼‚æ—¶æ‰ä¼šæ›´æ”¹ DOM èŠ‚ç‚¹ã€‚</strong></p><h2 id="stateManage"><a href="#stateManage" class="headerlink" title="stateManage"></a>stateManage</h2><p><strong>æ ¸å¿ƒ</strong>ï¼š<code>UI = fn(state)</code></p><p><strong>é¿å…å†—ä½™ã€çŸ›ç›¾ã€é‡å¤ã€æ·±åº¦åµŒå¥—çš„ state</strong>ã€‚</p><p><strong>UI æ ‘ï¼š</strong></p><img src="https://react.docschina.org/_next/image?url=%2Fimages%2Fdocs%2Fdiagrams%2Fpreserving_state_dom_tree.png&w=1920&q=75" title="" alt="Diagram with three sections arranged horizontally. In the first section, there are three rectangles stacked vertically, with labels 'Component A', 'Component B', and 'Component C'. Transitioning to the next pane is an arrow with the React logo on top labeled 'React'. The middle section contains a tree of components, with the root labeled 'A' and two children labeled 'B' and 'C'. The next section is again transitioned using an arrow with the React logo on top labeled 'React'. The third and final section is a wireframe of a browser, containing a tree of 8 nodes, which has only a subset highlighted (indicating the subtree from the middle section)." data-align="inline"><blockquote><p><strong>å¯¹ React æ¥è¯´é‡è¦çš„æ˜¯ç»„ä»¶åœ¨ UI æ ‘ä¸­çš„ä½ç½®,è€Œä¸æ˜¯åœ¨ JSX ä¸­çš„ä½ç½®ï¼</strong></p></blockquote><p><strong>æ‰€ä»¥å¦‚æœå¸Œæœ›åœ¨é‡æ–°æ¸²æŸ“çš„æ—¶å€™ä¿ç•™ state éœ€è¦ä¿è¯å‡ æ¬¡æ¸²æŸ“çš„æ ‘ç»“æ„ä¸­åº”è¯¥äº’ç›¸â€œåŒ¹é…â€</strong></p><p>åŸºæœ¬ä¸Šä¸€äº› ui ä¸Šçš„ bug éƒ½æ˜¯æ¸²æŸ“å‡ºé”™å¯¼è‡´ï¼Œä¸»è¦æ£€æŸ¥ key å€¼çš„è®¾ç½®ã€‚</p><h3 id="useReducer"><a href="#useReducer" class="headerlink" title="useReducer"></a>useReducer</h3><p>çº¯å‡½æ•°</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">ReducerAction</span>&lt;T&gt; = &#123; <span class="attr">type</span>: <span class="built_in">string</span> &#125; | T;</span><br><span class="line"><span class="keyword">declare</span> <span class="keyword">function</span> useReducer&lt;T&gt;(</span><br><span class="line">  <span class="attr">callback</span>: <span class="function">(<span class="params">state: T, action: ReducerAction&lt;T&gt;</span>) =&gt;</span> <span class="built_in">void</span>,</span><br><span class="line">  <span class="attr">initState</span>: T</span><br><span class="line">): [<span class="attr">state</span>: T, <span class="attr">dispatch</span>: <span class="function">(<span class="params">action: ReducerAction&lt;T&gt;</span>) =&gt;</span> <span class="built_in">void</span>];</span><br></pre></td></tr></table></figure><h3 id="useImmerReducer"><a href="#useImmerReducer" class="headerlink" title="useImmerReducer"></a>useImmerReducer</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useImmerReducer &#125; <span class="keyword">from</span> <span class="string">&quot;use-immer&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">tasksReducer</span>(<span class="params">draft, action</span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;added&quot;</span>: &#123;</span><br><span class="line">      draft.<span class="title function_">push</span>(&#123;</span><br><span class="line">        <span class="attr">id</span>: action.<span class="property">id</span>,</span><br><span class="line">        <span class="attr">text</span>: action.<span class="property">text</span>,</span><br><span class="line">        <span class="attr">done</span>: <span class="literal">false</span>,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;changed&quot;</span>: &#123;</span><br><span class="line">      <span class="keyword">const</span> index = draft.<span class="title function_">findIndex</span>(<span class="function">(<span class="params">t</span>) =&gt;</span> t.<span class="property">id</span> === action.<span class="property">task</span>.<span class="property">id</span>);</span><br><span class="line">      draft[index] = action.<span class="property">task</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;deleted&quot;</span>: &#123;</span><br><span class="line">      <span class="keyword">return</span> draft.<span class="title function_">filter</span>(<span class="function">(<span class="params">t</span>) =&gt;</span> t.<span class="property">id</span> !== action.<span class="property">id</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attr">default</span>: &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="title class_">Error</span>(<span class="string">&quot;æœªçŸ¥ actionï¼š&quot;</span> + action.<span class="property">type</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h2><p>ç±»ä¼¼ Vue ä¸­çš„ provide&#x2F;injextï¼Œä¸»è¦ç”¨æ¥è§£å†³ props é€çº§é€ä¼ é—®é¢˜ã€‚</p><p>react ä½œä¸ºå•å‘æ•°æ®æµï¼Œæ•°æ®æ¥è‡ªä¸Šå±‚ï¼Œä½†å¦‚æœ<strong>çŠ¶æ€æå‡</strong>åˆ°å¤ªé«˜çš„å±‚çº§å°±ä¼šå¯¼è‡´â€œé€å±‚é€ä¼  propsâ€çš„æƒ…å†µã€‚</p><p><img src="https://s2.loli.net/2023/07/25/23Tdlw8hItBMJAV.png" alt="image.png"></p><p>context åˆ™æ˜¯å…ˆä¸‹æ³¨å…¥æ•°æ®ï¼Œä¸è®ºæ·±åº¦ï¼Œä½†å­˜åœ¨<strong>å°±è¿‘åŸåˆ™</strong>ï¼š</p><p><img src="https://s2.loli.net/2023/07/25/a8Vk2WGdfAgQTem.png" alt="image.png"></p><p><code>createContext(value) -&gt; &lt;XxxContext.Provider&gt; -&gt; useContext(XxxContext)</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** createContext */</span></span><br><span class="line"><span class="keyword">import</span> &#123; createContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">LevelContext</span> = <span class="title function_">createContext</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/** XxxContext.Provider */</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LevelContext</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./LevelContext.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Section</span>(<span class="params">&#123; level, children &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">section</span> <span class="attr">className</span>=<span class="string">&quot;section&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">LevelContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;level&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">LevelContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">section</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** useContext */</span></span><br><span class="line"><span class="keyword">import</span> &#123; useContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">LevelContext</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./LevelContext.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Heading</span>(<span class="params">&#123; children &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> level = <span class="title function_">useContext</span>(<span class="title class_">LevelContext</span>);</span><br><span class="line">  <span class="keyword">switch</span> (level) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;children&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;children&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;children&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span>;</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">throw</span> <span class="title class_">Error</span>(<span class="string">&#x27;æœªçŸ¥çš„ levelï¼š&#x27;</span> + level);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åº”ç”¨åœºæ™¯ï¼šé¢œè‰²ä¸»é¢˜ã€å…¨å±€æ•°æ®å…±äº«ã€å±€éƒ¨æ•°æ®å‘ä¸‹é€ä¼ ã€‚</p><p>Context ä¸å±€é™äºé™æ€å€¼ã€‚å¦‚æœä½ åœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“æ—¶ä¼ é€’ä¸åŒçš„å€¼ï¼ŒReact å°†ä¼šæ›´æ–°è¯»å–å®ƒçš„æ‰€æœ‰ä¸‹å±‚ç»„ä»¶ï¼è¿™å°±æ˜¯ context ç»å¸¸å’Œ state ç»“åˆä½¿ç”¨çš„åŸå› ã€‚</p><p><strong>æŠ€å·§ï¼š</strong></p><ol><li><p>å½“æ–‡ä»¶ä¸­å­˜åœ¨å¤šä¸ª context æ—¶ï¼Œå¯è¿›è¡Œæ•´åˆå¹¶å£°æ˜æ–°çš„ç»„ä»¶ï¼ˆ<strong>æ³¨æ„é¢„ç•™ children</strong>ï¼‰ã€‚</p></li><li><p>å°†ç›¸å…³é€»è¾‘è¿ç§»åˆ°ä¸€ä¸ªæ–‡ä»¶å½“ä¸­ï¼Œç”Ÿäº§è‡ªå®šä¹‰ Hookï¼š<code>createContext -&gt; useContext -&gt; useHook</code></p></li></ol><h3 id="Reduce-amp-Context"><a href="#Reduce-amp-Context" class="headerlink" title="Reduce &amp; Context"></a>Reduce &amp; Context</h3><p>é€šè¿‡ Context å°† Reduce çš„ state ä»¥åŠ dispatch åˆ†å‘åˆ°å­å­™ç»„ä»¶ä¸­ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** App.js */</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AddTask</span> <span class="keyword">from</span> <span class="string">&quot;./AddTask.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">TaskList</span> <span class="keyword">from</span> <span class="string">&quot;./TaskList.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">TasksProvider</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./TasksContext.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">TaskApp</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">TasksProvider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Day off in Kyoto<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">AddTask</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">TaskList</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">TasksProvider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** TaskContext.js */</span></span><br><span class="line"><span class="keyword">import</span> &#123; createContext, useContext, useReducer &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TasksContext</span> = <span class="title function_">createContext</span>(<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TasksDispatchContext</span> = <span class="title function_">createContext</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">TasksProvider</span>(<span class="params">&#123; children &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [tasks, dispatch] = <span class="title function_">useReducer</span>(tasksReducer, initialTasks);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">TasksContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;tasks&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">TasksDispatchContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;dispatch&#125;</span>&gt;</span>&#123;children&#125;<span class="tag">&lt;/<span class="name">TasksDispatchContext.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">TasksContext.Provider</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// useHooks</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useTasks</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">useContext</span>(<span class="title class_">TasksContext</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useTasksDispatch</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">useContext</span>(<span class="title class_">TasksDispatchContext</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">tasksReducer</span>(<span class="params">tasks, action</span>) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;added&quot;</span>: &#123;</span><br><span class="line">      <span class="keyword">return</span> [</span><br><span class="line">        ...tasks,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">id</span>: action.<span class="property">id</span>,</span><br><span class="line">          <span class="attr">text</span>: action.<span class="property">text</span>,</span><br><span class="line">          <span class="attr">done</span>: <span class="literal">false</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      ];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;changed&quot;</span>: &#123;</span><br><span class="line">      <span class="keyword">return</span> tasks.<span class="title function_">map</span>(<span class="function">(<span class="params">t</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (t.<span class="property">id</span> === action.<span class="property">task</span>.<span class="property">id</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> action.<span class="property">task</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> t;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;deleted&quot;</span>: &#123;</span><br><span class="line">      <span class="keyword">return</span> tasks.<span class="title function_">filter</span>(<span class="function">(<span class="params">t</span>) =&gt;</span> t.<span class="property">id</span> !== action.<span class="property">id</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attr">default</span>: &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="title class_">Error</span>(<span class="string">&quot;Unknown action: &quot;</span> + action.<span class="property">type</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initialTasks = [</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">text</span>: <span class="string">&quot;Philosopherâ€™s Path&quot;</span>, <span class="attr">done</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">&quot;Visit the temple&quot;</span>, <span class="attr">done</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">&quot;Drink matcha&quot;</span>, <span class="attr">done</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><p><code>useRef&lt;T&gt;(initState: T): &#123; curretn: T&#125;</code></p><p>æ•°æ®ç”± React ä¿å­˜ï¼Œä¸ state ä¸åŒçš„æ˜¯ï¼Œref æ›´å˜ä¸è§¦å‘ render ã€‚</p><table><thead><tr><th align="center">ref</th><th align="center">state</th></tr></thead><tbody><tr><td align="center"><code>useRef&lt;T&gt;(initialValue: T): &#123; current: T&#125;</code></td><td align="center"><code>useState&lt;T&gt;(initState: T): [state: T, setState: (state: T) =&gt; void]</code></td></tr><tr><td align="center">æ›´æ”¹æ—¶ä¸ä¼šè§¦å‘é‡æ–°æ¸²æŸ“</td><td align="center">æ›´æ”¹æ—¶è§¦å‘é‡æ–°æ¸²æŸ“ã€‚</td></tr><tr><td align="center">å¯å˜ â€”â€” ä½ å¯ä»¥åœ¨æ¸²æŸ“è¿‡ç¨‹ä¹‹å¤–ä¿®æ”¹å’Œæ›´æ–° current çš„å€¼ã€‚</td><td align="center">â€œä¸å¯å˜â€ â€”â€” ä½ å¿…é¡»ä½¿ç”¨ state è®¾ç½®å‡½æ•°æ¥ä¿®æ”¹ state å˜é‡ï¼Œä»è€Œæ’é˜Ÿé‡æ–°æ¸²æŸ“ã€‚</td></tr><tr><td align="center">ä½ ä¸åº”åœ¨æ¸²æŸ“æœŸé—´è¯»å–ï¼ˆæˆ–å†™å…¥ï¼‰ current å€¼ã€‚</td><td align="center">ä½ ä¸åº”åœ¨æ¸²æŸ“æœŸé—´è¯»å–ï¼ˆæˆ–å†™å…¥ï¼‰ current å€¼ã€‚</td></tr></tbody></table><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><ol><li><p>timeoutID</p></li><li><p>DOM</p></li><li><p>JSX</p></li></ol><h3 id="get-DOM"><a href="#get-DOM" class="headerlink" title="get DOM"></a>get DOM</h3><ol><li><p>å­—ç¬¦ä¸²å½¢å¼ï¼ˆå›è°ƒå½¢å¼ç®€å†™ï¼Œæ¥æ”¶ DOM èµ‹å€¼ç»™ ref.currentï¼‰</p></li><li><p>å›è°ƒå‡½æ•°å½¢å¼</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Form</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> buttonRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    inputRef.<span class="property">current</span>.<span class="title function_">focus</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span> <span class="attr">ref</span>=<span class="string">&#123;(c)</span> =&gt;</span> (buttonRef.current = c)&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        èšç„¦è¾“å…¥æ¡†</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>React å†…éƒ¨ï¼š</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">useRef</span>(<span class="params">initialValue</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [ref, unused] = <span class="title function_">useState</span>(&#123; <span class="attr">current</span>: initialValue &#125;);</span><br><span class="line">  <span class="keyword">return</span> ref;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤š ref ç®¡ç†ï¼š</strong></p><ol><li><p>ref ç»‘åˆ°çˆ¶å±‚ï¼Œé€šè¿‡ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Document/querySelectorAll">querySelectorAll</a> è·å–ï¼Œä½† DOM ç»“æ„å‘ç”Ÿå˜åŒ–ï¼Œå¯èƒ½ä¼šå¤±æ•ˆã€‚</p></li><li><p>é€šè¿‡ ref å›è°ƒçš„å½¢å¼å­˜å‚¨å¤šä¸ª DOM è‡³ map ä¸­ï¼Œmap ä¹Ÿæ˜¯éœ€è¦é€šè¿‡ ref ä¿å­˜ã€‚</p></li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> list = [];</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Component</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> refs = <span class="title function_">useref</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Singal model</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">getRefs</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!refs.<span class="property">current</span>) refs.<span class="property">current</span> = <span class="keyword">new</span> <span class="title class_">Map</span>();</span><br><span class="line">    <span class="keyword">return</span> refs.<span class="property">current</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;list.map((item) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">ref</span>=<span class="string">&#123;(node)</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            const refs = getRefs();</span></span><br><span class="line"><span class="language-xml">            if (node) refs.set(item.id, node);</span></span><br><span class="line"><span class="language-xml">            else refs.delete(item.id);</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;<span class="tag">&lt;/<span class="name">div</span>&gt;</span>;</span></span><br><span class="line"><span class="language-xml">      &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="forwardRef"><a href="#forwardRef" class="headerlink" title="forwardRef"></a>forwardRef</h3><p><strong>ä»…åŸç”Ÿ DOMï¼Œè‡ªå®šä¹‰ç»„ä»¶ä¸ç”Ÿæ•ˆä¸”æŠ¥é”™</strong>ï¼Œä½†å¯ä»¥é€šè¿‡ <code>forwardRef</code> å°† <code>ref</code> è¿›è¡Œ<strong>é€ä¼ </strong>åˆ°å†…éƒ¨ <strong>DOM</strong> ä¸Šï¼Œå¹¶è¿”å›ç»™ä¸Šå±‚ ref å›è°ƒä¸­ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; forwardRef, useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MyInput</span> = <span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Form</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    inputRef.<span class="property">current</span>.<span class="title function_">focus</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">MyInput</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>èšç„¦è¾“å…¥æ¡†<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="useImperativeHandle"><a href="#useImperativeHandle" class="headerlink" title="useImperativeHandle"></a>useImperativeHandle</h3><p>ä¸»åŠ¨è¿”å› DOM èŠ‚ç‚¹ã€‚</p><p>é€šè¿‡ useImperativeHandle è¿”å›ä¸€ä¸ªå¯¹è±¡ç»™ä¸Šå±‚ ref å›è°ƒä¸­ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; forwardRef, useRef, useImperativeHandle &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MyInput</span> = <span class="title function_">forwardRef</span>(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> realInputRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="title function_">useImperativeHandle</span>(ref, <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="comment">// åªæš´éœ² focusï¼Œæ²¡æœ‰åˆ«çš„</span></span><br><span class="line">    <span class="title function_">focus</span>(<span class="params"></span>) &#123;</span><br><span class="line">      realInputRef.<span class="property">current</span>.<span class="title function_">focus</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;));</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">ref</span>=<span class="string">&#123;realInputRef&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Form</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    inputRef.<span class="property">current</span>.<span class="title function_">focus</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(inputRef.<span class="property">current</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      //</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">MyInput</span> <span class="attr">ref</span>=<span class="string">&#123;(c)</span> =&gt;</span> (inputRef.current = c)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">      Â Â Â Â Â Â </span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">MyInput</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span>èšç„¦è¾“å…¥æ¡†<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Effect"><a href="#Effect" class="headerlink" title="Effect"></a>Effect</h2><p><strong>æ¸²æŸ“å¼•èµ·çš„å‰¯ä½œç”¨ï¼Œæ¸²æŸ“ï¼ˆåŒ…æ‹¬åˆæ¬¡ï¼‰ä¹‹åæ‰§è¡Œ</strong>ã€‚</p><p>æ¯ä¸€ä¸ª Effect éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åŒæ­¥è¿‡ç¨‹ï¼Œå¤šä¸ªä¹‹é—´äº’ä¸å½±å“ã€‚</p><h3 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a>useEffect</h3><p>åŸºç¡€ç”¨æ³•ï¼š</p><ol><li><p>å£°æ˜ Effect</p></li><li><p>æŒ‡å®š Effect ä¾èµ–ã€‚</p></li><li><p>å¿…è¦æ—¶æ·»åŠ  cleanup æ¸…ç†å‡½æ•°ã€‚</p></li></ol><p>React ä½¿ç”¨ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/is"><code>Object.is</code></a> æ¯”è¾ƒä¾èµ–é¡¹çš„å€¼ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œçš„ä»£ç ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åæ‰§è¡Œ</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œçš„ä»£ç åªä¼šåœ¨ç»„ä»¶æŒ‚è½½åæ‰§è¡Œ</span></span><br><span class="line">&#125;, []);</span><br><span class="line"></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œçš„ä»£ç åªä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åï¼Œå¹¶ä¸” a æˆ– b çš„å€¼ä¸ä¸Šæ¬¡æ¸²æŸ“ä¸ä¸€è‡´æ—¶æ‰§è¡Œ</span></span><br><span class="line">  <span class="comment">// cleanup</span></span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;&#125;;</span><br><span class="line">&#125;, [a, b]);</span><br></pre></td></tr></table></figure><p>åœ¨ä¾èµ–æ•°ç»„ä¸­å¯ä»¥çœç•¥ <strong>ref</strong>ï¼ŒReact ä¿è¯æ¯æ¬¡æ¸²æŸ“è¿‡ç¨‹ä¸­è°ƒç”¨ <strong>useRef</strong> äº§ç”Ÿçš„å¼•ç”¨å¯¹è±¡æ—¶ï¼Œè·å–çš„å¯¹è±¡å¼•ç”¨å§‹ç»ˆä¸å˜ï¼Œä½†è‹¥ ref ç”±çˆ¶å±‚ä¼ é€’è¿‡æ¥æ—¶éœ€è¦æ·»åŠ åˆ°ä¾èµ–æ•°ç»„ä¸­çš„ã€‚</p><blockquote><p>åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼ŒReact ä¼šåœ¨åˆå§‹æŒ‚è½½ç»„ä»¶åï¼Œç«‹å³å†æŒ‚è½½ä¸€æ¬¡ï¼ˆå‹åŠ›æµ‹è¯•ï¼‰ã€‚</p></blockquote><p>å› æ­¤å¼€å‘ç¯å¢ƒä¸‹ Effect ä¼šæ‰§è¡Œä¸¤æ¬¡ï¼Œæ­¤æ—¶å°±éœ€è¦è®¾ç½® cleanup æ¸…ç†å‡½æ•°ï¼Œæ¥é¿å…ä¸€äº›é¢å¤–çš„å‰¯ä½œç”¨çš„å‡ºç°ã€‚</p><h3 id="cleanup"><a href="#cleanup" class="headerlink" title="cleanup"></a>cleanup</h3><p><strong>æ‰§è¡Œæ—¶æœºï¼š</strong></p><ol><li><p>ç»„ä»¶å¸è½½</p></li><li><p>æ‰§è¡Œä¸‹ä¸€è½®æ¸²æŸ“çš„ Effect ä¹‹å‰</p></li></ol><p><strong>å·¥ä½œåŸç†ï¼š</strong><code>depArr -&gt; compare -&gt; isShouldSyncEffect</code></p><p><strong>ç”Ÿå‘½å‘¨æœŸï¼š</strong></p><ol><li><p>å¼€å§‹åŒæ­¥</p></li><li><p>åœæ­¢åŒæ­¥</p></li></ol><h3 id="useEffectEvent"><a href="#useEffectEvent" class="headerlink" title="useEffectEvent"></a>useEffectEvent</h3><p>å°† Effect ä¸­ä¸€äº›å“åº”å¼æ•°æ®åŒ…è£…èµ·æ¥ï¼Œä¸ä½œä¸ºä¾èµ–é¡¹ï¼Œä½† EffectEvent ä¸­çš„å‡½æ•°ä»æ˜¯å“åº”å¼çš„ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">ChatRoom</span>(<span class="params">&#123; roomId, theme &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> onConnected = <span class="title function_">useEffectEvent</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">showNotification</span>(<span class="string">&quot;Connected!&quot;</span>, theme);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> connection = <span class="title function_">createConnection</span>(serverUrl, roomId);</span><br><span class="line">    connection.<span class="title function_">on</span>(<span class="string">&quot;connected&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">onConnected</span>();</span><br><span class="line">    &#125;);</span><br><span class="line">    connection.<span class="title function_">connect</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> connection.<span class="title function_">disconnect</span>();</span><br><span class="line">  &#125;, [roomId]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Welcome to the &#123;roomId&#125; room!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Effect &amp; äº‹ä»¶å¤„ç†ï¼š</strong></p><table><thead><tr><th align="center">Effect</th><th align="center">äº‹ä»¶å¤„ç†</th></tr></thead><tbody><tr><td align="center">éœ€è¦åŒæ­¥çš„æ—¶å€™è¿è¡Œ</td><td align="center">å“åº”ç‰¹å®šäº¤äº’æ—¶è¿è¡Œ</td></tr><tr><td align="center">å†…éƒ¨çš„é€»è¾‘æ˜¯å“åº”å¼çš„</td><td align="center">å‡½æ•°å†…éƒ¨çš„é€»è¾‘æ˜¯éå“åº”å¼çš„</td></tr></tbody></table><h2 id="Custom-Hooks"><a href="#Custom-Hooks" class="headerlink" title="Custom Hooks"></a>Custom Hooks</h2><p>çŠ¶æ€é€»è¾‘å…±äº«ï¼Œè€Œä¸æ˜¯çŠ¶æ€æœ¬èº«ã€‚</p><p><code>effect -&gt; hooks</code></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€æœ¬æ‘„å½±ä¹¦</title>
      <link href="/2023/06/28/%E9%9A%8F%E7%AC%94/%E4%B8%80%E6%9C%AC%E6%91%84%E5%BD%B1%E4%B9%A6/"/>
      <url>/2023/06/28/%E9%9A%8F%E7%AC%94/%E4%B8%80%E6%9C%AC%E6%91%84%E5%BD%B1%E4%B9%A6/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€æœ¬æ‘„å½±ä¹¦"><a href="#ä¸€æœ¬æ‘„å½±ä¹¦" class="headerlink" title="ä¸€æœ¬æ‘„å½±ä¹¦"></a>ä¸€æœ¬æ‘„å½±ä¹¦</h1><h2 id="æ‘„å½±åŸºç¡€çŸ¥è¯†"><a href="#æ‘„å½±åŸºç¡€çŸ¥è¯†" class="headerlink" title="æ‘„å½±åŸºç¡€çŸ¥è¯†"></a>æ‘„å½±åŸºç¡€çŸ¥è¯†</h2><h3 id="æ›å…‰"><a href="#æ›å…‰" class="headerlink" title="æ›å…‰"></a>æ›å…‰</h3><p>å…‰ -&gt; CMOSï¼ˆæ„Ÿå…‰å…ƒä»¶ï¼‰ -&gt; ç”µæµä¿¡å· -&gt; å›¾åƒæ–‡ä»¶ -&gt; å­˜å‚¨</p><p>å¯¹åŒä¸€åœºæ™¯è€Œè¨€ï¼Œå…‰çº¿è¶Šå¼ºï¼Œå½¢æˆçš„ç”µæµä¿¡å·è¶Šå¼ºï¼Œæœ€ç»ˆå½¢æˆå›¾åƒçš„æ—¶é—´ä¹Ÿå°±è¶ŠçŸ­ã€‚</p><p>æ›å…‰æ§åˆ¶ä¹Ÿå°±æ˜¯ç¡®å®šæ‹æ‘„ä¸­çš„å„ç§å‚æ•°ï¼šå¿«é—¨é€Ÿåº¦ã€å…‰åœˆã€ISOï¼ˆæ›å…‰çš„ä¸‰å¤§è¦ç´ ï¼‰ã€‚</p><h4 id="å¿«é—¨"><a href="#å¿«é—¨" class="headerlink" title="å¿«é—¨"></a>å¿«é—¨</h4><p>å¿«é—¨å®é™…ä¸Šæ˜¯ CMOS çš„æ„Ÿå…‰æ—¶é—´ã€‚</p><p>å¿«é—¨é€Ÿåº¦é™¤äº†èƒ½ç›´è§‚å½±å“è¿›å…‰é‡ä»¥å¤–ï¼Œè¿˜å¯¹æ¸…æ™°åº¦æœ‰å½±å“ï¼šçŸ­å¿«é—¨èƒ½èƒ½å¥½çš„æ•æ‰è¿åŠ¨ä¸­çš„ç‰©ä½“ï¼ŒåŒæ ·ä¹Ÿèƒ½å‡å°ç›¸æœºä¸ç¨³é€ æˆçš„æ¨¡ç³Šã€‚</p><p>å½“ç„¶å¿«é—¨è¿‡çŸ­ï¼Œå¯èƒ½å¯¼è‡´æ›å…‰ä¸è¶³ï¼›å¿«é—¨è¿‡é•¿ï¼Œå¯èƒ½å¯¼è‡´æ›å…‰è¿‡å‰©ã€‚</p><h4 id="å…‰åœˆ"><a href="#å…‰åœˆ" class="headerlink" title="å…‰åœˆ"></a>å…‰åœˆ</h4><p>æ§åˆ¶é•œå¤´è¿›å…‰é¢ç§¯ï¼Œf å€¼è¶Šå¤§ï¼Œå…‰åœˆè¶Šå°ï¼›f å€¼è¶Šå°ï¼Œå…‰åœˆè¶Šå¤§ã€‚</p><p><img src="https://s2.loli.net/2023/06/11/1t5feIXQ7q6kpli.png" alt="image-20230611150643789"></p><p>å®é™…ä¸Šå…‰åœˆé™¤äº†æ§åˆ¶è¿›å…‰é‡ï¼Œè¿˜å½±å“ç€ç…§ç‰‡çš„<strong>æ™¯æ·±</strong>ï¼ˆå°æ™¯æ·±å¤§å…‰åœˆï¼‰ã€‚</p><p>å°å…‰åœˆè®©è¿œå¤„çš„æ™¯è‰²æ›´åŠ æ¸…æ™°ï¼Œå¦‚åŒçœ¯ç€çœ¼ç›çœ‹è¿œå¤„æ›´æ¸…æ¥šã€‚</p><blockquote><p>å°æ™¯æ·±æ˜¯æŒ‡åœ¨æ‘„å½±ä¸­ï¼Œåªæœ‰ä¸€å°éƒ¨åˆ†åŒºåŸŸå¤„äºç„¦ç‚¹èŒƒå›´å†…ï¼Œè€Œå…¶ä»–åŒºåŸŸåˆ™å‘ˆç°å‡ºæ¨¡ç³Šçš„æ•ˆæœã€‚</p><p>é€šä¿—åœ°è¯´ï¼Œå°±æ˜¯ä¸»ä½“æ¸…æ™°ã€èƒŒæ™¯è™šåŒ–çš„æ•ˆæœã€‚å°æ™¯æ·±é€šå¸¸ç”±è¾ƒå¤§å…‰åœˆï¼ˆå¦‚f&#x2F;2.8ã€f&#x2F;1.8ç­‰ï¼‰å’Œè¾ƒè¿‘æ‹æ‘„è·ç¦»æ‰€äº§ç”Ÿã€‚</p></blockquote><p>è‡³äºå…‰åœˆæ¡£æ•°ï¼Œæˆ‘æ˜¯è¿™ä¹ˆç†è§£çš„ï¼š0.8 -&gt; 1.6 -&gt; 3.2 -&gt; 6.4ï¼Œå°æ•°éƒ¨åˆ†å››èˆä¸äº”å…¥ &#x3D;&gt; 0.8 -&gt; 1.6 -&gt; 3 -&gt; 6</p><h4 id="å…‰åœˆå’Œå¿«é—¨çš„å…³ç³»ï¼ˆæ˜“å€’ç‡ï¼‰"><a href="#å…‰åœˆå’Œå¿«é—¨çš„å…³ç³»ï¼ˆæ˜“å€’ç‡ï¼‰" class="headerlink" title="å…‰åœˆå’Œå¿«é—¨çš„å…³ç³»ï¼ˆæ˜“å€’ç‡ï¼‰"></a>å…‰åœˆå’Œå¿«é—¨çš„å…³ç³»ï¼ˆæ˜“å€’ç‡ï¼‰</h4><p>æ‰€è°“æ§åˆ¶å˜é‡å˜›ï¼</p><p>ISO ä¸å˜æ—¶ï¼Œå…‰åœˆå¤§å°å’Œå¿«é—¨é€Ÿåº¦æ˜¯å¯ä»¥<strong>äº’è¡¥</strong>çš„ï¼Œä¹Ÿå«åš<strong>æ˜“å€’ç‡</strong>ã€‚</p><p>æ¯”å¦‚ä½ æƒ³æ‹é£æ™¯ï¼Œåœ¨ f&#x2F;4.0 ä¸‹å¯¹åº”çš„å¿«é—¨é€Ÿåº¦æ˜¯ 1&#x2F;500sï¼Œä½†æ˜¯æ‹é£æ™¯éœ€è¦å°æ™¯æ·±ï¼Œè¿™æ—¶å€™ç¼©å°ä¸‰æŒ¡å…‰åœˆï¼šf&#x2F;4 -&gt; f&#x2F;5.6 -&gt; f&#x2F;8 -&gt; f&#x2F;11ï¼Œå¿«é—¨é€Ÿåº¦åˆ™è¦å»¶é•¿ä¸‰æŒ¡ï¼š1&#x2F;500s -&gt; 1&#x2F;250s -&gt; 1&#x2F;125s -&gt; 1&#x2F;60ã€‚</p><h4 id="æ„Ÿå…‰åº¦ï¼ˆISOï¼‰"><a href="#æ„Ÿå…‰åº¦ï¼ˆISOï¼‰" class="headerlink" title="æ„Ÿå…‰åº¦ï¼ˆISOï¼‰"></a>æ„Ÿå…‰åº¦ï¼ˆISOï¼‰</h4><p>æ„Ÿå…‰å…ƒä»¶å¯¹å…‰çš„æ•æ„Ÿåº¦ã€‚</p><p>ISOè¶Šä½ï¼Œæˆåƒè¶Šæ¸…æ™°ï¼Œä½†å¯¹å…‰ä¸å¤Ÿæ•æ„Ÿï¼Œåœ¨å…‰çº¿ä¸è¶³çš„æƒ…å†µä¸‹ï¼Œæ‹æ‘„å¾ˆå›°éš¾ã€‚æé«˜ ISO æœ‰åˆ©äºåœ¨æš—ç¯å¢ƒä¸‹æ‹æ‘„ï¼Œä½†ä¹Ÿä¼šå¯¼è‡´å‡ºç°å™ªç‚¹ï¼Œç”»è´¨ä¸‹é™ï¼Œä¸æ¸…æ™°ã€‚</p><p><img src="https://s2.loli.net/2023/06/11/rPQ2WmpM9zkRobD.png" alt="image-20230611154622340"></p><h3 id="å¦‚ä½•å¾—åˆ°æ›´æ¸…æ™°çš„ç…§ç‰‡"><a href="#å¦‚ä½•å¾—åˆ°æ›´æ¸…æ™°çš„ç…§ç‰‡" class="headerlink" title="å¦‚ä½•å¾—åˆ°æ›´æ¸…æ™°çš„ç…§ç‰‡"></a>å¦‚ä½•å¾—åˆ°æ›´æ¸…æ™°çš„ç…§ç‰‡</h3><h4 id="æ‰‹åŠ¿å§¿åŠ¿å’Œå‘¼å¸æ§åˆ¶"><a href="#æ‰‹åŠ¿å§¿åŠ¿å’Œå‘¼å¸æ§åˆ¶" class="headerlink" title="æ‰‹åŠ¿å§¿åŠ¿å’Œå‘¼å¸æ§åˆ¶"></a>æ‰‹åŠ¿å§¿åŠ¿å’Œå‘¼å¸æ§åˆ¶</h4><p><img src="https://s2.loli.net/2023/06/13/tl17g2MmHIAqan8.png" alt="image-20230613172256069"></p><h4 id="ç‰©ç†å¤–æŒ‚"><a href="#ç‰©ç†å¤–æŒ‚" class="headerlink" title="ç‰©ç†å¤–æŒ‚"></a>ç‰©ç†å¤–æŒ‚</h4><p>ä¸‰è„šæ¶ï¼Œä½†æ„Ÿè§‰æ€ªéº»çƒ¦çš„å“ˆå“ˆå“ˆå“ˆğŸ¤ª</p><p>æš‚ä¸è€ƒè™‘ï¼Œè·³è¿‡è·³è¿‡ï¼</p><h4 id="æé«˜å¿«é—¨é€Ÿåº¦"><a href="#æé«˜å¿«é—¨é€Ÿåº¦" class="headerlink" title="æé«˜å¿«é—¨é€Ÿåº¦"></a>æé«˜å¿«é—¨é€Ÿåº¦</h4><p>è¾ƒé«˜çš„å¿«é—¨é€Ÿåº¦å¯ä»¥å°†è¿åŠ¨ç‰©ä½“å‡å›ºã€‚</p><p>æ›å…‰æ—¶é—´çŸ­ï¼Œè¿åŠ¨ç‰©ä½“çš„å½±å“åœ¨ç”»é¢ä¸Šæ‰€ç»è¿‡çš„è·ç¦»å°±ç›¸åº”å˜çŸ­ï¼Œåœ¨æ—¶é—´çŸ­åˆ°ä¸€å®šç¨‹åº¦ï¼Œè¿åŠ¨ç‰©ä½“çš„æ‘„åƒä¾¿è¿‘ä¹é™æ­¢ã€‚</p><p><strong>ä»¥ç„¦è·å€’æ•°ä¸ºå®‰å…¨å¿«é—¨é€Ÿåº¦</strong>ï¼Œåœ¨å®‰å…¨å¿«é—¨é€Ÿåº¦ä¸‹å¯ä»¥ä¿è¯æˆåƒæ¸…æ™°ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼š50mm é•œå¤´æ‹ç€ -&gt; åˆ™å¿«é—¨é€Ÿåº¦è¦ä½äº 1&#x2F;50s å³å¯ä¿è¯æˆåƒæ¸…æ™°ã€‚</p><blockquote><p>ä½†è¿™ç§è§„å¾‹å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š</p><ol><li>ä¸æ‹æ‘„è€…çš„æ‰‹æŒç¨³å®šæ€§æœ‰å…³ï¼Œè‹¥æ¡æŒä¸ç¨³å®šï¼Œåˆ™å®‰å…¨å¿«é—¨æ ¹æœ¬ä¸èƒ½ä¿è¯ã€‚</li><li>è¿˜æ˜¯è¦æ ¹æ®å¯¹åº”çš„æœºå™¨æ¥åšç›¸åº”çš„è°ƒæ•´ã€‚</li><li>å¯¹äºæœ‰é˜²æŠ–çš„é•œå¤´ï¼Œå®‰å…¨å¿«é—¨ä¹Ÿå¯ä»¥å¤§å¹…é™ä½ã€‚</li></ol></blockquote><h4 id="é˜²æŠ–åŠŸèƒ½"><a href="#é˜²æŠ–åŠŸèƒ½" class="headerlink" title="é˜²æŠ–åŠŸèƒ½"></a>é˜²æŠ–åŠŸèƒ½</h4><p>ç›¸æœºçš„é˜²æŠ–åŠŸèƒ½æ˜¯åœ¨é•œå¤´ä¸­åŠ ä¸€å—å„¿è¡¥å¿é•œç‰‡ï¼Œåœ¨ç›¸æœºæŠ–åŠ¨æ˜¯è¿›è¡Œåå‘è¡¥å¿ï¼Œå°†æŠ–åŠ¨å¯¹æˆåƒçš„å½±å“é™ä½å€¼æœ€ä½ã€‚</p><p><img src="https://s2.loli.net/2023/06/13/E5w68KvoO4UJWS9.png" alt="image-20230613173723305"></p><h4 id="æ™¯æ·±"><a href="#æ™¯æ·±" class="headerlink" title="æ™¯æ·±"></a>æ™¯æ·±</h4><p>æ™¯æ·±æ˜¯æŒ‡åœ¨ä¸€å¼ ç…§ç‰‡æˆ–å›¾åƒä¸­ï¼Œèƒ½å¤Ÿæ¸…æ™°å‘ˆç°å‡ºçš„è·ç¦»èŒƒå›´ã€‚é€šä¿—æ¥è¯´ï¼Œå°±æ˜¯åœ¨ä¸€å¼ ç…§ç‰‡ä¸­ï¼Œä»å‰æ™¯åˆ°èƒŒæ™¯æœ‰å¤šå°‘éƒ¨åˆ†æ˜¯æ¸…æ™°çš„ã€‚</p><p>å¦‚æœä¸€å¼ ç…§ç‰‡çš„æ™¯æ·±å¾ˆæµ…ï¼Œé‚£ä¹ˆåªæœ‰å¾ˆå°çš„ä¸€éƒ¨åˆ†æ˜¯æ¸…æ™°çš„ï¼Œè€Œå…¶ä»–åŒºåŸŸåˆ™ä¼šæ¨¡ç³Šæˆ–è€…å˜å¾—ä¸æ¸…æ¥šã€‚è€Œå¦‚æœç…§ç‰‡çš„æ™¯æ·±å¾ˆæ·±ï¼Œé‚£ä¹ˆæ•´ä¸ªç”»é¢çš„ä¸»ä½“å’ŒèƒŒæ™¯éƒ½å¯ä»¥ä¿æŒç›¸å¯¹æ¸…æ™°çš„çŠ¶æ€ã€‚</p><p><img src="https://s2.loli.net/2023/06/13/kDpaJLWgwR2Kn1P.png" alt="image-20230613181941478"></p><p>å½±å“æ™¯æ·±çš„å› ç´ ä¸»è¦æœ‰å¦‚ä¸‹å››ç‚¹ï¼š</p><ol><li><p>å…‰åœˆ</p><p>å…‰åœˆè¶Šå¤§ï¼Œæ™¯æ·±è¶Šå°ï¼›å…‰åœˆè¶Šå°ï¼Œæ™¯æ·±è¶Šå¤§ã€‚</p><p>å…‰åœˆè¶Šå¤§ï¼Œè¿›å…‰é‡æ›´å¤šã€‚è¿™ç§æƒ…å†µä¸‹åªæœ‰é è¿‘ç›¸æœºçš„ç‰©ä½“æ‰èƒ½å¤„äºç„¦ç‚¹å†…ï¼Œä¸”é è¿‘çš„ç‰©ä½“éœ€è¦è¾ƒå°‘çš„å…‰çº¿å°±èƒ½å‘ˆç°æ¸…æ™°çš„å›¾åƒã€‚è·ç¦»è¾ƒè¿œçš„åˆ™éœ€è¦æ›´å¤šçš„å…‰çº¿æ‰èƒ½æ˜¾ç¤ºæ¸…æ™°ï¼Œå› æ­¤ä¼šå˜å¾—æ¨¡ç³Šè™šåŒ–ï¼Œå³æµ…æ™¯æ·±ã€‚ </p></li><li><p>ç„¦è·</p><p>ç„¦è·è¶Šé•¿ï¼Œæ™¯æ·±è¶Šå°ï¼›ç„¦è·è¶ŠçŸ­ï¼Œæ™¯æ·±è¶Šå¤§ã€‚</p><p>ç„¦è·è¶Šé•¿ï¼Œè¿œå¤„çš„ç‰©ä½“è¶Šæ¸…æ™°ï¼Œè¿‘å¤„ä¹Ÿå°±è¶Šæ¨¡ç³Šã€‚</p></li></ol><p><img src="https://s2.loli.net/2023/06/13/wkJIui8X74EKrDS.png" alt="image-20230613184939626"></p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‘„å½± </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿®æ”¹typoraå­—ä½“</title>
      <link href="/2023/04/15/Tool/%E4%BF%AE%E6%94%B9typora%E5%AD%97%E4%BD%93/"/>
      <url>/2023/04/15/Tool/%E4%BF%AE%E6%94%B9typora%E5%AD%97%E4%BD%93/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¿®æ”¹typoraå­—ä½“"><a href="#ä¿®æ”¹typoraå­—ä½“" class="headerlink" title="ä¿®æ”¹typoraå­—ä½“"></a>ä¿®æ”¹typoraå­—ä½“</h1><ol><li><p>æ‰“å¼€ä¸»é¢˜æ–‡ä»¶å¤¹</p><p><img src="https://s2.loli.net/2023/05/26/3ez9ZtSEDORqH7w.png" alt="image-20230526095620420"></p></li><li><p>æ‰“å¼€å¯¹åº”ä¸»é¢˜çš„ css æ–‡ä»¶ï¼Œå¹¶å¤‡ä»½</p><p><img src="https://s2.loli.net/2023/05/26/PVA87imQZ3vrfzp.png" alt="image-20230526095716062"></p></li><li><p>æœç´¢ font-family å¹¶ä¿®æ”¹ï¼Œåªéœ€è¦ä¿®æ”¹ â€“font-familyã€‚ï¼ˆä½†ä¹Ÿéœ€è¦æ ¹æ®æ¯ä¸ªä¸»é¢˜å…·ä½“æƒ…å†µæ¥ï¼‰</p><p><img src="https://s2.loli.net/2023/05/26/NxDkEH9KTut6Foz.png" alt="image-20230526095809045"></p></li><li><p>å¤§åŠŸå‘Šæˆï¼ğŸ‰</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Tool </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>React ç¬”è®°</title>
      <link href="/2023/04/14/React/React%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/04/14/React/React%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h1><h2 id="å…³äº-React"><a href="#å…³äº-React" class="headerlink" title="å…³äº React"></a>å…³äº React</h2><ol><li><p>ä»€ä¹ˆæ˜¯ Reactï¼Ÿ</p><p><strong>React</strong> æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“ã€‚</p><ul><li>æ˜¯ä¸€ä¸ªå°†æ•°æ®æ¸²æŸ“ä¸º HTML è§†å›¾çš„å¼€æº JS åº“ã€‚</li><li>å®ƒéµå¾ªåŸºäºç»„ä»¶çš„æ–¹æ³•ï¼Œæœ‰åŠ©äºæ„å»ºå¯é‡ç”¨çš„ UI ç»„ä»¶ã€‚</li><li>å®ƒç”¨äºå¼€å‘å¤æ‚çš„äº¤äº’å¼çš„ web å’Œç§»åŠ¨ UIã€‚</li></ul></li><li><p>React æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ</p><ul><li>ä½¿ç”¨è™šæ‹Ÿ DOM è€Œä¸æ˜¯çœŸæ­£çš„ DOMã€‚</li><li>å®ƒå¯ä»¥ç”¨æœåŠ¡å™¨æ¸²æŸ“ã€‚</li><li>å®ƒéµå¾ªå•å‘æ•°æ®æµæˆ–æ•°æ®ç»‘å®šã€‚</li><li>é«˜æ•ˆã€‚</li><li>å£°æ˜å¼ç¼–ç ï¼Œç»„ä»¶åŒ–ç¼–ç ã€‚</li></ul></li><li><p>React çš„ä¸€äº›ä¸»è¦ä¼˜ç‚¹ï¼Ÿ</p><ul><li><p>å®ƒæé«˜äº†åº”ç”¨çš„æ€§èƒ½ã€‚</p></li><li><p>å¯ä»¥æ–¹ä¾¿åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä½¿ç”¨ã€‚</p></li><li><p>ç”±äºä½¿ç”¨ JSXï¼Œä»£ç çš„å¯è¯»æ€§æ›´å¥½ã€‚</p></li><li><p>ä½¿ç”¨Reactï¼Œç¼–å†™ UI æµ‹è¯•ç”¨ä¾‹å˜å¾—éå¸¸å®¹æ˜“ã€‚</p></li></ul></li></ol><h2 id="JSX-è¯­æ³•"><a href="#JSX-è¯­æ³•" class="headerlink" title="JSX è¯­æ³•"></a>JSX è¯­æ³•</h2><ol><li>å®šä¹‰è™šæ‹ŸDOMï¼Œä¸èƒ½ä½¿ç”¨<code>â€œâ€</code></li><li>æ ‡ç­¾ä¸­æ··å…¥JSè¡¨è¾¾å¼çš„æ—¶å€™ä½¿ç”¨<code>&#123;&#125;</code>ï¼š<code>id = &#123;myId.toUpperCase()&#125;</code></li><li>æ ·å¼çš„ç±»åæŒ‡å®šä¸èƒ½ä½¿ç”¨classï¼Œä½¿ç”¨<code>className</code></li><li>å†…æ•›æ ·å¼è¦ä½¿ç”¨<code>&#123;&#123;&#125;&#125;</code>åŒ…è£¹ï¼š<code>style=&#123;&#123;color:'skyblue',fontSize:'24px'&#125;&#125;</code></li><li>ä¸èƒ½æœ‰å¤šä¸ªæ ¹æ ‡ç­¾ï¼Œåªèƒ½æœ‰ä¸€ä¸ªæ ¹æ ‡ç­¾ã€‚</li><li>æ ‡ç­¾å¿…é¡»é—­åˆï¼Œè‡ªé—­åˆä¹Ÿè¡Œã€‚</li><li>å¦‚æœå°å†™å­—æ¯å¼€å¤´ï¼Œå°±å°†æ ‡ç­¾è½¬åŒ–ä¸º html åŒåå…ƒç´ ï¼Œå¦‚æœ html ä¸­æ— è¯¥æ ‡ç­¾å¯¹åº”çš„å…ƒç´ ï¼Œå°±æŠ¥é”™ï¼›å¦‚æœæ˜¯å¤§å†™å­—æ¯å¼€å¤´ï¼Œreact å°±å»æ¸²æŸ“å¯¹åº”çš„ç»„ä»¶ï¼Œå¦‚æœæ²¡æœ‰å°±æŠ¥é”™ã€‚</li></ol><h1 id="é¢å‘ç»„ä»¶ç¼–ç¨‹"><a href="#é¢å‘ç»„ä»¶ç¼–ç¨‹" class="headerlink" title="é¢å‘ç»„ä»¶ç¼–ç¨‹"></a>é¢å‘ç»„ä»¶ç¼–ç¨‹</h1><p><strong>æ¸²æŸ“ç±»ç»„ä»¶æ ‡ç­¾çš„åŸºæœ¬æµç¨‹</strong>ï¼š</p><ol><li>React å†…éƒ¨ä¼šåˆ›å»ºç»„ä»¶å®ä¾‹å¯¹è±¡ã€‚</li><li>è°ƒç”¨<code>render()</code>å¾—åˆ°è™šæ‹Ÿ DOM ,å¹¶è§£æä¸ºçœŸå® DOMã€‚</li><li>æ’å…¥åˆ°æŒ‡å®šçš„é¡µé¢å…ƒç´ å†…éƒ¨ã€‚</li></ol><h2 id="å‡½æ•°ç»„ä»¶"><a href="#å‡½æ•°ç»„ä»¶" class="headerlink" title="å‡½æ•°ç»„ä»¶"></a>å‡½æ•°ç»„ä»¶</h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.å…ˆåˆ›å»ºå‡½æ•°ï¼Œå‡½æ•°å¯ä»¥æœ‰å‚æ•°ï¼Œä¹Ÿå¯ä»¥æ²¡æœ‰ï¼Œä½†æ˜¯å¿…é¡»è¦æœ‰è¿”å›å€¼ è¿”å›ä¸€ä¸ªè™šæ‹ŸDOM</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Welcome</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//2.è¿›è¡Œæ¸²æŸ“</span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title class_">Render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Welcom</span> <span class="attr">name</span> = <span class="string">&quot;ljc&quot;</span> /&gt;</span></span>,<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;div&quot;</span>));</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç ç»å†äº†ä»¥ä¸‹å‡ æ­¥ï¼š</p><ol><li>æˆ‘ä»¬è°ƒç”¨ <code>ReactDOM.render()</code> å‡½æ•°ï¼Œå¹¶ä¼ å…¥ <code>&lt;Welcome name=&quot;ljc&quot; /&gt;</code> ä½œä¸ºå‚æ•°ã€‚</li><li>React è°ƒç”¨ <code>Welcome</code> ç»„ä»¶ï¼Œå¹¶å°† <code>&#123;name: &#39;ljc&#39;&#125;</code> ä½œä¸º props ä¼ å…¥ã€‚</li><li><code>Welcome</code> ç»„ä»¶å°† <code>Hello, ljc</code> å…ƒç´ ä½œä¸ºè¿”å›å€¼ã€‚</li><li>React DOM å°† DOM é«˜æ•ˆåœ°æ›´æ–°ä¸º <code>Hello,ljc</code>ã€‚</li></ol><h2 id="ç±»ç»„ä»¶"><a href="#ç±»ç»„ä»¶" class="headerlink" title="ç±»ç»„ä»¶"></a>ç±»ç»„ä»¶</h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyComponent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">    state = &#123;<span class="attr">isHot</span>:<span class="literal">false</span>&#125;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;isHot&#125; = <span class="variable language_">this</span>.<span class="property">state</span></span><br><span class="line">        <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">onClick</span>=<span class="string">&#123;this.changeWeather&#125;</span>&gt;</span>ä»Šå¤©å¤©æ°”å¾ˆ&#123;isHot?&#x27;ç‚çƒ­&#x27;:&#x27;å‡‰çˆ½&#x27;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">    changeWeather = <span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">const</span> isHot = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">isHot</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;<span class="attr">isHot</span>:!isHot&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">MyComponent</span>/&gt;</span></span>,<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.test&#x27;</span>))</span><br></pre></td></tr></table></figure><p><strong>åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ï¼š</strong></p><ol><li><p>ç»„ä»¶ä¸­çš„ render æ–¹æ³•ä¸­çš„ this ä¸ºç»„ä»¶å®ä¾‹å¯¹è±¡ã€‚</p></li><li><p>ç»„ä»¶è‡ªå®šä¹‰æ–¹æ³•ä¸­ç”±äºå¼€å¯äº†ä¸¥æ ¼æ¨¡å¼ï¼Œthis æŒ‡å‘ <code>undefined</code> å¦‚ä½•è§£å†³ã€‚</p><ul><li><p>é€šè¿‡ bind æ”¹å˜ this æŒ‡å‘ã€‚</p></li><li><p>æ¨èé‡‡ç”¨ç®­å¤´å‡½æ•°ï¼Œç®­å¤´å‡½æ•°çš„ <code>this</code> æŒ‡å‘ã€‚</p></li></ul></li><li><p>state æ•°æ®ä¸èƒ½ç›´æ¥ä¿®æ”¹æˆ–è€…æ›´æ–°ã€‚</p></li></ol><h2 id="ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§å±æ€§"><a href="#ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§å±æ€§" class="headerlink" title="ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§å±æ€§"></a>ç»„ä»¶å®ä¾‹çš„ä¸‰å¤§å±æ€§</h2><h3 id="state"><a href="#state" class="headerlink" title="state"></a>state</h3><blockquote><p>React æŠŠç»„ä»¶çœ‹æˆæ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼ˆState Machinesï¼‰ã€‚é€šè¿‡ä¸ç”¨æˆ·çš„äº¤äº’ï¼Œå®ç°ä¸åŒçŠ¶æ€ï¼Œç„¶åæ¸²æŸ“ UIï¼Œè®©ç”¨æˆ·ç•Œé¢å’Œæ•°æ®ä¿æŒä¸€è‡´ã€‚</p><p>React é‡Œï¼Œåªéœ€æ›´æ–°ç»„ä»¶çš„ stateï¼Œç„¶åæ ¹æ®æ–°çš„ state é‡æ–°æ¸²æŸ“ç”¨æˆ·ç•Œé¢ï¼ˆä¸è¦æ“ä½œ DOMï¼‰ã€‚</p></blockquote><p>ç®€å•çš„è¯´å°±æ˜¯ç»„ä»¶çš„çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯¥ç»„ä»¶æ‰€å­˜å‚¨çš„æ•°æ®ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Weather</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="comment">// this.state = &#123; weather: &#x27;å‡‰çˆ½&#x27; &#125;;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">weather</span>: <span class="string">&#x27;ç‚çƒ­&#x27;</span>,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123; this.state.weather &#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>state å³å½“å‰ç»„ä»¶çš„å®ä¾‹å±æ€§ã€‚</p><p>åœ¨ç±»ç»„ä»¶ä¸­å¯ä»¥ç›´æ¥ä¿®æ”¹ state å€¼ï¼Œä½†ä¿®æ”¹ä¹‹åé¡µé¢å†…å®¹æ˜¯ä¸ä¼šå˜åŒ–çš„ã€‚</p><p>åŸå› æ˜¯ React ä¸­ä¸å»ºè®® <code>state</code>ä¸å…è®¸ç›´æ¥ä¿®æ”¹ï¼Œè€Œæ˜¯é€šè¿‡ç±»çš„åŸå‹å¯¹è±¡ä¸Šçš„æ–¹æ³• <code>setState()</code></p><blockquote><p>é¡µé¢çš„æ¸²æŸ“é çš„æ˜¯ <code>render</code> å‡½æ•°ã€‚</p></blockquote><p><strong>setState()</strong></p><p><code>this.setState(partialState, [callback]);</code></p><ul><li><code>partialState</code>ï¼šéœ€è¦æ›´æ–°çš„çŠ¶æ€çš„éƒ¨åˆ†å¯¹è±¡ã€‚</li><li><code>callback</code>ï¼šæ›´æ–°å®ŒçŠ¶æ€åçš„å›è°ƒå‡½æ•°ã€‚</li></ul><p>ä¸¤ç§å†™æ³•ï¼š</p><ol><li>å¯¹è±¡å½¢å¼ï¼š<code>this.setState(&#123; weather: &#39;å‡‰çˆ½&#39; &#125;)</code>;</li><li>å›è°ƒå½¢å¼ï¼š<code>this.setState(state =&gt; (&#123; count: state.count+1 &#125;));</code></li></ol><blockquote><p><code>setState</code> æ˜¯ä¸€ç§åˆå¹¶æ“ä½œï¼Œå¹¶ä¸æ˜¯æ›¿æ¢æ“ä½œã€‚</p><p>æ¯ä¸€æ¬¡è°ƒç”¨ <code>setState</code> å°†ä¼šè§¦å‘ <code>render</code> è¿›è¡Œé¡µé¢æ¸²æŸ“ï¼Œå› æ­¤ <code>react</code> å†…éƒ¨ä¼šå°†æœ¬æ¬¡æ›´æ–°æ‰€æ¶‰åŠåˆ°çš„æ‰€æœ‰ <code>setState</code> è¿›è¡Œæ”¶é›†åˆå¹¶ï¼Œé¿å…é‡å¤æ¸²æŸ“ã€‚</p></blockquote><ul><li>åœ¨æ‰§è¡Œ <code>setState</code>æ“ä½œåï¼ŒReact ä¼šè‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡ <code>render()</code></li><li><code>render()</code> çš„æ‰§è¡Œæ¬¡æ•°æ˜¯ 1+n (1 ä¸ºåˆå§‹åŒ–æ—¶çš„è‡ªåŠ¨è°ƒç”¨ï¼Œn ä¸ºçŠ¶æ€æ›´æ–°çš„æ¬¡æ•°)</li></ul><h3 id="props"><a href="#props" class="headerlink" title="props"></a>props</h3><p>ä¸<code>state</code>ä¸åŒï¼Œ<code>state</code>æ˜¯ç»„ä»¶è‡ªèº«çš„çŠ¶æ€ï¼Œè€Œ<code>props</code>åˆ™æ˜¯å¤–éƒ¨ä¼ å…¥çš„æ•°æ®ã€‚</p><p><strong>ç±»ç»„ä»¶ä¸­ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span> &#123; this.props.name &#125; <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span> &#123; this.props.age &#125; <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä½¿ç”¨çš„æ—¶å€™å¯ä»¥é€šè¿‡ <code>this.props</code> æ¥è·å–å€¼ ç±»å¼ç»„ä»¶çš„ <code>props</code>:</p><ol><li>é€šè¿‡åœ¨ç»„ä»¶æ ‡ç­¾ä¸Šä¼ é€’å€¼ï¼Œåœ¨ç»„ä»¶ä¸­å°±å¯ä»¥è·å–åˆ°æ‰€ä¼ é€’çš„å€¼</li><li>åœ¨æ„é€ å™¨é‡Œçš„ <code>props</code> å‚æ•°é‡Œå¯ä»¥è·å–åˆ° <code>props</code></li><li>å¯ä»¥åˆ†åˆ«è®¾ç½® <code>propTypes</code> å’Œ <code>defaultProps</code> ä¸¤ä¸ªå±æ€§æ¥åˆ†åˆ«æ“ä½œ <code>props</code> çš„è§„èŒƒå’Œé»˜è®¤å€¼ï¼Œä¸¤è€…éƒ½æ˜¯ç›´æ¥æ·»åŠ åœ¨ç±»å¼ç»„ä»¶çš„<strong>åŸå‹å¯¹è±¡</strong>ä¸Šçš„ï¼ˆæ‰€ä»¥éœ€è¦æ·»åŠ  <code>static</code> ï¼‰</li><li>åŒæ—¶å¯ä»¥é€šè¿‡ <code>...</code> è¿ç®—ç¬¦æ¥ç®€åŒ–</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span> &#123; this.props.name &#125; <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span> &#123; this.props.age &#125; <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> propTypes = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="title class_">PropTypes</span>.<span class="property">string</span>.<span class="property">isRequired</span>,</span><br><span class="line">    <span class="attr">age</span>: propTypes.<span class="property">string</span>,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> defaultPorps = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Akira&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">21</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** ä½¿ç”¨ */</span></span><br><span class="line"><span class="keyword">const</span> person = &#123; <span class="attr">name</span>: <span class="string">&quot;AkiraIce&quot;</span>, <span class="attr">age</span>: <span class="number">21</span> &#125;</span><br><span class="line"><span class="title class_">ReactDom</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Person</span> &#123; <span class="attr">...p</span> &#125; /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;div&quot;</span>));</span><br></pre></td></tr></table></figure><p><strong>å‡½æ•°ç»„ä»¶ä¸­ï¼š</strong></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123; props.name &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123; props.age &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡½æ•°ç»„ä»¶çš„ <code>props</code>å®šä¹‰:</p><ol><li>åœ¨ç»„ä»¶æ ‡ç­¾ä¸­ä¼ é€’ <code>props</code>çš„å€¼</li><li>ç»„ä»¶å‡½æ•°çš„å‚æ•°ä¸º <code>props</code></li><li>å¯¹ <code>props</code>çš„é™åˆ¶å’Œé»˜è®¤å€¼åŒæ ·è®¾ç½®åœ¨åŸå‹å¯¹è±¡ä¸Š</li></ol><h3 id="refs"><a href="#refs" class="headerlink" title="refs"></a>refs</h3><p>å¦‚åŒ Vue ä¸­çš„ refï¼Œç”¨æ¥è·å– DOM èŠ‚ç‚¹çš„ã€‚</p><p>æœ‰ä¸‰ç§æ“ä½œ<code>refs</code>çš„æ–¹æ³•ï¼Œåˆ†åˆ«ä¸ºï¼š</p><ul><li><p>å­—ç¬¦ä¸²å½¢å¼</p></li><li><p>å›è°ƒå½¢å¼</p></li><li><p><code>createRef</code>å½¢å¼</p></li></ul><ol><li><p>å­—ç¬¦ä¸²å½¢å¼</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Component</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  inputHanddle = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; input &#125; = <span class="variable language_">this</span>.<span class="property">refs</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(input.<span class="property">value</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&quot;input&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å›è°ƒå½¢å¼</p><p>ref çš„å›è°ƒå‡½æ•°å°†è‡ªåŠ¨æ¥æ”¶å½“å‰ DOM èŠ‚ç‚¹ã€‚</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input ref=&#123; <span class="function"><span class="params">c</span> =&gt;</span> <span class="variable language_">this</span>.<span class="property">input1</span> = c &#125; /&gt;</span><br></pre></td></tr></table></figure></li><li><p>createRef å½¢å¼</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Component</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title class_">MyRef</span> = <span class="title class_">React</span>.<span class="title function_">createRef</span>();</span><br><span class="line">  <span class="title class_">MyRef1</span> = <span class="title class_">React</span>.<span class="title function_">createRef</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">//è°ƒç”¨</span></span><br><span class="line">  btnOnClick = <span class="function">() =&gt;</span>&#123;</span><br><span class="line">      <span class="comment">//åˆ›å»ºä¹‹åï¼Œå°†è‡ªèº«èŠ‚ç‚¹ï¼Œä¼ å…¥currentä¸­</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">MyRef</span>.<span class="property">current</span>.<span class="property">value</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;this.MyRef&#125;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;ç‚¹å‡»å¼¹å‡º&quot;</span> /&gt;</span></span></span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;this.MyRef1&#125;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;ç‚¹å‡»å¼¹å‡º&quot;</span> /&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ç‚¹å‡»äº‹ä»¶</p><p>React ä½¿ç”¨çš„æ˜¯è‡ªå®šä¹‰äº‹ä»¶ï¼Œè€Œä¸æ˜¯åŸç”Ÿçš„ DOM äº‹ä»¶</p><p>React çš„äº‹ä»¶æ˜¯é€šè¿‡äº‹ä»¶å§”æ‰˜æ–¹å¼å¤„ç†çš„ï¼ˆä¸ºäº†æ›´åŠ çš„é«˜æ•ˆï¼‰</p><p>å¯ä»¥é€šè¿‡äº‹ä»¶çš„ <code>event.target</code>è·å–å‘ç”Ÿçš„ DOM å…ƒç´ å¯¹è±¡ï¼Œå¯ä»¥å°½é‡å‡å°‘ <code>refs</code>çš„ä½¿ç”¨</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Component</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  clickHanddle = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(event.<span class="property">target</span>.<span class="property">value</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">           <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">this.clickHanddle</span> &#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        )</span></span><br><span class="line"><span class="language-xml">  &#125;</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="ç”Ÿå‘½å‘¨æœŸ"><a href="#ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸ"></a>ç”Ÿå‘½å‘¨æœŸ</h1><p>React ç”Ÿå‘½å‘¨æœŸä¸»è¦åŒ…æ‹¬ä¸‰ä¸ªèŠ‚ç‚¹ï¼šåˆå§‹åŒ–é˜¶æ®µã€æ›´æ–°é˜¶æ®µã€é”€æ¯é˜¶æ®µã€‚</p><h2 id="åˆå§‹åŒ–é˜¶æ®µ"><a href="#åˆå§‹åŒ–é˜¶æ®µ" class="headerlink" title="åˆå§‹åŒ–é˜¶æ®µ"></a>åˆå§‹åŒ–é˜¶æ®µ</h2><h3 id="constructor-NaN"><a href="#constructor-NaN" class="headerlink" title="constructor"></a>constructor</h3><p><code>constructor</code> åœ¨ç»„å»ºåˆå§‹åŒ–çš„æ—¶å€™åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚</p><p>é€šå¸¸å®ƒç”¨äºåšè¿™ä¸¤ä»¶äº‹</p><ol><li>åˆå§‹åŒ–å‡½æ•°å†…éƒ¨ <code>state</code></li><li>ç»‘å®šå‡½æ•°</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;è¿›å…¥æ„é€ å™¨&#x27;</span>);</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="static-getDerivedStateFormPorps"><a href="#static-getDerivedStateFormPorps" class="headerlink" title="static getDerivedStateFormPorps"></a>static getDerivedStateFormPorps</h3><p>è¿™æ˜¯ React æ–°ç‰ˆæœ¬ä¸­æ–°å¢çš„ä¸¤ä¸ªé’©å­ä¹‹ä¸€ï¼Œæ®è¯´å¾ˆå°‘ç”¨ã€‚</p><p><code>getDerivedStateFormProps</code> åœ¨åˆå§‹åŒ–å’Œæ›´æ–°ä¸­éƒ½ä¼šè¢«è°ƒç”¨ï¼Œå®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•° <code>props</code> å’Œ <code>state</code>ï¼Œä¸”åœ¨ <code>render</code> æ–¹æ³•ä¹‹å‰è°ƒç”¨ï¼Œå®ƒè¿”å›ä¸€ä¸ªå¯¹è±¡ç”¨æ¥æ›´æ–° <code>state</code></p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Component</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">1</span>,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">getDerivedFromProps</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="attr">count</span>: props.<span class="property">count</span>&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123; this.count &#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;<span class="title class_">Component</span> count=<span class="string">&quot;111&quot;</span>&gt; <span class="comment">// 111</span></span><br></pre></td></tr></table></figure><h3 id="componentWillMountï¼ˆå³å°†åºŸé™¤ï¼‰"><a href="#componentWillMountï¼ˆå³å°†åºŸé™¤ï¼‰" class="headerlink" title="componentWillMountï¼ˆå³å°†åºŸé™¤ï¼‰"></a>componentWillMountï¼ˆå³å°†åºŸé™¤ï¼‰</h3><blockquote><p>å¦‚æœå­˜åœ¨ <code>getDerivedStateFromProps</code> å’Œ <code>getSnapshotBeforeUpdate</code> å°±ä¸ä¼šæ‰§è¡Œç”Ÿå‘½å‘¨æœŸ<code>componentWillMount</code></p></blockquote><p>è¯¥æ–¹æ³•åªåœ¨æŒ‚åœ¨çš„æ—¶å€™è°ƒç”¨ä¸€æ¬¡ï¼Œè¡¨ç¤ºç»„ä»¶å°†è¦æŒ‚è½½ï¼Œå¹¶ä¸”åœ¨ <code>render</code> æ–¹æ³•ä¹‹å‰è°ƒç”¨ã€‚</p><p>è¿™ä¸ªæ–¹æ³•åœ¨ React 18ç‰ˆæœ¬ä¸­å°†è¦è¢«åºŸå¼ƒï¼Œå®˜æ–¹è§£é‡Šæ˜¯åœ¨ React å¼‚æ­¥æœºåˆ¶ä¸‹ï¼Œå¦‚æœæ»¥ç”¨è¿™ä¸ªé’©å­å¯èƒ½ä¼šæœ‰ Bugã€‚</p><h3 id="render"><a href="#render" class="headerlink" title="render"></a>render</h3><p><code>render</code> æ–¹æ³•æ˜¯ç»„ä»¶ä¸­å¿…é¡»å®ç°çš„æ–¹æ³•ï¼Œç”¨äºæ¸²æŸ“ DOMï¼Œä½†æ˜¯å®ƒä¸ä¼šçœŸæ­£çš„æ“ä½œ DOMï¼Œå®ƒçš„ä½œç”¨æ˜¯å§éœ€è¦çš„ä¸œè¥¿è¿”å›å‡ºå»ï¼Œå®ç°æ¸²æŸ“ DOM æ“ä½œçš„æ˜¯ <code>ReactDOM.render()</code></p><blockquote><p>æ³¨æ„ï¼šé¿å…åœ¨ <code>render</code> ä¸­ä½¿ç”¨ <code>setState</code>ï¼Œå¦åˆ™ä¼šæ­»å¾ªç¯ï¼Œå› ä¸ºæ¯ä¸€æ¬¡ setState å°†ä¼šé‡æ–°æ‰§è¡Œ render ä¸€æ¬¡ã€‚</p></blockquote><h3 id="åˆå§‹åŒ–é˜¶æ®µæ€»ç»“"><a href="#åˆå§‹åŒ–é˜¶æ®µæ€»ç»“" class="headerlink" title="åˆå§‹åŒ–é˜¶æ®µæ€»ç»“"></a>åˆå§‹åŒ–é˜¶æ®µæ€»ç»“</h3><p>æ‰§è¡Œé¡ºåº <code>constructor</code> -&gt; <code>getDerivedStateFromProps</code> æˆ–è€… <code>componentWillMount</code> -&gt; <code>render</code> -&gt; <code>componentDidMount</code></p><p><img src="https://s2.loli.net/2023/06/25/VP1UJLka35hc9eH.png" alt="image-20230625151832472"></p><h2 id="æ›´æ–°é˜¶æ®µ"><a href="#æ›´æ–°é˜¶æ®µ" class="headerlink" title="æ›´æ–°é˜¶æ®µ"></a>æ›´æ–°é˜¶æ®µ</h2><p><img src="https://s2.loli.net/2023/06/25/IOpzrCiUkZDKAf6.png" alt="image-20230625145804292"></p><h3 id="getDeriveStateFormProps"><a href="#getDeriveStateFormProps" class="headerlink" title="getDeriveStateFormProps"></a>getDeriveStateFormProps</h3><p>æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ<code>getDerivedStateFromProps</code>ï¼Œ è¿”å›çš„å€¼ç”¨äºåˆå¹¶ <code>state</code>ï¼Œç”Ÿæˆæ–°çš„<code>state</code>ã€‚</p><h3 id="shouldComponentUpdate"><a href="#shouldComponentUpdate" class="headerlink" title="shouldComponentUpdate"></a>shouldComponentUpdate</h3><p><code>shouldComponentUpdate()</code> åœ¨ç»„ä»¶æ›´æ–°ä¹‹å‰è°ƒç”¨ï¼Œå¯ä»¥é€šè¿‡è¿”å›å€¼æ¥æ§åˆ¶ç»„ä»¶æ˜¯å¦æ›´æ–°ï¼Œå…è®¸æ›´æ–°è¿”å› <code>true</code> ï¼Œåä¹‹ä¸æ›´æ–°ã€‚</p><h3 id="render-1"><a href="#render-1" class="headerlink" title="render"></a>render</h3><p>åœ¨æ§åˆ¶æ˜¯å¦æ›´æ–°çš„å‡½æ•°ä¸­ï¼Œå¦‚æœè¿”å› <code>true</code> æ‰ä¼šæ‰§è¡Œ <code>render</code> ,å¾—åˆ°æœ€æ–°çš„ <code>React element</code></p><h3 id="getSnapshotBeforeUpdate"><a href="#getSnapshotBeforeUpdate" class="headerlink" title="getSnapshotBeforeUpdate"></a>getSnapshotBeforeUpdate</h3><p>åœ¨æœ€è¿‘ä¸€æ¬¡çš„æ¸²æŸ“è¾“å‡ºä¹‹å‰è¢«æäº¤ä¹‹å‰è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯å³å°†æŒ‚è½½æ—¶è°ƒç”¨ã€‚</p><p>ç›¸å½“äºæ·˜å®è´­ç‰©çš„å¿«ç…§ï¼Œä¼šä¿ç•™ä¸‹å•å‰çš„å•†å“å†…å®¹ï¼Œåœ¨ React ä¸­å°±ç›¸å½“äºæ˜¯ å³å°†æ›´æ–°å‰çš„çŠ¶æ€ã€‚</p><blockquote><p>å®ƒå¯ä»¥ä½¿ç»„ä»¶åœ¨ DOM çœŸæ­£æ›´æ–°ä¹‹å‰æ•è·ä¸€äº›ä¿¡æ¯ï¼ˆä¾‹å¦‚æ»šåŠ¨ä½ç½®ï¼‰ï¼Œæ­¤ç”Ÿå‘½å‘¨æœŸè¿”å›çš„ä»»ä½•å€¼éƒ½ä¼šä½œä¸ºå‚æ•°ä¼ é€’ç»™ <code>componentDidUpdate()</code>ã€‚å¦‚ä¸éœ€è¦ä¼ é€’ä»»ä½•å€¼ï¼Œé‚£ä¹ˆè¯·è¿”å› nullã€‚</p></blockquote><h3 id="componentDidUpdate"><a href="#componentDidUpdate" class="headerlink" title="componentDidUpdate"></a>componentDidUpdate</h3><p>ç»„ä»¶åœ¨æ›´æ–°å®Œæ¯•åä¼šç«‹å³è¢«è°ƒç”¨ï¼Œé¦–æ¬¡æ¸²æŸ“ä¸ä¼šè°ƒç”¨ã€‚</p><h2 id="é”€æ¯é˜¶æ®µ"><a href="#é”€æ¯é˜¶æ®µ" class="headerlink" title="é”€æ¯é˜¶æ®µ"></a>é”€æ¯é˜¶æ®µ</h2><h3 id="componentWillUnmount"><a href="#componentWillUnmount" class="headerlink" title="componentWillUnmount"></a>componentWillUnmount</h3><p>åœ¨ç»„ä»¶å³å°†è¢«å¸è½½æˆ–é”€æ¯æ—¶è¿›è¡Œè°ƒç”¨ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p><strong>åˆå§‹åŒ–</strong></p><ul><li>constructor()</li><li>static getDerivedStateFromProps()</li><li>render()</li><li>componentDidMount()</li></ul><p><strong>æ›´æ–°</strong></p><ul><li>static getDerivedStateFromProps()</li><li>shouldComponentUpdate()</li><li>render()</li><li>getSnapshotBeforeUpdate()</li><li>componentDidUpdate()</li></ul><p><strong>é”€æ¯</strong></p><ul><li>componentWillUnmount()</li></ul>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>padding å¯¼è‡´æ»šåŠ¨å†…å®¹ä¸å…¨</title>
      <link href="/2023/03/14/bugRoad/padding%20%E5%AF%BC%E8%87%B4%E6%BB%9A%E5%8A%A8%E5%86%85%E5%AE%B9%E4%B8%8D%E5%85%A8/"/>
      <url>/2023/03/14/bugRoad/padding%20%E5%AF%BC%E8%87%B4%E6%BB%9A%E5%8A%A8%E5%86%85%E5%AE%B9%E4%B8%8D%E5%85%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="padding-å¯¼è‡´æ»šåŠ¨å†…å®¹ä¸å…¨"><a href="#padding-å¯¼è‡´æ»šåŠ¨å†…å®¹ä¸å…¨" class="headerlink" title="padding å¯¼è‡´æ»šåŠ¨å†…å®¹ä¸å…¨"></a>padding å¯¼è‡´æ»šåŠ¨å†…å®¹ä¸å…¨</h1><p>å¦‚æœå…ƒç´ çš„ä¸Šä¸‹ Padding è¿‡å¤§ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…ƒç´ çš„å†…å®¹æº¢å‡ºå¹¶éšè—ï¼Œä»è€Œå¯¼è‡´æ»šåŠ¨ä¸å…¨çš„é—®é¢˜ã€‚è¿™æ˜¯å› ä¸ºå…ƒç´ çš„é«˜åº¦è¢«ä¸Šä¸‹ Padding å¢åŠ ï¼Œè€Œå®¹å™¨çš„é«˜åº¦æ²¡æœ‰ç›¸åº”åœ°å¢åŠ ï¼Œå¯¼è‡´å†…å®¹è¢«è£å‰ªã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥è€ƒè™‘ä»¥ä¸‹ä¸¤ç§æ–¹æ³•æ¥è§£å†³é—®é¢˜ï¼š</p><h2 id="ä½¿ç”¨-box-sizing-å±æ€§"><a href="#ä½¿ç”¨-box-sizing-å±æ€§" class="headerlink" title="ä½¿ç”¨ box-sizing å±æ€§"></a>ä½¿ç”¨ <code>box-sizing</code> å±æ€§</h2><p><code>box-sizing</code> å±æ€§å¯ä»¥ç”¨æ¥è°ƒæ•´å…ƒç´ ç›’æ¨¡å‹çš„å¸ƒå±€æ–¹å¼ï¼Œä»è€Œé¿å…ä¸Šä¸‹ Padding å¯¹å…ƒç´ é«˜åº¦çš„å½±å“ã€‚é€šè¿‡å°†å…ƒç´ çš„ <code>box-sizing</code> å±æ€§è®¾ç½®ä¸º <code>border-box</code>ï¼Œå¯ä»¥ä½¿å…ƒç´ çš„å†…è¾¹è·å’Œè¾¹æ¡†å¤§å°è¢«åŒ…å«åœ¨å…ƒç´ çš„æ€»å®½åº¦å’Œé«˜åº¦å†…ï¼Œä¸ä¼šå¯¹å…ƒç´ çš„é«˜åº¦äº§ç”Ÿå½±å“ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.element</span> &#123;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">20px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨å†…éƒ¨å®¹å™¨å…ƒç´ "><a href="#ä½¿ç”¨å†…éƒ¨å®¹å™¨å…ƒç´ " class="headerlink" title="ä½¿ç”¨å†…éƒ¨å®¹å™¨å…ƒç´ "></a>ä½¿ç”¨å†…éƒ¨å®¹å™¨å…ƒç´ </h2><p>å¦‚æœä¸Šè¿°æ–¹æ³•æ— æ³•è§£å†³é—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘åœ¨å…ƒç´ å†…éƒ¨æ·»åŠ ä¸€ä¸ªå®¹å™¨å…ƒç´ ï¼Œå¹¶å°†ä¸Šä¸‹ Padding åº”ç”¨åˆ°å®¹å™¨å…ƒç´ ä¸Šï¼Œè€Œä¸æ˜¯åº”ç”¨åˆ°å¤–éƒ¨å…ƒç´ ä¸Šã€‚è¿™æ ·å¯ä»¥é¿å…ä¸Šä¸‹ Padding å¯¹å…ƒç´ é«˜åº¦çš„å½±å“ï¼ŒåŒæ—¶ä¿è¯å…ƒç´ çš„å†…å®¹ä¸ä¼šè¢«è£å‰ªã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;element&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner-element&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å†…å®¹ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.element</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="comment">/* å…¶ä»–æ ·å¼ */</span></span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.inner-element</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding-top</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding-bottom</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>.inner-element</code> å…ƒç´ è¢«ç”¨ä½œå®¹å™¨å…ƒç´ ï¼Œä¸Šä¸‹ Padding è¢«åº”ç”¨åˆ°äº†å®¹å™¨å…ƒç´ ä¸Šï¼Œè€Œä¸æ˜¯åº”ç”¨åˆ°å¤–éƒ¨çš„ <code>.element</code> å…ƒç´ ä¸Šã€‚è¿™æ ·å¯ä»¥é¿å…ä¸Šä¸‹ Padding å¯¹å…ƒç´ é«˜åº¦çš„å½±å“ï¼Œå¹¶ä¿è¯å…ƒç´ çš„å†…å®¹ä¸ä¼šè¢«è£å‰ªã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šè¿°ä¸¤ç§è§£å†³æ–¹æ³•éƒ½éœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´å’Œé€‚é…ï¼Œä»¥è¾¾åˆ°æœ€ä½³çš„æ•ˆæœã€‚åŒæ—¶ï¼Œåœ¨è°ƒæ•´å…ƒç´ çš„ä¸Šä¸‹ Padding æ—¶ï¼Œä¹Ÿéœ€è¦è€ƒè™‘å…ƒç´ çš„å†…å®¹å’Œå¸ƒå±€éœ€æ±‚ï¼Œä»¥é¿å…å‡ºç°å…¶ä»–çš„é—®é¢˜ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BugRoad </category>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> scroll </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯åŸ‹ç‚¹</title>
      <link href="/2023/03/10/JS/%E5%89%8D%E7%AB%AF%E5%9F%8B%E7%82%B9/"/>
      <url>/2023/03/10/JS/%E5%89%8D%E7%AB%AF%E5%9F%8B%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰ç«¯åŸ‹ç‚¹"><a href="#å‰ç«¯åŸ‹ç‚¹" class="headerlink" title="å‰ç«¯åŸ‹ç‚¹"></a>å‰ç«¯åŸ‹ç‚¹</h1><h2 id="ä»€ä¹ˆæ˜¯åŸ‹ç‚¹ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯åŸ‹ç‚¹ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯åŸ‹ç‚¹ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯åŸ‹ç‚¹ï¼Ÿ</h2><p>å‰ç«¯åŸ‹ç‚¹æ˜¯ä¸€ç§åœ¨ Web åº”ç”¨ç¨‹åºä¸­ç”¨äºç›‘æ§å’Œè®°å½•ç”¨æˆ·è¡Œä¸ºçš„æŠ€æœ¯ï¼Œé€šå¸¸é€šè¿‡å®¢æˆ·ç«¯è„šæœ¬æ¥å®ç°ã€‚</p><p>å‰ç«¯åŸ‹ç‚¹å¯ä»¥å¯¹ç”¨æˆ·è®¿é—®ç½‘ç«™çš„è·¯å¾„ã€æµè§ˆå™¨ä¿¡æ¯ã€æ“ä½œè¡Œä¸ºã€é”™è¯¯æ—¥å¿—ç­‰è¿›è¡Œè·Ÿè¸ªå’Œåˆ†æã€‚é€šè¿‡æ”¶é›†è¿™äº›æ•°æ®ï¼Œå¼€å‘äººå‘˜å¯ä»¥æ›´å¥½åœ°äº†è§£ç”¨æˆ·ä½¿ç”¨åº”ç”¨ç¨‹åºçš„æ–¹å¼ï¼Œå¹¶åšå‡ºç›¸åº”çš„å†³ç­–æ¥ä¼˜åŒ–ç”¨æˆ·ä½“éªŒå’Œæé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚</p><h2 id="åŸ‹ç‚¹æ–¹å¼"><a href="#åŸ‹ç‚¹æ–¹å¼" class="headerlink" title="åŸ‹ç‚¹æ–¹å¼"></a>åŸ‹ç‚¹æ–¹å¼</h2><p>ç›®å‰å¸¸è§çš„åŸ‹ç‚¹ä¸ŠæŠ¥æ–¹å¼æœ‰ï¼šajaxã€imgã€navigator.sendBeaconã€‚</p><h3 id="åŸºäº-ajax-çš„åŸ‹ç‚¹ä¸ŠæŠ¥"><a href="#åŸºäº-ajax-çš„åŸ‹ç‚¹ä¸ŠæŠ¥" class="headerlink" title="åŸºäº ajax çš„åŸ‹ç‚¹ä¸ŠæŠ¥"></a>åŸºäº ajax çš„åŸ‹ç‚¹ä¸ŠæŠ¥</h3><p>åŸ‹ç‚¹å®é™…ä¸Šæ˜¯å¯¹å…³é”®èŠ‚ç‚¹çš„æ•°æ®è¿›è¡Œä¸ŠæŠ¥å’ŒæœåŠ¡ç«¯äº¤äº’çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œå› æ­¤ä¸åç«¯çº¦å®šçš„æ¥å£æ˜¯å¿…è¦çš„ã€‚</p><p>å®ç°æ–¹å¼ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">buryingPointAjax</span>(<span class="params">url, data</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resole, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">    xhr.<span class="title function_">open</span>(<span class="string">&quot;post&quot;</span>, url, <span class="literal">true</span>);</span><br><span class="line">    xhr.<span class="title function_">send</span>(data);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼ºç‚¹ï¼šä¸€èˆ¬è€Œè¨€ï¼ŒåŸ‹ç‚¹åŸŸåä¸æ˜¯å½“å‰åŸŸåï¼Œå› æ­¤è¯·æ±‚å­˜åœ¨è·¨åŸŸé—®é¢˜ã€‚</p><h3 id="åŸºäº-img-çš„åŸ‹ç‚¹ä¸ŠæŠ¥"><a href="#åŸºäº-img-çš„åŸ‹ç‚¹ä¸ŠæŠ¥" class="headerlink" title="åŸºäº img çš„åŸ‹ç‚¹ä¸ŠæŠ¥"></a>åŸºäº img çš„åŸ‹ç‚¹ä¸ŠæŠ¥</h3><p>ä»‹äº ajax å¯èƒ½å­˜åœ¨è·¨åŸŸé—®é¢˜ï¼Œæˆ‘ä»¬é‡‡ç”¨ä¸€äº›æ”¯æŒè·¨åŸŸçš„æ ‡ç­¾æ— ç–‘æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œæ¯”å¦‚ï¼šscriptã€linkã€imgã€‚</p><p>ä½† script ä»¥åŠ link æ˜¯éœ€è¦åˆ›å»º dom èŠ‚ç‚¹ï¼Œå¹¶æŒ‚è½½åˆ°é¡µé¢ä¸Šçš„ï¼Œåå¤æ“ä½œ dom å¿…ç„¶ä¼šå¯¼è‡´é¡µé¢çš„å¡é¡¿ï¼Œå¹¶ä¸”è½½å…¥ js&#x2F;css èµ„æºè¿˜ä¼šé˜»å¡é¡µé¢çš„æ¸²æŸ“ï¼Œå› æ­¤è¿™ä¿©å¹¶ä¸åˆé€‚ã€‚</p><p>img æ ‡ç­¾æœ¬èº«ä¸ä¼šé˜»å¡é¡µé¢çš„è§£æå’Œæ¸²æŸ“ï¼Œå› ä¸ºæµè§ˆå™¨æ­¤æ—¶é‡‡ç”¨çš„æ˜¯æ¸è¿›å¼æ¸²æŸ“ï¼Œåœ¨é‡åˆ° img æ ‡ç­¾æ—¶ï¼Œä¼šç«‹å³ä¸‹è½½å›¾ç‰‡èµ„æºï¼Œå¹¶ä¸ä¼šç­‰å¾…å›¾ç‰‡åŠ è½½å®Œæˆååœ¨ç»§ç»­è§£æå’Œæ¸²æŸ“ä¸‹é¢çš„å†…å®¹ï¼Œè€Œæ˜¯é¢„ç•™ç›¸åº”çš„ç©ºé—´ä¿è¯åç»­çš„æ¸²æŸ“ã€‚</p><p>å®ç°æ–¹å¼ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> buryingPointImg = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">buryingPointImg.<span class="property">src</span> = <span class="string">&quot;http://example.com/xxx.png&quot;</span>;</span><br></pre></td></tr></table></figure><p>ä¼˜ç‚¹ï¼š</p><ol><li>img å…¼å®¹æ€§å¥½</li><li>æ— éœ€æŒ‚è½½åˆ° domï¼Œåå¤æ“ä½œ dom</li><li>img çš„åŠ è½½ä¸ä¼šé˜»å¡é¡µé¢çš„è§£æä¸æ¸²æŸ“</li></ol><p>ç¼ºç‚¹ï¼šä¸é€‚åˆå¤„ç†å¤§é‡æ•°æ®å’Œå¤æ‚çš„åŒçº§éœ€æ±‚</p><blockquote><p>é€šå¸¸åŸ‹ç‚¹ä¸ŠæŠ¥ä¼šä½¿ç”¨ GIF å›¾ï¼Œåˆæ³•çš„ GIF åªéœ€è¦ 43 ä¸ªå­—èŠ‚ã€‚</p></blockquote><h3 id="åŸºäº-Navigator-sendBeanCon-çš„åŸ‹ç‚¹ä¸ŠæŠ¥"><a href="#åŸºäº-Navigator-sendBeanCon-çš„åŸ‹ç‚¹ä¸ŠæŠ¥" class="headerlink" title="åŸºäº Navigator.sendBeanCon çš„åŸ‹ç‚¹ä¸ŠæŠ¥"></a>åŸºäº Navigator.sendBeanCon çš„åŸ‹ç‚¹ä¸ŠæŠ¥</h3><p><code>Navigator.sendBeanCon(url: string, params: any)ï¼šboolean</code></p><p>è¯¥æ–¹æ³•æ˜¯é€šè¿‡ HTTP POST å°†å°‘é‡æ•°æ®ï¼Œå¼‚æ­¥ä¼ è¾“åˆ°æœåŠ¡å™¨ï¼Œé¿å…äº†ä¼ ç»ŸæŠ€æœ¯ï¼ˆXMLï¼‰å‘é€æ•°æ®çš„ä¸€äº›é—®é¢˜ã€‚</p><p><code>navigator.sendBeacon()</code> æ–¹æ³•å°†æ•°æ®å‘é€åˆ°æœåŠ¡å™¨æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåœ¨åå°å¼‚æ­¥åœ°åˆ›å»ºä¸€ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶å°†æ•°æ®å‘é€ç»™æŒ‡å®šçš„ URLï¼Œå¹¶è¿”å›ä¸€ä¸ª boolean å€¼ï¼štrue è¡¨ç¤ºæˆåŠŸåŠ å…¥æ‰§è¡Œé˜Ÿåˆ—ï¼Œfalse è¡¨ç¤ºå› æµè§ˆå™¨æ‰§è¡Œé˜Ÿåˆ—æ ˆå·²æ»¡ï¼ŒæœªåŠ å…¥å…¶ä¸­ï¼Œå› æ­¤å‘çš„è¿”å›å€¼å¹¶ä¸èƒ½åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸï¼Œä½†æµè§ˆå™¨ä¼šå°½åŠ›ä¿è¯ã€‚</p><p>ä¼˜ç‚¹ï¼š</p><ol><li>ç›¸å¯¹äº imgï¼Œæ›´åŠ è§„èŒƒï¼Œæ•°æ®ä¸Šä¼ å¯ä»¥ä¼ è¾“èµ„æºç±»å‹æ›´å¤šã€‚</li><li>å¼‚æ­¥ä¼ è¾“ï¼Œä¸å›å½±å“é¡µé¢ä¹‹é—´è·³è½¬ï¼Œä¸”ä¸å—åŒåŸŸé™åˆ¶ã€‚</li></ol><h2 id="å¸¸è§åŸ‹ç‚¹"><a href="#å¸¸è§åŸ‹ç‚¹" class="headerlink" title="å¸¸è§åŸ‹ç‚¹"></a>å¸¸è§åŸ‹ç‚¹</h2><h3 id="ç‚¹å‡»è§¦å‘åŸ‹ç‚¹"><a href="#ç‚¹å‡»è§¦å‘åŸ‹ç‚¹" class="headerlink" title="ç‚¹å‡»è§¦å‘åŸ‹ç‚¹"></a>ç‚¹å‡»è§¦å‘åŸ‹ç‚¹</h3><p>ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼Œå½“ç‚¹å‡»ç›®æ ‡å…ƒç´ æ—¶ï¼Œè§¦å‘åŸ‹ç‚¹ä¸ŠæŠ¥ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">clickButton</span>(<span class="params">url, data</span>) &#123;</span><br><span class="line">  navigator.<span class="title function_">sendBeacon</span>(url, data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é¡µé¢åœç•™æ—¶é—´ä¸ŠæŠ¥åŸ‹ç‚¹"><a href="#é¡µé¢åœç•™æ—¶é—´ä¸ŠæŠ¥åŸ‹ç‚¹" class="headerlink" title="é¡µé¢åœç•™æ—¶é—´ä¸ŠæŠ¥åŸ‹ç‚¹"></a>é¡µé¢åœç•™æ—¶é—´ä¸ŠæŠ¥åŸ‹ç‚¹</h3><p>è·¯ç”±æ–‡ä»¶ä¸­ï¼Œåˆå§‹åŒ–ä¸€ä¸ª startTimeï¼Œå½“é¡µé¢ç¦»å¼€æ—¶é€šè¿‡è·¯ç”±å®ˆå«è®¡ç®—åœç•™æ—¶é—´ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> url = <span class="string">&quot;&quot;</span>; <span class="comment">// ä¸ŠæŠ¥åœ°å€</span></span><br><span class="line"><span class="keyword">let</span> startTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line"><span class="keyword">let</span> currentTime = <span class="string">&quot;&quot;</span>;</span><br><span class="line">router.<span class="title function_">beforeEach</span>(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (to) &#123;</span><br><span class="line">    currentTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">    stayTime = <span class="built_in">parseInt</span>(currentTime - startTime);</span><br><span class="line">    navigator.<span class="title function_">sendBeacon</span>(url, &#123; <span class="attr">time</span>: stayTime &#125;);</span><br><span class="line">    startTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="é”™è¯¯ç›‘å¬åŸ‹ç‚¹"><a href="#é”™è¯¯ç›‘å¬åŸ‹ç‚¹" class="headerlink" title="é”™è¯¯ç›‘å¬åŸ‹ç‚¹"></a>é”™è¯¯ç›‘å¬åŸ‹ç‚¹</h3><p>é€šè¿‡ç›‘å¬å‡½æ•°å»æ¥æ”¶é”™è¯¯ä¿¡æ¯ã€‚</p><h4 id="vue-é”™è¯¯æ•è·"><a href="#vue-é”™è¯¯æ•è·" class="headerlink" title="vue é”™è¯¯æ•è·"></a>vue é”™è¯¯æ•è·</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="property">config</span>.<span class="property">errorHandler</span> = <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">  navigator.<span class="title function_">sendBeacon</span>(url, &#123; <span class="attr">error</span>: error.<span class="property">message</span>, <span class="attr">text</span>: <span class="string">&quot;vueè¿è¡Œå¼‚å¸¸&quot;</span> &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="JS-å¼‚å¸¸ä¸é™æ€èµ„æºåŠ è½½å¼‚å¸¸"><a href="#JS-å¼‚å¸¸ä¸é™æ€èµ„æºåŠ è½½å¼‚å¸¸" class="headerlink" title="JS å¼‚å¸¸ä¸é™æ€èµ„æºåŠ è½½å¼‚å¸¸"></a>JS å¼‚å¸¸ä¸é™æ€èµ„æºåŠ è½½å¼‚å¸¸</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(</span><br><span class="line">  <span class="string">&quot;error&quot;</span>,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (error.<span class="property">message</span>) &#123;</span><br><span class="line">      navigator.<span class="title function_">sendBeacon</span>(url, &#123; <span class="attr">error</span>: error.<span class="property">message</span>, <span class="attr">text</span>: <span class="string">&quot;jsæ‰§è¡Œå¼‚å¸¸&quot;</span> &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      navigator.<span class="title function_">sendBeacon</span>(url, &#123; <span class="attr">error</span>: error.<span class="property">filename</span>, <span class="attr">text</span>: <span class="string">&quot;èµ„æºåŠ è½½å¼‚å¸¸&quot;</span> &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="literal">true</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h4 id="è¯·æ±‚é”™è¯¯æ•è·"><a href="#è¯·æ±‚é”™è¯¯æ•è·" class="headerlink" title="è¯·æ±‚é”™è¯¯æ•è·"></a>è¯·æ±‚é”™è¯¯æ•è·</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(</span><br><span class="line">  <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (response.<span class="property">code</span> == <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">resolve</span>(response);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(response);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// è¿”å›é”™è¯¯é€»è¾‘</span></span><br><span class="line">    navigator.<span class="title function_">sendBeacon</span>(url, &#123; <span class="attr">error</span>: error, <span class="attr">text</span>: <span class="string">&quot;è¯·æ±‚é”™è¯¯å¼‚å¸¸&quot;</span> &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="å†…å®¹å¯è§åŸ‹ç‚¹"><a href="#å†…å®¹å¯è§åŸ‹ç‚¹" class="headerlink" title="å†…å®¹å¯è§åŸ‹ç‚¹"></a>å†…å®¹å¯è§åŸ‹ç‚¹</h3><p>é€šè¿‡äº¤å‰è§‚å¯Ÿå™¨å»ç›‘å¬å½“å‰å…ƒç´ æ˜¯å¦å‡ºç°åœ¨é¡µé¢</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯è§æ€§å‘ç”Ÿå˜åŒ–åçš„å›è°ƒ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">callback</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  navigator.<span class="title function_">sendBeacon</span>(url, &#123; <span class="attr">target</span>: data[<span class="number">0</span>].<span class="property">target</span>, <span class="attr">text</span>: <span class="string">&quot;å†…å®¹å¯è§&quot;</span> &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// äº¤å‰è§‚å¯Ÿå™¨é…ç½®é¡¹</span></span><br><span class="line"><span class="keyword">let</span> options = &#123;&#125;;</span><br><span class="line"><span class="comment">// ç”Ÿæˆäº¤å‰è§‚å¯Ÿå™¨</span></span><br><span class="line"><span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">IntersectionObserver</span>(callback);</span><br><span class="line"><span class="comment">// è·å–ç›®æ ‡èŠ‚ç‚¹</span></span><br><span class="line"><span class="keyword">let</span> target = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;target&quot;</span>);</span><br><span class="line"><span class="comment">// ç›‘å¬ç›®æ ‡å…ƒç´ </span></span><br><span class="line">observer.<span class="title function_">observe</span>(target);</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://mp.weixin.qq.com/s/yV35Fy1lGWbeH5AS97Hzjg">ä¸‰åˆ†é’Ÿï¼Œæ•™ä½  3 ç§å‰ç«¯åŸ‹ç‚¹æ–¹å¼ï¼</a></p>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Nuxt.js</title>
      <link href="/2023/03/05/vue/Nuxt/Nuxt.js%E7%AC%94%E8%AE%B0/"/>
      <url>/2023/03/05/vue/Nuxt/Nuxt.js%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="Nuxt-js"><a href="#Nuxt-js" class="headerlink" title="Nuxt.js"></a>Nuxt.js</h1><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><ol><li><p>ä½¿ç”¨ npx</p><p><code>npx create-nuxt-app &lt;é¡¹ç›®å&gt;</code></p></li><li><p>ä½¿ç”¨ yarn</p><p><code>yarn create-nuxt-app &lt;é¡¹ç›®å&gt;</code></p></li></ol><h2 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h2><p>çº¦å®šä¿—æˆçš„ç›®å½•ç»“æ„ -&gt; è‰¯å¥½çš„èµ·ç‚¹</p><h3 id="nuxt"><a href="#nuxt" class="headerlink" title=".nuxt"></a>.nuxt</h3><p>ç”Ÿäº§ç›®å½•ï¼Œç”± nuxt è‡ªåŠ¨ç”Ÿæˆçš„ä¸€äº›æ–‡ä»¶ã€‚</p><h3 id="pages"><a href="#pages" class="headerlink" title="pages"></a>pages</h3><p>nuxt æ ¹æ®è¯¥ç›®å½•è‡ªåŠ¨ç”Ÿæˆè·¯ç”±é…ç½®ï¼Œä¹Ÿå°±æ˜¯é€šå¸¸æ‰€ç†ŸçŸ¥çš„è·¯ç”±ç»„ä»¶çš„ä½ç½®ã€‚</p><p>ä¸åŒçš„æ˜¯ï¼Œnuxt åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šå¢åŠ äº†ä¸€äº›ç‰¹æ®Šçš„å±æ€§ã€‚</p><p><strong>åŠ¨æ€è·¯ç”±</strong></p><p>ç±»ä¼¼åŠ¨æ€è®¾ç½®è·¯ç”±çš„ params å‚æ•°ï¼Œé€šè¿‡  <code>_paramName.vue</code> åˆ›å»ºè·¯ç”±ç»„ä»¶ã€‚</p><p><strong>å¿½ç•¥è·¯ç”±</strong></p><p>å€˜è‹¥éœ€è¦å¿½ç•¥æŸäº›è·¯ç”±ï¼Œé€šè¿‡ <code>-xxx.vue</code> å³å¯ã€‚</p><p>å½“é€šè¿‡ <code>/paramValue</code> è®¿é—®æ—¶ï¼Œå¯é€šè¿‡ä¸Šä¸‹æ–‡(context.params)å¯æ¥æ”¶ paramValueã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h1&gt;&#123;&#123; slug &#125;&#125;&lt;/h1&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    async asyncData(&#123; params &#125;) &#123;</span><br><span class="line">      const slug = params.slug // When calling /abc the slug will be &quot;abc&quot;</span><br><span class="line">      return &#123; slug &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><strong>é¢å¤–çš„é…ç½®</strong></p><ol><li><p>asyncData: Function</p><p>ç»„ä»¶åŠ è½½å‰è°ƒç”¨ï¼Œå¯æ¥å—ä¸€ä¸ª context å‡½æ•°å‚æ•°ï¼Œå³å½“å‰é¡µé¢ä¸Šä¸‹æ–‡ï¼Œè¿”å›å€¼å°†è¢« nuxt æ··å…¥åˆ° data ä¸­å»ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">asyncData</span>(<span class="params">context</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">name</span>: <span class="string">&#x27;World&#x27;</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>fetch: Function</p><p>ç”¨äºè·å–å¼‚æ­¥æ•°æ®ï¼Œå’Œ asyncData ç±»ä¼¼ï¼Œä½†åªèƒ½åœ¨æœåŠ¡ç«¯è·¯ç”±æ¸²æŸ“æ—¶è°ƒç”¨ï¼Œä¸”åªåœ¨é¦–æ¬¡åŠ è½½é¡µé¢æ—¶è§¦å‘ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        posts: []</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    async fetch() &#123;</span><br><span class="line">      this.posts = await fetch(&#x27;https://api.nuxtjs.dev/posts&#x27;).then(res =&gt;</span><br><span class="line">        res.json()</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></li><li><p>head: Function</p><p>è®¾ç½®å½“å‰é¡µé¢çš„ä¸€äº› head ä¿¡æ¯ï¼Œnuxt é€šè¿‡ <code>vue-meta</code> è¿›è¡Œæ›´æ–°ã€‚</p></li><li><p>layout: String</p><p>é…ç½®å½“å‰é¡µé¢çš„å¸ƒå±€ã€‚</p></li><li><p>loading: Boolean</p><p>é…ç½®å½“å‰æ˜¯å¦ä½¿ç”¨é¡¶éƒ¨åŠ è½½æ ·å¼ã€‚</p><p>è‹¥è®¾ä¸º falseï¼Œå¯æ‰‹åŠ¨é€šè¿‡ <code>this.$nuxt.$loading.finish()</code> å’Œ <code>this.$nuxt.$loading.start()</code>ã€‚</p></li><li><p>transition: Object</p><p>é…ç½®é¡µé¢åŠ¨æ•ˆã€‚</p></li><li><p>scrollToTop: Boolean</p><p>é…ç½®å½“å‰é¡µé¢æ˜¯å¦å›è°ƒé¡¶éƒ¨ã€‚</p></li><li><p>middleware: String | Array</p><p>é…ç½®å½“å‰é¡µé¢ä¸­é—´ä»¶ï¼Œå°†åœ¨é¡µé¢æ¸²æŸ“å‰è°ƒç”¨ã€‚</p></li><li><p>key: String</p><p>ç±»ä¼¼ Vue ç»„ä»¶ä¸Šçš„ keyï¼Œåªä¸è¿‡è¿™é‡Œæ˜¯ä½œç”¨åœ¨ router-link ä¸Šã€‚</p></li></ol><h3 id="components"><a href="#components" class="headerlink" title="components"></a>components</h3><p>éè·¯ç”±ç»„ä»¶ã€‚</p><p>é€šè¿‡ nuxt.config.js ä¸‹çš„ components é…ç½®æ˜¯å¦è‡ªåŠ¨æ‰«æ components ä¸‹çš„æ‰€æœ‰ç»„ä»¶ã€‚</p><p><strong>æ‡’åŠ è½½</strong></p><p>ç›´æ¥åœ¨ç»„ä»¶å‰é¢åŠ ä¸Š <code>Lazy</code> å³å¯ï¼Œåœ¨ä¸€äº›äº‹ä»¶ä¹‹ååŠ è½½æ¸²æŸ“ç»„ä»¶ã€‚</p><p><strong>åµŒå¥—è·¯ç”±</strong></p><p>ä¾‹å¦‚ä»¥ä¸‹ç›®å½•ç»“æ„ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">components/</span><br><span class="line">  base/</span><br><span class="line">      foo/</span><br><span class="line">         CustomButton.vue</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„æœ€ç»ˆè·¯ç”±ï¼š<code>&lt;BaseFooCustomButton /&gt;</code></p><h3 id="Assets"><a href="#Assets" class="headerlink" title="Assets"></a>Assets</h3><p>èµ„æºæ–‡ä»¶ï¼šStylusã€Sassã€imagesã€fontsã€‚</p><p><strong>Images</strong></p><p>åœ¨ template ä¸­ï¼Œå¯é€šè¿‡ <code>~/assets/xxx.png</code> è®¿é—®ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;~/assets/your_image.png&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½†åœ¨ css æ–‡ä»¶ä¸­ï¼Œåˆ™ä¸éœ€è¦æ–œæ ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">&#x27;~assets/banner.svg&#x27;</span>);</span><br></pre></td></tr></table></figure><p><strong>Styles</strong></p><p>nuxt å…è®¸é€šè¿‡ nuxt.config.js é…ç½®å…¨å±€æ ·å¼ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">css</span>: [</span><br><span class="line">    <span class="comment">// Load a Node.js module directly (here it&#x27;s a Sass file)</span></span><br><span class="line">    <span class="string">&#x27;bulma&#x27;</span>,</span><br><span class="line">    <span class="comment">// CSS file in the project</span></span><br><span class="line">    <span class="string">&#x27;~/assets/css/main.css&#x27;</span>,</span><br><span class="line">    <span class="comment">// SCSS file in the project</span></span><br><span class="line">    <span class="string">&#x27;~/assets/css/main.scss&#x27;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Static"><a href="#Static" class="headerlink" title="Static"></a>Static</h3><p>é™æ€èµ„æºï¼Œæ”¹ç›®å½•ä¸‹ä¸€èˆ¬åŒ…å«ä¸€äº›æ°¸è¿œä¸ä¼šæ”¹å˜çš„èµ„æºï¼Œä¸”å°†ä¼šç›´æ¥æ˜ å°„åˆ°æœåŠ¡å™¨çš„æ ¹ç›®å½•ä¸‹ã€‚</p><p>static ä¸‹çš„æ–‡ä»¶å¯é€šè¿‡ <code>/</code> ç›´æ¥è®¿é—®ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Static image from static directory --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/my-image.png&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- webpacked image from assets directory --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;~/assets/my-image-2.png&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>è‹¥ nuxt.config.js ä¸­é…ç½®äº† router.base å±æ€§ï¼Œé¡¹ç›®å°†åœ¨å­ç›®å½•ä¸‹éƒ¨ç½²ï¼Œå±Šæ—¶å°±éœ€è¦åŠ ä¸Š base æ‰èƒ½è®¿é—®åˆ°é™æ€èµ„æºã€‚</p><p>å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡é…ç½® static.prefix ä¸º false æ¥å–æ¶ˆå‰ç¼€ã€‚</p><h3 id="nuxt-config-js"><a href="#nuxt-config-js" class="headerlink" title="nuxt.config.js"></a>nuxt.config.js</h3><p>nuxt çš„é…ç½®æ–‡ä»¶ã€‚</p><ol><li><p><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-alias/">alias</a></p><p>é…ç½®ç›®å½•åˆ«åã€‚</p></li><li><p><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-build/">build</a></p><p>é…ç½® webpackï¼ŒåŒ…æ‹¬ loaderã€filenamesã€transpilationã€‚</p></li><li><p><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-css/">css</a></p><p>é…ç½®å…¨å±€ css æ–‡ä»¶ã€‚</p></li><li><p><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-generate/">generate</a></p><p>å‘½ä»¤ <code>nuxt g</code> ç›¸å…³é…ç½®ã€‚</p></li><li><p><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-head/">head</a></p><p>é…ç½® web headã€‚</p></li><li><p><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-loading/">loading</a></p><p>é…ç½®é¡µé¢åŠ è½½ã€‚</p></li><li><p><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-modules/">modules</a></p><p>åŠ è½½ç¬¬ä¸‰æ–¹åº“ã€‚</p></li><li><p><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-plugins/">plugins</a></p><p>åŠ è½½æ’ä»¶ã€‚</p></li><li><p><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-router/">router</a></p><p>é…ç½® nuxt è·¯ç”±ã€‚</p></li><li><p><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-server/">server</a></p><p>é…ç½®æœåŠ¡ç›¸å…³å±æ€§ã€‚</p></li><li><p>srcDir</p><p>é…ç½®å½“å‰ nuxt åº”ç”¨çš„æºç›®å½•ã€‚</p></li><li><p>.gitignore</p><p>é…ç½®å¿½ç•¥æ–‡ä»¶ã€‚</p></li></ol><h2 id="è§†å›¾"><a href="#è§†å›¾" class="headerlink" title="è§†å›¾"></a>è§†å›¾</h2><p><img src="https://www.nuxtjs.cn/nuxt-views-schema.svg" alt="nuxt-views-schema"></p><h3 id="é¡µé¢"><a href="#é¡µé¢" class="headerlink" title="é¡µé¢"></a>é¡µé¢</h3><p>åŒ Vue ç»„ä»¶ä¸€è‡´ï¼Œåªä¸è¿‡ nuxt ä¸ºæ¯ä¸€ä¸ªé¡µé¢æ·»åŠ äº†ä¸€äº›ç‰¹æ®Šçš„å±æ€§ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h1 class=&quot;red&quot;&gt;Hello &#123;&#123; name &#125;&#125;!&lt;/h1&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    asyncData (context) &#123;</span><br><span class="line">      // called every time before loading the component</span><br><span class="line">      return &#123; name: &#x27;World&#x27; &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    fetch () &#123;</span><br><span class="line">      // The fetch method is used to fill the store before rendering the page</span><br><span class="line">    &#125;,</span><br><span class="line">    head () &#123;</span><br><span class="line">      // Set Meta Tags for this Page</span><br><span class="line">    &#125;,</span><br><span class="line">    // and more functionality to discover</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">  .red &#123;</span><br><span class="line">    color: red;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p>é…ç½®é¡¹ï¼š</p><blockquote><p>åªè¦æ˜¯å‡½æ•°å¼å†™æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°éƒ½å¯ä»¥æ¥æ”¶åˆ°å½“å‰é¡µé¢çš„ä¸Šä¸‹æ–‡(context)ã€‚</p></blockquote><ol><li><p><code>asyncData: Function</code></p><p>æœåŠ¡ç«¯è·å–å¹¶æ¸²æŸ“æ•°æ®ï¼ŒasyncData åœ¨ç»„ä»¶<strong>åˆå§‹åŒ–ä¹‹å‰</strong>æ‰§è¡Œã€‚</p></li><li><p><code>fetch: Function</code></p><p>ç”¨äºæ¸²æŸ“å‰å¤„ç†çŠ¶æ€æœº(store)ä¸­çš„æ•°æ®ï¼Œä¸ <code>asyncData</code> æ–¹æ³•ç±»ä¼¼ï¼Œä½†ä»–ä¸ä¼šè®¾ç½®ç»„ä»¶çš„æ•°æ®ã€‚</p></li><li><p><code>head: Object | Function</code></p><p>é…ç½®headã€htmlã€‚</p></li><li><p><code>key: String | Function</code></p><p>é…ç½® <code>&lt;router-view&gt;</code> ç»„ä»¶çš„ <code>key</code> å±æ€§ã€‚</p></li><li><p><code>layout: String | Function</code></p><p>é…ç½®é¡µé¢å¸ƒå±€æ–‡ä»¶ã€‚</p></li><li><p><code>loading: Boolean</code></p><p>é…ç½®æ˜¯å¦åŠ è½½è¿›åº¦æ¡é€‰é¡¹ã€‚</p></li><li><p><code>middleware: String | Array</code></p><p>é…ç½®ä¸­é—´ä»¶æ–‡ä»¶ã€‚</p></li><li><p><code>scrollToTop: Boolean</code></p><p>æ§åˆ¶é¡µé¢æ¸²æŸ“å‰æ˜¯å¦æ»šåŠ¨è‡³é¡µé¢é¡¶éƒ¨ã€‚</p></li><li><p><code>transition: String | Object | Function</code></p><p>é…ç½®è¿‡æ¸¡åŠ¨æ•ˆã€‚</p></li><li><p><code>validate: (context: any) =&gt; Boolean</code></p><p>é…ç½®è·¯ç”±å‚æ•°æ ¡éªŒã€‚</p></li><li><p><code>watchQuery: Boolean | Array</code></p><p>ç›‘å¬å±æ€§å˜åŒ–ï¼Œæ‰§è¡Œæ‰€æœ‰ç»„ä»¶æ–¹æ³•(asyncData, fetch, validate, layout,â€¦)</p></li></ol><h4 id="åŠ¨æ€é¡µé¢"><a href="#åŠ¨æ€é¡µé¢" class="headerlink" title="åŠ¨æ€é¡µé¢"></a>åŠ¨æ€é¡µé¢</h4><p>é€šè¿‡ _name.vue æ¥å®ç°åŠ¨æ€å‚æ•°çš„é¡µé¢ï¼Œname å°†æ•´åˆåˆ°è·¯ç”±çš„ params å‚æ•°ä¸­ã€‚</p><h4 id="å¿½ç•¥é¡µé¢"><a href="#å¿½ç•¥é¡µé¢" class="headerlink" title="å¿½ç•¥é¡µé¢"></a>å¿½ç•¥é¡µé¢</h4><p>é€šè¿‡ -name.vue æ¥å®ç°ã€‚</p><h3 id="å¸ƒå±€"><a href="#å¸ƒå±€" class="headerlink" title="å¸ƒå±€"></a>å¸ƒå±€</h3><p>layout ç›®å½•ä¸‹åˆ›å»ºè‡ªå®šä¹‰å¸ƒå±€ã€‚</p><h4 id="é»˜è®¤å¸ƒå±€"><a href="#é»˜è®¤å¸ƒå±€" class="headerlink" title="é»˜è®¤å¸ƒå±€"></a>é»˜è®¤å¸ƒå±€</h4><p>å…¥å£ï¼š<code>layouts/default.vue</code></p><p><strong>æ³¨æ„</strong>ï¼šåœ¨å¸ƒå±€æ–‡ä»¶ä¸­éœ€è¦æ·»åŠ  <code>&lt;nuxt/&gt;</code> ç»„ä»¶ç”¨äºæ˜¾ç¤ºé¡µé¢çš„ä¸»ä½“å†…å®¹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;nuxt /&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h4 id="è‡ªå®šä¹‰å¸ƒå±€"><a href="#è‡ªå®šä¹‰å¸ƒå±€" class="headerlink" title="è‡ªå®šä¹‰å¸ƒå±€"></a>è‡ªå®šä¹‰å¸ƒå±€</h4><p>æ¯ä¸ªé¡µé¢å¯ä»¥é…ç½®ç‹¬è‡ªçš„å¸ƒå±€ï¼Œè‡ªå®šä¹‰å¸ƒå±€æ–‡ä»¶åº”åœ¨ <code>layouts</code> ç›®å½•ä¸‹ï¼Œä¸”éœ€è¦ç¡®ä¿åœ¨å¸ƒå±€æ–‡ä»¶ä¸­æ·»åŠ  <code>&lt;Nuxt/&gt;</code> æ¥æ˜¾ç¤ºé¡µé¢ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/** layouts/blob.vue */</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;div&gt;My blog navigation bar here&lt;/div&gt;</span><br><span class="line">    &lt;Nuxt /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">/** pages/posts.vue */</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- Your template --&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    layout: &#x27;blog&#x27;</span><br><span class="line">    // page component definitions</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="é”™è¯¯é¡µé¢"><a href="#é”™è¯¯é¡µé¢" class="headerlink" title="é”™è¯¯é¡µé¢"></a>é”™è¯¯é¡µé¢</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/** layouts/error.vue */</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1 v-if=&quot;error.statusCode === 404&quot;&gt;Page not found&lt;/h1&gt;</span><br><span class="line">    &lt;h1 v-else&gt;An error occurred&lt;/h1&gt;</span><br><span class="line">    &lt;NuxtLink to=&quot;/&quot;&gt;Home page&lt;/NuxtLink&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    props: [&#x27;error&#x27;],</span><br><span class="line">    layout: &#x27;error&#x27; // you can set a custom layout for the error page</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="app-html"><a href="#app-html" class="headerlink" title="app.html"></a>app.html</h3><p>å¯æ ¹æ® nuxt.config.js ä¸­çš„é…ç½®åŠ¨æ€é…ç½®æ ¹å…¥å£æ–‡ä»¶çš„ç›¸å…³å±æ€§ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> &#123;&#123; <span class="attr">HTML_ATTRS</span> &#125;&#125;&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span> &#123;&#123; <span class="attr">HEAD_ATTRS</span> &#125;&#125;&gt;</span></span><br><span class="line">    &#123;&#123; HEAD &#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span> &#123;&#123; <span class="attr">BODY_ATTRS</span> &#125;&#125;&gt;</span></span><br><span class="line">    &#123;&#123; APP &#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="context"><a href="#context" class="headerlink" title="context"></a>context</h2><p><img src="https://s2.loli.net/2023/05/31/6wLcWYTUzMymNOZ.png" alt="c12c33"></p><p>context åœ¨ nuxt æä¾›çš„ä¸€äº›å‡½æ•°ä¸­æ˜¯å¯ç”¨çš„ï¼Œæ¯”å¦‚ï¼šasyncDataã€pluginsã€middlewareã€nuxtServerInitï¼Œå…¶å±æ€§å¦‚ä¸Šå›¾ã€‚</p><blockquote><p>ä¸è¦ä¸ action ä¸­çš„ context æ··æ·†ï¼</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> (<span class="params">context</span>) &#123; <span class="comment">// Could be asyncData, nuxtServerInit, ...</span></span><br><span class="line">  <span class="comment">// Always available</span></span><br><span class="line">  <span class="keyword">const</span> &#123;</span><br><span class="line">    app,</span><br><span class="line">    store,</span><br><span class="line">    route,</span><br><span class="line">    params,</span><br><span class="line">    query,</span><br><span class="line">    env,</span><br><span class="line">    isDev,</span><br><span class="line">    isHMR,</span><br><span class="line">    redirect,</span><br><span class="line">    error,</span><br><span class="line">    $config</span><br><span class="line">  &#125; = context</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Only available on the Server-side</span></span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">server</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; req, res, beforeNuxtRender, beforeSerialize &#125; = context</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Only available on the Client-side</span></span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">client</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; <span class="keyword">from</span>, nuxtState &#125; = context</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è·å–è·¯ç”±-params-å‚æ•°"><a href="#è·å–è·¯ç”±-params-å‚æ•°" class="headerlink" title="è·å–è·¯ç”± params å‚æ•°"></a>è·å–è·¯ç”± params å‚æ•°</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">asyncData</span>(<span class="params">context</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> id = context.<span class="property">params</span>.<span class="property">id</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// Using the nuxtjs/http module here exposed via context.app</span></span><br><span class="line">      <span class="keyword">const</span> post = <span class="keyword">await</span> context.<span class="property">app</span>.<span class="property">$http</span>.$get(</span><br><span class="line">        <span class="string">`https://api.nuxtjs.dev/posts/<span class="subst">$&#123;id&#125;</span>`</span></span><br><span class="line">      )</span><br><span class="line">      <span class="keyword">return</span> &#123; post &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      context.<span class="title function_">error</span>(e) <span class="comment">// Show the nuxt error page with the thrown error</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è®¿é—®-store-å¹¶é‡å®šå‘ï¼ˆé‰´æƒï¼‰"><a href="#è®¿é—®-store-å¹¶é‡å®šå‘ï¼ˆé‰´æƒï¼‰" class="headerlink" title="è®¿é—® store å¹¶é‡å®šå‘ï¼ˆé‰´æƒï¼‰"></a>è®¿é—® store å¹¶é‡å®šå‘ï¼ˆé‰´æƒï¼‰</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">middleware</span>(<span class="params">&#123; store, redirect &#125;</span>) &#123;</span><br><span class="line">    <span class="comment">// retrieving keys via object destructuring</span></span><br><span class="line">    <span class="keyword">const</span> isAuthenticated = store.<span class="property">state</span>.<span class="property">authenticated</span></span><br><span class="line">    <span class="keyword">if</span> (!isAuthenticated) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="title function_">redirect</span>(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Helper"><a href="#Helper" class="headerlink" title="Helper"></a>Helper</h2><p>nuxt çš„è¾…åŠ©å™¨ã€‚</p><h3 id="nuxt-1"><a href="#nuxt-1" class="headerlink" title="$nuxt"></a>$nuxt</h3><p><code>$nuxt</code> å¯ä»¥åœ¨ vue ç»„ä»¶ä¸­é€šè¿‡ <code>this.$nuxt</code> è®¿é—®ï¼Œåœ¨å®¢æˆ·ç«¯ä¹Ÿå¯ä»¥é€šè¿‡ <code>window.$nuxt</code> è®¿é—®ã€‚</p><h4 id="æ£€æŸ¥ç”¨æˆ·æ˜¯å¦è”ç½‘"><a href="#æ£€æŸ¥ç”¨æˆ·æ˜¯å¦è”ç½‘" class="headerlink" title="æ£€æŸ¥ç”¨æˆ·æ˜¯å¦è”ç½‘"></a>æ£€æŸ¥ç”¨æˆ·æ˜¯å¦è”ç½‘</h4><p><code>$nuxt.isOffline</code> æä¾›äº†å¿«é€ŸæŸ¥æ˜ç”¨æˆ·æ˜¯å¦è¿æ¥äº’è”ç½‘ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;$nuxt.isOffline&quot;</span>&gt;</span>You are offline<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Nuxt</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="åˆ·æ–°é¡µé¢æ•°æ®"><a href="#åˆ·æ–°é¡µé¢æ•°æ®" class="headerlink" title="åˆ·æ–°é¡µé¢æ•°æ®"></a>åˆ·æ–°é¡µé¢æ•°æ®</h4><p><code>$nuxt.refresh</code> æ–¹æ³•å°†é‡æ–°è°ƒç”¨ asyncDataã€fetch é‡æ–°è·å–æ•°æ®ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; content &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;refresh&quot;</span>&gt;</span>Refresh<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">asyncData</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123; <span class="attr">content</span>: <span class="string">&#x27;Created at: &#x27;</span> + <span class="keyword">new</span> <span class="title class_">Date</span>() &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">refresh</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">$nuxt</span>.<span class="title function_">refresh</span>()</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="æ§åˆ¶åŠ è½½æ¡"><a href="#æ§åˆ¶åŠ è½½æ¡" class="headerlink" title="æ§åˆ¶åŠ è½½æ¡"></a>æ§åˆ¶åŠ è½½æ¡</h4><p>å¯é€šè¿‡ <code>$nuxt.$loading</code> å®ç°å¯¹åŠ è½½æ¡çš„æ§åˆ¶ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">$nuxt</span>.<span class="property">$loading</span>.<span class="title function_">start</span>()</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="property">$nuxt</span>.<span class="property">$loading</span>.<span class="title function_">finish</span>(), <span class="number">500</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="window-onNuxtReady"><a href="#window-onNuxtReady" class="headerlink" title="window.onNuxtReady"></a>window.onNuxtReady</h3><p>åœ¨ nuxt åº”ç”¨åŠ è½½å°±ç»ªä¹‹åæ‰§è¡Œä¸€äº›å›è°ƒã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">onNuxtReady</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Nuxt is ready and mounted&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="Process"><a href="#Process" class="headerlink" title="Process"></a>Process</h3><p>nuxt é›†æˆäº†ä¸‰ä¸ªæ ‡å¿—ï¼ˆclientã€serverã€staticï¼‰ï¼Œç”¨äºåˆ¤æ–­å½“å‰åº”ç”¨ç¨‹åºåœ¨æœåŠ¡å™¨ã€å®¢æˆ·ç«¯æˆ–é™æ€ç«™ç‚¹ä¸Šå‘ˆç°ï¼Œé€šå¸¸åœ¨ asyncData ä¸­ä½¿ç”¨ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>I am rendered on the &#123;&#123; renderedOn &#125;&#125; side<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">asyncData</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123; <span class="attr">renderedOn</span>: process.<span class="property">client</span> ? <span class="string">&#x27;client&#x27;</span> : <span class="string">&#x27;server&#x27;</span> &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="SSR"><a href="#SSR" class="headerlink" title="SSR"></a>SSR</h2><p>æœåŠ¡ç«¯æ¸²æŸ“ï¼Œnuxt äº¦ä¸ºæ­¤è€Œç”Ÿï¼Œæ‰€è°“æœåŠ¡ç«¯æ¸²æŸ“ï¼Œå³åœ¨æœåŠ¡ç«¯è¿›è¡Œé¡µé¢ç¼–è¯‘è§£ææˆ htmlï¼Œå†äº¤ç»™å®¢æˆ·ç«¯æ¸²æŸ“ï¼Œè‡³æ­¤ä¸éœ€è¦æµè§ˆå™¨è¿›è¡Œ js çš„è§£æä»¥åŠæ‰§è¡Œã€‚</p><p>Node.js server æ˜¯å¿…è¦çš„ï¼š</p><ol><li>js çš„æ‰§è¡Œéœ€è¦ node ç¯å¢ƒçš„ã€‚</li><li>node ç¯å¢ƒè¿˜éœ€è¦åšä¸€äº›é…ç½®æ¥å®ç°ç¼–è¯‘æ‰§è¡Œ vue åº”ç”¨ã€‚</li></ol><p>nuxt ä¹Ÿå¯ä»¥é€šè¿‡ serverMiddleware æ¥æ‹“å±•å’Œæ§åˆ¶æœåŠ¡ç«¯ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** server-middleware/logger.js */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> (<span class="params">req, res, next</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">url</span>)</span><br><span class="line">  <span class="title function_">next</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/** nuxt.config.js */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">serverMiddleware</span>: [<span class="string">&#x27;~/server-middleware/logger&#x27;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºæ˜¯åœ¨æœåŠ¡ç«¯çš„åŸå› ï¼Œé€šå¸¸æƒ…å†µæ˜¯ä¸å¯ä»¥è®¿é—®åˆ°æµè§ˆå™¨ç‹¬æœ‰çš„ <code>window</code> å¯¹è±¡çš„ï¼Œåªèƒ½åœ¨  <code>beforeMount</code> å’Œ <code>mounted</code> ä¸­è®¿é—®ã€‚</p><p>ssrçš„æ­¥éª¤ï¼š</p><ol><li><p>å®¢æˆ·ç«¯ -&gt; æœåŠ¡ç«¯</p><p>æµè§ˆå™¨ç»™ nodejs æœåŠ¡ç«¯å‘å‡ºåˆå§‹åŒ–è¯·æ±‚ã€‚Nuxt å°†ç”Ÿæˆ html å¹¶è¿”å›ç»™æµè§ˆå™¨ï¼Œå¹¶ä¸”ä¼šæ‰§è¡Œ asyncDataã€nuxtServerInitã€Fetchã€‚</p></li><li><p>æœåŠ¡ç«¯ -&gt; æµè§ˆå™¨</p><p>æµè§ˆå™¨æ¥æ”¶åˆ° html è¿›è¡Œæ¸²æŸ“é¡µé¢ï¼Œç„¶å Vue.js çš„ hydration æœºåˆ¶å¼€å§‹è¿ä½œï¼Œä½¿é¡µé¢å“åº”å¼ï¼Œè¿›è€Œå®ç°é¡µé¢äº¤äº’ã€‚</p></li><li><p>æµè§ˆå™¨ -&gt; æµè§ˆå™¨</p><p>é¡µé¢ä¹‹é—´çš„è·³è½¬é€šè¿‡ <code>&lt;NuxtLink&gt;</code> æ¥å®Œæˆï¼Œé™¤éä½ åˆ·æ–°é¡µé¢ï¼Œæ•´ä¸ª ssr æµç¨‹å°†é‡æ–°è¿›è¡Œã€‚</p></li></ol><p>æ³¨æ„äº‹é¡¹ï¼š</p><ol><li><p>window or document is undefined</p><p>è¿™åŸºæœ¬æ˜¯ç”±äºåœ¨æœåŠ¡ç«¯æ‰§è¡Œçš„ç¼˜æ•…ï¼Œå»ºè®®ä½¿ç”¨ <code>process.cilent</code> åˆ¤æ–­ä¹‹åæ‰§è¡Œã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (process.<span class="property">client</span>) &#123;</span><br><span class="line">  <span class="built_in">require</span>(<span class="string">&#x27;external_library&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h2 id="Nuxtç”Ÿå‘½å‘¨æœŸ"><a href="#Nuxtç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Nuxtç”Ÿå‘½å‘¨æœŸ"></a>Nuxtç”Ÿå‘½å‘¨æœŸ</h2><p><img src="https://s2.loli.net/2023/06/01/vpoL8D9CRBxzMae.png" alt="de48ca"></p><p>ä¸‹é¢æ˜¯å¸¸ç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼š</p><ol><li><p><code>nuxtServerInit</code></p><p>åœ¨æœåŠ¡å™¨æ¸²æŸ“é—´æ‰§è¡Œçš„æ–¹æ³•ï¼Œåˆå§‹åŒ– Vuex çš„çŠ¶æ€æˆ–ä» API ä¸­è·å–æ•°æ®ç­‰æ“ä½œã€‚</p></li><li><p><code>middleware</code></p><p>æ‰§è¡Œç›¸å…³çš„ä¸­é—´ä»¶ï¼Œé¡ºåºæ˜¯ï¼šGlobal middleware -&gt; Layout middleware -&gt; Route middlewareã€‚</p></li><li><p><code>asyncData</code></p><p>åœ¨ç»„ä»¶æ¸²æŸ“å‰è¿è¡Œï¼Œåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥æ‰§è¡Œã€‚ç”¨äºå¼‚æ­¥è·å–æ•°æ®åœ¨æ¸²æŸ“ï¼Œé€šå¸¸å’ŒæœåŠ¡ç«¯é…åˆä½¿ç”¨ã€‚</p></li><li><p><code>fetch</code></p><p>ç»„ä»¶å®ä¾‹åŒ–ä¹‹åï¼Œåœ¨é¡µé¢åŠ è½½å‰æ‰§è¡Œã€‚ä¸»è¦ç”¨äºå®¢æˆ·ç«¯è·å–æ•°æ®ï¼Œä¸æ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“ã€‚</p></li><li><p><code>created</code></p><p>åœ¨ç»„ä»¶å®ä¾‹åŒ–åç«‹å³è¢«è°ƒç”¨ï¼Œåœ¨æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯å‡å¯ç”¨ã€‚å¸¸ç”¨äºåˆå§‹åŒ–æ•°æ®è¯·æ±‚å’Œäº‹ä»¶ç›‘å¬å™¨ç­‰ä»»åŠ¡ã€‚</p></li><li><p><code>mounted</code></p><p>åœ¨ç»„ä»¶æŒ‚è½½åˆ°é¡µé¢ä¸Šåè°ƒç”¨ï¼Œåªèƒ½åœ¨å®¢æˆ·ç«¯ä¸­ä½¿ç”¨ã€‚é€‚åˆè¿›è¡Œ DOM æ“ä½œå’Œä½¿ç”¨ç¬¬ä¸‰æ–¹åº“åˆå§‹åŒ–é¡µé¢ã€‚</p></li><li><p><code>updated</code></p><p>åœ¨ç»„ä»¶æ›´æ–°æ—¶è¢«è°ƒç”¨ï¼Œåªèƒ½åœ¨å®¢æˆ·ç«¯ä¸­ä½¿ç”¨ã€‚å¸¸ç”¨äºæ›´æ–°æ•°æ®å’Œæ“ä½œ DOMã€‚</p></li><li><p><code>beforeDestory</code></p><p>åœ¨ç»„ä»¶è¢«é”€æ¯ä¹‹å‰è°ƒç”¨ï¼Œé€‚åˆåšä¸€äº›æ¸…ç†å·¥ä½œæˆ–è€…äº‹ä»¶è§£ç»‘å®šç­‰ä»»åŠ¡ã€‚</p></li></ol><h2 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h2><p>nuxt å°†æ ¹æ® pages ç›®å½•ä¸‹æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆè·¯ç”±é…ç½®ã€‚</p><h3 id="åŸºç¡€è·¯ç”±"><a href="#åŸºç¡€è·¯ç”±" class="headerlink" title="åŸºç¡€è·¯ç”±"></a>åŸºç¡€è·¯ç”±</h3><p>æ–‡ä»¶æ ‘ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pages/</span><br><span class="line">--| user/</span><br><span class="line">-----| index.vue</span><br><span class="line">-----| one.vue</span><br><span class="line">--| index.vue</span><br></pre></td></tr></table></figure><p>è‡ªåŠ¨ç”Ÿæˆè·¯ç”±é…ç½®ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">router</span>: &#123;</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;index&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="string">&#x27;pages/index.vue&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;user&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/user&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="string">&#x27;pages/user/index.vue&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;user-one&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/user/one&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="string">&#x27;pages/user/one.vue&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŠ¨æ€è·¯ç”±"><a href="#åŠ¨æ€è·¯ç”±" class="headerlink" title="åŠ¨æ€è·¯ç”±"></a>åŠ¨æ€è·¯ç”±</h3><p>ç±»ä¼¼åŸ vue-router ä¸­ <code>/:id</code>ï¼Œåœ¨ nuxt ä¸­é€šè¿‡ <code>_id.vue</code> è¿™ç§ä¸‹åˆ’çº¿å‘½åæ–¹å¼å®ç°ã€‚</p><p>æ–‡ä»¶æ ‘ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pages/</span><br><span class="line">--| _slug/</span><br><span class="line">-----| comments.vue</span><br><span class="line">-----| index.vue</span><br><span class="line">--| users/</span><br><span class="line">-----| _id.vue</span><br><span class="line">--| index.vue</span><br></pre></td></tr></table></figure><p>è‡ªåŠ¨ç”Ÿæˆï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">router</span>: &#123;</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;index&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="string">&#x27;pages/index.vue&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;users-id&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/users/:id?&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="string">&#x27;pages/users/_id.vue&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;slug&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/:slug&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="string">&#x27;pages/_slug/index.vue&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&#x27;slug-comments&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/:slug/comments&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="string">&#x27;pages/_slug/comments.vue&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è·¯ç”±å‚æ•°"><a href="#è·¯ç”±å‚æ•°" class="headerlink" title="è·¯ç”±å‚æ•°"></a>è·¯ç”±å‚æ•°</h4><p>åœ¨è·¯ç”±ç»„ä»¶æœ¬åœ°å¯é€šè¿‡ <code>this.$route.params.parameterName</code>ã€‚</p><h3 id="åµŒå¥—è·¯ç”±"><a href="#åµŒå¥—è·¯ç”±" class="headerlink" title="åµŒå¥—è·¯ç”±"></a>åµŒå¥—è·¯ç”±</h3><p>å³å­è·¯ç”±ã€‚nuxt ä¸­é€šè¿‡åˆ›å»ºäºå­ç›®å½•åŒåçš„ vue æ–‡ä»¶å®ç°ã€‚</p><blockquote><p>æ³¨æ„ï¼šéœ€è¦åœ¨çˆ¶çº§æ·»åŠ  <code>&lt;NuxtChild/&gt;</code> ï¼›æ¥æ˜¾ç¤ºå­ç»„ä»¶å†…å®¹ã€‚</p></blockquote><p>æ–‡ä»¶æ ‘ï¼š</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pages/</span><br><span class="line">--| users/</span><br><span class="line">-----| _id.vue</span><br><span class="line">-----| index.vue</span><br><span class="line">--| users.vue</span><br></pre></td></tr></table></figure><p>è‡ªåŠ¨ç”Ÿæˆï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">router</span>: &#123;</span><br><span class="line">  <span class="attr">routes</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">path</span>: <span class="string">&#x27;/users&#x27;</span>,</span><br><span class="line">      <span class="attr">component</span>: <span class="string">&#x27;pages/users.vue&#x27;</span>,</span><br><span class="line">      <span class="attr">children</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">          <span class="attr">component</span>: <span class="string">&#x27;pages/users/index.vue&#x27;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;users&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">path</span>: <span class="string">&#x27;:id&#x27;</span>,</span><br><span class="line">          <span class="attr">component</span>: <span class="string">&#x27;pages/users/_id.vue&#x27;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;users-id&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è·¯ç”±æ‹“å±•"><a href="#è·¯ç”±æ‹“å±•" class="headerlink" title="è·¯ç”±æ‹“å±•"></a>è·¯ç”±æ‹“å±•</h3><h4 id="nuxt-js-x2F-router"><a href="#nuxt-js-x2F-router" class="headerlink" title="@nuxt.js&#x2F;router"></a><a href="https://github.com/nuxt-community/router-module">@nuxt.js&#x2F;router</a></h4><p>è¯¥æ–¹å¼å¯ä»¥ä½¿ç”¨è‡ªå·±çš„è·¯ç”±é…ç½®æ¥è¦†ç›–é‡å†™ nuxt è‡ªåŠ¨ç”Ÿæˆçš„è·¯ç”±é…ç½®ã€‚</p><p>å…·ä½“ä½¿ç”¨å‚è€ƒå®˜æ–¹åº“ã€‚</p><blockquote><p>æ³¨æ„ï¼šæˆ‘ä»¬çš„ router.js éœ€è¦æš´éœ² createRouter å‡ºå»ã€‚</p></blockquote><h4 id="router-extendRoutes"><a href="#router-extendRoutes" class="headerlink" title="router.extendRoutes"></a><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-router/#extendroutes">router.extendRoutes</a></h4><p>é€šè¿‡ nuxt.config.js è¿›è¡Œæ‹“å±•è·¯ç”±ã€‚</p><p>æ·»åŠ è·¯ç”±ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">router</span>: &#123;</span><br><span class="line">    <span class="title function_">extendRoutes</span>(<span class="params">routes, resolve</span>) &#123;</span><br><span class="line">      routes.<span class="title function_">push</span>(&#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;custom&#x27;</span>,</span><br><span class="line">        <span class="attr">path</span>: <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;pages/404.vue&#x27;</span>)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·¯ç”±æ’åºï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; sortRoutes &#125; <span class="keyword">from</span> <span class="string">&#x27;@nuxt/utils&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">router</span>: &#123;</span><br><span class="line">    <span class="title function_">extendRoutes</span>(<span class="params">routes, resolve</span>) &#123;</span><br><span class="line">      <span class="comment">// Add some routes here ...</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// and then sort them</span></span><br><span class="line">      <span class="title function_">sortRoutes</span>(routes)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è·¯ç”±é…ç½®"><a href="#è·¯ç”±é…ç½®" class="headerlink" title="è·¯ç”±é…ç½®"></a>è·¯ç”±é…ç½®</h3><p>è·¯ç”±é…ç½®åœ¨ nuxt.config.js ä¸­çš„ router æ¨¡å—ã€‚</p><ol><li><p><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-router/#base">base: string</a></p><p>è·¯ç”±æ ¹è·¯å¾„ã€‚</p></li><li><p><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-router/#extendroutes">extendRoutes: function</a></p><p>è·¯ç”±æ‹“å±•ã€‚</p></li><li><p><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-router/#fallback">fallback: boolean</a></p><p>å½“æµè§ˆå™¨ä¸æ”¯æŒ history æ¨¡å¼æ—¶ï¼Œæ˜¯å¦å›é€€ä½¿ç”¨ hash æ¨¡å¼ã€‚</p></li><li><p><a href="https://v2.nuxt.com/docs/configuration-glossary/configuration-router/#mode">mode: â€˜hashâ€™ | â€˜historyâ€™</a></p><p>é…ç½®è·¯ç”±æ¨¡å¼ï¼Œä½†ä¸å»ºè®®ä¿®æ”¹ï¼Œå› ä¸ºä¼šå½±å“åˆ°æœåŠ¡ç«¯æ¸²æŸ“ã€‚</p></li><li><p><a href="https://v3.router.vuejs.org/guide/advanced/scroll-behavior.html#async-scrolling">scrollBehavior</a></p><p>è·¯ç”±è·³è½¬åé…ç½®æ»šåŠ¨æ¡è¡Œä¸ºã€‚</p></li></ol><h2 id="æ•°æ®è·å–"><a href="#æ•°æ®è·å–" class="headerlink" title="æ•°æ®è·å–"></a>æ•°æ®è·å–</h2><p>nuxt æ”¯æŒä¼ ç»Ÿçš„æ•°æ®è·å–æ–¹å¼ï¼Œä¾‹å¦‚ vue çš„ mounted å‘¨æœŸä¸­è·å–æ•°æ®ã€‚ä½†åªæœ‰ä½¿ç”¨ nuxt ç‰¹æœ‰çš„ hook æ‰èƒ½åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“æœŸé—´å‘ˆç°æ•°æ®ã€‚</p><p>nuxt è·å–æ•°æ®çš„é’©å­æœ‰ï¼šasyncDataã€fetchã€‚</p><h3 id="æ‰§è¡Œå‘¨æœŸ"><a href="#æ‰§è¡Œå‘¨æœŸ" class="headerlink" title="æ‰§è¡Œå‘¨æœŸ"></a>æ‰§è¡Œå‘¨æœŸ</h3><p><code>fetch</code> é’©å­å‡½æ•°å’Œ <code>asyncData</code> é’©å­å‡½æ•°éƒ½æ˜¯ç”¨äºåœ¨ç»„ä»¶æ¸²æŸ“å‰è·å–å¼‚æ­¥æ•°æ®çš„é’©å­å‡½æ•°ï¼Œä½†å®ƒä»¬çš„è°ƒç”¨å‘¨æœŸå’Œè§¦å‘æ—¶æœºä¸å®Œå…¨ä¸€æ ·ã€‚</p><p>åœ¨ Nuxt.js åº”ç”¨ç¨‹åºä¸­ï¼Œ<code>fetch</code> é’©å­å‡½æ•°ä¼šåœ¨æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰æœŸé—´å’Œå®¢æˆ·ç«¯æ¸²æŸ“ï¼ˆCSRï¼‰æœŸé—´åˆ†åˆ«è¢«è°ƒç”¨ã€‚å…·ä½“æ¥è¯´ï¼š</p><ul><li>åœ¨ SSR æœŸé—´ï¼Œ<code>fetch</code> é’©å­å‡½æ•°ä¼šåœ¨æœåŠ¡å™¨ç«¯ç»„ä»¶å®ä¾‹åŒ–ä¹‹åã€é¡µé¢æ¸²æŸ“ä¹‹å‰è¢«è°ƒç”¨ï¼Œæ­¤æ—¶å¯ä»¥è·å–åˆ°å¼‚æ­¥æ•°æ®å¹¶å°†å…¶ä¿å­˜åˆ° Vuex store ä¸­ï¼Œä»¥ä¾¿åœ¨é¡µé¢æ¸²æŸ“æ—¶ä½¿ç”¨ã€‚</li><li>åœ¨ CSR æœŸé—´ï¼Œ<code>fetch</code> é’©å­å‡½æ•°ä¼šåœ¨æ¯æ¬¡è·¯ç”±å¯¼èˆªåˆ‡æ¢æ—¶è¢«è°ƒç”¨ï¼Œæ­¤æ—¶ä¹Ÿå¯ä»¥è·å–å¼‚æ­¥æ•°æ®å¹¶æ›´æ–° Vuex store ä¸­çš„çŠ¶æ€ã€‚</li></ul><p>è€Œå¯¹äº <code>asyncData</code> é’©å­å‡½æ•°ï¼Œåˆ™ä»…åœ¨å®¢æˆ·ç«¯æ¸²æŸ“æ—¶è¢«è°ƒç”¨ï¼Œåœ¨æœåŠ¡ç«¯æ¸²æŸ“æœŸé—´ä¸ä¼šæ‰§è¡Œã€‚å…·ä½“æ¥è¯´ï¼š</p><ul><li>åœ¨ CSR æœŸé—´ï¼Œ<code>asyncData</code> é’©å­å‡½æ•°ä¼šåœ¨ç»„ä»¶å®ä¾‹åŒ–ä¹‹å‰è¢«è°ƒç”¨ï¼Œå¹¶ä¸”ä¼šç­‰å¾… Promise å¯¹è±¡è¢«è§£å†³åå†ç»§ç»­é¡µé¢çš„æ¸²æŸ“è¿‡ç¨‹ã€‚è¿™ä¸ªé˜¶æ®µå¯ä»¥ç†è§£ä¸ºåˆå§‹åŒ–å‰ã€‚</li><li>åœ¨ç»„ä»¶å®ä¾‹åŒ–å®Œæˆä¹‹åï¼Œä¼šè¿›å…¥<code>created</code>ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼Œæ­¤æ—¶ç»„ä»¶çš„ DOM èŠ‚ç‚¹å·²ç»ç”Ÿæˆï¼Œä½†æ˜¯å°šæœªè¢«æ¸²æŸ“åˆ°é¡µé¢ä¸Šã€‚</li><li>ç­‰åˆ°ç»„ä»¶çš„ <code>mounted</code> ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°è°ƒç”¨æ—¶ï¼Œç»„ä»¶çš„ DOM èŠ‚ç‚¹å·²ç»æˆåŠŸåœ°æ¸²æŸ“åˆ°äº†é¡µé¢ä¸Šã€‚</li></ul><p>å› æ­¤ï¼Œåœ¨ Nuxt.js åº”ç”¨ç¨‹åºä¸­ï¼Œå¦‚æœéœ€è¦åœ¨ç»„ä»¶æ¸²æŸ“å‰å°±è·å–å¼‚æ­¥æ•°æ®å¹¶ä½¿ç”¨ï¼Œåº”è¯¥ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ <code>fetch</code> é’©å­å‡½æ•°ï¼›å¦‚æœå¼‚æ­¥æ•°æ®è·å–ä¸é¡µé¢æ¸²æŸ“æ— å…³ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>asyncData</code> é’©å­å‡½æ•°ã€‚</p><h3 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h3><p>åœ¨æ¸²æŸ“é¡µé¢å‰å¡«å……çŠ¶æ€æ ‘(store)æ•°æ®ï¼Œä¸ä¼šè®¾ç½®ç»„ä»¶çš„æ•°æ®ï¼Œå¯åº”ç”¨åœ¨æ‰€æœ‰ç»„ä»¶ä¸Šã€‚</p><p>å…¶è¿˜æä¾›äº† this.$fetchState ç”¨äºè·å– fetch çŠ¶æ€ï¼Œå¹¶åœ¨é¡µé¢å±•ç¤ºç›¸å…³ä¿¡æ¯ã€‚</p><p>$fetchState ç¤ºä¾‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-if</span>=<span class="string">&quot;$fetchState.pending&quot;</span>&gt;</span>Fetching mountains...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-else-if</span>=<span class="string">&quot;$fetchState.error&quot;</span>&gt;</span>An error occurred :(<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Nuxt Mountains<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;mountain of mountains&quot;</span>&gt;</span>&#123;&#123; mountain.title &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;$fetch&quot;</span>&gt;</span>Refresh<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">mountains</span>: []</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">async</span> <span class="title function_">fetch</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">mountains</span> = <span class="keyword">await</span> <span class="title function_">fetch</span>(</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&#x27;https://api.nuxtjs.dev/mountains&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      ).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç›‘å¬è·¯ç”±å‚æ•°ä¿¡æ¯ï¼Œè¿›è¡Œè°ƒç”¨ fetch æ›´æ–°æ•°æ®ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">watch</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;$route.query&#x27;</span>: <span class="string">&#x27;$fetch&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">async</span> <span class="title function_">fetch</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// Called also on query changes</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ ·ï¼Œåœ¨ <code>&lt;nuxt&gt;</code> ç»„ä»¶ä¸Šä½¿ç”¨ <code>keep-alive</code> å¯è¿›è¡Œç»„ä»¶æ•°æ®ç¼“å­˜ã€‚</p><p>nuxt è¿˜æä¾›äº† <code>this.$fetchState.timestamp</code> ç”¨äºè®°å½•æœ€åä¸€æ¬¡ fetch çš„æ—¶é—´æˆ³ï¼Œå¯åœ¨ç¼“å­˜ç»„ä»¶è¶…è¿‡ä¸€å®šæ—¶é—´åï¼Œè¿›è¡Œæ•°æ®åˆ·æ–°ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span> ... <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">posts</span>: []</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">activated</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// Call fetch again if last fetch more than 30 sec ago</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">$fetchState</span>.<span class="property">timestamp</span> &lt;= <span class="title class_">Date</span>.<span class="title function_">now</span>() - <span class="number">30000</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.$fetch()</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">async</span> <span class="title function_">fetch</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">this</span>.<span class="property">posts</span> = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&#x27;https://api.nuxtjs.dev/posts&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span></span></span><br><span class="line"><span class="language-javascript">        res.<span class="title function_">json</span>()</span></span><br><span class="line"><span class="language-javascript">      )</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="asyncData"><a href="#asyncData" class="headerlink" title="asyncData"></a>asyncData</h3><p>åœ¨æœåŠ¡å™¨ç«¯è·å–æ¸²æŸ“æ•°æ®ï¼Œå¹¶è¿”å›ç»™å½“å‰ç»„ä»¶çš„ dataï¼Œä¸”ä¸èƒ½è®¿é—®åˆ° this ä»¥åŠ ç»„ä»¶å®ä¾‹ã€‚ä¸åŒäº fetchï¼Œè¯¥é’©å­å‡½æ•°åªèƒ½åº”ç”¨äºç»„ä»¶é¡µé¢ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; post.title &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; post.description &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">async</span> <span class="title function_">asyncData</span>(<span class="params">&#123; params, $http &#125;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> post = <span class="keyword">await</span> $http.$get(<span class="string">`https://api.nuxtjs.dev/posts/<span class="subst">$&#123;params.id&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123; post &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="Meta-å’Œ-SEO"><a href="#Meta-å’Œ-SEO" class="headerlink" title="Meta å’Œ SEO"></a>Meta å’Œ SEO</h2><h3 id="å…¨å±€é…ç½®"><a href="#å…¨å±€é…ç½®" class="headerlink" title="å…¨å±€é…ç½®"></a>å…¨å±€é…ç½®</h3><p>nuxt.config.js -&gt; headã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">head</span>: &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;my website title&#x27;</span>,</span><br><span class="line">    <span class="attr">meta</span>: [</span><br><span class="line">      &#123; <span class="attr">charset</span>: <span class="string">&#x27;utf-8&#x27;</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">name</span>: <span class="string">&#x27;viewport&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;width=device-width, initial-scale=1&#x27;</span> &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">hid</span>: <span class="string">&#x27;description&#x27;</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;description&#x27;</span>,</span><br><span class="line">        <span class="attr">content</span>: <span class="string">&#x27;my website description&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">link</span>: [&#123; <span class="attr">rel</span>: <span class="string">&#x27;icon&#x27;</span>, <span class="attr">type</span>: <span class="string">&#x27;image/x-icon&#x27;</span>, <span class="attr">href</span>: <span class="string">&#x27;/favicon.ico&#x27;</span> &#125;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å±€éƒ¨é…ç½®"><a href="#å±€éƒ¨é…ç½®" class="headerlink" title="å±€éƒ¨é…ç½®"></a>å±€éƒ¨é…ç½®</h3><p>å¯¹è±¡å½¢å¼ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">head</span>: &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;Home page&#x27;</span>,</span><br><span class="line">    <span class="attr">meta</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">hid</span>: <span class="string">&#x27;description&#x27;</span>,</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;description&#x27;</span>,</span><br><span class="line">        <span class="attr">content</span>: <span class="string">&#x27;Home page description&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>å‡½æ•°å½¢å¼ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">title</span>: <span class="string">&#x27;Home page&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">head</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">title</span>: <span class="variable language_">this</span>.<span class="property">title</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">meta</span>: [</span></span><br><span class="line"><span class="language-javascript">          &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">hid</span>: <span class="string">&#x27;description&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">name</span>: <span class="string">&#x27;description&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">content</span>: <span class="string">&#x27;Home page description&#x27;</span></span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        ]</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="å¤–éƒ¨èµ„æº"><a href="#å¤–éƒ¨èµ„æº" class="headerlink" title="å¤–éƒ¨èµ„æº"></a>å¤–éƒ¨èµ„æº</h3><p>é€šè¿‡ head.script å¼•å…¥å¤–éƒ¨èµ„æºã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">head</span>: &#123;</span><br><span class="line">    <span class="attr">script</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">src</span>: <span class="string">&#x27;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">link</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">rel</span>: <span class="string">&#x27;stylesheet&#x27;</span>,</span><br><span class="line">        <span class="attr">href</span>: <span class="string">&#x27;https://fonts.googleapis.com/css?family=Roboto&amp;display=swap&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><h3 id="css"><a href="#css" class="headerlink" title="css"></a>css</h3><p>nuxt ä¸­å…è®¸é€šè¿‡é…ç½®æ–‡ä»¶é…ç½®å…¨å±€ cssã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">css</span>: [</span><br><span class="line">    <span class="comment">// Load a Node.js module directly (here it&#x27;s a Sass file)</span></span><br><span class="line">    <span class="string">&#x27;bulma&#x27;</span>,</span><br><span class="line">    <span class="comment">// CSS file in the project</span></span><br><span class="line">    <span class="string">&#x27;~/assets/css/main.css&#x27;</span>,</span><br><span class="line">    <span class="comment">// SCSS file in the project</span></span><br><span class="line">    <span class="string">&#x27;~/assets/css/main.scss&#x27;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¹¶ä¸”ï¼Œnuxt æ”¯æŒä½ å¿½ç•¥æ–‡ä»¶åç¼€åã€‚ä½†å­˜åœ¨ä¼˜å…ˆçº§ï¼š[â€˜cssâ€™, â€˜pcssâ€™, â€˜postcssâ€™, â€˜stylâ€™, â€˜stylusâ€™, â€˜scssâ€™, â€˜sassâ€™, â€˜lessâ€™]</p><blockquote><p>åŒåæ–‡ä»¶ï¼Œå°†æŒ‰ç…§è¯¥é¡ºåºè§£æã€‚</p></blockquote><h3 id="å¤–éƒ¨èµ„æº-1"><a href="#å¤–éƒ¨èµ„æº-1" class="headerlink" title="å¤–éƒ¨èµ„æº"></a>å¤–éƒ¨èµ„æº</h3><p>ä¸»è¦é€šè¿‡ head ä¸­çš„ script ä»¥åŠ link å®ç°ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">head</span>: &#123;</span><br><span class="line">    <span class="attr">script</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">src</span>: <span class="string">&#x27;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">link</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">rel</span>: <span class="string">&#x27;stylesheet&#x27;</span>,</span><br><span class="line">        <span class="attr">href</span>: <span class="string">&#x27;https://fonts.googleapis.com/css?family=Roboto&amp;display=swap&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="PostCSS"><a href="#PostCSS" class="headerlink" title="PostCSS"></a>PostCSS</h3><p>nuxt é…ç½®å¯æ›¿ä»£ postcss.config.jsã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="attr">postcss</span>: &#123;</span><br><span class="line">      <span class="comment">// Add plugin names as key and arguments as value</span></span><br><span class="line">      <span class="comment">// Install them before as dependencies with npm or yarn</span></span><br><span class="line">      <span class="attr">plugins</span>: &#123;</span><br><span class="line">        <span class="comment">// Disable a plugin by passing false as value</span></span><br><span class="line">        <span class="string">&#x27;postcss-url&#x27;</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="string">&#x27;postcss-nested&#x27;</span>: &#123;&#125;,</span><br><span class="line">        <span class="string">&#x27;postcss-responsive-type&#x27;</span>: &#123;&#125;,</span><br><span class="line">        <span class="string">&#x27;postcss-hexrgba&#x27;</span>: &#123;&#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">preset</span>: &#123;</span><br><span class="line">        <span class="comment">// Change the postcss-preset-env settings</span></span><br><span class="line">        <span class="attr">autoprefixer</span>: &#123;</span><br><span class="line">          <span class="attr">grid</span>: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h3><p>nuxt é€šè¿‡ <a href="https://github.com/nuxt/nuxt/tree/2.x-dev/packages/babel-preset-app">@nuxt&#x2F;babel-preset-app</a>ï¼Œå®ç° JSX çš„ç¼–è¯‘æ¸²æŸ“ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  data () &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">name</span>: <span class="string">&#x27;World&#x27;</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  render (h) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;red&quot;</span>&gt;</span>&#123;this.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Ignore-files"><a href="#Ignore-files" class="headerlink" title="Ignore files"></a>Ignore files</h3><p><strong>.nuxtignore</strong></p><p>æ‚¨å¯ä»¥ä½¿ç”¨ .nuxtignore æ–‡ä»¶æ¥è®© Nuxt åœ¨æ„å»ºé˜¶æ®µå¿½ç•¥é¡¹ç›®æ ¹ç›®å½•ä¸­çš„å¸ƒå±€ã€é¡µé¢ã€å­˜å‚¨å’Œä¸­é—´ä»¶æ–‡ä»¶ã€‚</p><p>.nuxtignore æ–‡ä»¶éµå¾ªä¸ .gitignore å’Œ .eslintignore æ–‡ä»¶ç›¸åŒçš„è§„èŒƒï¼Œå…¶ä¸­æ¯è¡Œéƒ½æ˜¯ä¸€ä¸ª glob æ¨¡å¼ï¼ŒæŒ‡ç¤ºåº”å¿½ç•¥å“ªäº›æ–‡ä»¶ã€‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># ignore layout foo.vue</span></span><br><span class="line"></span><br><span class="line">layouts/foo.vue</span><br><span class="line"></span><br><span class="line"><span class="section"># ignore layout files whose name ends with -ignore.vue</span></span><br><span class="line"></span><br><span class="line">layouts/<span class="emphasis">*-ignore.vue</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis"># ignore page bar.vue</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">pages/bar.vue</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis"># ignore page inside ignore folder</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">pages/ignore/*</span>.vue</span><br><span class="line"></span><br><span class="line"><span class="section"># ignore store baz.js</span></span><br><span class="line"></span><br><span class="line">store/baz.js</span><br><span class="line"></span><br><span class="line"><span class="section"># ignore store files match <span class="emphasis">_.test._</span></span></span><br><span class="line"></span><br><span class="line">store/ignore/<span class="emphasis">_.test._</span></span><br><span class="line"></span><br><span class="line"><span class="section"># ignore middleware files under foo folder except foo/bar.js</span></span><br><span class="line"></span><br><span class="line">middleware/foo/<span class="emphasis">*.js !middleware/foo/bar.js</span></span><br></pre></td></tr></table></figure><p>åŒæ ·ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡ç‰¹æ®Šçš„å‘½åæ–¹å¼æ¥å®ç°å¿½ç•¥æ–‡ä»¶ï¼š<code>-xxx.xxx</code></p><p>åœ¨é…ç½®æ–‡ä»¶ä¸­ä¹Ÿå¯ä»¥é€šè¿‡ ignore æ¨¡å—é…ç½®å¿½ç•¥æ–‡ä»¶ã€‚</p><h3 id="webpack-é…ç½®"><a href="#webpack-é…ç½®" class="headerlink" title="webpack é…ç½®"></a>webpack é…ç½®</h3><p>nuxt é€šè¿‡é…ç½®æ–‡ä»¶ä¸‹ build æ¨¡å—è¿› è¡Œé…ç½® webpackï¼Œbuild æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡ä¸­åŒ…å«ä¸€ä¸ª extend å‡½æ•°ã€‚</p><p>è¯¥å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä» nuxt çš„ webpack é…ç½®ä¸­å¯¼å‡ºçš„ webpack é…ç½®å¯¹è±¡ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¸¦æœ‰ä»¥ä¸‹å¸ƒå°”å±æ€§çš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼š<code>&#123; isDev, isClient, isServer, loaders &#125;</code>ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="title function_">extend</span>(<span class="params">config, &#123; isClient &#125;</span>) &#123;</span><br><span class="line">      <span class="comment">// Extend only webpack config for client-bundle</span></span><br><span class="line">      <span class="keyword">if</span> (isClient) &#123;</span><br><span class="line">        config.<span class="property">devtool</span> = <span class="string">&#x27;source-map&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è‡ªå®šä¹‰-chunks"><a href="#è‡ªå®šä¹‰-chunks" class="headerlink" title="è‡ªå®šä¹‰ chunks"></a>è‡ªå®šä¹‰ chunks</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="title function_">extend</span>(<span class="params">config, &#123; isClient &#125;</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (isClient) &#123;</span><br><span class="line">        config.<span class="property">optimization</span>.<span class="property">splitChunks</span>.<span class="property">maxSize</span> = <span class="number">200000</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹webpacké…ç½®"><a href="#æŸ¥çœ‹webpacké…ç½®" class="headerlink" title="æŸ¥çœ‹webpacké…ç½®"></a>æŸ¥çœ‹webpacké…ç½®</h4><p>é€šè¿‡ <code>nuxt webpack</code> å‘½ä»¤æŸ¥çœ‹æœ€ç»ˆçš„ webpack é…ç½®ã€‚</p><h4 id="æ·»åŠ webpack-plugins"><a href="#æ·»åŠ webpack-plugins" class="headerlink" title="æ·»åŠ webpack plugins"></a>æ·»åŠ webpack plugins</h4><p>nuxt é€šè¿‡ build æ¨¡å—ä¸‹ <code>plugins: Object</code> è¿›è¡Œæ·»åŠ ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> webpack <span class="keyword">from</span> <span class="string">&#x27;webpack&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">      <span class="keyword">new</span> webpack.<span class="title class_">ProvidePlugin</span>(&#123;</span><br><span class="line">        <span class="comment">// global modules</span></span><br><span class="line">        <span class="attr">$</span>: <span class="string">&#x27;jquery&#x27;</span>,</span><br><span class="line">        <span class="attr">_</span>: <span class="string">&#x27;lodash&#x27;</span></span><br><span class="line">      &#125;)</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¤„ç†éŸ³é¢‘æ–‡ä»¶"><a href="#å¤„ç†éŸ³é¢‘æ–‡ä»¶" class="headerlink" title="å¤„ç†éŸ³é¢‘æ–‡ä»¶"></a>å¤„ç†éŸ³é¢‘æ–‡ä»¶</h4><p>éŸ³é¢‘æ–‡ä»¶åº”è¯¥ç”± <code>file-loader</code> è¿›è¡Œå¤„ç†ï¼Œä½†é»˜è®¤å¹¶æ²¡æœ‰è¿›è¡Œé…ç½®ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="title function_">extend</span>(<span class="params">config, ctx</span>) &#123;</span><br><span class="line">      config.<span class="property">module</span>.<span class="property">rules</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(ogg|mp3|wav|mpe?g)$/i</span>,</span><br><span class="line">        <span class="attr">loader</span>: <span class="string">&#x27;file-loader&#x27;</span>,</span><br><span class="line">        <span class="attr">options</span>: &#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;[path][name].[ext]&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé…ç½®å®Œä¹‹åï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡ require ç›´æ¥å¼•å…¥éŸ³é¢‘æ–‡ä»¶æä¾›ç»™ audio æ ‡ç­¾ä½¿ç”¨ï¼š<code>&lt;audio :src=&quot;require(&#39;@/assets/water.mp3&#39;)&quot; controls&gt;&lt;/audio&gt;</code> </p><p>è‹¥ä¸æƒ³ä½¿ç”¨ require å¯é€šè¿‡é…ç½® <code>vue-loader</code> è‡ªåŠ¨åŠ è½½ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="attr">loaders</span>: &#123;</span><br><span class="line">      <span class="attr">vue</span>: &#123;</span><br><span class="line">        <span class="attr">transformAssetUrls</span>: &#123;</span><br><span class="line">          <span class="attr">audio</span>: <span class="string">&#x27;src&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="title function_">extend</span>(<span class="params">config, ctx</span>) &#123;</span><br><span class="line">      config.<span class="property">module</span>.<span class="property">rules</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.(ogg|mp3|wav|mpe?g)$/i</span>,</span><br><span class="line">        <span class="attr">loader</span>: <span class="string">&#x27;file-loader&#x27;</span>,</span><br><span class="line">        <span class="attr">options</span>: &#123;</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;[path][name].[ext]&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹ä¸»æœºå’Œç«¯å£å·"><a href="#ä¿®æ”¹ä¸»æœºå’Œç«¯å£å·" class="headerlink" title="ä¿®æ”¹ä¸»æœºå’Œç«¯å£å·"></a>ä¿®æ”¹ä¸»æœºå’Œç«¯å£å·</h3><p>åœ¨é…ç½®æ–‡ä»¶ä¸‹çš„ server æ¨¡å—å¯è¿›è¡Œä¿®æ”¹ host å’Œ portã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">server</span>: &#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&#x27;0&#x27;</span> <span class="comment">// default: localhost</span></span><br><span class="line">    <span class="attr">port</span>: <span class="number">8000</span> <span class="comment">// default: 3000</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†ä¸å»ºè®®è¿™æ ·åšï¼Œå› ä¸ºå¯èƒ½åœ¨ç½‘ç«™æ‰˜ç®¡æ—¶å¼•èµ·é—®é¢˜ã€‚æœ€å¥½ç›´æ¥åœ¨ dev å‘½ä»¤ä¸­ä¿®æ”¹ä¸»æœºå’Œç«¯å£å·ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;dev:host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nuxt --hostname &#x27;0&#x27; --port 8000&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="å¼‚æ­¥é…ç½®"><a href="#å¼‚æ­¥é…ç½®" class="headerlink" title="å¼‚æ­¥é…ç½®"></a>å¼‚æ­¥é…ç½®</h3><p>nuxt å¯å°†é€šè¿‡å¼‚æ­¥å‡½æ•°è¿”å›å€¼çš„å½¢å¼è¿›è¡Œé…ç½®ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;https://api.nuxtjs.dev/posts&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">head</span>: &#123;</span><br><span class="line">      <span class="attr">title</span>: data.<span class="property">title</span></span><br><span class="line">      <span class="comment">//... rest of config</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ è½½æ¡"><a href="#åŠ è½½æ¡" class="headerlink" title="åŠ è½½æ¡"></a>åŠ è½½æ¡</h2><h3 id="è‡ªå®šä¹‰è¿›åº¦æ¡"><a href="#è‡ªå®šä¹‰è¿›åº¦æ¡" class="headerlink" title="è‡ªå®šä¹‰è¿›åº¦æ¡"></a>è‡ªå®šä¹‰è¿›åº¦æ¡</h3><p>nuxt é…ç½®æ–‡ä»¶çš„ loading æ¨¡å—ä¸‹è¿›è¡Œé…ç½®ã€‚</p><table><thead><tr><th>Key</th><th>Type</th><th>Default</th><th>Description</th><th></th></tr></thead><tbody><tr><td>color</td><td>String</td><td>â€˜blackâ€™</td><td>CSS color of the progress bar</td><td></td></tr><tr><td>failedColor</td><td>String</td><td>â€˜redâ€™</td><td>CSS color of the progress bar when an error appended while rendering the route (if data or fetch sent back an error, for example).</td><td></td></tr><tr><td>height</td><td>String</td><td>â€˜2pxâ€™</td><td>Height of the progress bar (used in the style property of the progress bar)</td><td></td></tr><tr><td>throttle</td><td>Number</td><td>200</td><td>In ms, wait for the specified time before displaying the progress bar. Useful for preventing the bar from flashing.</td><td></td></tr><tr><td>duration</td><td>Number</td><td>5000</td><td>In ms, the maximum duration of the progress bar, Nuxt assumes that the route will be rendered before 5 seconds.</td><td></td></tr><tr><td>continuous</td><td>Boolean</td><td>false</td><td>Keep animating progress bar when loading takes longer than duration.</td><td></td></tr><tr><td>css</td><td>Boolean</td><td>true</td><td>Set to false to remove default progress bar styles (and add your own).</td><td></td></tr><tr><td>rtl</td><td>Boolean</td><td>false</td><td>Set the direction of the progress bar from right to left.</td><td></td></tr></tbody></table><h3 id="ç¦ç”¨è¿›åº¦æ¡"><a href="#ç¦ç”¨è¿›åº¦æ¡" class="headerlink" title="ç¦ç”¨è¿›åº¦æ¡"></a>ç¦ç”¨è¿›åº¦æ¡</h3><p>é€šè¿‡ <code>loading: false</code> ç¦ç”¨è¿›åº¦æ¡ï¼Œæ— è®ºæ˜¯å…¨å±€é…ç½®è¿˜æ˜¯å±€éƒ¨é…ç½®å‡å¯ã€‚</p><h3 id="ç¼–ç¨‹å¼è°ƒç”¨"><a href="#ç¼–ç¨‹å¼è°ƒç”¨" class="headerlink" title="ç¼–ç¨‹å¼è°ƒç”¨"></a>ç¼–ç¨‹å¼è°ƒç”¨</h3><p>nuxt æä¾› <code>$loading</code> è¿›è¡Œç›´æ¥æ§åˆ¶è¿›åº¦æ¡ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">$nuxt</span>.<span class="property">$loading</span>.<span class="title function_">start</span>()</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="property">$nuxt</span>.<span class="property">$loading</span>.<span class="title function_">finish</span>(), <span class="number">500</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å†…ç½®ç»„ä»¶"><a href="#å†…ç½®ç»„ä»¶" class="headerlink" title="å†…ç½®ç»„ä»¶"></a>å†…ç½®ç»„ä»¶</h2><h3 id="Nuxt"><a href="#Nuxt" class="headerlink" title="Nuxt"></a>Nuxt</h3><p>ç”¨äºæ˜¾ç¤ºè·¯ç”±ç»„ä»¶ï¼Œåªèƒ½ç”¨äºå¸ƒå±€æ–‡ä»¶(layouts)ä¸­ä½¿ç”¨ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/** layouts/default.vue */</span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>My nav bar<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Nuxt</span> <span class="attr">:nuxt-child-key</span>=<span class="string">&quot;somekey&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>My footer<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>:nuxt-child-key</code> å°†ä¼ é€’ç»™ <code>&lt;RouterView&gt;</code>ï¼Œä»¥ä¾¿åœ¨åŠ¨æ€é¡µé¢æ­£ç¡®å¤„ç†è¿‡æ¸¡æ•ˆæœã€‚</p><h3 id="NuxtChild"><a href="#NuxtChild" class="headerlink" title="NuxtChild"></a>NuxtChild</h3><p>ç”¨äºæ˜¾ç¤ºå­è·¯ç”±(åµŒå¥—è·¯ç”±)ã€‚</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-| pages/</span><br><span class="line">---| parent/</span><br><span class="line">------| child.vue</span><br><span class="line">---| parent.vue</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>I am the parent view<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">NuxtChild</span> <span class="attr">:foobar</span>=<span class="string">&quot;123&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="keep-alive"><a href="#keep-alive" class="headerlink" title="keep-alive"></a>keep-alive</h3><p>ä½œç”¨äº <code>&lt;NuxtChild&gt;</code> å’Œ <code>&lt;Nuxt&gt;</code>ï¼Œè¿›è¡Œç»„ä»¶ç¼“å­˜ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Nuxt</span> <span class="attr">keep-alive</span> <span class="attr">:keep-alive-props</span>=<span class="string">&quot;&#123; exclude: [&#x27;modal&#x27;] &#125;&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- will be converted into something like this --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">KeepAlive</span> <span class="attr">:exclude</span>=<span class="string">&quot;[&#x27;modal&#x27;]&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">RouterView</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">KeepAlive</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>keep-alive-props</code> æ˜¯åŸ keep-alive ä¸Šçš„ä¸€äº›å±æ€§ï¼ŒåŒ…æ‹¬ï¼šexcludeã€includeç­‰ã€‚</p><h3 id="NuxtLink"><a href="#NuxtLink" class="headerlink" title="NuxtLink"></a>NuxtLink</h3><p>è·¯ç”±è·³è½¬ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">NuxtLink</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span>&gt;</span>Home page<span class="tag">&lt;/<span class="name">NuxtLink</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨ nuxt ä¸­ NuxtLink æ˜¯é»˜è®¤<strong>é¢„å–</strong>çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨æµè§ˆå™¨ç©ºé—²çš„æ—¶å€™ï¼Œå°†ä¼šé¢„å–å¹¶åŠ è½½èµ„æºï¼Œä»¥ä¾¿ç”¨æˆ·ç‚¹å‡»é“¾æ¥æ—¶ä»–ä»¬å·²ç»å‡†å¤‡å¥½ã€‚</p><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥å…³é—­ prefetchã€‚</p><p>å±€éƒ¨å…³é—­ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">NuxtLink</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">no-prefetch</span>&gt;</span>About page not pre-fetched<span class="tag">&lt;/<span class="name">NuxtLink</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">NuxtLink</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">:prefetch</span>=<span class="string">&quot;false&quot;</span>&gt;</span>About page not pre-fetched<span class="tag">&lt;/<span class="name">NuxtLink</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å…¨å±€å…³é—­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">router</span>: &#123;</span><br><span class="line">    <span class="attr">prefetchLinks</span>: <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å±€éƒ¨å¼€å¯ï¼š</p><blockquote><p>Nuxt v2.10.0 ä¹‹å</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">NuxtLink</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">prefetch</span>&gt;</span>About page pre-fetched<span class="tag">&lt;/<span class="name">NuxtLink</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="linkActiveClass"><a href="#linkActiveClass" class="headerlink" title="linkActiveClass"></a>linkActiveClass</h3><p>nuxt é»˜è®¤é“¾æ¥æ¿€æ´»ç±»åæ˜¯ï¼š<code>nuxt-link-active</code></p><p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">router</span>: &#123;</span><br><span class="line">    <span class="attr">linkActiveClass</span>: <span class="string">&#x27;my-custom-active-link&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="client-only"><a href="#client-only" class="headerlink" title="client-only"></a>client-only</h3><p>æ˜¾ç¤ºä»…åœ¨å®¢æˆ·ç«¯æ¸²æŸ“çš„ç»„ä»¶ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sidebar</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">client-only</span> <span class="attr">placeholder</span>=<span class="string">&quot;Loading...&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- this component will only be rendered on client-side --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">comments</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">client-only</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ’æ§½ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sidebar</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">client-only</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- this component will only be rendered on client-side --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">comments</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- loading indicator, rendered on server-side --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">placeholder</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">comments-placeholder</span> /&gt;</span>        </span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">client-only</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>æœ‰æ—¶åœ¨æœåŠ¡å™¨æ¸²æŸ“çš„é¡µé¢ä¸­ï¼Œå³ä½¿ä½¿ç”¨ $nextTickï¼Œ<code>&lt;client-only&gt;</code> ä¸­çš„ $refs ä¹Ÿå¯èƒ½è¿˜æ²¡æœ‰å‡†å¤‡å¥½ã€‚æŠ€å·§å¯èƒ½æ˜¯å¤šæ¬¡è°ƒç”¨ $nextTickï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">initClientOnlyComp</span>()</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  <span class="title function_">initClientOnlyComp</span>(<span class="params">count = <span class="number">10</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">myComp</span>) &#123;</span><br><span class="line">        <span class="comment">//...</span></span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">initClientOnlyComp</span>(count - <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></blockquote><blockquote><p>åœ¨ Nuxt &lt; v2.9.0 ä¸­å¯ä»¥ä½¿ç”¨ <code>&lt;no-ssr&gt;</code> æ›¿ä»£ <code>&lt;client-only&gt;</code></p></blockquote><h2 id="éè·¯ç”±ç»„ä»¶"><a href="#éè·¯ç”±ç»„ä»¶" class="headerlink" title="éè·¯ç”±ç»„ä»¶"></a>éè·¯ç”±ç»„ä»¶</h2><h3 id="è‡ªåŠ¨å¯¼å…¥"><a href="#è‡ªåŠ¨å¯¼å…¥" class="headerlink" title="è‡ªåŠ¨å¯¼å…¥"></a>è‡ªåŠ¨å¯¼å…¥</h3><p>nuxt ä¸­æ”¯æŒè‡ªåŠ¨å¼•å…¥ï¼Œåœ¨å…¨å±€é…ç½®çš„ component å±æ€§è¿›è¡Œé…ç½®ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">components</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç»„ä»¶å‘½å"><a href="#ç»„ä»¶å‘½å" class="headerlink" title="ç»„ä»¶å‘½å"></a>ç»„ä»¶å‘½å</h3><p>éè·¯ç”±ç»„ä»¶çš„å‘½åæ˜¯åŸºäºæ–‡ä»¶å¤¹åå’Œæ–‡ä»¶åç”Ÿæˆçš„ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">| components/</span><br><span class="line">--| base/</span><br><span class="line">----| foo/</span><br><span class="line">------| Button.vue</span><br><span class="line"></span><br><span class="line">/** æœ€ç»ˆçš„ç»„ä»¶å */</span><br><span class="line">&lt;BaseFooButton /&gt;</span><br></pre></td></tr></table></figure><blockquote><p>å»ºè®®è¿˜æ˜¯å°†æœ€ç»ˆçš„ç»„ä»¶åæå‰æ ¹æ®æ–‡ä»¶å¤¹å‘½åä¸€è‡´ã€‚</p></blockquote><p>å¿½ç•¥æŸä¸ªæ–‡ä»¶å¤¹å¯¹å‘½åçš„å½±å“ï¼Œå¯é€šè¿‡ component ä¸‹çš„ dirs è¿›è¡Œé…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">components: &#123;</span><br><span class="line">  <span class="built_in">dirs</span>: [</span><br><span class="line">    <span class="string">&#x27;~/components&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;~/components/base&#x27;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ‡’åŠ è½½"><a href="#æ‡’åŠ è½½" class="headerlink" title="æ‡’åŠ è½½"></a>æ‡’åŠ è½½</h3><p>nuxt ä¸­æ‡’åŠ è½½ç›´æ¥åœ¨ç»„ä»¶å‰é¢åŠ ä¸Š Lazy å³å¯ã€‚</p><p>æ‡’åŠ è½½çš„ç»„ä»¶åœ¨æ‰“åŒ…çš„è¿‡ç¨‹ä¸­å°†ä¼šè¢«å•ç‹¬åˆ†å—å„¿æ‰“åŒ…ï¼Œè¿™å°†ä¼˜åŒ–æ‰“åŒ…çš„å¤§å°ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Mountains<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">LazyMountainsList</span> <span class="attr">v-if</span>=<span class="string">&quot;show&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-if</span>=<span class="string">&quot;!show&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;show = true&quot;</span>&gt;</span>Show List<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">show</span>: <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="è¿‡æ¸¡"><a href="#è¿‡æ¸¡" class="headerlink" title="è¿‡æ¸¡"></a>è¿‡æ¸¡</h2><p>ä½œç”¨äºè·¯ç”±ï¼Œè¿‡æ¸¡åŠ¨æ•ˆã€‚</p><p>æœ‰ä¸‰ç§å†™æ³•ï¼šstringã€objectã€functionã€‚</p><p>é»˜è®¤çš„å…¨å±€ transition-name ä¸º pageã€‚</p><h3 id="string"><a href="#string" class="headerlink" title="string"></a>string</h3><p>string ç±»å‹ä¸»è¦é…ç½® transition çš„ nameï¼Œåç»­æ ¹æ® .name-enter-active ç­‰ç±»åç¼–å†™ css åŠ¨æ•ˆã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  transition: &#x27;home&#x27;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;transition name=&quot;home&quot;&gt;&lt;/transition&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">  .home-enter-active, .home-leave-active &#123; transition: opacity .5s; &#125;</span><br><span class="line">  .home-enter, .home-leave-active &#123; opacity: 0; &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h3 id="object"><a href="#object" class="headerlink" title="object"></a>object</h3><p>å¯¹è±¡é…ç½®çš„å±æ€§ç›¸å¯¹ string å°±å¤šäº†ä¸€äº›ï¼Œæ¯”å¦‚ï¼šnameã€modeã€durationç­‰ç­‰ï¼Œä»¥åŠå¯ä»¥è°ƒç”¨ä¸€äº›<a href="https://v2.vuejs.org/v2/guide/transitions.html#JavaScript-Hooks">é’©å­å‡½æ•°</a>ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">transition</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;home&#x27;</span>,</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&#x27;out-in&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">transition</span>: &#123;</span><br><span class="line">    <span class="title function_">afterLeave</span>(<span class="params">el</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;afterLeave&#x27;</span>, el)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="function"><a href="#function" class="headerlink" title="function"></a>function</h3><p>èƒ½å¤Ÿè·å–åˆ°è·¯ç”±ä¿¡æ¯ï¼štoã€fromã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">transition</span>(<span class="params">to, <span class="keyword">from</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">from</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">&#x27;slide-left&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> +to.<span class="property">query</span>.<span class="property">page</span> &lt; +<span class="keyword">from</span>.<span class="property">query</span>.<span class="property">page</span> ? <span class="string">&#x27;slide-right&#x27;</span> : <span class="string">&#x27;slide-left&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…¨å±€é…ç½®-1"><a href="#å…¨å±€é…ç½®-1" class="headerlink" title="å…¨å±€é…ç½®"></a>å…¨å±€é…ç½®</h3><p>nuxt.config.js çš„å…¨å±€è¿‡æ¸¡é…ç½®ä¸»è¦æœ‰ä¿©ï¼šlayoutTransitionã€pageTransitionã€‚</p><p>å†™æ³•å’Œä¸Šè¿°ä¸€è‡´ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">layoutTransition</span>: <span class="string">&#x27;my-layouts&#x27;</span></span><br><span class="line">  <span class="comment">// or</span></span><br><span class="line">  <span class="attr">layoutTransition</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;my-layouts&#x27;</span>,</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&#x27;out-in&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">pageTransition</span>: <span class="string">&#x27;my-page&#x27;</span></span><br><span class="line">  <span class="comment">// or</span></span><br><span class="line">  <span class="attr">pageTransition</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;my-page&#x27;</span>,</span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&#x27;out-in&#x27;</span>,</span><br><span class="line">    beforeEnter (el) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Before enter...&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶"></a>ä¸­é—´ä»¶</h2><p>nuxt ä¸­å¯å®šä¹‰ä¸€äº›è‡ªå®šä¹‰å‡½æ•°ä½œä¸ºä¸­é—´ä»¶ï¼Œåœ¨ï¼ˆä¸€ç»„ï¼‰é¡µé¢æ¸²æŸ“å‰æ‰§è¡Œã€‚</p><p>å…±äº«çš„ä¸­é—´ä»¶åº”å½“æ”¾ç½®åœ¨ <code>/middleware</code> ä¸‹ï¼Œæ–‡ä»¶ååˆ™æ˜¯ä¸­é—´ä»¶çš„åç§°ã€‚</p><p>æ¯ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°å¯æ¥æ”¶ä¸€ä¸ª context å‚æ•°ã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸­é—´ä»¶å°†åœ¨é¦–æ¬¡æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆç¬¬ä¸€æ¬¡è¯·æ±‚ nuxt app æˆ–è€… åˆ·æ–°é¡µé¢ï¼‰æ—¶ä»¥åŠå®¢æˆ·ç«¯è·¯ç”±è·³è½¬æ—¶æ‰§è¡Œã€‚</p><p>å¤šä¸ªä¸­é—´ä»¶çš„æ‰§è¡Œé¡ºåºï¼š</p><ol><li>nuxt.config.js ä¸­çš„å…¨å±€ä¸­é—´ä»¶</li><li>layouts ä¸­çš„ä¸­é—´ä»¶</li><li>pages ä¸­çš„ä¸­é—´ä»¶</li></ol><h3 id="Router-Middleware"><a href="#Router-Middleware" class="headerlink" title="Router Middleware"></a>Router Middleware</h3><p>ç±»ä¼¼è·¯ç”±å®ˆå«ï¼Œéœ€è¦åœ¨ nuxt.config.js ä¸­ router æ¨¡å—ä¸‹é…ç½®ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** middleware/stats.js */</span></span><br><span class="line"><span class="keyword">import</span> http <span class="keyword">from</span> <span class="string">&#x27;http&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> (<span class="params">&#123; route &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> http.<span class="title function_">post</span>(<span class="string">&#x27;http://my-stats-api.com&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">url</span>: route.<span class="property">fullPath</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** nuxt.config.js */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">router</span>: &#123;</span><br><span class="line">    <span class="attr">middleware</span>: <span class="string">&#x27;stats&#x27;</span> <span class="comment">// middleware: [&quot;stats&quot;],</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åŒ¿åä¸­é—´ä»¶"><a href="#åŒ¿åä¸­é—´ä»¶" class="headerlink" title="åŒ¿åä¸­é—´ä»¶"></a>åŒ¿åä¸­é—´ä»¶</h3><p>å±€éƒ¨ä¸­é—´ä»¶ï¼Œç›´æ¥åœ¨ç‰¹æ®Šçš„é¡µé¢ä¸­ç›´æ¥é€šè¿‡ middleware é…ç½®å½“å‰é¡µé¢çš„ä¸­é—´ä»¶ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Secret page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">middleware</span>(<span class="params">&#123; store, redirect &#125;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// If the user is not authenticated</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (!store.<span class="property">state</span>.<span class="property">authenticated</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="title function_">redirect</span>(<span class="string">&#x27;/login&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="æ’ä»¶"><a href="#æ’ä»¶" class="headerlink" title="æ’ä»¶"></a>æ’ä»¶</h2><p>nuxt ä¸­çš„æ’ä»¶ç³»ç»Ÿä¸»è¦åŠŸèƒ½æ¶µç›–ï¼šå…¨å±€æ³¨å…¥ã€Vue æ’ä»¶ã€å¤–éƒ¨åŒ…ï¼ˆæ¨¡å—ï¼‰ï¼Œåœ¨ <code>/plugins</code> ä¸­è¿›è¡Œç®¡ç†ã€‚</p><p><img src="https://v2.nuxt.com/_nuxt/image/5d7783.svg" alt="img"></p><h3 id="inject"><a href="#inject" class="headerlink" title="inject"></a>inject</h3><p>nuxt å…è®¸é€šè¿‡ <code>inject(key, value)</code> å®ç°å°†ä¸€äº›å‡½æ•°æˆ–å˜é‡æ³¨å…¥è´¯ç©¿æ•´ä¸ªåº”ç”¨ä¸­ï¼Œæ³¨å…¥åˆ° $root ä»¥åŠ context å½“ä¸­ã€‚</p><blockquote><p>é‡è¦çš„æ˜¯ Vue çš„ç”Ÿå‘½å‘¨æœŸä¸­åªæœ‰ beforeCreate å’Œ created é’©å­èƒ½åœ¨å®¢æˆ·ç«¯ä»¥åŠæœåŠ¡ç«¯ä¸­è¢«è°ƒç”¨ï¼Œå…¶ä»–çš„éƒ½åªèƒ½åœ¨å®¢æˆ·ç«¯ä¸­è°ƒç”¨ã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** plugins/hello.js */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (&#123; app &#125;, inject) =&gt; &#123;</span><br><span class="line">  <span class="comment">// Inject $hello(msg) in Vue, context and store.</span></span><br><span class="line">  <span class="title function_">inject</span>(<span class="string">&#x27;hello&#x27;</span>, <span class="function"><span class="params">msg</span> =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Hello <span class="subst">$&#123;msg&#125;</span>!`</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** nuxt.config.js */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="string">&#x27;~/plugins/hello.js&#x27;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** example-component.vue */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.$hello(<span class="string">&#x27;mounted&#x27;</span>)</span><br><span class="line">    <span class="comment">// will console.log &#x27;Hello mounted!&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">asyncData</span>(<span class="params">&#123; app, $hello &#125;</span>) &#123;</span><br><span class="line">    $hello(<span class="string">&#x27;asyncData&#x27;</span>)</span><br><span class="line">    <span class="comment">// If using Nuxt &lt;= 2.12, use ğŸ‘‡</span></span><br><span class="line">    app.$hello(<span class="string">&#x27;asyncData&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Vue-Plugins"><a href="#Vue-Plugins" class="headerlink" title="Vue Plugins"></a>Vue Plugins</h3><p>ä¸åŸç”Ÿçš„ Vue æ’ä»¶å®‰è£…ä¸€æ ·ï¼Œé€šè¿‡ <code>Vue.use()</code> è¿›è¡Œå®‰è£…ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** plugins/vue-tooltip.js */</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">VTooltip</span> <span class="keyword">from</span> <span class="string">&#x27;v-tooltip&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">VTooltip</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/** nuxt.config.js */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [<span class="string">&#x27;~/plugins/vue-tooltip.js&#x27;</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äº ES6 çš„æ¨¡å—ï¼Œå¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶ä¸‹ build.transpile è¿›è¡Œ babel è½¬ä¹‰ä¸º ES5ã€‚ </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">build</span>: &#123;</span><br><span class="line">    <span class="attr">transpile</span>: [<span class="string">&#x27;vue-tooltip&#x27;</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Client-or-Server-side-only"><a href="#Client-or-Server-side-only" class="headerlink" title="Client or Server side only"></a>Client or Server side only</h3><ol><li><p>é€šè¿‡ç‰¹æ®Šå‘½ååç¼€</p><p><code>xxx.client.js</code> æˆ– <code>xxx.server.js</code> å¯é™åˆ¶æ’ä»¶çš„æ‰§è¡ŒåŒºåŸŸã€‚</p></li><li><p>é…ç½®ä¸‹ plugins æ¨¡å—æ¯ä¸ªæ’ä»¶é€šè¿‡å¯¹è±¡çš„å½¢å¼é…ç½®ï¼Œå¹¶é…ç½® modeã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    &#123; <span class="attr">src</span>: <span class="string">&#x27;~/plugins/both-sides.js&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">src</span>: <span class="string">&#x27;~/plugins/client-only.js&#x27;</span>, <span class="attr">mode</span>: <span class="string">&#x27;client&#x27;</span> &#125;, <span class="comment">// only on client side</span></span><br><span class="line">    &#123; <span class="attr">src</span>: <span class="string">&#x27;~/plugins/server-only.js&#x27;</span>, <span class="attr">mode</span>: <span class="string">&#x27;server&#x27;</span> &#125; <span class="comment">// only on server side</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="extendPlugins"><a href="#extendPlugins" class="headerlink" title="extendPlugins"></a>extendPlugins</h3><p>é…ç½®æ–‡ä»¶ä¸­ extendPlugins æ¨¡å—å¯è¿›è¡Œå¯¹å½“å‰ plugins é…ç½®è¿›è¡Œç¼–ç¨‹å¼å¤„ç†ï¼ˆæ’åºã€åˆ é™¤ï¼‰ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** nuxt.config.js */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">extendPlugins</span>(<span class="params">plugins</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> pluginIndex = plugins.<span class="title function_">findIndex</span>(</span><br><span class="line">      <span class="function">(<span class="params">&#123; src &#125;</span>) =&gt;</span> src === <span class="string">&#x27;~/plugins/shouldBeFirst.js&#x27;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">const</span> shouldBeFirstPlugin = plugins[pluginIndex]</span><br><span class="line"></span><br><span class="line">    plugins.<span class="title function_">splice</span>(pluginIndex, <span class="number">1</span>)</span><br><span class="line">    plugins.<span class="title function_">unshift</span>(shouldBeFirstPlugin)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> plugins</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
          <category> Nuxt </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œåŸºç¡€ OSI ç½‘é™…äº’è”</title>
      <link href="/2023/02/26/Work/Eccom/CCNA%20(%20R&amp;S%20)/"/>
      <url>/2023/02/26/Work/Eccom/CCNA%20(%20R&amp;S%20)/</url>
      
        <content type="html"><![CDATA[<h1 id="ç½‘ç»œåŸºç¡€-OSI-ç½‘é™…äº’è”"><a href="#ç½‘ç»œåŸºç¡€-OSI-ç½‘é™…äº’è”" class="headerlink" title="ç½‘ç»œåŸºç¡€ OSI ç½‘é™…äº’è”"></a>ç½‘ç»œåŸºç¡€ OSI ç½‘é™…äº’è”</h1><h2 id="å¤§çº²"><a href="#å¤§çº²" class="headerlink" title="å¤§çº²"></a>å¤§çº²</h2><ul><li>ç½‘ç»œæ¦‚å¿µ</li><li>ç½‘é™…äº’è”</li><li>OSI ä¸ƒå±‚æ¨¡å‹</li></ul><h2 id="ç½‘ç»œçš„æ¦‚å¿µ"><a href="#ç½‘ç»œçš„æ¦‚å¿µ" class="headerlink" title="ç½‘ç»œçš„æ¦‚å¿µ"></a>ç½‘ç»œçš„æ¦‚å¿µ</h2><h3 id="ip"><a href="#ip" class="headerlink" title="ip"></a>ip</h3><p>ä»»ä½•é€šä¿¡èŠ‚ç‚¹ï¼Œåœ¨ç½‘ç»œå½“ä¸­çš„æ ‡è¯†ç¬¦</p><h3 id="hub"><a href="#hub" class="headerlink" title="hub"></a>hub</h3><p>æ•°æ®é€šä¿¡å†²çªï¼Œå…±äº«èµ„æº</p><h3 id="äº¤æ¢æœº"><a href="#äº¤æ¢æœº" class="headerlink" title="äº¤æ¢æœº"></a>äº¤æ¢æœº</h3><p>ç«¯å£æœ‰ç‹¬ç«‹å¸¦å®½ï¼Œä¸å†²çª</p><p><code>å¹¿æ’­åŸŸ == ç½‘æ®µ</code></p><h3 id="è·¯ç”±å™¨"><a href="#è·¯ç”±å™¨" class="headerlink" title="è·¯ç”±å™¨"></a>è·¯ç”±å™¨</h3><p>æ•°æ®è½¬å‘</p><p><img src="https://s2.loli.net/2023/02/23/MORBhLxezPNtYHb.png" alt="image-20230223103447248"></p><ul><li>è·¯ç”±åè®®æ”¯æŒ</li><li>æ•°æ®è½¬å‘</li><li>å¹¿åŸŸç½‘é“¾è·¯æ”¯æŒ</li></ul><p>å±€åŸŸç½‘ï¼šæœ¬åœ°åŒºåŸŸç§æœ‰ç½‘ç»œã€åŸåŸŸç½‘ã€å¹¿åŸŸç½‘</p><h2 id="OSI-ç½‘é™…äº’è”"><a href="#OSI-ç½‘é™…äº’è”" class="headerlink" title="OSI ç½‘é™…äº’è”"></a>OSI ç½‘é™…äº’è”</h2><p>Open System Intercinnect æ¡†æ¶ &#x2F; æ¨¡å‹</p><ul><li><p>åº”ç”¨å±‚</p><ul><li>å®šä¹‰ç¨‹åºæ¥å£</li></ul></li><li><p>è¡¨ç¤ºå±‚</p><ul><li>æ•°æ®è½¬æ¢ã€åŠ å¯†ã€å‹ç¼©</li></ul></li><li><p>ä¼šè¯å±‚</p><ul><li>å»ºç«‹ã€ç®¡ç†å’Œç»ˆæ­¢ä¼šè¯</li></ul></li><li><p>ä¼ è¾“å±‚</p><ul><li>æä¾›å¯é çš„ç«¯åˆ°ç«¯çš„æŠ¥æ–‡ä¼ è¾“å’Œå·®é”™æ§åˆ¶</li></ul></li><li><p>ç½‘ç»œå±‚ï¼ˆip ã€ç½‘æ®µè€ƒè™‘ã€‘ï¼‰</p><ul><li>å°†åˆ†ç»„ä»æºç«¯ä¼ é€åˆ°ç›®çš„ç«¯ï¼Œæä¾›ç½‘ç»œäº’è”</li><li>å¯»å€</li><li>è·¯ç”±å™¨</li></ul></li><li><p>æ•°æ®é“¾è·¯å±‚ï¼ˆmacã€å±€åŸŸç½‘è€ƒè™‘ã€‘ &#x3D;&#x3D; æœ¬åœ°ï¼‰</p><ul><li>åœ¨ä¸å¯é çš„ç‰©ç†é“¾è·¯ä¸Šï¼Œæä¾›å¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼ŒæŠŠå¸§ä»ä¸€è·³ç§»åŠ¨åˆ°å¦ä¸€è·³ï¼ˆç»“ç‚¹ï¼‰</li><li>ç»„å¸§ã€ç‰©ç†ç¼–å€ã€æµé‡æ§åˆ¶ã€å·®é”™æ§åˆ¶ã€æ¥å…¥æ§åˆ¶</li><li>äº¤æ¢æœº<ul><li>æ¯ä¸ªç«¯å£ç‹¬ç«‹å†²çªåŸŸ</li><li>æ•´ä¸ªäº¤æ¢æœºæ˜¯ä¸€ä¸ªå¹¿æ’­åŸŸ</li></ul></li></ul></li><li><p>ç‰©ç†å±‚</p><ul><li>è´Ÿè´£æŠŠé€ä¸€çš„æ¯”ç‰¹è¿›è¡Œä¼ é€’</li><li><h2 id="é›†çº¿å™¨-åŒæ„å†²çªåŸŸ-å…±äº«ç½‘ç»œå¸¦å®½"><a href="#é›†çº¿å™¨-åŒæ„å†²çªåŸŸ-å…±äº«ç½‘ç»œå¸¦å®½" class="headerlink" title="é›†çº¿å™¨- åŒæ„å†²çªåŸŸ- å…±äº«ç½‘ç»œå¸¦å®½"></a>é›†çº¿å™¨<br>- åŒæ„å†²çªåŸŸ<br>- å…±äº«ç½‘ç»œå¸¦å®½</h2></li></ul></li></ul><blockquote><p>ip ç±»ä¼¼ èº«ä»½è¯ï¼Œåœ¨æŸä¸ªç½‘æ®µè€ƒè™‘</p><p>mac ç±»ä¼¼ åå­—ï¼Œåœ¨å±€åŸŸç½‘è€ƒè™‘ï¼Œæœ¬åœ°ï¼Œä¸€èˆ¬å‚å•†çƒ§å½•åœ¨ç½‘å¡ä¸Šçš„</p></blockquote><p><img src="https://s2.loli.net/2023/03/02/AGtnYgDJ2ks5MBP.png" alt="image-20230302153453021"></p><h2 id="TCP-x2F-IP"><a href="#TCP-x2F-IP" class="headerlink" title="TCP&#x2F;IP"></a>TCP&#x2F;IP</h2><h3 id="DOD"><a href="#DOD" class="headerlink" title="DOD"></a>DOD</h3><ul><li>åº”ç”¨å±‚</li><li>ä¸»æœºåˆ°ä¸»æœºå±‚<ul><li>TCPï¼ˆä¼ è¾“æ§åˆ¶åè®®ï¼‰å±äºé¢å‘è¿æ¥çš„ç½‘ç»œåè®®<ul><li>é¢å‘è¿æ¥</li><li>å¯é ä¼ è¾“</li><li>æµæ§</li><li>web æµè§ˆå™¨ã€ç”µå­é‚®ä»¶ã€æ–‡ä»¶ä¼ è¾“</li></ul></li><li>UDPï¼ˆç”¨æˆ·æŠ¥æ–‡åè®®ï¼‰å±äºæ— è¿æ¥çš„ç½‘ç»œåè®®<ul><li>æ— è¿æ¥</li><li>ä¸å¯é </li><li>è§†é¢‘é€šè¯ã€åŸŸåç³»ç»Ÿã€IP è¯­éŸ³</li></ul></li></ul></li><li>å› ç‰¹ç½‘å±‚</li><li>ç½‘ç»œæ¥å…¥å±‚</li></ul><blockquote><p>ç«¯å£å·ï¼š åŒºåˆ†æœ¬åœ°æœåŠ¡æˆ–è€…åº”ç”¨ç¨‹åºã€ç‰©ç†æ¥å£ ~65535</p></blockquote><h3 id="ä¸‰æ¬¡æ¡æ‰‹"><a href="#ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="ä¸‰æ¬¡æ¡æ‰‹"></a>ä¸‰æ¬¡æ¡æ‰‹</h3><p><img src="https://s2.loli.net/2023/03/04/yuXLloJDs8qe2WO.png" alt="image-20230304123827160"></p><ul><li>ç¡®å®š A å‘é€èƒ½åŠ›</li><li>ç¡®å®š B æ¥æ”¶èƒ½åŠ›</li><li>ç¡®å®š B å‘é€èƒ½åŠ›</li><li>ç¡®å®š A æ¥æ”¶èƒ½åŠ›</li></ul><h3 id="çª—å£æœºåˆ¶"><a href="#çª—å£æœºåˆ¶" class="headerlink" title="çª—å£æœºåˆ¶"></a>çª—å£æœºåˆ¶</h3><p><img src="https://s2.loli.net/2023/03/04/TJS93Cn5BGkDqvw.png" alt="image-20230304124203658"></p><ul><li>æ»‘åŠ¨çª—å£</li><li>è¿ç»­ä¼ è¾“</li><li>è¿ç»­æ¥æ”¶</li></ul><h3 id="ARP-åè®®"><a href="#ARP-åè®®" class="headerlink" title="ARP åè®®"></a>ARP åè®®</h3><ul><li><p>IPv4 åœ°å€è§£æä¸º MAC åœ°å€</p></li><li><p>ç»´æŠ¤æ˜ å°„çš„ç¼“å­˜</p></li><li><p>A -&gt; å±€åŸŸç½‘ -&gt; è·¯ç”±å™¨ -&gt; å¹¿åŸŸç½‘ -&gt; è·¯ç”±å™¨ -&gt; å±€åŸŸç½‘ -&gt; B</p><p>(mac, ip)â€”â€”â€“ipâ€”â€”â€”â€“ipâ€”â€”â€”-ipâ€”â€”â€”-ipâ€”â€”â€”ipâ€”â€”â€”(mac, ip)</p></li></ul><h2 id="VLSM"><a href="#VLSM" class="headerlink" title="VLSM"></a>VLSM</h2><p><code>å¯å˜å­ç½‘æ©ç </code></p><p>ipï¼š ç½‘ç»œå· + ä¸»æœºå·</p><p>127.0.0.1 ç‰¹æ®Šï¼Œæœ¬åœ°å›ç¯ï¼Œæµ‹è¯•æœ¬åœ°åè®®æ˜¯å¦å®‰è£…æˆåŠŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Work </category>
          
          <category> Eccom </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç½‘ç»œ </tag>
            
            <tag> Eccom </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é˜¿é‡Œäº‘åŸ¹è®­ - MySQLåŸºç¡€</title>
      <link href="/2023/02/23/Work/Eccom/%E9%98%BF%E9%87%8C%E4%BA%91%E5%9F%B9%E8%AE%AD/MySQL%E5%9F%BA%E7%A1%80/"/>
      <url>/2023/02/23/Work/Eccom/%E9%98%BF%E9%87%8C%E4%BA%91%E5%9F%B9%E8%AE%AD/MySQL%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h1 id="MySQL-åŸºç¡€"><a href="#MySQL-åŸºç¡€" class="headerlink" title="MySQL åŸºç¡€"></a>MySQL åŸºç¡€</h1><h2 id="MySQL-ä»‹ç»"><a href="#MySQL-ä»‹ç»" class="headerlink" title="MySQL ä»‹ç»"></a>MySQL ä»‹ç»</h2><p><strong>å…³ç³»å‹æ•°æ®åº“</strong>ç®¡ç†ç³»ç»Ÿ</p><p>ä½“ç§¯å°ã€é€Ÿåº¦å¿«ã€æ€»ä½“æ‹¥æœ‰æˆæœ¬ä½</p><h2 id="MySQL-å­˜å‚¨å¼•æ“"><a href="#MySQL-å­˜å‚¨å¼•æ“" class="headerlink" title="MySQL å­˜å‚¨å¼•æ“"></a>MySQL å­˜å‚¨å¼•æ“</h2><ol><li><p>MyISAM</p><p>MySQL 5.0 ä»¥å‰é»˜è®¤çš„æ•°æ®åº“å¼•æ“ï¼Œæœ€å¸¸ç”¨ï¼Œæ‹¥æœ‰è¾ƒé«˜çš„æ’å…¥ã€æŸ¥è¯¢é€Ÿåº¦ï¼Œè›‹ä¸æ”¯æŒäº‹åŠ¡ã€‚</p></li><li><p>InnoDB</p><p>äº‹åŠ¡å‹æ•°æ®åº“çš„é¦–é€‰å¼•æ“ï¼Œæ”¯æŒ ACID äº‹åŠ¡ï¼Œæ”¯æŒè¡Œçº§é”å®šï¼ŒMySQL 5.5 èµ·æˆä¸ºé»˜è®¤æ•°æ®åº“å¼•æ“ã€‚</p></li><li><p>MEMORY</p><p>MEMORY å­˜å‚¨å¼•æ“æä¾› â€œå†…å­˜è¡¨â€ï¼Œä¹Ÿä¸æ”¯æŒäº‹åŠ¡ã€å¤–é”®ã€‚</p></li><li><p>ARCHIVE</p><p>ARCHIVE å­˜å‚¨å¼•æ“æ˜¯è¢«è®¾è®¡ç”¨æ¥å­˜å‚¨ä¼ä¸šä¸­çš„å¤§é‡æµæ°´æ•°æ®çš„å­˜å‚¨å¼•æ“ã€‚</p></li></ol><h2 id="MySQL-ç³»ç»Ÿå‘½ä»¤"><a href="#MySQL-ç³»ç»Ÿå‘½ä»¤" class="headerlink" title="MySQL ç³»ç»Ÿå‘½ä»¤"></a>MySQL ç³»ç»Ÿå‘½ä»¤</h2><h3 id="MySQL-æœåŠ¡ç®¡ç†"><a href="#MySQL-æœåŠ¡ç®¡ç†" class="headerlink" title="MySQL æœåŠ¡ç®¡ç†"></a>MySQL æœåŠ¡ç®¡ç†</h3><ol><li><p>æœåŠ¡çŠ¶æ€æŸ¥è¯¢</p><p><code>service mysqld status</code></p></li><li><p>å¯åŠ¨æœåŠ¡</p><p><code>service mysqld start</code></p></li><li><p>åœæ­¢æœåŠ¡</p><p><code>service mysqld stop</code></p></li><li><p>æ£€æŸ¥ MySQL ç«¯å£</p><p><code>netstat -antulp | grep mysqld</code></p></li></ol><h3 id="å¸¸ç”¨æŒ‡ä»¤"><a href="#å¸¸ç”¨æŒ‡ä»¤" class="headerlink" title="å¸¸ç”¨æŒ‡ä»¤"></a>å¸¸ç”¨æŒ‡ä»¤</h3><ol><li><p>è·å–å¸®åŠ©</p><p><code>help(\?)</code></p></li><li><p>é€‰æ‹©æ•°æ®åº“</p><p><code>use(\u)</code></p></li><li><p>æ‰§è¡Œ SQL æ–‡ä»¶</p><p><code>source(\.)</code></p></li><li><p>æ¸…ç©ºå½“å‰çš„è¾“å…¥è¯­å¥</p><p><code>clear(\c)</code></p></li></ol><h3 id="å…ƒæ•°æ®æŸ¥è¯¢"><a href="#å…ƒæ•°æ®æŸ¥è¯¢" class="headerlink" title="å…ƒæ•°æ®æŸ¥è¯¢"></a>å…ƒæ•°æ®æŸ¥è¯¢</h3><ol><li><p>æœåŠ¡å™¨ç‰ˆæœ¬ä¿¡æ¯</p><p><code>SELECT VERSION()</code></p></li><li><p>å½“å‰æ•°æ®åº“å</p><p><code>SELECT DATABASE()</code></p></li><li><p>å½“å‰ç”¨æˆ·å</p><p><code>SELECT USER()</code></p></li><li><p>æœåŠ¡å™¨é…ç½®å˜é‡</p><p><code>SHOW VARIABLES</code></p></li><li><p>æœåŠ¡å™¨çŠ¶æ€</p><p><code>SHOW STATUS</code></p></li></ol><h3 id="MySQL-é…ç½®æ–‡ä»¶"><a href="#MySQL-é…ç½®æ–‡ä»¶" class="headerlink" title="MySQL é…ç½®æ–‡ä»¶"></a>MySQL é…ç½®æ–‡ä»¶</h3><ol><li><p>MySQL é…ç½®æ–‡ä»¶é»˜è®¤è·¯å¾„</p><p><code>/etc/my.cnf</code></p></li><li><p>å¸¸ç”¨é…ç½®å‚æ•°</p><p><code>basedir</code> â€”â€” MySQL æ ¹ç›®å½•</p><p><code>datadir</code> â€”â€” æ•°æ®åº“æ–‡ä»¶ç›®å½•</p><p><code>socket</code> â€”â€” ä¸º MySQL å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´æœ¬åœ°é€šä¿¡æŒ‡å®šçš„ä¸€ä¸ªå¥—æ¥å­—æ–‡ä»¶</p><p><code>character-set-server</code> â€”â€” æ–°æ•°æ®åº“æˆ–æ•°æ®åº“çš„é»˜è®¤å­—ç¬¦é›†</p></li></ol><h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><p><code>Structured Query Language</code></p><h3 id="è¯­æ³•ç»„æˆ"><a href="#è¯­æ³•ç»„æˆ" class="headerlink" title="è¯­æ³•ç»„æˆ"></a>è¯­æ³•ç»„æˆ</h3><ol><li><p>DML</p><p>æŸ¥è¯¢ã€æ’å…¥ã€åˆ é™¤å’Œä¿®æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚</p><p>SELECTã€INSERTã€UPDATEã€DELETE ç­‰ã€‚</p></li><li><p>DCL</p><p>ç”¨æ¥æ§åˆ¶å­˜å–è®¸å¯ã€å­˜å–æƒé™ç­‰ã€‚</p><p>GRANTã€REVOKE ç­‰ã€‚</p></li><li><p>DDL</p><p>ç”¨æ¥å»ºç«‹æ•°æ®åº“ã€æ•°æ®åº“å¯¹è±¡å’Œå®šä¹‰å…¶åˆ—ã€‚</p><p>CREATE TABLEã€DROP TABLEã€ALTER TABLE ç­‰ã€‚</p></li><li><p>åŠŸèƒ½å‡½æ•°</p><p>æ—¥æœŸå‡½æ•°ã€æ•°æ®å‡½æ•°ã€å­—ç¬¦å‡½æ•°ã€ç³»ç»Ÿå‡½æ•°ç­‰ã€‚</p></li></ol><h3 id="æ•°æ®åº“æ“ä½œ"><a href="#æ•°æ®åº“æ“ä½œ" class="headerlink" title="æ•°æ®åº“æ“ä½œ"></a>æ•°æ®åº“æ“ä½œ</h3><ol><li><p>æ˜¾ç¤ºæ•°æ®åº“</p><p><code>show databases;</code></p></li><li><p>é€‰æ‹©æ“ä½œæ•°æ®åº“</p><p><code>use &lt;dbname&gt;;</code></p></li><li><p>åˆ›å»ºæ•°æ®åº“</p><p><code>create database &lt;dbname&gt; [charset=utf8];</code></p></li><li><p>æ˜¾ç¤ºæ•°æ®åº“åˆ›å»ºè¯­å¥</p><p><code>show create database &lt;dbname&gt;;</code></p></li><li><p>åˆ é™¤æ•°æ®åº“</p><p><code>drop &lt;dbname&gt;;</code></p></li><li><p>æ˜¾ç¤ºæ•°æ®åº“ä¸­åˆ›å»ºçš„æ‰€æœ‰è¡¨</p><p><code>show tables;</code></p></li><li><p>æ˜¾ç¤ºè¡¨ç»“æ„</p><p><code>desc[rive] &lt;tbname&gt;;</code></p><p><code>show colums from &lt;tbname&gt;;</code></p></li><li><p>ç°å®æ•°æ®è¡¨åˆ›å»ºè¯­å¥</p><p><code>show create table &lt;tbname&gt;;</code></p></li></ol><h3 id="MySQL-æ•°æ®ç±»å‹"><a href="#MySQL-æ•°æ®ç±»å‹" class="headerlink" title="MySQL æ•°æ®ç±»å‹"></a>MySQL æ•°æ®ç±»å‹</h3><h4 id="æ•°å€¼ç±»å‹"><a href="#æ•°å€¼ç±»å‹" class="headerlink" title="æ•°å€¼ç±»å‹"></a>æ•°å€¼ç±»å‹</h4><h4 id="è‡ªå¢ç±»å‹-auto-increment"><a href="#è‡ªå¢ç±»å‹-auto-increment" class="headerlink" title="è‡ªå¢ç±»å‹ - auto_increment"></a>è‡ªå¢ç±»å‹ - auto_increment</h4><ol><li><p>å­—æ®µå€¼æ¯æ¬¡è‡ªåŠ¨å¢é•¿ 1ã€‚</p></li><li><p>è‡ªå¢å‹çš„æ•´æ•°å­—æ®µ</p><p>åªé€‚ç”¨äºæ•´æ•°ï¼Œåœ¨æ•°æ®ç±»å‹ååŠ  auto_increment å…³é”®å­—è¡¨ç¤ºã€‚å¦‚ï¼š<code>smallint unsigned auto_increment;</code></p></li></ol><p>æ³¨æ„ï¼š</p><ol><li><p>mysql ä¸­æ¯ä¸ªè¡¨åªèƒ½è®¾ç½®ä¸€ä¸ªè‡ªå¢å­—æ®µã€‚</p></li><li><p>è¯¥åˆ—å¿…é¡»æ˜¯ NOT NULL</p></li><li><p>è¯¥åˆ—å¿…é¡»å®šä¹‰å”¯ä¸€ç´¢å¼•ï¼Œå¦‚é€æ¸ primary key æˆ–å”¯ä¸€é”® unique keyï¼Œä»¥é¿å…é‡å¤ã€‚</p></li><li><p>è¯¥åˆ—çš„æœ€å¤§å€¼å—å…¶æ•°æ®ç±»å‹çº¦æŸã€‚å¦‚ tinyint å‹çš„æœ€å¤§åªä¸º 127ï¼ŒåŠ ä¸Š unsignedï¼Œåˆ™ä¸º 255.ä¸€å•æ‰“åˆ°ä¸Šé™ï¼Œauto_increment å°±ä¼šå¤±æ•ˆã€‚</p></li></ol><h4 id="å°æ•°ç±»å‹-decimal"><a href="#å°æ•°ç±»å‹-decimal" class="headerlink" title="å°æ•°ç±»å‹ - decimal"></a>å°æ•°ç±»å‹ - decimal</h4><ol><li>å°æ•°å¯é€šè¿‡ unsigned è®¾ç½®ä¸ºéè´Ÿæ•°ã€‚</li><li><code>decimal(m,d)</code> è¡¨ç¤ºè¿°èŒä¸­å…±æœ‰ m ä½æ•°ï¼Œå…¶ä¸­æ•´æ•° m-d ä½ï¼Œå°æ•° d ä½ã€‚</li></ol><p>å¦‚ï¼š <code>decimal(5,2)</code>ï¼Œå–å€¼èŒƒå›´ä¸ºï¼š-999.99 ~ 999.99ã€‚</p><h4 id="å­—ç¬¦ä¸²ç±»å‹"><a href="#å­—ç¬¦ä¸²ç±»å‹" class="headerlink" title="å­—ç¬¦ä¸²ç±»å‹"></a>å­—ç¬¦ä¸²ç±»å‹</h4><p><img src="https://s2.loli.net/2023/05/23/muMqIx8z27laOZv.png" alt="image-20230523143815654"></p><ol><li>CHARï¼šå®šé•¿å­—ç¬¦ä¸²</li><li>VARCHARï¼šå˜é•¿å­—ç¬¦ä¸²</li><li>TEXTï¼šé•¿æ–‡æœ¬æ•°æ®</li></ol><h4 id="æ—¥æœŸå’Œæ—¶é—´ç±»å‹"><a href="#æ—¥æœŸå’Œæ—¶é—´ç±»å‹" class="headerlink" title="æ—¥æœŸå’Œæ—¶é—´ç±»å‹"></a>æ—¥æœŸå’Œæ—¶é—´ç±»å‹</h4><p><img src="https://s2.loli.net/2023/05/23/tgZNQjeXYnVP4K7.png" alt="image-20230523144009500"></p><ol><li>DATEï¼šæ—¥æœŸå€¼</li><li>DATETIMEï¼šæ··åˆæ—¥æœŸå’Œæ—¶é—´å€¼</li></ol><h3 id="æ•°æ®è¡¨åˆ›å»º"><a href="#æ•°æ®è¡¨åˆ›å»º" class="headerlink" title="æ•°æ®è¡¨åˆ›å»º"></a>æ•°æ®è¡¨åˆ›å»º</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tbname (</span><br><span class="line">    id <span class="type">int</span> auto_increment <span class="keyword">primary</span> key,</span><br><span class="line">  name <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">  sex tinyint <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">  birthday <span class="type">date</span> <span class="keyword">not</span> <span class="keyword">null</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="ä¸´æ—¶è¡¨"><a href="#ä¸´æ—¶è¡¨" class="headerlink" title="ä¸´æ—¶è¡¨"></a>ä¸´æ—¶è¡¨</h3><p>ä¿å­˜ä¸€äº›ä¸´æ—¶æ•°æ®æ—¶ä½¿ç”¨çš„è¡¨</p><p><code>create TEMPORARY tbname (xxx);</code></p><p>ç‰¹æ€§ï¼š</p><ol><li>ä¸´æ—¶è¡¨åªåœ¨<strong>å½“å‰</strong>è¿æ¥å¯è§</li><li>å½“å…³é—­è¿æ¥æ—¶ï¼ŒMySQL ä¼š<strong>è‡ªåŠ¨åˆ é™¤</strong>è¡¨å¹¶é‡Šæ”¾æ‰€æœ‰ç©ºé—´ã€‚</li></ol><h3 id="æ•°æ®æ“ä½œ"><a href="#æ•°æ®æ“ä½œ" class="headerlink" title="æ•°æ®æ“ä½œ"></a>æ•°æ®æ“ä½œ</h3><p><strong>CRUD</strong></p><h4 id="æ–°å¢æ•°æ®"><a href="#æ–°å¢æ•°æ®" class="headerlink" title="æ–°å¢æ•°æ®"></a>æ–°å¢æ•°æ®</h4><p><code>INSERT [INFO] &lt;è¡¨å&gt;(&lt;åˆ—å&gt;) VALUES(&lt;å€¼åˆ—è¡¨&gt;)ï¼›</code></p><h4 id="æŸ¥è¯¢æ•°æ®"><a href="#æŸ¥è¯¢æ•°æ®" class="headerlink" title="æŸ¥è¯¢æ•°æ®"></a>æŸ¥è¯¢æ•°æ®</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT [DISTINCET | DISTINCTROW | ALL] select_expression [</span><br><span class="line">    FROM table_references //æŒ‡å®šæŸ¥è¯¢æ•°æ®çš„è¡¨</span><br><span class="line">        [WHERE where_definition] //æŸ¥è¯¢æ•°æ®çš„è¿‡æ»¤æ¡ä»¶</span><br><span class="line">        [GROUP BY col_name,...] // å¯¹åŒ¹é… where å­å¥çš„æŸ¥è¯¢ç»“æœè¿›è¡Œåˆ†ç»„</span><br><span class="line">        [HAVING where_definition] //å¯¹åˆ†ç»„åçš„ç»“æœè¿›è¡Œæ¡ä»¶é™åˆ¶</span><br><span class="line">        [ORDER BY &#123;unsigned_integer | col_name | formula&#125; [ASC | DESC],...] // å¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œæ’åº</span><br><span class="line">        [LIMIT [offset] rows] //å¯¹æŸ¥è¯¢çš„æ˜¾ç¤ºç»“æœé™åˆ¶æ•°ç›®</span><br><span class="line">        [PROCEDURE procedure_name] //æŸ¥è¯¢å­˜å‚¨è¿‡ç¨‹è¿”å›çš„ç»“æœé›†æ•°æ®</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h5 id="SQL-é›†å‡½æ•°"><a href="#SQL-é›†å‡½æ•°" class="headerlink" title="SQL é›†å‡½æ•°"></a>SQL é›†å‡½æ•°</h5><p>ä¸»è¦é›†å‡½æ•°ï¼š</p><ol><li>è®°æ•°å‡½æ•°ï¼š<code>count(åˆ—å)</code> è®¡ç®—å…ƒç´ çš„ä¸ªæ•°ã€‚</li><li>æ±‚å’Œå‡½æ•°ï¼š<code>sum(åˆ—å)</code> å¯¹æŸä¸€åˆ—çš„å€¼æ±‚å’Œï¼Œä½†å±æ€§å¿…é¡»æ˜¯æ•´æ•°ã€‚</li><li>è®¡ç®—å¹³å‡å€¼ï¼š<code>avg(åˆ—å)</code> å¯¹æŸä¸€åˆ—çš„å€¼è®¡ç®—å¹³å‡å€¼ã€‚</li><li>æ±‚æœ€å¤§å€¼ï¼š<code>max(åˆ—å)</code> æ‰¾å‡ºæŸä¸€åˆ—çš„æœ€å¤§å€¼ã€‚</li><li>æ±‚æœ€å°å€¼ï¼š<code>min(åˆ—å)</code> æ‰¾å‡ºæŸä¸€åˆ—æœ€å°å€¼ã€‚</li></ol><h5 id="WHERE"><a href="#WHERE" class="headerlink" title="WHERE"></a>WHERE</h5><p>è°“è¯­ï¼š</p><ol><li><code>BETWEEN AND</code>ï¼šåœ¨ä¸¤æ•°ä¹‹é—´ã€‚</li><li><code>NOT BETWEEN AND</code>ï¼šä¸åœ¨ä¸¤æ•°ä¹‹é—´ã€‚</li><li><code>IN &lt;å€¼è¡¨&gt;</code>ï¼šæ˜¯å¦åœ¨ç‰¹å®šçš„é›†åˆé‡Œé¢ï¼ˆæšä¸¾ï¼‰ã€‚</li><li><code>NOT IN &lt;å€¼è¡¨&gt;</code>ï¼šä¸ä¸Šé¢ç›¸åã€‚</li><li><code>LIKE</code>ï¼š æ˜¯å¦åŒ¹é…ä¸ä¸€ä¸ªæ¨¡å¼ã€‚</li><li><code>IS NULLï¼ˆä¸ºç©ºï¼‰æˆ– IS NOT NULLï¼ˆä¸ä¸ºç©ºï¼‰ REGEXP</code>ï¼šæ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦åŒ¹é…ä¸€ä¸ªå¸¸è§„è¡¨è¾¾å¼ã€‚</li></ol><h4 id="å¤šè¡¨æŸ¥è¯¢"><a href="#å¤šè¡¨æŸ¥è¯¢" class="headerlink" title="å¤šè¡¨æŸ¥è¯¢"></a>å¤šè¡¨æŸ¥è¯¢</h4><ol><li><p>è¿æ¥æŸ¥è¯¢</p><p>åŒæ—¶æ¶‰åŠå¤šä¸ªè¡¨çš„æŸ¥è¯¢ç§°ä¸ºè¿æ¥æŸ¥è¯¢</p><p>ç”¨æ¥è¿æ¥ä¸¤ä¸ªè¡¨çš„æ¡ä»¶ç§°ä¸ºè¿æ¥æ¡ä»¶</p></li><li><p>è¿æ¥æŸ¥è¯¢çš„æ–¹å¼</p><ol><li>å†…è¿æ¥</li><li>å¤–è¿æ¥<ol><li>å·¦å¤–è¿æ¥</li><li>å³å¤–è¿æ¥</li></ol></li><li>æŸ¥è¯¢ç»“æœåˆå¹¶</li><li>å­æŸ¥è¯¢</li></ol></li></ol><h5 id="å†…è¿æ¥ï¼ˆINER-JOINï¼‰"><a href="#å†…è¿æ¥ï¼ˆINER-JOINï¼‰" class="headerlink" title="å†…è¿æ¥ï¼ˆINER JOINï¼‰"></a>å†…è¿æ¥ï¼ˆINER JOINï¼‰</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> S.SName,C.score</span><br><span class="line"><span class="keyword">From</span> Score <span class="keyword">AS</span> C</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> Students <span class="keyword">AS</span> S</span><br><span class="line"><span class="keyword">ON</span> C.Student_id <span class="operator">=</span> S.student_id</span><br><span class="line">## <span class="keyword">or</span></span><br><span class="line"><span class="keyword">SELECT</span> S.SName,C.score</span><br><span class="line"><span class="keyword">From</span> Score <span class="keyword">AS</span> C, Students <span class="keyword">AS</span> S</span><br><span class="line"><span class="keyword">Where</span> c.Student_id <span class="operator">=</span> S.Student_id;</span><br></pre></td></tr></table></figure><h5 id="å¤–è¿æ¥-å·¦è¿æ¥"><a href="#å¤–è¿æ¥-å·¦è¿æ¥" class="headerlink" title="å¤–è¿æ¥ - å·¦è¿æ¥"></a>å¤–è¿æ¥ - å·¦è¿æ¥</h5><p>ä»¥ä¸€å¼ è¡¨ä¸ºä¸­å¿ƒï¼Œå¾€å¤–æ‰¾ï¼Œæ‰¾åˆ°è¿”å›ï¼Œæœªæ‰¾åˆ°è¿”å›<code>null</code>ã€‚</p><p>åšå¤–è¿ä»¥å‰é¢çš„è¡¨ä½œä¸ºä¸»è¡¨ï¼Œè¿”å›æ‰€æœ‰ä¸»è¡¨ä¸­çš„æ‰€æœ‰è¡Œã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sname,number</span><br><span class="line"><span class="keyword">FROM</span> student <span class="keyword">AS</span> S</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> score <span class="keyword">AS</span> C</span><br><span class="line"><span class="keyword">ON</span> S.sid <span class="operator">=</span> C.student_id;</span><br></pre></td></tr></table></figure><h5 id="å¤–è¿æ¥-å³è¿æ¥"><a href="#å¤–è¿æ¥-å³è¿æ¥" class="headerlink" title="å¤–è¿æ¥ - å³è¿æ¥"></a>å¤–è¿æ¥ - å³è¿æ¥</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sname,number</span><br><span class="line"><span class="keyword">FROM</span> student <span class="keyword">AS</span> S</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> score <span class="keyword">AS</span> C</span><br><span class="line"><span class="keyword">ON</span> S.sid <span class="operator">=</span> C.student_id;</span><br></pre></td></tr></table></figure><h5 id="åˆå¹¶æŸ¥è¯¢æ•°æ®è®°å½•"><a href="#åˆå¹¶æŸ¥è¯¢æ•°æ®è®°å½•" class="headerlink" title="åˆå¹¶æŸ¥è¯¢æ•°æ®è®°å½•"></a>åˆå¹¶æŸ¥è¯¢æ•°æ®è®°å½•</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t1</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> t2</span><br></pre></td></tr></table></figure><h5 id="å­æŸ¥è¯¢"><a href="#å­æŸ¥è¯¢" class="headerlink" title="å­æŸ¥è¯¢"></a>å­æŸ¥è¯¢</h5><p>é€šä¿—è¯´ï¼Œå°±æ˜¯åµŒå¥—æŸ¥è¯¢ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sname <span class="keyword">FROM</span> student</span><br><span class="line"><span class="keyword">WHERE</span> age <span class="operator">&gt;</span> (<span class="keyword">SELECT</span> age <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> sname<span class="operator">=</span><span class="string">&#x27;èµµå…­&#x27;</span>);</span><br></pre></td></tr></table></figure><h4 id="ä¿®æ”¹æ•°æ®"><a href="#ä¿®æ”¹æ•°æ®" class="headerlink" title="ä¿®æ”¹æ•°æ®"></a>ä¿®æ”¹æ•°æ®</h4><p>è¯­æ³•ï¼š<code>UPDATE &lt;è¡¨å&gt; SET &lt;åˆ—å = æ›´æ–°å€¼&gt; [WHERE &lt;æ›´æ–°æ¡ä»¶&gt;]</code></p><h4 id="æ•°æ®åˆ é™¤"><a href="#æ•°æ®åˆ é™¤" class="headerlink" title="æ•°æ®åˆ é™¤"></a>æ•°æ®åˆ é™¤</h4><p>è¯­æ³•ï¼š<code>DELETE FROM &lt;è¡¨å&gt; [WHERE &lt;æ›´æ–°æ¡ä»¶&gt;]</code></p><blockquote><p><strong>ç”Ÿäº§ç¯å¢ƒç¦æ­¢ä½¿ç”¨ UPDATE å’Œ DELETE</strong>ï¼Œä¸”åœ¨ä½¿ç”¨æ—¶éœ€è¦äº› WHEREï¼Œå¦åˆ™å°†ä¿®æ”¹æ•´å¼ è¡¨çš„æ•°æ®ï¼Œä¸”æ— æ³•ä¿®å¤ã€‚</p></blockquote><h2 id="æ—¥å¿—æŸ¥çœ‹"><a href="#æ—¥å¿—æŸ¥çœ‹" class="headerlink" title="æ—¥å¿—æŸ¥çœ‹"></a>æ—¥å¿—æŸ¥çœ‹</h2><ol><li><p>é”™è¯¯æ—¥å¿—</p><p>è®°å½• MySQL æœåŠ¡å™¨å¯åŠ¨ã€å…³é—­å’Œè¿è¡Œæ—¶å‡ºé”™ç­‰ä¿¡æ¯ã€‚</p></li><li><p>æŸ¥è¯¢æ—¥å¿—</p><p>è®°å½• MySQL æœåŠ¡å™¨çš„å¯åŠ¨å’Œå…³é—­ä¿¡æ¯ã€å®¢æˆ·ç«¯çš„è¿æ¥ä¿¡æ¯ã€æ›´æ–°æ•°æ®åº“è®°å½• SQL è¯­å¥å’ŒæŸ¥è¯¢æ•°æ®åº“è®°å½• SQL è¯­å¥ã€‚</p></li><li><p>æ…¢æŸ¥è¯¢æ—¥å¿—</p><p>è®°å½•æ‰§è¡Œæ—¶é—´è¶…è¿‡æŒ‡å®šæ—¶é—´çš„æŸ¥è¯¢è¯­å¥ï¼Œé€šè¿‡å·¥å…·åˆ†ææ…¢æŸ¥è¯¢æ—¥å¿—å¼€ä¸€å®šä½ MySQL æœåŠ¡å™¨æ€§èƒ½ç“¶é¢ˆæ‰€åœ¨ã€‚</p></li><li><p>äºŒè¿›åˆ¶æ—¥å¿—</p><p>ä»¥äºŒè¿›åˆ¶å½¢å¼è®°å½•æ•°æ®åº“çš„å„ç§æ“ä½œï¼Œä½†ä¸è®°å½•æŸ¥è¯¢è¯­å¥ã€‚</p></li></ol><h3 id="é”™è¯¯æ—¥å¿—"><a href="#é”™è¯¯æ—¥å¿—" class="headerlink" title="é”™è¯¯æ—¥å¿—"></a>é”™è¯¯æ—¥å¿—</h3><p>æ—¥å¿—è·¯å¾„ï¼š<code>mysql&gt; show variables like &#39;log_error&#39;</code></p><p>é»˜è®¤è·¯å¾„ä¸ºï¼š<code>/var/log/mysqld.log</code></p><h3 id="æ…¢æŸ¥è¯¢æ—¥å¿—"><a href="#æ…¢æŸ¥è¯¢æ—¥å¿—" class="headerlink" title="æ…¢æŸ¥è¯¢æ—¥å¿—"></a>æ…¢æŸ¥è¯¢æ—¥å¿—</h3><p>æ—¥å¿—è·¯å¾„ï¼š<code>show variables like &#39;slow_query_log%&#39;</code></p><p><img src="https://s2.loli.net/2023/05/24/dj58HGVAXLJFlZo.png" alt="image-20230524152158771"></p><h2 id="å¤‡ä»½è¿˜åŸ"><a href="#å¤‡ä»½è¿˜åŸ" class="headerlink" title="å¤‡ä»½è¿˜åŸ"></a>å¤‡ä»½è¿˜åŸ</h2><h3 id="æ•°æ®å¤‡ä»½"><a href="#æ•°æ®å¤‡ä»½" class="headerlink" title="æ•°æ®å¤‡ä»½"></a>æ•°æ®å¤‡ä»½</h3><p><code>mysqldump</code> æ˜¯ mysql ç”¨äºè½¬å­˜å‚¨æ•°æ®åº“çš„å®ç”¨ç¨‹åºã€‚</p><p>äº§ç”Ÿä¸€ä¸ª SQL è„šæœ¬ã€‚</p><p>è¯­æ³•ï¼š<code>mysqldump -u root -p Password [databaseName]</code></p><blockquote><p>å€¼å¤‡ä»½æ‰€æœ‰è¡¨ï¼Œä¸åŒ…æ‹¬æ•°æ®åº“æœ¬èº«ã€‚</p></blockquote><h3 id="æ•°æ®è¿˜åŸ"><a href="#æ•°æ®è¿˜åŸ" class="headerlink" title="æ•°æ®è¿˜åŸ"></a>æ•°æ®è¿˜åŸ</h3><ol><li><p>mysql å‘½ä»¤å¯¼å…¥</p><p><code>mysql -u root -p password &lt; sqlæ–‡ä»¶</code></p></li><li><p>source</p><p><code>source sqlæ–‡ä»¶</code></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> Work </category>
          
          <category> Eccom </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é˜¿é‡Œäº‘åŸ¹è®­ </tag>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é˜¿é‡Œäº‘åŸ¹è®­ - LinuxåŸºç¡€</title>
      <link href="/2023/02/22/Work/Eccom/%E9%98%BF%E9%87%8C%E4%BA%91%E5%9F%B9%E8%AE%AD/Linux%E5%9F%BA%E7%A1%80/"/>
      <url>/2023/02/22/Work/Eccom/%E9%98%BF%E9%87%8C%E4%BA%91%E5%9F%B9%E8%AE%AD/Linux%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h1 id="Linux-åŸºç¡€"><a href="#Linux-åŸºç¡€" class="headerlink" title="Linux åŸºç¡€"></a>Linux åŸºç¡€</h1><h2 id="å¸¸è§å‘½ä»¤"><a href="#å¸¸è§å‘½ä»¤" class="headerlink" title="å¸¸è§å‘½ä»¤"></a>å¸¸è§å‘½ä»¤</h2><h3 id="æŸ¥çœ‹æ–‡ä»¶"><a href="#æŸ¥çœ‹æ–‡ä»¶" class="headerlink" title="æŸ¥çœ‹æ–‡ä»¶"></a>æŸ¥çœ‹æ–‡ä»¶</h3><h4 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h4><p>ç”¨äºè¿æ¥æ–‡ä»¶å¹¶æ‰“å°åˆ°æ ‡å‡†è¾“å‡ºè®¾å¤‡ä¸Š</p><p><code>cat /etc/issue</code></p><h4 id="more"><a href="#more" class="headerlink" title="more"></a>more</h4><p>ç±»ä¼¼ cat å‘½ä»¤ï¼Œä»¥åˆ†é¡µçš„æ–¹å¼æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</p><p><code>more /etc/issue</code></p><h4 id="less"><a href="#less" class="headerlink" title="less"></a>less</h4><p>ä¸ more ç±»ä¼¼ï¼Œä½†ä½¿ç”¨ less å¯ä»¥éšæ„æµè§ˆæ–‡ä»¶</p><p><code>less /etc/issue</code></p><h4 id="head"><a href="#head" class="headerlink" title="head"></a>head</h4><p>ç”¨äºæ˜¾ç¤ºæ–‡ä»¶çš„å¼€å¤´è‡³æ ‡å‡†è¾“å‡ºä¸­</p><p><code>head -n 20 /etc/fstab</code></p><h4 id="tail"><a href="#tail" class="headerlink" title="tail"></a>tail</h4><p>ç”¨äºæ˜¾ç¤ºæ–‡ä»¶çš„æœ«ç«¯è‡³æ ‡å‡†è¾“å‡ºä¸­</p><p><code>tail-n 20 /etc/fstab</code></p><h3 id="vim-æ–‡æœ¬ç¼–è¾‘å™¨"><a href="#vim-æ–‡æœ¬ç¼–è¾‘å™¨" class="headerlink" title="vim æ–‡æœ¬ç¼–è¾‘å™¨"></a>vim æ–‡æœ¬ç¼–è¾‘å™¨</h3><p><img src="https://s2.loli.net/2023/05/18/PGNk7BQWReILlZr.png" alt="image-20230518145505809"></p><h4 id="å¸¸ç”¨æ¨¡å¼"><a href="#å¸¸ç”¨æ¨¡å¼" class="headerlink" title="å¸¸ç”¨æ¨¡å¼"></a>å¸¸ç”¨æ¨¡å¼</h4><ul><li>å‘½ä»¤æ¨¡å¼</li><li>æ’å…¥æ¨¡å¼</li><li>ex æ¨¡å¼</li><li>å¯è§†æ¨¡å¼</li></ul><h3 id="æ–‡æœ¬ç»Ÿè®¡"><a href="#æ–‡æœ¬ç»Ÿè®¡" class="headerlink" title="æ–‡æœ¬ç»Ÿè®¡"></a>æ–‡æœ¬ç»Ÿè®¡</h3><h4 id="wc"><a href="#wc" class="headerlink" title="wc"></a>wc</h4><p>ç”¨äºè®¡ç®—å­—æ•°</p><p><code>wc file</code></p><p><code>wc -l file</code></p><p><code>w|wc -l</code></p><h3 id="åˆ é™¤æ–‡æœ¬é‡å¤è¡Œ"><a href="#åˆ é™¤æ–‡æœ¬é‡å¤è¡Œ" class="headerlink" title="åˆ é™¤æ–‡æœ¬é‡å¤è¡Œ"></a>åˆ é™¤æ–‡æœ¬é‡å¤è¡Œ</h3><h4 id="uniq"><a href="#uniq" class="headerlink" title="uniq"></a>uniq</h4><p>ç”¨äºæ£€æŸ¥åŠåˆ é™¤æ–‡æœ¬æ–‡ä»¶ä¸­é‡å¤å‡ºç°çš„è¡Œåˆ—</p><p><code>uniq testfile</code> åˆ é™¤é‡å¤è¡Œ</p><p><code>uniq -c testfile</code> åˆ é™¤å¹¶ç»Ÿè®¡é‡å¤çš„è¡Œæ•°</p><p><code>uniq -d testfile</code>åªæ˜¾ç¤ºé‡å¤çš„è¡Œæ•°</p><h3 id="æ–‡æœ¬åˆ†æ"><a href="#æ–‡æœ¬åˆ†æ" class="headerlink" title="æ–‡æœ¬åˆ†æ"></a>æ–‡æœ¬åˆ†æ</h3><h4 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h4><p>å¤„ç†æ–‡æœ¬æ–‡ä»¶çš„è¯­è¨€ï¼Œå¼ºå¤§çš„æ–‡æœ¬åˆ†æå·¥å…·ã€‚</p><p>æŸ¥çœ‹ä¸ªæŒ‚è½½ç‚¹çš„å¯ç”¨ç©ºé—´ï¼š<code>df -h | awk &#39;print 1234&#39;</code></p><p>æŸ¥çœ‹æ¯ä¸ªç”¨æˆ·çš„ shellï¼š<code> awk -F &#39;:&#39; &#39;&#123;print $1, $7&#125;&#39; /etc/pawword</code></p><p>æŸ¥çœ‹é•¿åº¦å¤§äº 80 å­—èŠ‚çš„æ—¥å¿—ä¿¡æ¯ï¼š<code>awk &#39;length &gt; 80&#39; /var/log/messages</code></p><h3 id="æ–‡ä»¶æŸ¥æ‰¾"><a href="#æ–‡ä»¶æŸ¥æ‰¾" class="headerlink" title="æ–‡ä»¶æŸ¥æ‰¾"></a>æ–‡ä»¶æŸ¥æ‰¾</h3><h4 id="find"><a href="#find" class="headerlink" title="find"></a>find</h4><p><code>find . -name &#39;c&#39;</code></p><p><code>find . -type f</code></p><p><code>find . -ctime -20</code></p><h3 id="æŸ¥çœ‹å½“å‰ç›®å½•"><a href="#æŸ¥çœ‹å½“å‰ç›®å½•" class="headerlink" title="æŸ¥çœ‹å½“å‰ç›®å½•"></a>æŸ¥çœ‹å½“å‰ç›®å½•</h3><h4 id="pwd"><a href="#pwd" class="headerlink" title="pwd"></a>pwd</h4><p>æ˜¾ç¤ºå·¥ä½œç›®å½•</p><p><code>pwd [-L]</code></p><p><code>pwd -p</code></p><h4 id="pwdx"><a href="#pwdx" class="headerlink" title="pwdx"></a>pwdx</h4><p>æŸ¥çœ‹è¿›ç¨‹è¿è¡Œçš„ç›®å½•</p><p><code>pwdx PID</code></p><h3 id="æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ"><a href="#æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ"></a>æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ</h3><h3 id="mount"><a href="#mount" class="headerlink" title="mount"></a>mount</h3><p>æŒ‚åœ¨ Linux ç³»ç»Ÿå¤–çš„æ–‡ä»¶ã€‚</p><p><code>mount</code> æŸ¥çœ‹å½“å‰æ‰€æœ‰çš„æŒ‚è½½</p><p><code>mount /dev/sdb1/mnt</code></p><p><code>mount -o ro /dev/sdb1/mnt</code></p><p><code>mount -o loop /tmp/</code></p><h3 id="è¿›ç¨‹çŠ¶æ€"><a href="#è¿›ç¨‹çŠ¶æ€" class="headerlink" title="è¿›ç¨‹çŠ¶æ€"></a>è¿›ç¨‹çŠ¶æ€</h3><h4 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h4><p>æ˜¾ç¤ºå½“å‰è¿›ç¨‹çš„çŠ¶æ€</p><p><code>ps -ef | grep http</code></p><p><code>ps aux | grep http</code></p><p><code>ps -A</code></p><p><code>ps -u root</code></p><h4 id="top"><a href="#top" class="headerlink" title="top"></a>top</h4><p>å®æ—¶æŸ¥çœ‹è¿›ç¨‹çŠ¶æ€</p><p><code>top -p PID</code><br>å®æ—¶æŸ¥çœ‹æŸä¸€ä¸ªè¿›ç¨‹</p><h3 id="è¿›ç¨‹ç®¡ç†"><a href="#è¿›ç¨‹ç®¡ç†" class="headerlink" title="è¿›ç¨‹ç®¡ç†"></a>è¿›ç¨‹ç®¡ç†</h3><h4 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h4><p><code>kill PID</code></p><p><code>kill -9 PID</code></p><p>å¼ºåˆ¶ç»“æŸè¿›ç¨‹</p><h4 id="nohup"><a href="#nohup" class="headerlink" title="nohup"></a>nohup</h4><p>åå°è¿è¡Œè¿›ç¨‹</p><p><code>nohup ./start.sh &amp;</code></p><h3 id="æŸ¥çœ‹æ‰“å¼€æ–‡ä»¶"><a href="#æŸ¥çœ‹æ‰“å¼€æ–‡ä»¶" class="headerlink" title="æŸ¥çœ‹æ‰“å¼€æ–‡ä»¶"></a>æŸ¥çœ‹æ‰“å¼€æ–‡ä»¶</h3><h4 id="lsof"><a href="#lsof" class="headerlink" title="lsof"></a>lsof</h4><p>æŸ¥çœ‹è¿›ç¨‹æ‰“å¼€çš„æ–‡ä»¶ï¼Œæ‰“å¼€æ–‡ä»¶çš„è¿›ç¨‹ï¼Œè¿›ç¨‹æ‰“å¼€çš„ç«¯å£ï¼ˆTCPã€UDPï¼‰</p><p><code>lsof abc.txt</code></p><p><code>lsof -c abc</code></p><p><code>lsof -i 8080</code></p><h3 id="é…ç½®ä¸»æœºå"><a href="#é…ç½®ä¸»æœºå" class="headerlink" title="é…ç½®ä¸»æœºå"></a>é…ç½®ä¸»æœºå</h3><h4 id="hostname"><a href="#hostname" class="headerlink" title="hostname"></a>hostname</h4><p><code>hostname xxx</code></p><p>ä¸´æ—¶ä¿®æ”¹</p><h3 id="ç³»ç»Ÿè¿è¡Œæ—¶é—´"><a href="#ç³»ç»Ÿè¿è¡Œæ—¶é—´" class="headerlink" title="ç³»ç»Ÿè¿è¡Œæ—¶é—´"></a>ç³»ç»Ÿè¿è¡Œæ—¶é—´</h3><h4 id="uptime"><a href="#uptime" class="headerlink" title="uptime"></a>uptime</h4><p>æŸ¥çœ‹æœºå™¨å¯åŠ¨è¿è¡Œå¤šä¹…ã€è´Ÿè½½</p><h3 id="ç³»ç»Ÿç›‘æµ‹"><a href="#ç³»ç»Ÿç›‘æµ‹" class="headerlink" title="ç³»ç»Ÿç›‘æµ‹"></a>ç³»ç»Ÿç›‘æµ‹</h3><h4 id="tsar"><a href="#tsar" class="headerlink" title="tsar"></a>tsar</h4><p><code>tsar --swap --load</code></p><p>ç›‘æ§è™šæ‹Ÿå†…å­˜</p><p><code>tsar --mem</code></p><p>ç›‘æ§å†…å­˜</p><p><code>tsar --io</code></p><p>ç›‘æ§ io</p><p><code>tsar --traffic</code></p><p>ç›‘æ§ç½‘ç»œ</p><p><code>tsar --check --cpu --io</code></p><p>ç›‘æ§è­¦å‘Šä¿¡æ¯</p><h2 id="NTP"><a href="#NTP" class="headerlink" title="NTP"></a>NTP</h2><p>ç½‘ç»œæ—¶é—´åè®®</p><h3 id="NTPServer-çš„æ—¶é—´æ¥æº"><a href="#NTPServer-çš„æ—¶é—´æ¥æº" class="headerlink" title="NTPServer çš„æ—¶é—´æ¥æº"></a>NTPServer çš„æ—¶é—´æ¥æº</h3><ol><li>GPSã€åŒ—æ–—ç­‰å«æ˜Ÿç³»ç»Ÿ</li><li>åŸå­é’Ÿ</li><li>ç§»åŠ¨åŸºç«™</li><li>æ’æ¸©æ™¶æŒ¯</li></ol><h3 id="å®‰è£…-NTP"><a href="#å®‰è£…-NTP" class="headerlink" title="å®‰è£… NTP"></a>å®‰è£… NTP</h3><h4 id="æ£€æŸ¥æ˜¯å¦å®‰è£…"><a href="#æ£€æŸ¥æ˜¯å¦å®‰è£…" class="headerlink" title="æ£€æŸ¥æ˜¯å¦å®‰è£…"></a>æ£€æŸ¥æ˜¯å¦å®‰è£…</h4><p><code>rpm -q ntp</code></p><h4 id="å®‰è£…-NTP-1"><a href="#å®‰è£…-NTP-1" class="headerlink" title="å®‰è£… NTP"></a>å®‰è£… NTP</h4><p><code>yum install ntp</code></p><h3 id="é…ç½®-NTP-å®¢æˆ·ç«¯"><a href="#é…ç½®-NTP-å®¢æˆ·ç«¯" class="headerlink" title="é…ç½® NTP å®¢æˆ·ç«¯"></a>é…ç½® NTP å®¢æˆ·ç«¯</h3><p>é…ç½®æ–‡ä»¶ï¼š<code>/etc/ntp.conf</code></p><h3 id="NTP-æœåŠ¡ç®¡ç†"><a href="#NTP-æœåŠ¡ç®¡ç†" class="headerlink" title="NTP æœåŠ¡ç®¡ç†"></a>NTP æœåŠ¡ç®¡ç†</h3><p>æœåŠ¡çŠ¶æ€æŸ¥çœ‹ï¼š<code>service ntpd status</code></p><p>æœåŠ¡å¯ç”¨ï¼š<code>service ntpd start</code></p><p>æœåŠ¡é‡å¯ï¼š<code>service ntpd restart</code></p><p>æœåŠ¡å¼€å¯å¯åŠ¨ï¼š<code>service ntpd on</code></p><h3 id="NTP-å¸¸ç”¨å‘½ä»¤"><a href="#NTP-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="NTP å¸¸ç”¨å‘½ä»¤"></a>NTP å¸¸ç”¨å‘½ä»¤</h3><h4 id="æŸ¥è¯¢-NTP-æœåŠ¡å™¨æ—¶é—´"><a href="#æŸ¥è¯¢-NTP-æœåŠ¡å™¨æ—¶é—´" class="headerlink" title="æŸ¥è¯¢ NTP æœåŠ¡å™¨æ—¶é—´"></a>æŸ¥è¯¢ NTP æœåŠ¡å™¨æ—¶é—´</h4><p><code>ntpdate -q ntp1.aliyun.com</code></p><h4 id="æ£€æŸ¥-NTP-æ—¶é—´åŒæ­¥æƒ…å†µ"><a href="#æ£€æŸ¥-NTP-æ—¶é—´åŒæ­¥æƒ…å†µ" class="headerlink" title="æ£€æŸ¥ NTP æ—¶é—´åŒæ­¥æƒ…å†µ"></a>æ£€æŸ¥ NTP æ—¶é—´åŒæ­¥æƒ…å†µ</h4><p><code>ntpq -p</code></p><h2 id="è½¯ä»¶ç®¡ç†"><a href="#è½¯ä»¶ç®¡ç†" class="headerlink" title="è½¯ä»¶ç®¡ç†"></a>è½¯ä»¶ç®¡ç†</h2><h3 id="yum"><a href="#yum" class="headerlink" title="yum"></a>yum</h3><p>è‡ªåŠ¨å¤„ç†ä¾èµ–å…³ç³»ã€‚</p><h4 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h4><p><code>/etc/yum.repos.d/*.repo</code></p><ul><li>[åç§°] - yum æºåç§°</li><li>name - yum æºçš„æè¿°ä¿¡æ¯</li><li>baseurl - yum æºåœ°å€</li><li>gpgcheck - æ˜¯å¦æ£€æŸ¥ GPGKEy</li><li>enable - æ˜¯å¦å¯ç”¨</li></ul><h4 id="å¸¸ç”¨å‘½ä»¤"><a href="#å¸¸ç”¨å‘½ä»¤" class="headerlink" title="å¸¸ç”¨å‘½ä»¤"></a>å¸¸ç”¨å‘½ä»¤</h4><ul><li><p>æŸ¥çœ‹å¯ç”¨åŒ…ç‰ˆæœ¬</p><p><code>yum list packname</code></p></li><li><p>å®‰è£…</p><p><code>yum install packname</code></p></li><li><p>æœç´¢</p><p><code>yum search xx</code></p></li><li><p>åˆ é™¤</p><p><code>yum remove packname</code></p></li></ul><h3 id="æºç ç¼–è¯‘å®‰è£…"><a href="#æºç ç¼–è¯‘å®‰è£…" class="headerlink" title="æºç ç¼–è¯‘å®‰è£…"></a>æºç ç¼–è¯‘å®‰è£…</h3><h2 id="DNS-è§£æ"><a href="#DNS-è§£æ" class="headerlink" title="DNS è§£æ"></a>DNS è§£æ</h2><h3 id="dig"><a href="#dig" class="headerlink" title="dig"></a>dig</h3><h4 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h4><p><code>dig aliyun.com</code></p><h4 id="æŸ¥çœ‹åå‘è§£æ"><a href="#æŸ¥çœ‹åå‘è§£æ" class="headerlink" title="æŸ¥çœ‹åå‘è§£æ"></a>æŸ¥çœ‹åå‘è§£æ</h4><p><code>dig -x 104.205.34.3</code></p><h4 id="ä»æ ¹æœåŠ¡å™¨å¼€å§‹è¿½è¸ªä¸€ä¸ªåŸŸåçš„è§£æè¿‡ç¨‹"><a href="#ä»æ ¹æœåŠ¡å™¨å¼€å§‹è¿½è¸ªä¸€ä¸ªåŸŸåçš„è§£æè¿‡ç¨‹" class="headerlink" title="ä»æ ¹æœåŠ¡å™¨å¼€å§‹è¿½è¸ªä¸€ä¸ªåŸŸåçš„è§£æè¿‡ç¨‹"></a>ä»æ ¹æœåŠ¡å™¨å¼€å§‹è¿½è¸ªä¸€ä¸ªåŸŸåçš„è§£æè¿‡ç¨‹</h4><p><code>dig +trace aliyun.com</code></p><h3 id="nslookup"><a href="#nslookup" class="headerlink" title="nslookup"></a>nslookup</h3><h4 id="ç›´æ¥æŸ¥è¯¢"><a href="#ç›´æ¥æŸ¥è¯¢" class="headerlink" title="ç›´æ¥æŸ¥è¯¢"></a>ç›´æ¥æŸ¥è¯¢</h4><p><code>nslookup aliyun.com</code></p><h4 id="åå‘æŸ¥è¯¢"><a href="#åå‘æŸ¥è¯¢" class="headerlink" title="åå‘æŸ¥è¯¢"></a>åå‘æŸ¥è¯¢</h4><p><code>nslookup ip</code></p><h3 id="DNS-é—®é¢˜æ’æŸ¥æ€è·¯"><a href="#DNS-é—®é¢˜æ’æŸ¥æ€è·¯" class="headerlink" title="DNS é—®é¢˜æ’æŸ¥æ€è·¯"></a>DNS é—®é¢˜æ’æŸ¥æ€è·¯</h3><ul><li><p>ç”¨æˆ·ä¸èƒ½è®¿é—®ï¼Œè¿ç»´å¯è®¿é—®</p><ul><li>ç”¨æˆ· DNS è®¾ç½®é—®é¢˜</li></ul></li><li><p>ç”¨æˆ·ä¸è¿ç»´éƒ½ä¸èƒ½è®¿é—®</p><ul><li><p>æ£€æŸ¥ DNS æœåŠ¡æ˜¯å¦èƒ½ ping é€š</p></li><li><p>æŸ¥çœ‹ DNS æœåŠ¡å™¨çš„ 53 ç«¯å£æ˜¯å¦å¯ç”¨</p><p><code>telnet &lt;IP&gt; 53</code></p></li></ul></li></ul><h2 id="ç½‘ç»œé…ç½®"><a href="#ç½‘ç»œé…ç½®" class="headerlink" title="ç½‘ç»œé…ç½®"></a>ç½‘ç»œé…ç½®</h2><h3 id="æŸ¥çœ‹ç½‘ç»œ"><a href="#æŸ¥çœ‹ç½‘ç»œ" class="headerlink" title="æŸ¥çœ‹ç½‘ç»œ"></a>æŸ¥çœ‹ç½‘ç»œ</h3><h4 id="ifconfig"><a href="#ifconfig" class="headerlink" title="ifconfig"></a>ifconfig</h4><p>ç”¨äºæ˜¾ç¤ºæˆ–è®¾ç½®ç½‘ç»œè®¾å¤‡ã€‚</p><p>æŸ¥çœ‹æ´»åŠ¨ç½‘å¡ï¼š<code>ifconfig</code></p><p>æŸ¥çœ‹æŒ‡å®šç½‘å¡ï¼š<code>ifconfig eth0</code></p><p>æŸ¥çœ‹æ‰€æœ‰ç½‘å¡ï¼š<code>ifconfig -a</code></p><h4 id="netstat"><a href="#netstat" class="headerlink" title="netstat"></a>netstat</h4><p>æŸ¥çœ‹è·¯ç”±è¡¨ï¼š<code>netstat -rn ã€ route -n</code></p><p>æŸ¥çœ‹æŸç«¯å£ï¼š<code>netstat -antulp | grep ï¼š80</code></p><p>æŸ¥çœ‹æ‰€æœ‰ç›‘å¬ç«¯å£ï¼š<code>netstat -antulp | grep LISTEN</code></p><h4 id="ç½‘å¡é…ç½®æ–‡ä»¶"><a href="#ç½‘å¡é…ç½®æ–‡ä»¶" class="headerlink" title="ç½‘å¡é…ç½®æ–‡ä»¶"></a>ç½‘å¡é…ç½®æ–‡ä»¶</h4><p>æ–‡ä»¶ç›®å½•ï¼š<code>/etc/sysconfig/network-scripts/ifcfg-*</code></p><ul><li>IPADDR â€”â€” IP åœ°å€</li><li>NETMASK â€”â€” å­ç½‘æ©ç </li><li>GATEWAY â€”â€” ç½‘å…³</li></ul><h4 id="å…¨å±€ç½‘ç»œé…ç½®"><a href="#å…¨å±€ç½‘ç»œé…ç½®" class="headerlink" title="å…¨å±€ç½‘ç»œé…ç½®"></a>å…¨å±€ç½‘ç»œé…ç½®</h4><p>æ–‡ä»¶ç›®å½•ï¼š<code>/etc/sysconfig/network</code></p><ul><li>HOSTNAME â€”â€” ä¸»æœºå</li><li>GATEWAY â€”â€” é»˜è®¤ç½‘å…³</li></ul><h2 id="æ—¥å¿—æŸ¥çœ‹"><a href="#æ—¥å¿—æŸ¥çœ‹" class="headerlink" title="æ—¥å¿—æŸ¥çœ‹"></a>æ—¥å¿—æŸ¥çœ‹</h2><h3 id="ç³»ç»Ÿç™»å½•æ—¥å¿—"><a href="#ç³»ç»Ÿç™»å½•æ—¥å¿—" class="headerlink" title="ç³»ç»Ÿç™»å½•æ—¥å¿—"></a>ç³»ç»Ÿç™»å½•æ—¥å¿—</h3><p>ç™»å½•æˆåŠŸæ—¥å¿—ï¼š<code>last [userName]</code></p><p>ç™»å½•å¤±è´¥æ—¥å¿—ï¼š<code>lastb</code></p><p>å‘½ä»¤è®°å½•ï¼š<code>history</code></p><h3 id="å¸¸ç”¨æ—¥å¿—æ–‡ä»¶"><a href="#å¸¸ç”¨æ—¥å¿—æ–‡ä»¶" class="headerlink" title="å¸¸ç”¨æ—¥å¿—æ–‡ä»¶"></a>å¸¸ç”¨æ—¥å¿—æ–‡ä»¶</h3><p>ç³»ç»Ÿå¯åŠ¨åçš„ä¿¡æ¯å’Œé”™è¯¯æ—¥å¿—ï¼š<code>/var/log/message</code></p><p>å®‰å…¨ç›¸å…³çš„æ—¥å¿—ï¼š<code>/var/log/secure</code></p><p>å®šæ—¶ä»»åŠ¡ç›¸å…³çš„æ—¥å¿—ï¼š<code>/var/log/corn</code></p><p>å®ˆæŠ¤è¿›ç¨‹å¯åŠ¨å’Œåœæ­¢ç›¸å…³çš„æ—¥å¿—ï¼š<code>/var/log/boot.log</code></p><p>ç”¨æˆ·ç™»å½•ã€æ³¨é”€åŠç³»ç»Ÿå¯åŠ¨ã€åœæœºçš„äº‹ä»¶æ—¥å¿—ï¼š<code>/var/log/wtmp</code></p>]]></content>
      
      
      <categories>
          
          <category> Work </category>
          
          <category> Eccom </category>
          
      </categories>
      
      
        <tags>
            
            <tag> é˜¿é‡Œäº‘åŸ¹è®­ </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é˜¿é‡Œäº‘åŸ¹è®­ - ç½‘ç»œåŸºç¡€</title>
      <link href="/2023/02/21/Work/Eccom/%E9%98%BF%E9%87%8C%E4%BA%91%E5%9F%B9%E8%AE%AD/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/"/>
      <url>/2023/02/21/Work/Eccom/%E9%98%BF%E9%87%8C%E4%BA%91%E5%9F%B9%E8%AE%AD/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h1 id="ç½‘ç»œè™šæ‹ŸåŒ–"><a href="#ç½‘ç»œè™šæ‹ŸåŒ–" class="headerlink" title="ç½‘ç»œè™šæ‹ŸåŒ–"></a>ç½‘ç»œè™šæ‹ŸåŒ–</h1><h2 id="ç½‘ç»œè™šæ‹ŸåŒ–åè®®"><a href="#ç½‘ç»œè™šæ‹ŸåŒ–åè®®" class="headerlink" title="ç½‘ç»œè™šæ‹ŸåŒ–åè®®"></a>ç½‘ç»œè™šæ‹ŸåŒ–åè®®</h2><h3 id="VLAN"><a href="#VLAN" class="headerlink" title="VLAN"></a>VLAN</h3><h4 id="ç‰¹ç‚¹ï¼š"><a href="#ç‰¹ç‚¹ï¼š" class="headerlink" title="ç‰¹ç‚¹ï¼š"></a>ç‰¹ç‚¹ï¼š</h4><ul><li>å¤šä¸ªç”¨æˆ·å…±ç”¨ä¸€å¥—ç‰©ç†ç½‘ç»œç¯å¢ƒ</li><li>ä¸åŒç”¨æˆ·çš„ VM åˆ†åˆ«é‡‡ç”¨ä¸€ä¸ª VLAN</li><li>ä¸€å°ç‰©ç†æœºå¯ä»¥ä¸ºå¤šä¸ªç”¨æˆ·æœåŠ¡</li></ul><p><img src="https://s2.loli.net/2023/05/06/lwi8rjQn9xu3mzL.png" alt="image-20230506151205862"></p><h4 id="åè®®æŠ¥æ–‡"><a href="#åè®®æŠ¥æ–‡" class="headerlink" title="åè®®æŠ¥æ–‡"></a>åè®®æŠ¥æ–‡</h4><p><img src="https://s2.loli.net/2023/05/06/pveIHjhsU3gRBnm.png" alt="image-20230506151243605"></p><h4 id="å±€é™æ€§"><a href="#å±€é™æ€§" class="headerlink" title="å±€é™æ€§"></a>å±€é™æ€§</h4><ul><li>ç½‘ç»œè®¾å¤‡è§„æ ¼é™åˆ¶</li><li>ç”¨æˆ·è§„æ¨¡ç½‘ç»œåè®®é™åˆ¶</li><li>ç½‘ç»œéš”ç¦»ã€åˆ†ç¦»èƒ½åŠ›é™åˆ¶</li><li>æ— æ³•è‡ªå®šä¹‰ç½‘ç»œ</li></ul><h3 id="VXLAN"><a href="#VXLAN" class="headerlink" title="VXLAN"></a>VXLAN</h3><p>VXLAN æ˜¯ NVo3 ä¸­çš„ä¸€ç§ç½‘ç»œè™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œé‡‡ç”¨ MAC in UDP å°è£…æ–¹å¼ï¼Œå°†äºŒå±‚æŠ¥æ–‡ç”¨ä¸‰å±‚åè®®å°è£…ï¼Œå¯å¯¹äºŒå±‚ç½‘ç»œåœ¨ä¸‰å±‚èŒƒå›´è¿›è¡Œæ‰©å±•ï¼ŒåŒæ—¶æ”¯æŒ 24bits çš„ VNI ID ï¼ˆ16M ç§Ÿæˆ·èƒ½åŠ›ï¼‰ï¼Œæ»¡è¶³æ•°æ®ä¸­å¿ƒå¤§äºŒå±‚ VM è¿ç§»å’Œå¤šç§Ÿæˆ·çš„éœ€æ±‚</p><h4 id="åŸºæœ¬åŸç†"><a href="#åŸºæœ¬åŸç†" class="headerlink" title="åŸºæœ¬åŸç†"></a>åŸºæœ¬åŸç†</h4><p><img src="https://s2.loli.net/2023/05/06/8JA5FMt2Tlpogrj.png" alt="image-20230506151610837"></p><h4 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h4><ul><li>å¤šä¸ªç”¨æˆ·å…±ç”¨ä¸€å¥—ç‰©ç†ç½‘ç»œ</li><li>ä¸åŒç”¨æˆ· VM åˆ†åˆ«é‡‡ç”¨ä¸€ä¸ª VXLAN</li><li>ä¸€å°ç‰©ç†æœºå¯ä»¥ä¸ºå¤šä¸ªç”¨æˆ·æœåŠ¡</li></ul><h4 id="è§£å†³çš„é—®é¢˜"><a href="#è§£å†³çš„é—®é¢˜" class="headerlink" title="è§£å†³çš„é—®é¢˜"></a>è§£å†³çš„é—®é¢˜</h4><ul><li>è™šæ‹Ÿæœºè§„æ¨¡å—ç½‘ç»œè®¾å¤‡è§„æ ¼çš„é™åˆ¶</li><li>ç½‘ç»œéš”ç¦»èƒ½åŠ›é™åˆ¶</li><li>å¹¿æ’­ä¿¡æ¯æ³›æ´ª</li><li>ç”¨æˆ·å¯è‡ªå®šä¹‰ç½‘ç»œ</li></ul><h3 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h3><table><thead><tr><th align="center"></th><th>VLAN</th><th>VXLAN</th></tr></thead><tbody><tr><td align="center">åŸç†</td><td>ç”¨ VID æ¥åˆ’åˆ†ä¸åŒçš„ VLAN</td><td>ç”¨ç½‘ç»œæ ‡è¯† VNI åŒºåˆ† VXLAN æ®µ</td></tr><tr><td align="center">åè®®æ ‡å‡†</td><td>802.1Q</td><td>NVo3</td></tr><tr><td align="center">åº”ç”¨åœºæ™¯</td><td>å°†åŒä¸€ç½‘ç»œåˆ’åˆ†ä¸ºå¤šä¸ªé€»è¾‘ä¸Šçš„è™šæ‹Ÿå­ç½‘</td><td>å°†å¤„äºä¸åŒç½‘æ®µç½‘ç»œè®¾å¤‡æ•´åˆåœ¨åŒä¸€é€»è¾‘é“¾è·¯å±‚ç½‘ç»œä¸­</td></tr></tbody></table><h1 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h1><p>IP æŠ¥æ–‡å‘é€çš„è·¯å¾„ä¿¡æ¯</p><h2 id="å…³é”®åŠŸèƒ½"><a href="#å…³é”®åŠŸèƒ½" class="headerlink" title="å…³é”®åŠŸèƒ½"></a>å…³é”®åŠŸèƒ½</h2><ul><li>æ£€æŸ¥æ•°æ®åŒ…çš„ç›®çš„åœ°</li><li>ç¡®å®šä¿¡æ¯æº</li><li>å‘ç°å¯èƒ½çš„è·¯ç”±</li><li>é€‰æ‹©æœ€ä½³è·¯ç”±</li><li>éªŒè¯å’Œç»´æŠ¤è·¯ç”±ä¿¡æ¯</li></ul><h2 id="OSPF-åŸºæœ¬ç‰¹ç‚¹"><a href="#OSPF-åŸºæœ¬ç‰¹ç‚¹" class="headerlink" title="OSPF åŸºæœ¬ç‰¹ç‚¹"></a>OSPF åŸºæœ¬ç‰¹ç‚¹</h2><ul><li>æ”¯æŒ VLSM</li><li>æ”¯æŒåŒºåŸŸåˆ’åˆ†</li><li>è·¯ç”±å˜åŒ–æ”¶æ•›é€Ÿåº¦å¿«</li><li>ä½¿ç”¨ IP ç»„æ’­æ”¶å‘åè®®æ•°æ®</li><li>æ”¯æŒå¤šæ¡ç­‰å€¼è·¯ç”±</li><li>æ”¯æŒåè®®æŠ¥æ–‡çš„è®¤è¯</li></ul><h2 id="è·¯ç”±è®¡ç®—è¿‡ç¨‹ï¼ˆOSPFï¼‰"><a href="#è·¯ç”±è®¡ç®—è¿‡ç¨‹ï¼ˆOSPFï¼‰" class="headerlink" title="è·¯ç”±è®¡ç®—è¿‡ç¨‹ï¼ˆOSPFï¼‰"></a>è·¯ç”±è®¡ç®—è¿‡ç¨‹ï¼ˆOSPFï¼‰</h2><p><img src="https://s2.loli.net/2023/05/06/VGaZ27EqxHOIAzm.png" alt="image-20230506153203805"></p><h2 id="è·¯ç”±å¯ä¿¡åº¦é—®é¢˜â€”â€”ç®¡ç†è·ç¦»"><a href="#è·¯ç”±å¯ä¿¡åº¦é—®é¢˜â€”â€”ç®¡ç†è·ç¦»" class="headerlink" title="è·¯ç”±å¯ä¿¡åº¦é—®é¢˜â€”â€”ç®¡ç†è·ç¦»"></a>è·¯ç”±å¯ä¿¡åº¦é—®é¢˜â€”â€”ç®¡ç†è·ç¦»</h2><p><img src="https://s2.loli.net/2023/05/06/sH7XRJcgZ5uYwBn.png" alt="image-20230506153304427"></p><h2 id="ç­‰ä»·è·¯ç”±"><a href="#ç­‰ä»·è·¯ç”±" class="headerlink" title="ç­‰ä»·è·¯ç”±"></a>ç­‰ä»·è·¯ç”±</h2><p>è´Ÿè½½åˆ†æ‹…</p><p><img src="https://s2.loli.net/2023/05/06/TbsHvWEFP1BDxGk.png" alt="image-20230506153332861"></p><h2 id="å¸¸ç”¨ç½‘ç»œå‘½ä»¤"><a href="#å¸¸ç”¨ç½‘ç»œå‘½ä»¤" class="headerlink" title="å¸¸ç”¨ç½‘ç»œå‘½ä»¤"></a>å¸¸ç”¨ç½‘ç»œå‘½ä»¤</h2><h2 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h2><ul><li>æ£€æµ‹ä¸»æœº</li><li>ICMP ä¼ è¾“åè®®</li></ul><h2 id="teInet"><a href="#teInet" class="headerlink" title="teInet"></a>teInet</h2><ul><li>è¿œç«¯ç™»å…¥</li><li>æ£€æµ‹ä¸»æœºç«¯å£æ˜¯å¦å¼€æ”¾</li></ul><h2 id="traceroute"><a href="#traceroute" class="headerlink" title="traceroute"></a>traceroute</h2><ul><li>æ˜¾ç¤º i æ•°æ®åŒ…åˆ°ä¸»æœºé—´çš„è·¯å¾„</li><li>è¿½è¸ªç½‘ç»œæ•°æ®åŒ…çš„è·¯ç”±é€”å¾„</li></ul>]]></content>
      
      
      <categories>
          
          <category> Work </category>
          
          <category> Eccom </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç½‘ç»œ </tag>
            
            <tag> é˜¿é‡Œäº‘åŸ¹è®­ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022 Summarize</title>
      <link href="/2023/01/01/%E9%9A%8F%E7%AC%94/2023.1.1/"/>
      <url>/2023/01/01/%E9%9A%8F%E7%AC%94/2023.1.1/</url>
      
        <content type="html"><![CDATA[<p><code>2023.1.1 10:48:48 Akira</code></p><p>æ–°å¹´å¿«ä¹å•¦ï¼Œæœ€è¿‘çœŸçš„ç©çš„æœ‰ç‚¹æ”¾è‚†äº†ï¼Œæ˜¯æ—¶å€™è§„åˆ’ä¸€ä¸‹æ¥ä¸‹æ¥çš„æ—¥å­äº†ã€‚</p><p>å…ˆæ¥å›é¡¾ä¸€ä¸‹å¹¶ä¸å¾ˆé¡ºçš„ä¸Šä¸€å¹´è¶´ã€‚</p><ul><li><p>2022.6 - 2022.9</p><p>äººç”Ÿç¬¬ä¸€æ¬¡é¢è¯•ï¼Œå¾ˆé¡ºåˆ©ï¼Œä¹Ÿå¦‚æ„¿çš„æ¥åˆ°äº†æ²å¤ç§‘æŠ€ã€‚ç›¸è¯†äº†æˆ‘ä»¬çš„å¤§ç‰›æ¯›ç»„é•¿ï¼Œå¤§æˆ‘ä¸€ä¸¤å±Šä¸”å¼ºçš„ä¸€å¡Œç³Šæ¶‚çš„æ–¹å®å“¥ï¼Œè¿˜æœ‰æ—¶åˆ»æ¿€åŠ±ç€æˆ‘çš„å­è±ªå“ˆå“ˆå“ˆå“ˆï¼Œå­è±ªçœŸçš„å¾ˆæ£’ï¼Œç›¸ä¿¡ä»–ä¸€å®šä¼šæ˜¯ä¸ªå¤§ä½¬æ»´ã€‚</p><p>é‚£æ®µæ—¶é—´ï¼Œæœ€å«æˆ‘å°è±¡æ·±åˆ»çš„ï¼Œå°±æ˜¯èˆ’é˜³äº†å§ã€‚å“‡ğŸ˜¯ï¼Œæ€ä¹ˆä¼šæœ‰è¿™ä¹ˆä¼˜ç§€çš„å¥³å­©å­å•Šï¼Œç´æ£‹ä¹¦ç”»ï¼Œ3Aå¤§ä½œï¼Œæ ·æ ·ç²¾é€šå‘ï¼Œè†œæ‹œå“ˆå“ˆå“ˆã€‚å¦ˆå¦ˆçœ‹ä¸Šäº†ï¼Œä½†æ˜¯ï¼Œæˆ‘ä½•å¾·ä½•èƒ½å‘ã€‚</p><p>â€¦â€¦æœ€åæˆ‘æ¶¦äº†ï¼Œå¹´å°‘è½»ç‹‚ï¼Œå®ä¹ 3kè½¬æ­£8kçš„æ—¥å­æ²¡æœ‰æ‹´ä½æˆ‘ï¼Œä¸€å¤´æ‰è¿›ç§‹æ‹›äº†ã€‚</p><p>æ‚”ä¸å½“åˆå•Šï¼Œæ²å¤ç¡®å®è®©æˆ‘å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼Œåº”è¯¥ç•™ä¸‹å¤šå­¦å­¦çš„ã€‚</p></li><li><p>2022.9 - 2022.12</p><p>åˆæ˜¯ä¸€ä¸ªå¾ˆé¡ºåˆ©çš„é¢è¯•ï¼Œä¸‡æœ‹æ•°æ™ºï¼Œå¾ˆå¼€å¿ƒï¼Œä»¥ä¸ºç¨³äº†ï¼Œç©äº†ä¸€ä¸ªæœˆï¼Œæœ€åäººå®¶é¸½äº†ï¼Œæ€äººçš„å¿ƒéƒ½æœ‰äº†ï¼Œä¸ºä»–æˆ‘è¿˜æ”¾å¼ƒäº†åŠ›ç»´çš„å²—ä½ğŸ™„ã€‚</p><p>ç–¯ç‹‚èƒŒé¢è¯•é¢˜ï¼Œå­¦ä¹ æ–°çš„ä¸œè¥¿â€¦â€¦</p><p>ç­‰åˆ°äº†åè®¯ï¼Œç›®å‰æ­£åœ¨ç­¾ä¸‰æ–¹ï¼Œä½†æ„¿é¡ºåˆ©</p></li></ul><p>okeyï¼Œå¤§è‡´ä¹Ÿå°±è¿™äº›ï¼Œä¸æ˜¯å¾ˆé¡ºï¼Œæ–°å¹´ç»§ç»­åŠ æ²¹ï¼</p><p>æ¥ä¸‹æ¥çš„è§„åˆ’ï¼š</p><ul><li><p>åè®¯ç­¾ä¸‰æ–¹</p><ul><li><p>äº‰å–æ±²å–å¤§ä½¬çš„ç»éªŒğŸ¤¦â€â™‚ï¸ï¼ï¼</p></li><li><p>å¤šå¾…ä¸€æ®µæ—¶æ—¥ï¼Œæ··å·¥ä½œç»éªŒ</p></li></ul></li><li><p>React</p></li><li><p>å¾®ä¿¡å°ç¨‹åº</p></li><li><p>vite</p></li><li><p>æå®šæ¯•è®¾ï¼ˆä¹Ÿå¿«äº†ğŸ¤ªï¼‰</p></li></ul><p>å°±è¿™äº›å§ï¼Œå¤šäº†ä¹Ÿåšä¸åˆ°ï¼ŒåŠ æ²¹ï¼</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æºç å­¦ä¹  - æ¨¡æ¿ç¼–è¯‘</title>
      <link href="/2022/12/23/vue/Vue%20Resource%20Learing/6.%20%E6%A8%A1%E6%9D%BF%E7%BC%96%E8%AF%91/"/>
      <url>/2022/12/23/vue/Vue%20Resource%20Learing/6.%20%E6%A8%A1%E6%9D%BF%E7%BC%96%E8%AF%91/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¨¡æ¿ç¼–è¯‘"><a href="#æ¨¡æ¿ç¼–è¯‘" class="headerlink" title="æ¨¡æ¿ç¼–è¯‘"></a>æ¨¡æ¿ç¼–è¯‘</h1><h2 id="å¤§ä½“æ­¥éª¤"><a href="#å¤§ä½“æ­¥éª¤" class="headerlink" title="å¤§ä½“æ­¥éª¤"></a>å¤§ä½“æ­¥éª¤</h2><p>ä¸»è¦çš„æ­¥éª¤æ˜¯ï¼šå…ˆå°†æ¨¡æ¿ç¼–è¯‘æˆ <code>AST</code>ï¼Œç„¶åå†å°†å…¶è½¬æ¢æˆ æ¸²æŸ“å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ç†Ÿæ‚‰çš„ <code>render</code>å‡½æ•°ã€‚</p><p>ä½†æ˜¯æœ‰ä¸€äº›ä¸å­˜åœ¨å˜é‡çš„èŠ‚ç‚¹ï¼Œæ˜¯ä¸éœ€è¦é‡æ–°æ¸²æŸ“çš„ï¼Œæ‰€ä»¥ <code>Vue</code> å¯¹å…¶åšäº†ç›¸åº”çš„ä¼˜åŒ–ï¼Œä¹Ÿå°±æ˜¯å°†æ‰€æœ‰çš„é™æ€èŠ‚ç‚¹è¿›è¡Œæ ‡è®°ï¼Œæœ€ç»ˆåœ¨ç”Ÿæˆ <code>render</code> å‡½æ•°</p><p>æ‰€ä»¥å¤§ä½“é€»è¾‘ï¼Œå¯ä»¥åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>å°†æ¨¡æ¿ç¼–è¯‘æˆ AST</li><li>éå† AST æ ‡è®°é™æ€èŠ‚ç‚¹</li><li>ä½¿ç”¨ AST ç”Ÿæˆæ¸²æŸ“å‡½æ•°</li></ul><p>è¿™ä¸‰éƒ¨åˆ†åœ¨æºç ä¸­æ˜¯åˆ†æˆä¸‰ä¸ªæ¨¡å—å»æ‰§è¡Œï¼š</p><ul><li>è§£æå™¨</li><li>ä¼˜åŒ–å™¨</li><li>ä»£ç ç”Ÿæˆå™¨</li></ul><p><img src="https://s2.loli.net/2023/03/08/b5RofgcjlB6G1hI.png" alt="image-20230308103949419"></p><h2 id="è§£æå™¨"><a href="#è§£æå™¨" class="headerlink" title="è§£æå™¨"></a>è§£æå™¨</h2><h3 id="è§£æå™¨ä½œç”¨"><a href="#è§£æå™¨ä½œç”¨" class="headerlink" title="è§£æå™¨ä½œç”¨"></a>è§£æå™¨ä½œç”¨</h3><p><code>template -&gt; AST</code></p><p>è¿™ä¸€æ¨¡å—ä¸»è¦å°±æ˜¯å°† æ¨¡æ¿ ç¼–è¯‘æˆ ASTã€‚</p><p>ä¾‹å¦‚ï¼š </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; name &#125;&#125;&lt;/p&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç®€å•çš„æ¨¡æ¿ç¼–è¯‘æˆ AST ä¹‹åæ˜¯è¿™æ ·çš„ã€‚</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;div&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;attrsList&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;attrsMap&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;rawAttrsMap&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;children&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;p&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;attrsList&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;attrsMap&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rawAttrsMap&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;parent&quot;</span><span class="punctuation">:</span> <span class="string">&quot;[Circular ~]&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;children&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;expression&quot;</span><span class="punctuation">:</span> <span class="string">&quot;_s(name)&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;tokens&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">              <span class="attr">&quot;@binding&quot;</span><span class="punctuation">:</span> <span class="string">&quot;name&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">          <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#123;&#123; name &#125;&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">20</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;static&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">24</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;plain&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;static&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;staticRoot&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;end&quot;</span><span class="punctuation">:</span> <span class="number">31</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;plain&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;static&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;staticRoot&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>æ‰€è°“çš„ <code>AST</code> å®é™…ä¸Šå°±æ˜¯é€šè¿‡ <code>Object</code> çš„å½¢å¼æè¿°æ¨¡æ¿çš„å„ä¸ªçŠ¶æ€ä»¥åŠå±æ€§ã€‚</p><h3 id="è§£æå™¨å†…éƒ¨åŸç†"><a href="#è§£æå™¨å†…éƒ¨åŸç†" class="headerlink" title="è§£æå™¨å†…éƒ¨åŸç†"></a>è§£æå™¨å†…éƒ¨åŸç†</h3><p><code>æ­£åˆ™</code> </p><p>å®é™…ä¸Šï¼Œè§£æå™¨å†…éƒ¨æ‹†åˆ†äº†å¥½å¤šä¸ªå­è§£æå™¨ï¼Œä¾‹å¦‚ï¼šHTMLè§£æå™¨ã€æ–‡æœ¬è§£æå™¨ã€è¿‡æ»¤è§£æå™¨â€¦å…¶ä¸­æœ€é‡è¦çš„å°±æ˜¯ HTMLè§£æå™¨ï¼Œåœ¨è§£æçš„è¿‡ç¨‹ä¸­ï¼Œä¼šä¸æ–­çš„è§¦å‘ä¸€ç³»åˆ—çš„é’©å­å‡½æ•°ï¼š</p><ul><li>æ–‡æœ¬é’©å­</li><li>æ³¨é‡Šé’©å­</li><li>å¼€å§‹æ ‡ç­¾é’©å­</li><li>ç»“æŸæ ‡ç­¾é’©å­</li></ul><p>è§£æå™¨çš„å·¥ä½œè¿‡ç¨‹ï¼Œå°±æ˜¯æ‹¿åˆ°æ¨¡æ¿ä¹‹åè¿›è¡Œå¾ªç¯éå†ï¼Œé€šè¿‡æ­£åˆ™è¿›è¡ŒåŒ¹é…ï¼Œä¸€æ®µä¸€æ®µçš„è£å‰ªï¼Œä»¥åŠé‡‡ç”¨æ ˆçš„å½¢å¼ï¼Œç¡®ä¿ AST çš„å±‚çº§å…³ç³»ï¼Œç›´åˆ°æ¨¡æ¿è¢«æˆªå–ç©ºã€‚</p><p>å…¶ä¸­éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè‡ªé—­åˆæ ‡ç­¾çš„å¤„ç†ã€‚è‡ªé—­åˆæ ‡ç­¾å®é™…ä¸Šå°±æ˜¯åœ¨å¼€å§‹æ ‡ç­¾çš„æœ«å°¾å­˜åœ¨ <code>/</code> ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** å±æ€§ */</span></span><br><span class="line"><span class="keyword">const</span> attribute = <span class="regexp">/^\s*([^\s&quot;&#x27;&lt;&gt;\/=]+)(?:\s*(=)\s*(?:&quot;([^&quot;]*)&quot;+|&#x27;([^&#x27;]*)&#x27;+|([^\s&quot;&#x27;=&lt;&gt;`]+)))?/</span></span><br><span class="line"><span class="comment">/** æ ‡ç­¾å */</span></span><br><span class="line"><span class="comment">/** &lt;my-card&gt;&lt;/my-card&gt; */</span></span><br><span class="line"><span class="keyword">const</span> ncname = <span class="string">`[a-zA-Z_][\\-\\.0-9_a-zA-Z<span class="subst">$&#123;unicodeRegExp.source&#125;</span>]*`</span></span><br><span class="line"><span class="comment">/** &lt;component:child&gt;&lt;/component:child&gt; */</span></span><br><span class="line"><span class="keyword">const</span> qnameCapture = <span class="string">`((?:<span class="subst">$&#123;ncname&#125;</span>\\:)?<span class="subst">$&#123;ncname&#125;</span>)`</span></span><br><span class="line"><span class="comment">/** &lt; */</span></span><br><span class="line"><span class="keyword">const</span> startTagOpen = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">`^&lt;<span class="subst">$&#123;qnameCapture&#125;</span>`</span>)</span><br><span class="line"><span class="comment">/** &gt; || /&gt; */</span></span><br><span class="line"><span class="keyword">const</span> startTagClose = <span class="regexp">/^\s*(\/?)&gt;/</span></span><br><span class="line"><span class="comment">/** &lt;/div&gt; */</span></span><br><span class="line"><span class="keyword">const</span> endTag = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">`^&lt;\\/<span class="subst">$&#123;qnameCapture&#125;</span>[^&gt;]*&gt;`</span>)</span><br></pre></td></tr></table></figure><h3 id="å¤§ä½“è¿‡ç¨‹"><a href="#å¤§ä½“è¿‡ç¨‹" class="headerlink" title="å¤§ä½“è¿‡ç¨‹"></a>å¤§ä½“è¿‡ç¨‹</h3><p><code>å®é™…ä¸Š å¼€å§‹æ ‡ç­¾ å’Œ ç»“æŸæ ‡ç­¾ ä¹‹å‰è¿˜æœ‰ æ³¨é‡Šã€æ¡ä»¶æ³¨é‡Šã€DOCTYPE</code></p><p><img src="https://s2.loli.net/2023/03/08/VMaqS3xOLyjDtEZ.png" alt="image-20230308144858685"></p><h2 id="ä¼˜åŒ–å™¨"><a href="#ä¼˜åŒ–å™¨" class="headerlink" title="ä¼˜åŒ–å™¨"></a>ä¼˜åŒ–å™¨</h2><p>æ‰€è°“ä¼˜åŒ–ï¼Œå³éå† AST å°†æ‰€æœ‰çš„é™æ€èŠ‚ç‚¹æ‰¾åˆ°ï¼Œå¹¶ä¸”è¿›è¡Œæ ‡è®°ã€‚</p><p>ä½œç”¨ï¼š</p><ul><li>æ¯æ¬¡é‡æ–°æ¸²æŸ“æ—¶ï¼Œä¸éœ€è¦ä¸ºé™æ€å­æ ‘åˆ›å»ºæ–°èŠ‚ç‚¹</li><li>åœ¨ <code>patch</code> è¿‡ç¨‹ä¸­å¯ä»¥è·³è¿‡</li></ul><p>ä¸»è¦æ ‡è®°æœ‰ä¿©ï¼š<code>static</code>  <code>staticRoot</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** packages\vue-template-compiler\browser.js */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">isStatic</span> (node) &#123;</span><br><span class="line">  <span class="keyword">if</span> (node.<span class="property">type</span> === <span class="number">2</span>) &#123; <span class="comment">// expression</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (node.<span class="property">type</span> === <span class="number">3</span>) &#123; <span class="comment">// text</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> !!(node.<span class="property">pre</span> || (</span><br><span class="line">    !node.<span class="property">hasBindings</span> &amp;&amp; <span class="comment">// no dynamic bindings</span></span><br><span class="line">    !node.<span class="property">if</span> &amp;&amp; !node.<span class="property">for</span> &amp;&amp; <span class="comment">// not v-if or v-for or v-else</span></span><br><span class="line">    !<span class="title function_">isBuiltInTag</span>(node.<span class="property">tag</span>) &amp;&amp; <span class="comment">// not a built-in</span></span><br><span class="line">    <span class="title function_">isPlatformReservedTag</span>(node.<span class="property">tag</span>) &amp;&amp; <span class="comment">// not a component</span></span><br><span class="line">    !<span class="title function_">isDirectChildOfTemplateFor</span>(node) &amp;&amp;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">keys</span>(node).<span class="title function_">every</span>(isStaticKey)</span><br><span class="line">  ))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä»£ç ç”Ÿæˆå™¨"><a href="#ä»£ç ç”Ÿæˆå™¨" class="headerlink" title="ä»£ç ç”Ÿæˆå™¨"></a>ä»£ç ç”Ÿæˆå™¨</h2><p><code>AST -&gt; render</code></p><p>æ‰€è°“çš„ <code>render</code> å‡½æ•°ï¼Œå®é™…ä¸Šå°±æ˜¯å‡½æ•°çš„åµŒå¥—ï¼Œè¿™ä¸ªåµŒå¥—å‡½æ•°æ˜¯é€šè¿‡éå† <code>AST</code>ï¼Œæ‹¼æ¥è€Œæˆçš„ ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">&lt;div id=&quot;el&quot;&gt;Hello &#123;&#123;name&#125;&#125;&lt;/div&gt; -&gt; AST -&gt; render</span></span><br><span class="line"><span class="comment">render: </span></span><br><span class="line"><span class="comment">with(this) &#123;</span></span><br><span class="line"><span class="comment">return _c(&quot;div&quot;, &#123;attrs: &#123; &quot;id&quot;: &quot;el&quot; &#125;&#125;, [_v(&quot;hello&quot; + _s(name))])</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>æ¶‰åŠåˆ°çš„å‡½æ•°æœ‰ï¼š<code>_c</code> <code>_v</code> <code>_s</code></p><p><code>_c</code>ï¼šå…¶å®å°±æ˜¯ <code>createElement(tagName, attrs, children)</code></p><p>æœ€ä¸ºä¸»è¦çš„å‡½æ•°å°±æ˜¯ <code>genElement</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">genElement</span>(<span class="params">el, state</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> data = el.<span class="property">plain</span> ? <span class="literal">undefined</span> : <span class="title function_">genData</span>(el, state)</span><br><span class="line">  <span class="keyword">const</span> children = <span class="title function_">genChildren</span>(el, state)</span><br><span class="line">  code = <span class="string">`_c(&#x27;<span class="subst">$&#123;el.tag&#125;</span>&#x27;<span class="subst">$&#123;data ? <span class="string">`,<span class="subst">$&#123;data&#125;</span>`</span>: <span class="string">&#x27;&#x27;</span>&#125;</span><span class="subst">$&#123;children ? <span class="string">`,<span class="subst">$&#123;children&#125;</span>`</span>: <span class="string">&#x27;&#x27;</span>&#125;</span>)`</span></span><br><span class="line">  <span class="keyword">return</span> code</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
          <category> Vue2 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Source-Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æºç å­¦ä¹  - å…¨å±€ API &amp; å®ä¾‹æ–¹æ³•</title>
      <link href="/2022/12/21/vue/Vue%20Resource%20Learing/5.%20%E5%85%A8%E5%B1%80%20API%20&amp;%20%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95/"/>
      <url>/2022/12/21/vue/Vue%20Resource%20Learing/5.%20%E5%85%A8%E5%B1%80%20API%20&amp;%20%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="å…¨å±€-API-amp-å®ä¾‹æ–¹æ³•"><a href="#å…¨å±€-API-amp-å®ä¾‹æ–¹æ³•" class="headerlink" title="å…¨å±€ API &amp; å®ä¾‹æ–¹æ³•"></a>å…¨å±€ API &amp; å®ä¾‹æ–¹æ³•</h1><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼šVue.use(plugin) åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>è´Ÿè´£å®‰è£… plugin æ’ä»¶ï¼Œå…¶å®å°±æ˜¯æ‰§è¡Œæ’ä»¶æä¾›çš„ install æ–¹æ³•ã€‚</p><ul><li>é¦–å…ˆåˆ¤æ–­è¯¥æ’ä»¶æ˜¯å¦å·²ç»å®‰è£…è¿‡</li><li>å¦‚æœæ²¡æœ‰ï¼Œåˆ™æ‰§è¡Œæ’ä»¶æä¾›çš„ install æ–¹æ³•å®‰è£…æ’ä»¶ï¼Œå…·ä½“åšä»€ä¹ˆæœ‰æ’ä»¶è‡ªå·±å†³å®š</li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼šVue.mixin(options) åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>è´Ÿè´£åœ¨ Vue çš„å…¨å±€é…ç½®ä¸Šåˆå¹¶ options é…ç½®ã€‚ç„¶ååœ¨æ¯ä¸ªç»„ä»¶ç”Ÿæˆ vnode æ—¶ä¼šå°†å…¨å±€é…ç½®åˆå¹¶åˆ°ç»„ä»¶è‡ªèº«çš„é…ç½®ä¸Šæ¥ã€‚</p><ul><li>æ ‡å‡†åŒ– options å¯¹è±¡ä¸Šçš„ propsã€injectã€directive é€‰é¡¹çš„æ ¼å¼</li><li>å¤„ç† options ä¸Šçš„ extends å’Œ mixinsï¼Œåˆ†åˆ«å°†ä»–ä»¬åˆå¹¶åˆ°å…¨å±€é…ç½®ä¸Š</li><li>ç„¶åå°† options é…ç½®å’Œå…¨å±€é…ç½®è¿›è¡Œåˆå¹¶ï¼Œé€‰é¡¹å†²çªæ—¶ options é…ç½®ä¼šè¦†ç›–å…¨å±€é…ç½®</li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼šVue.component(compName, Comp) åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>è´Ÿè´£æ³¨å†Œå…¨å±€ç»„ä»¶ã€‚å…¶å®å°±æ˜¯å°†ç»„ä»¶é…ç½®æ³¨å†Œåˆ°å…¨å±€é…ç½®çš„ components é€‰é¡¹ä¸Šï¼ˆoptions.componentsï¼‰ï¼Œç„¶åå„ä¸ªå­ç»„ä»¶åœ¨ç”Ÿæˆ vnode æ—¶ä¼šå°†å…¨å±€çš„ components é€‰é¡¹åˆå¹¶åˆ°å±€éƒ¨çš„ components é…ç½®é¡¹ä¸Šã€‚</p><ul><li>å¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ºç©ºï¼Œåˆ™è¡¨ç¤ºè·å– compName çš„ç»„ä»¶æ„é€ å‡½æ•°</li><li>å¦‚æœ Comp æ˜¯ç»„ä»¶é…ç½®å¯¹è±¡ï¼Œåˆ™ä½¿ç”¨ Vue.extend æ–¹æ³•å¾—åˆ°ç»„ä»¶æ„é€ å‡½æ•°ï¼Œå¦åˆ™ç›´æ¥è¿›è¡Œä¸‹ä¸€æ­¥</li><li>åœ¨å…¨å±€é…ç½®ä¸Šè®¾ç½®ç»„ä»¶ä¿¡æ¯ï¼Œ<code>this.options.components.compName = CompConstructor</code></li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼šVue.directive(â€˜my-directiveâ€™, {xx}) åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>åœ¨å…¨å±€æ³¨å†Œ my-directive æŒ‡ä»¤ï¼Œç„¶åæ¯ä¸ªå­ç»„ä»¶åœ¨ç”Ÿæˆ vnode æ—¶ä¼šå°†å…¨å±€çš„ directives é€‰é¡¹åˆå¹¶åˆ°å±€éƒ¨çš„ directives é€‰é¡¹ä¸­ã€‚åŸç†åŒ Vue.component æ–¹æ³•ï¼š</p><ul><li>å¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ºç©ºï¼Œåˆ™è·å–æŒ‡å®šæŒ‡ä»¤çš„é…ç½®å¯¹è±¡</li><li>å¦‚æœä¸ä¸ºç©ºï¼Œå¦‚æœç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°çš„è¯ï¼Œåˆ™ç”Ÿæˆé…ç½®å¯¹è±¡ { bind: ç¬¬äºŒä¸ªå‚æ•°, update: ç¬¬äºŒä¸ªå‚æ•° }</li><li>ç„¶åå°†æŒ‡ä»¤é…ç½®å¯¹è±¡è®¾ç½®åˆ°å…¨å±€é…ç½®ä¸Šï¼Œ<code>this.options.directives[&#39;my-directive&#39;] = &#123;xx&#125;</code></li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼šVue.filter(â€˜my-filterâ€™, function(val) {xx}) åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>è´Ÿè´£åœ¨å…¨å±€æ³¨å†Œè¿‡æ»¤å™¨ my-filterï¼Œç„¶åæ¯ä¸ªå­ç»„ä»¶åœ¨ç”Ÿæˆ vnode æ—¶ä¼šå°†å…¨å±€çš„ filters é€‰é¡¹åˆå¹¶åˆ°å±€éƒ¨çš„ filters é€‰é¡¹ä¸­ã€‚åŸç†æ˜¯ï¼š</p><ul><li>å¦‚æœæ²¡æœ‰æä¾›ç¬¬äºŒä¸ªå‚æ•°ï¼Œåˆ™è·å– my-filter è¿‡æ»¤å™¨çš„å›è°ƒå‡½æ•°</li><li>å¦‚æœæä¾›äº†ç¬¬äºŒä¸ªå‚æ•°ï¼Œåˆ™æ˜¯è®¾ç½® <code>this.options.filters[&#39;my-filter&#39;] = function(val) &#123;xx&#125;</code>ã€‚</li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼šVue.extend(options) åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>Vue.extend åŸºäº Vue åˆ›å»ºä¸€ä¸ªå­ç±»ï¼Œå‚æ•° options ä¼šä½œä¸ºè¯¥å­ç±»çš„é»˜è®¤å…¨å±€é…ç½®ï¼Œå°±åƒ Vue çš„é»˜è®¤å…¨å±€é…ç½®ä¸€æ ·ã€‚æ‰€ä»¥é€šè¿‡ Vue.extend æ‰©å±•ä¸€ä¸ªå­ç±»ï¼Œä¸€å¤§ç”¨å¤„å°±æ˜¯å†…ç½®ä¸€äº›å…¬å…±é…ç½®ï¼Œä¾›å­ç±»çš„å­ç±»ä½¿ç”¨ã€‚</p><ul><li>å®šä¹‰å­ç±»æ„é€ å‡½æ•°ï¼Œè¿™é‡Œå’Œ Vue ä¸€æ ·ï¼Œä¹Ÿæ˜¯è°ƒç”¨ _init(options)</li><li>åˆå¹¶ Vue çš„é…ç½®å’Œ optionsï¼Œå¦‚æœé€‰é¡¹å†²çªï¼Œåˆ™ options çš„é€‰é¡¹ä¼šè¦†ç›– Vue çš„é…ç½®é¡¹</li><li>ç»™å­ç±»å®šä¹‰å…¨å±€ APIï¼Œå€¼ä¸º Vue çš„å…¨å±€ APIï¼Œæ¯”å¦‚ <code>Sub.extend = Super.extend</code>ï¼Œè¿™æ ·å­ç±»åŒæ ·å¯ä»¥æ‰©å±•å‡ºå…¶å®ƒå­ç±»</li><li>è¿”å›å­ç±» Sub</li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼šVue.set(target, key, val) åšäº†ä»€ä¹ˆ</p><p><strong>ç­”</strong>ï¼š</p><p>ç”±äº Vue æ— æ³•æ¢æµ‹æ™®é€šçš„æ–°å¢ property (æ¯”å¦‚ this.myObject.newProperty &#x3D; â€˜hiâ€™)ï¼Œæ‰€ä»¥é€šè¿‡ Vue.set ä¸ºå‘å“åº”å¼å¯¹è±¡ä¸­æ·»åŠ ä¸€ä¸ª propertyï¼Œå¯ä»¥ç¡®ä¿è¿™ä¸ªæ–° property åŒæ ·æ˜¯å“åº”å¼çš„ï¼Œä¸”è§¦å‘è§†å›¾æ›´æ–°ã€‚</p><ul><li>æ›´æ–°æ•°ç»„æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ ï¼šVue.set(array, idx, val)ï¼Œå†…éƒ¨é€šè¿‡ splice æ–¹æ³•å®ç°å“åº”å¼æ›´æ–°</li><li>æ›´æ–°å¯¹è±¡å·²æœ‰å±æ€§ï¼šVue.set(obj, key ,val)ï¼Œç›´æ¥æ›´æ–°å³å¯ &#x3D;&gt; <code>obj[key] = val</code></li><li>ä¸èƒ½å‘ Vue å®ä¾‹æˆ–è€… $data åŠ¨æ€æ·»åŠ æ ¹çº§åˆ«çš„å“åº”å¼æ•°æ®</li><li>Vue.set(obj, key, val)ï¼Œå¦‚æœ obj ä¸æ˜¯å“åº”å¼å¯¹è±¡ï¼Œä¼šæ‰§è¡Œ <code>obj[key] = val</code>ï¼Œä½†æ˜¯ä¸ä¼šåšå“åº”å¼å¤„ç†</li><li>Vue.set(obj, key, val)ï¼Œä¸ºå“åº”å¼å¯¹è±¡ obj å¢åŠ ä¸€ä¸ªæ–°çš„ keyï¼Œåˆ™é€šè¿‡ defineReactive æ–¹æ³•è®¾ç½®å“åº”å¼ï¼Œå¹¶è§¦å‘ä¾èµ–æ›´æ–°</li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼šVue.delete(target, key) åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>åˆ é™¤å¯¹è±¡çš„ propertyã€‚å¦‚æœå¯¹è±¡æ˜¯å“åº”å¼çš„ï¼Œç¡®ä¿åˆ é™¤èƒ½è§¦å‘æ›´æ–°è§†å›¾ã€‚è¿™ä¸ªæ–¹æ³•ä¸»è¦ç”¨äºé¿å¼€ Vue ä¸èƒ½æ£€æµ‹åˆ° property è¢«åˆ é™¤çš„é™åˆ¶ï¼Œä½†æ˜¯ä½ åº”è¯¥å¾ˆå°‘ä¼šä½¿ç”¨å®ƒã€‚å½“ç„¶åŒæ ·ä¸èƒ½åˆ é™¤æ ¹çº§åˆ«çš„å“åº”å¼å±æ€§ã€‚</p><ul><li>Vue.delete(array, idx)ï¼Œåˆ é™¤æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ ï¼Œå†…éƒ¨æ˜¯é€šè¿‡ splice æ–¹æ³•å®ç°çš„</li><li>åˆ é™¤å“åº”å¼å¯¹è±¡ä¸Šçš„æŸä¸ªå±æ€§ï¼šVue.delete(obj, key)ï¼Œå†…éƒ¨æ˜¯æ‰§è¡Œ <code>delete obj.key</code>ï¼Œç„¶åæ‰§è¡Œä¾èµ–æ›´æ–°å³å¯</li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼šVue.nextTick(cb) åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>Vue.nextTick(cb) æ–¹æ³•çš„ä½œç”¨æ˜¯å»¶è¿Ÿå›è°ƒå‡½æ•° cb çš„æ‰§è¡Œï¼Œä¸€èˆ¬ç”¨äº <code>this.key = newVal</code> æ›´æ”¹æ•°æ®åï¼Œæƒ³ç«‹å³è·å–æ›´æ”¹è¿‡åçš„ DOM æ•°æ®ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">key</span> = <span class="string">&#x27;new val&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">nextTick</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// DOM æ›´æ–°äº†</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å…¶å†…éƒ¨çš„æ‰§è¡Œè¿‡ç¨‹æ˜¯ï¼š</p><ul><li><code>this.key = &#39;new val</code>ï¼Œè§¦å‘ä¾èµ–é€šçŸ¥æ›´æ–°ï¼Œå°†è´Ÿè´£æ›´æ–°çš„ watcher æ”¾å…¥ watcher é˜Ÿåˆ—</li><li>å°†åˆ·æ–° watcher é˜Ÿåˆ—çš„å‡½æ•°æ”¾åˆ° callbacks æ•°ç»„ä¸­</li><li>åœ¨æµè§ˆå™¨çš„å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ä¸­æ”¾å…¥ä¸€ä¸ªåˆ·æ–° callbacks æ•°ç»„çš„å‡½æ•°</li><li><strong>Vue.nextTick(cb)</strong> æ¥æ’é˜Ÿï¼Œå°† cb å‡½æ•°æ”¾å…¥ callbacks æ•°ç»„</li><li>å¾…å°†æ¥çš„æŸä¸ªæ—¶åˆ»æ‰§è¡Œåˆ·æ–° callbacks æ•°ç»„çš„å‡½æ•°</li><li>ç„¶åæ‰§è¡Œ callbacks æ•°ç»„ä¸­çš„ä¼—å¤šå‡½æ•°ï¼Œè§¦å‘ watcher.run çš„æ‰§è¡Œï¼Œæ›´æ–° DOM</li><li>ç”±äº cb å‡½æ•°æ˜¯åœ¨åé¢æ”¾åˆ° callbacks æ•°ç»„ï¼Œæ‰€ä»¥è¿™å°±ä¿è¯äº†å…ˆå®Œæˆçš„ DOM æ›´æ–°ï¼Œå†æ‰§è¡Œ cb å‡½æ•°</li></ul></li><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼švm.$set(obj, key, val) åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>vm.$set ç”¨äºå‘å“åº”å¼å¯¹è±¡æ·»åŠ ä¸€ä¸ªæ–°çš„ propertyï¼Œå¹¶ç¡®ä¿è¿™ä¸ªæ–°çš„ property åŒæ ·æ˜¯å“åº”å¼çš„ï¼Œå¹¶è§¦å‘è§†å›¾æ›´æ–°ã€‚ç”±äº Vue æ— æ³•æ¢æµ‹å¯¹è±¡æ–°å¢å±æ€§æˆ–è€…é€šè¿‡ç´¢å¼•ä¸ºæ•°ç»„æ–°å¢ä¸€ä¸ªå…ƒç´ ï¼Œæ¯”å¦‚ï¼š<code>this.obj.newProperty = &#39;val&#39;</code>ã€<code>this.arr[3] = &#39;val&#39;</code>ã€‚æ‰€ä»¥è¿™æ‰æœ‰äº† vm.$setï¼Œå®ƒæ˜¯ Vue.set çš„åˆ«åã€‚</p><ul><li>ä¸ºå¯¹è±¡æ·»åŠ ä¸€ä¸ªæ–°çš„å“åº”å¼æ•°æ®ï¼šè°ƒç”¨ defineReactive æ–¹æ³•ä¸ºå¯¹è±¡å¢åŠ å“åº”å¼æ•°æ®ï¼Œç„¶åæ‰§è¡Œ dep.notify è¿›è¡Œä¾èµ–é€šçŸ¥ï¼Œæ›´æ–°è§†å›¾</li><li>ä¸ºæ•°ç»„æ·»åŠ ä¸€ä¸ªæ–°çš„å“åº”å¼æ•°æ®ï¼šé€šè¿‡ splice æ–¹æ³•å®ç°</li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼švm.$delete(obj, key)  åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>vm.$delete ç”¨äºåˆ é™¤å¯¹è±¡ä¸Šçš„å±æ€§ã€‚å¦‚æœå¯¹è±¡æ˜¯å“åº”å¼çš„ï¼Œä¸”èƒ½ç¡®ä¿èƒ½è§¦å‘è§†å›¾æ›´æ–°ã€‚è¯¥æ–¹æ³•ä¸»è¦ç”¨äºé¿å¼€ Vue ä¸èƒ½æ£€æµ‹å±æ€§è¢«åˆ é™¤çš„æƒ…å†µã€‚å®ƒæ˜¯ Vue.delete çš„åˆ«åã€‚</p><ul><li>åˆ é™¤æ•°ç»„æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ ï¼Œå†…éƒ¨é€šè¿‡ splice æ–¹æ³•æ¥å®Œæˆ</li><li>åˆ é™¤å¯¹è±¡ä¸Šçš„æŒ‡å®šå±æ€§ï¼Œåˆ™æ˜¯å…ˆé€šè¿‡ delete è¿ç®—ç¬¦åˆ é™¤è¯¥å±æ€§ï¼Œç„¶åæ‰§è¡Œ dep.notify è¿›è¡Œä¾èµ–é€šçŸ¥ï¼Œæ›´æ–°è§†å›¾</li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼švm.$watch(expOrFn, callback, [options]) åšäº†ä»€ä¹ˆï¼Ÿ</p><p>ç­”ï¼š</p><p>vm.$watch è´Ÿè´£è§‚å¯Ÿ Vue å®ä¾‹ä¸Šçš„ä¸€ä¸ªè¡¨è¾¾å¼æˆ–è€…ä¸€ä¸ªå‡½æ•°è®¡ç®—ç»“æœçš„å˜åŒ–ã€‚å½“å…¶å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå›è°ƒå‡½æ•°å°±ä¼šè¢«æ‰§è¡Œï¼Œå¹¶ä¸ºå›è°ƒå‡½æ•°ä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºæ›´æ–°åçš„æ–°å€¼ï¼Œç¬¬äºŒä¸ªä¸ºè€å€¼ã€‚</p><p>è¿™é‡Œéœ€è¦ <strong>æ³¨æ„</strong> ä¸€ç‚¹çš„æ˜¯ï¼šå¦‚æœè§‚å¯Ÿçš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ¯”å¦‚ï¼šæ•°ç»„ï¼Œå½“ä½ ç”¨æ•°ç»„æ–¹æ³•ï¼Œæ¯”å¦‚ push ä¸ºæ•°ç»„æ–°å¢ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œå›è°ƒå‡½æ•°è¢«è§¦å‘æ—¶ä¼ é€’çš„æ–°å€¼å’Œè€å€¼ç›¸åŒï¼Œå› ä¸ºå®ƒä»¬æŒ‡å‘åŒä¸€ä¸ªå¼•ç”¨ï¼Œæ‰€ä»¥åœ¨è§‚å¯Ÿä¸€ä¸ªå¯¹è±¡å¹¶ä¸”åœ¨å›è°ƒå‡½æ•°ä¸­æœ‰æ–°è€å€¼æ˜¯å¦ç›¸ç­‰çš„åˆ¤æ–­æ—¶éœ€è¦æ³¨æ„ã€‚</p><p>vm.$watch çš„ç¬¬ä¸€ä¸ªå‚æ•°åªæ¥æ”¶ç®€å•çš„å“åº”å¼æ•°æ®çš„é”®è·¯å¾„ï¼Œå¯¹äºæ›´å¤æ‚çš„è¡¨è¾¾å¼å»ºè®®ä½¿ç”¨å‡½æ•°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p><p>è‡³äº vm.$watch çš„å†…éƒ¨åŸç†æ˜¯ï¼š</p><ul><li>è®¾ç½® options.user &#x3D; trueï¼Œæ ‡å¿—æ˜¯ä¸€ä¸ªç”¨æˆ· watcher</li><li>å®ä¾‹åŒ–ä¸€ä¸ª Watcher å®ä¾‹ï¼Œå½“æ£€æµ‹åˆ°æ•°æ®æ›´æ–°æ—¶ï¼Œé€šè¿‡ watcher å»è§¦å‘å›è°ƒå‡½æ•°çš„æ‰§è¡Œï¼Œå¹¶ä¼ é€’æ–°è€å€¼ä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°</li><li>è¿”å›ä¸€ä¸ª unwatch å‡½æ•°ï¼Œç”¨äºå–æ¶ˆè§‚å¯Ÿ</li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼švm.$on(event, callback) åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>ç›‘å¬å½“å‰å®ä¾‹ä¸Šçš„è‡ªå®šä¹‰äº‹ä»¶ï¼Œäº‹ä»¶å¯ç”± vm.$emit è§¦å‘ï¼Œå›è°ƒå‡½æ•°ä¼šæ¥æ”¶æ‰€æœ‰ä¼ å…¥äº‹ä»¶è§¦å‘å‡½æ•°ï¼ˆvm.$emitï¼‰çš„é¢å¤–å‚æ•°ã€‚</p><p>vm.$on çš„åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯å¤„ç†ä¼ é€’çš„ event å’Œ callback ä¸¤ä¸ªå‚æ•°ï¼Œå°†æ³¨å†Œçš„äº‹ä»¶å’Œå›è°ƒå‡½æ•°ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨åˆ° vm._event å¯¹è±¡ä¸­ï¼Œvm._events &#x3D; { eventName: [cb1, cb2, â€¦], â€¦ }ã€‚</p></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼švm.$emit(eventName, [â€¦args]) åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>è§¦å‘å½“å‰å®ä¾‹ä¸Šçš„æŒ‡å®šäº‹ä»¶ï¼Œé™„åŠ å‚æ•°éƒ½ä¼šä¼ é€’ç»™äº‹ä»¶çš„å›è°ƒå‡½æ•°ã€‚</p><p>å…¶å†…éƒ¨åŸç†å°±æ˜¯æ‰§è¡Œ <code>vm._events[eventName]</code> ä¸­æ‰€æœ‰çš„å›è°ƒå‡½æ•°ã€‚</p><blockquote><p>å¤‡æ³¨ï¼šä» onå’Œon å’Œ onå’Œemit çš„å®ç°åŸç†ä¹Ÿèƒ½çœ‹å‡ºï¼Œç»„ä»¶çš„è‡ªå®šä¹‰äº‹ä»¶å…¶å®æ˜¯è°è§¦å‘è°ç›‘å¬ï¼Œæ‰€ä»¥åœ¨è¿™ä¼šå„¿å†å›å¤´çœ‹ <a href="https://juejin.cn/post/6950084496515399717">Vue æºç è§£è¯»ï¼ˆ2ï¼‰â€”â€” Vue åˆå§‹åŒ–è¿‡ç¨‹</a> ä¸­å…³äº initEvent çš„è§£é‡Šå°±ä¼šæ˜ç™½åœ¨è¯´ä»€ä¹ˆï¼Œå› ä¸ºç»„ä»¶è‡ªå®šä¹‰äº‹ä»¶çš„å¤„ç†å†…éƒ¨ç”¨çš„å°±æ˜¯ vm.onã€vm.onã€vm.onã€vm.emitã€‚</p></blockquote></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼švm.$off([event, callback]) åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>ç§»é™¤è‡ªå®šä¹‰äº‹ä»¶ç›‘å¬å™¨ï¼Œå³ç§»é™¤ vm._events å¯¹è±¡ä¸Šç›¸å…³æ•°æ®ã€‚</p><ul><li>å¦‚æœæ²¡æœ‰æä¾›å‚æ•°ï¼Œåˆ™ç§»é™¤å®ä¾‹çš„æ‰€æœ‰äº‹ä»¶ç›‘å¬</li><li>å¦‚æœåªæä¾›äº† event å‚æ•°ï¼Œåˆ™ç§»é™¤å®ä¾‹ä¸Šè¯¥äº‹ä»¶çš„æ‰€æœ‰ç›‘å¬å™¨</li><li>å¦‚æœä¸¤ä¸ªå‚æ•°éƒ½æä¾›äº†ï¼Œåˆ™ç§»é™¤å®ä¾‹ä¸Šè¯¥äº‹ä»¶å¯¹åº”çš„ç›‘å¬å™¨</li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼švm.$once(event, callback)  åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>ç›‘å¬ä¸€ä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œä½†æ˜¯è¯¥äº‹ä»¶åªä¼šè¢«è§¦å‘ä¸€æ¬¡ã€‚ä¸€æ—¦è§¦å‘ä»¥åç›‘å¬å™¨å°±ä¼šè¢«ç§»é™¤ã€‚</p><p>å…¶å†…éƒ¨çš„å®ç°åŸç†æ˜¯ï¼š</p><ul><li>åŒ…è£…ç”¨æˆ·ä¼ é€’çš„å›è°ƒå‡½æ•°ï¼Œå½“åŒ…è£…å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œé™¤äº†ä¼šæ‰§è¡Œç”¨æˆ·å›è°ƒå‡½æ•°ä¹‹å¤–è¿˜ä¼šæ‰§è¡Œ <code>vm.$off(event, åŒ…è£…å‡½æ•°)</code> ç§»é™¤è¯¥äº‹ä»¶</li><li>ç”¨ <code>vm.$on(event, åŒ…è£…å‡½æ•°)</code> æ³¨å†Œäº‹ä»¶</li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼švm._update(vnode, hydrating)  åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>å®˜æ–¹æ–‡æ¡£æ²¡æœ‰è¯´æ˜è¯¥ APIï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºæºç å†…éƒ¨çš„å®ä¾‹æ–¹æ³•ï¼Œè´Ÿè´£æ›´æ–°é¡µé¢ï¼Œæ˜¯é¡µé¢æ¸²æŸ“çš„å…¥å£ï¼Œå…¶å†…éƒ¨æ ¹æ®æ˜¯å¦å­˜åœ¨ prevVnode æ¥å†³å®šæ˜¯é¦–æ¬¡æ¸²æŸ“ï¼Œè¿˜æ˜¯é¡µé¢æ›´æ–°ï¼Œä»è€Œåœ¨è°ƒç”¨ <strong>patch</strong> å‡½æ•°æ—¶ä¼ é€’ä¸åŒçš„å‚æ•°ã€‚è¯¥æ–¹æ³•åœ¨ä¸šåŠ¡å¼€å‘ä¸­ä¸ä¼šç”¨åˆ°ã€‚</p></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼švm.$forceUpdate()  åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>è¿«ä½¿ Vue å®ä¾‹é‡æ–°æ¸²æŸ“ï¼Œå®ƒä»…ä»…å½±å“ç»„ä»¶å®ä¾‹æœ¬èº«å’Œæ’å…¥æ’æ§½å†…å®¹çš„å­ç»„ä»¶ï¼Œè€Œä¸æ˜¯æ‰€æœ‰å­ç»„ä»¶ã€‚å…¶å†…éƒ¨åŸç†åˆ°ä¹Ÿç®€å•ï¼Œå°±æ˜¯ç›´æ¥è°ƒç”¨ <code>vm._watcher.update()</code>ï¼Œå®ƒå°±æ˜¯ <code>watcher.update()</code> æ–¹æ³•ï¼Œæ‰§è¡Œè¯¥æ–¹æ³•è§¦å‘ç»„ä»¶æ›´æ–°ã€‚</p></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼švm.$destroy()  åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>è´Ÿè´£å®Œå…¨é”€æ¯ä¸€ä¸ªå®ä¾‹ã€‚æ¸…ç†å®ƒä¸å…¶å®ƒå®ä¾‹çš„è¿æ¥ï¼Œè§£ç»‘å®ƒçš„å…¨éƒ¨æŒ‡ä»¤å’Œäº‹ä»¶ç›‘å¬å™¨ã€‚åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šè°ƒç”¨ <code>beforeDestroy</code> å’Œ <code>destroy</code> ä¸¤ä¸ªé’©å­å‡½æ•°ã€‚åœ¨å¤§å¤šæ•°ä¸šåŠ¡å¼€å‘åœºæ™¯ä¸‹ç”¨ä¸åˆ°è¯¥æ–¹æ³•ï¼Œä¸€èˆ¬éƒ½é€šè¿‡ v-if æŒ‡ä»¤æ¥æ“ä½œã€‚å…¶å†…éƒ¨åŸç†æ˜¯ï¼š</p><ul><li>è°ƒç”¨ beforeDestroy é’©å­å‡½æ•°</li><li>å°†è‡ªå·±ä»è€çˆ¹è‚šå­é‡Œï¼ˆ$parentï¼‰ç§»é™¤ï¼Œä»è€Œé”€æ¯å’Œè€çˆ¹çš„å…³ç³»</li><li>é€šè¿‡ watcher.teardown() æ¥ç§»é™¤ä¾èµ–ç›‘å¬</li><li>é€šè¿‡ vm.<strong>patch</strong>(vnode, null) æ–¹æ³•æ¥é”€æ¯èŠ‚ç‚¹</li><li>è°ƒç”¨ destroyed é’©å­å‡½æ•°</li><li>é€šè¿‡ <code>vm.$off</code> æ–¹æ³•ç§»é™¤æ‰€æœ‰çš„äº‹ä»¶ç›‘å¬</li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼švm.$nextTick(cb)  åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>vm.$nextTick æ˜¯ Vue.nextTick çš„åˆ«åï¼Œå…¶ä½œç”¨æ˜¯å»¶è¿Ÿå›è°ƒå‡½æ•° cb çš„æ‰§è¡Œï¼Œä¸€èˆ¬ç”¨äº <code>this.key = newVal</code> æ›´æ”¹æ•°æ®åï¼Œæƒ³ç«‹å³è·å–æ›´æ”¹è¿‡åçš„ DOM æ•°æ®ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">key</span> = <span class="string">&#x27;new val&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">nextTick</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// DOM æ›´æ–°äº†</span></span><br><span class="line">&#125;)</span><br><span class="line">å¤åˆ¶ä»£ç </span><br></pre></td></tr></table></figure><p>å…¶å†…éƒ¨çš„æ‰§è¡Œè¿‡ç¨‹æ˜¯ï¼š</p><ul><li><code>this.key = &#39;new val&#39;</code>ï¼Œè§¦å‘ä¾èµ–é€šçŸ¥æ›´æ–°ï¼Œå°†è´Ÿè´£æ›´æ–°çš„ watcher æ”¾å…¥ watcher é˜Ÿåˆ—</li><li>å°†åˆ·æ–° watcher é˜Ÿåˆ—çš„å‡½æ•°æ”¾åˆ° callbacks æ•°ç»„ä¸­</li><li>åœ¨æµè§ˆå™¨çš„å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ä¸­æ”¾å…¥ä¸€ä¸ªåˆ·æ–° callbacks æ•°ç»„çš„å‡½æ•°</li><li><strong>vm.$nextTick(cb)</strong> æ¥æ’é˜Ÿï¼Œç›´æ¥å°† cb å‡½æ•°æ”¾å…¥ callbacks æ•°ç»„</li><li>å¾…å°†æ¥çš„æŸä¸ªæ—¶åˆ»æ‰§è¡Œåˆ·æ–° callbacks æ•°ç»„çš„å‡½æ•°</li><li>ç„¶åæ‰§è¡Œ callbacks æ•°ç»„ä¸­çš„ä¼—å¤šå‡½æ•°ï¼Œè§¦å‘ watcher.run çš„æ‰§è¡Œï¼Œæ›´æ–° DOM</li><li>ç”±äº cb å‡½æ•°æ˜¯åœ¨åé¢æ”¾åˆ° callbacks æ•°ç»„ï¼Œæ‰€ä»¥è¿™å°±ä¿è¯äº†å…ˆå®Œæˆçš„ DOM æ›´æ–°ï¼Œå†æ‰§è¡Œ cb å‡½æ•°</li></ul></li></ul><hr><ul><li><p><strong>é¢è¯•å®˜ é—®</strong>ï¼švm._render  åšäº†ä»€ä¹ˆï¼Ÿ</p><p><strong>ç­”</strong>ï¼š</p><p>å®˜æ–¹æ–‡æ¡£æ²¡æœ‰æä¾›è¯¥æ–¹æ³•ï¼Œå®ƒæ˜¯ä¸€ä¸ªç”¨äºæºç å†…éƒ¨çš„å®ä¾‹æ–¹æ³•ï¼Œè´Ÿè´£ç”Ÿæˆ vnodeã€‚å…¶å…³é”®ä»£ç å°±ä¸€è¡Œï¼Œæ‰§è¡Œ render å‡½æ•°ç”Ÿæˆ vnodeã€‚ä¸è¿‡å…¶ä¸­åŠ äº†å¤§é‡çš„å¼‚å¸¸å¤„ç†ä»£ç ã€‚</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
          <category> Vue2 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Source-Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æºç å­¦ä¹  - å¼‚æ­¥æ›´æ–°</title>
      <link href="/2022/12/20/vue/Vue%20Resource%20Learing/4.%20%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0/"/>
      <url>/2022/12/20/vue/Vue%20Resource%20Learing/4.%20%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="å¼‚æ­¥æ›´æ–°"><a href="#å¼‚æ­¥æ›´æ–°" class="headerlink" title="å¼‚æ­¥æ›´æ–°"></a>å¼‚æ­¥æ›´æ–°</h1><h2 id="å…¥å£"><a href="#å…¥å£" class="headerlink" title="å…¥å£"></a>å…¥å£</h2><p>æ•°æ®æ›´æ–°ï¼Œé€šçŸ¥ä¾èµ–æ›´æ–°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** src\core\observer\index.js */</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(obj, key, &#123;</span><br><span class="line">    <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">configurable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">get</span>: <span class="keyword">function</span> <span class="title function_">reactiveGetter</span> () &#123; ... &#125;,</span><br><span class="line">    <span class="attr">set</span>: <span class="keyword">function</span> <span class="title function_">reactiveSetter</span> (newVal) &#123;</span><br><span class="line">      <span class="keyword">const</span> value = getter ? getter.<span class="title function_">call</span>(obj) : val</span><br><span class="line">      <span class="keyword">if</span> (newVal === value || (newVal !== newVal &amp;&amp; value !== value)) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (getter &amp;&amp; !setter) <span class="keyword">return</span></span><br><span class="line">      <span class="keyword">if</span> (setter) &#123;</span><br><span class="line">        setter.<span class="title function_">call</span>(obj, newVal)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        val = newVal</span><br><span class="line">      &#125;</span><br><span class="line">      childOb = !shallow &amp;&amp; <span class="title function_">observe</span>(newVal)</span><br><span class="line">      dep.<span class="title function_">notify</span>() <span class="comment">// =========================================å¼‚æ­¥æ›´æ–°å…¥å£</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><h2 id="dep-notify"><a href="#dep-notify" class="headerlink" title="dep.notify()"></a>dep.notify()</h2><p>é€šçŸ¥æ‰€æœ‰çš„ä¾èµ–æ›´æ–°ï¼Œæ”¶é›†åˆ°çš„æ‰€æœ‰ <code>watcher</code> æ‰§è¡Œ <code>update</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">notify () &#123;</span><br><span class="line">  <span class="keyword">const</span> subs = <span class="variable language_">this</span>.<span class="property">subs</span>.<span class="title function_">slice</span>()</span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span> &amp;&amp; !config.<span class="property">async</span>) &#123;</span><br><span class="line">    subs.<span class="title function_">sort</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a.<span class="property">id</span> - b.<span class="property">id</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, l = subs.<span class="property">length</span>; i &lt; l; i++) &#123;</span><br><span class="line">    subs[i].<span class="title function_">update</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="subs-i-update"><a href="#subs-i-update" class="headerlink" title="subs[i].update()"></a>subs[i].update()</h2><p>å®é™…ä¸Š <code>update</code> ä¸­æœ€ç»ˆæ˜¯è¦æ‰§è¡Œ <code>this.run()</code> çš„ï¼Œ<code>run</code> æœ€ç»ˆæ‰§è¡Œ <code>get</code> æ–¹æ³•ã€‚</p><p>ä½†æ˜¯ <code>Vue</code> åœ¨è¿™é‡Œå°†æ‰€æœ‰éœ€è¦æ‰§è¡Œ <code>run</code> æ–¹æ³•çš„ <code>watcher</code> é€šè¿‡é˜Ÿåˆ—çš„å½¢å¼è¿›è¡Œå­˜å‚¨èµ·æ¥ï¼Œå¹¶ä¸”é€šè¿‡åˆ·æ–°é˜Ÿåˆ—å‡½æ•°çš„å½¢å¼æœ€ç»ˆæ‰§è¡Œ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">update () &#123;</span><br><span class="line">  <span class="comment">/** computed */</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">lazy</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">dirty</span> = <span class="literal">true</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">sync</span>) &#123;</span><br><span class="line">    <span class="comment">/** æœ€ç»ˆæ‰§è¡Œ run */</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">run</span>()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">/** å…¥é˜Ÿ */</span></span><br><span class="line">    <span class="title function_">queueWatcher</span>(<span class="variable language_">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="queueWatcher"><a href="#queueWatcher" class="headerlink" title="queueWatcher"></a>queueWatcher</h2><p>å°† <code>watcher</code> å…¥é˜Ÿï¼Œä»¥åŠå°†åˆ·æ–°é˜Ÿåˆ—çš„å‡½æ•°æ”¾å…¥ <code>nextTick</code> ä¸­ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** å°† watcher æ”¾å…¥ watcher é˜Ÿåˆ— */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">queueWatcher</span> (<span class="attr">watcher</span>: <span class="title class_">Watcher</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> id = watcher.<span class="property">id</span></span><br><span class="line">  <span class="comment">// å¦‚æœ watcher å·²ç»å­˜åœ¨ï¼Œåˆ™è·³è¿‡ï¼Œä¸ä¼šé‡å¤å…¥é˜Ÿ</span></span><br><span class="line">  <span class="keyword">if</span> (has[id] == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="comment">// ç¼“å­˜ watcher.idï¼Œç”¨äºåˆ¤æ–­ watcher æ˜¯å¦å·²ç»å…¥é˜Ÿ</span></span><br><span class="line">    has[id] = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">if</span> (!flushing) &#123;</span><br><span class="line">      <span class="comment">// å½“å‰æ²¡æœ‰å¤„äºåˆ·æ–°é˜Ÿåˆ—çŠ¶æ€ï¼Œwatcher ç›´æ¥å…¥é˜Ÿ</span></span><br><span class="line">      queue.<span class="title function_">push</span>(watcher)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// å·²ç»åœ¨åˆ·æ–°é˜Ÿåˆ—äº†</span></span><br><span class="line">      <span class="comment">// ä»é˜Ÿåˆ—æœ«å°¾å¼€å§‹å€’åºéå†ï¼Œæ ¹æ®å½“å‰ watcher.id æ‰¾åˆ°å®ƒå¤§äºçš„ watcher.id çš„ä½ç½®ï¼Œç„¶åå°†è‡ªå·±æ’å…¥åˆ°è¯¥ä½ç½®ä¹‹åçš„ä¸‹ä¸€ä¸ªä½ç½®</span></span><br><span class="line">      <span class="comment">// å³å°†å½“å‰ watcher æ”¾å…¥å·²æ’åºçš„é˜Ÿåˆ—ä¸­ï¼Œä¸”é˜Ÿåˆ—ä»æ˜¯æœ‰åºçš„</span></span><br><span class="line">      <span class="keyword">let</span> i = queue.<span class="property">length</span> - <span class="number">1</span></span><br><span class="line">      <span class="keyword">while</span> (i &gt; index &amp;&amp; queue[i].<span class="property">id</span> &gt; watcher.<span class="property">id</span>) &#123;</span><br><span class="line">        i--</span><br><span class="line">      &#125;</span><br><span class="line">      queue.<span class="title function_">splice</span>(i + <span class="number">1</span>, <span class="number">0</span>, watcher)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// queue the flush</span></span><br><span class="line">    <span class="keyword">if</span> (!waiting) &#123;</span><br><span class="line">      waiting = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">NODE_ENV</span> !== <span class="string">&#x27;production&#x27;</span> &amp;&amp; !config.<span class="property">async</span>) &#123;</span><br><span class="line">        <span class="comment">// ç›´æ¥åˆ·æ–°è°ƒåº¦é˜Ÿåˆ—</span></span><br><span class="line">        <span class="comment">// ä¸€èˆ¬ä¸ä¼šèµ°è¿™å„¿ï¼ŒVue é»˜è®¤æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œå¦‚æœæ”¹ä¸ºåŒæ­¥æ‰§è¡Œï¼Œæ€§èƒ½ä¼šå¤§æ‰“æŠ˜æ‰£</span></span><br><span class="line">        <span class="title function_">flushSchedulerQueue</span>()</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * ç†Ÿæ‚‰çš„ nextTick =&gt; vm.$nextTickã€Vue.nextTick</span></span><br><span class="line"><span class="comment">       *   1ã€å°† å›è°ƒå‡½æ•°ï¼ˆflushSchedulerQueueï¼‰ æ”¾å…¥ callbacks æ•°ç»„</span></span><br><span class="line"><span class="comment">       *   2ã€é€šè¿‡ pending æ§åˆ¶å‘æµè§ˆå™¨ä»»åŠ¡é˜Ÿåˆ—ä¸­æ·»åŠ  flushCallbacks å‡½æ•°</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      <span class="title function_">nextTick</span>(flushSchedulerQueue)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="nextTick"><a href="#nextTick" class="headerlink" title="nextTick"></a>nextTick</h2><p>æ‰€æœ‰çš„å›è°ƒæ”¾å…¥åˆ° <code>callbacks</code> æ•°ç»„ä¸­ï¼Œç„¶åé€šè¿‡ <code>timerFunc</code> ï¼Œä¹Ÿå°±æ˜¯æµè§ˆå™¨çš„å¼‚æ­¥ä»»åŠ¡ï¼Œæˆ–è€…å®ä»»åŠ¡ï¼Œè¿›è¡Œå¼‚æ­¥æ‰§è¡Œã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">nextTick</span> (cb?: <span class="title class_">Function</span>, ctx?: <span class="title class_">Object</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> _resolve</span><br><span class="line">  callbacks.<span class="title function_">push</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (cb) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        cb.<span class="title function_">call</span>(ctx)</span><br><span class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">        <span class="title function_">handleError</span>(e, ctx, <span class="string">&#x27;nextTick&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (_resolve) &#123;</span><br><span class="line">      <span class="title function_">_resolve</span>(ctx)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">if</span> (!pending) &#123;</span><br><span class="line">    pending = <span class="literal">true</span></span><br><span class="line">    <span class="title function_">timerFunc</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (!cb &amp;&amp; <span class="keyword">typeof</span> <span class="title class_">Promise</span> !== <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">      _resolve = resolve</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="timerFunc"><a href="#timerFunc" class="headerlink" title="timerFunc"></a>timerFunc</h2><p>ä¼˜é›…é™çº§</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> timerFunc</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="title class_">Promise</span> !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="title function_">isNative</span>(<span class="title class_">Promise</span>)) &#123;</span><br><span class="line">  <span class="comment">/** promise */</span></span><br><span class="line">  <span class="keyword">const</span> p = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>()</span><br><span class="line">  timerFunc = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    p.<span class="title function_">then</span>(flushCallbacks)</span><br><span class="line">    <span class="keyword">if</span> (isIOS) <span class="built_in">setTimeout</span>(noop)</span><br><span class="line">  &#125;</span><br><span class="line">  isUsingMicroTask = <span class="literal">true</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (!isIE &amp;&amp; <span class="keyword">typeof</span> <span class="title class_">MutationObserver</span> !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; (</span><br><span class="line">  <span class="comment">/** MutationObserver */</span></span><br><span class="line">  <span class="title function_">isNative</span>(<span class="title class_">MutationObserver</span>) ||</span><br><span class="line">  <span class="title class_">MutationObserver</span>.<span class="title function_">toString</span>() === <span class="string">&#x27;[object MutationObserverConstructor]&#x27;</span></span><br><span class="line">)) &#123;</span><br><span class="line">  <span class="keyword">let</span> counter = <span class="number">1</span></span><br><span class="line">  <span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">MutationObserver</span>(flushCallbacks)</span><br><span class="line">  <span class="keyword">const</span> textNode = <span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="title class_">String</span>(counter))</span><br><span class="line">  observer.<span class="title function_">observe</span>(textNode, &#123;</span><br><span class="line">    <span class="attr">characterData</span>: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line">  timerFunc = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    counter = (counter + <span class="number">1</span>) % <span class="number">2</span></span><br><span class="line">    textNode.<span class="property">data</span> = <span class="title class_">String</span>(counter)</span><br><span class="line">  &#125;</span><br><span class="line">  isUsingMicroTask = <span class="literal">true</span></span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> setImmediate !== <span class="string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="title function_">isNative</span>(setImmediate)) &#123;</span><br><span class="line">  <span class="comment">/** setImmediate */</span></span><br><span class="line">  timerFunc = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">setImmediate</span>(flushCallbacks)</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="comment">/** setTimeout */</span></span><br><span class="line">  timerFunc = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(flushCallbacks, <span class="number">0</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¤§ä½“æµç¨‹"><a href="#å¤§ä½“æµç¨‹" class="headerlink" title="å¤§ä½“æµç¨‹"></a>å¤§ä½“æµç¨‹</h2><p>æ›´æ–°ï¼Œæ›´æ–°ï¼Œæœ€ç»ˆæ˜¯ä¸€å®šä¼šæ‰§è¡Œåˆ°æ›´æ–°çš„ï¼šæ›´æ–°æ•°æ®ï¼Œæ›´æ–°è§†å›¾ï¼Œè¿™é‡Œçš„æ•°æ®æ›´æ–°æŒ‡çš„æ˜¯ watcher ä¸­çš„ value å€¼ã€‚</p><p>åªä¸è¿‡ä»–é‡‡ç”¨çš„æ˜¯<code>ç»Ÿä¸€(callbacks,flushCallbacks)</code>çš„<code>å¼‚æ­¥(timerFunc,promise,setTimeout...)</code>æ›´æ–°ã€‚</p><p>ç»Ÿä¸€ï¼šè‡ªç„¶æ˜¯é€šè¿‡é˜Ÿåˆ—çš„å½¢å¼è¿›è¡Œå­˜å‚¨ä¹‹åï¼Œåœ¨è¿›è¡Œæ‰§è¡Œ<code>åˆ·æ–°é˜Ÿåˆ—</code>çš„æ–¹æ³•ã€‚</p><p>å¼‚æ­¥ï¼šå°±æ˜¯é€šè¿‡æµè§ˆå™¨çš„å¼‚æ­¥æ–¹å¼ï¼Œåœ¨ <code>Vue</code> ä¸­ä¹Ÿå°±ä½“ç°åœ¨ <code>nextTick</code> å½“ä¸­ ï¼Œè¿›è¡Œè°ƒç”¨<code>åˆ·æ–°é˜Ÿåˆ—</code>çš„æ–¹æ³•ã€‚</p><p><img src="https://s2.loli.net/2023/03/06/aswJTMAUuo4OCiE.png" alt="image-20230306100952238"></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
          <category> Vue2 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Source-Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vueæºç å­¦ä¹  - å“åº”å¼åŸç†</title>
      <link href="/2022/12/18/vue/Vue%20Resource%20Learing/3.%20%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86/"/>
      <url>/2022/12/18/vue/Vue%20Resource%20Learing/3.%20%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h1 id="å“åº”å¼åŸç†"><a href="#å“åº”å¼åŸç†" class="headerlink" title="å“åº”å¼åŸç†"></a>å“åº”å¼åŸç†</h1><h2 id="å…¥å£"><a href="#å…¥å£" class="headerlink" title="å…¥å£"></a>å…¥å£</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">initState</span>(<span class="params"></span>) &#123;</span><br><span class="line">  vm.<span class="property">_watchers</span> = []</span><br><span class="line">  <span class="keyword">const</span> opts = vm.<span class="property">$options</span></span><br><span class="line">  <span class="keyword">if</span> (opts.<span class="property">props</span>) <span class="title function_">initProps</span>(vm, opts.<span class="property">props</span>)</span><br><span class="line">  <span class="keyword">if</span> (opts.<span class="property">methods</span>) <span class="title function_">initMethods</span>(vm, opts.<span class="property">methods</span>)</span><br><span class="line">  <span class="keyword">if</span> (opts.<span class="property">data</span>) <span class="title function_">initData</span>(vm)</span><br><span class="line">  <span class="keyword">else</span> <span class="title function_">observe</span>(vm.<span class="property">_data</span> = &#123;&#125;, <span class="literal">true</span> <span class="comment">/* asRootData */</span>)</span><br><span class="line">  <span class="keyword">if</span> (opts.<span class="property">computed</span>) <span class="title function_">initComputed</span>(vm, opts.<span class="property">computed</span>)</span><br><span class="line">  <span class="keyword">if</span> (opts.<span class="property">watch</span> &amp;&amp; opts.<span class="property">watch</span> !== nativeWatch) <span class="title function_">initWatch</span>(vm, opts.<span class="property">watch</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="initState"><a href="#initState" class="headerlink" title="initState"></a>initState</h2><ul><li><code>initProps</code></li><li><code>initMethods</code></li><li><code>initData</code></li><li><code>initComputed</code></li><li><code>initWatch</code></li></ul><blockquote><p>æ€è€ƒï¼šä¸ºä»€ä¹ˆ Vue ä¸­èƒ½é€šè¿‡ this ç›´æ¥è®¿é—®ï¼Œ<code>propsã€methodsã€computedã€data</code> ä¸­çš„æ•°æ®ï¼Ÿ</p><p>è¿™ä¹Ÿå°±æ˜¯ <code>initPropsã€initMethodsã€initDataã€initComputed</code> çš„ä½œç”¨ï¼Œåœ¨å†…éƒ¨ä¼šå°†æ•°æ®é€šè¿‡ <code>proxy</code> ä»£ç†åˆ°å…¨å±€çš„ <code>_data</code> ä¸­ï¼Œå› æ­¤å¯ä»¥è®¿é—®</p></blockquote><h2 id="initData"><a href="#initData" class="headerlink" title="initData"></a>initData</h2><ul><li><code>Object.defineProperty</code> æ•°æ®æ‹¦æˆª</li><li><code>Dep</code> ä¾èµ–æ”¶é›†</li><li><code>Wathcer</code></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿‡ç¨‹</span></span><br><span class="line"><span class="title class_">Observer</span> -&gt; defineReactive -&gt; dep = <span class="keyword">new</span> <span class="title class_">Dep</span>() -&gt; <span class="title class_">Object</span>.<span class="title function_">definProperty</span>() -&gt; getterã€setter</span><br><span class="line">    getter -&gt; <span class="keyword">if</span>(<span class="title class_">Dep</span>.<span class="property">terget</span>) -&gt; dep.<span class="title function_">depend</span>() </span><br><span class="line">             -&gt; <span class="title class_">Dep</span>.<span class="property">target</span>.<span class="title function_">addDep</span>(<span class="variable language_">this</span>) -&gt; dep.<span class="title function_">addSub</span>(<span class="variable language_">this</span>)</span><br><span class="line">    setter -&gt; dep.<span class="title function_">notify</span>() </span><br><span class="line">             -&gt; watcher.<span class="title function_">update</span>() -&gt; watcher.<span class="property">dirty</span> = <span class="literal">true</span> -&gt; watcher.<span class="title function_">run</span>() -&gt; watcher.<span class="title function_">get</span>()</span><br></pre></td></tr></table></figure><blockquote><p><code>Dep.target</code> æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>Dep.target ä¸º Dep ç±»çš„ä¸€ä¸ªé™æ€å±æ€§ï¼Œå€¼ä¸º watcherï¼Œåœ¨å®ä¾‹åŒ– Watcher æ—¶ä¼šè¢«è®¾ç½®ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ new Watcher(vm, exp, cb, options) æ—¶ï¼Œä¼šæ‰§è¡Œä¼ é€’çš„å›è°ƒå‡½æ•°ï¼Œè‹¥å›è°ƒä¸­å­˜åœ¨ vm.key è¯»å–è¡Œä¸ºï¼Œå°†ä¼šè®¾ç½® Dep.target ä¸ºå½“å‰çš„ watcherï¼Œè¿›è€Œè¿›è¡Œåç»­çš„ä¾èµ–æ”¶é›†ã€‚</p></blockquote><blockquote><p><code>watcher.dirty</code> æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</p><p><code>dirty</code> å…¶å®å°±æ˜¯ <code>Computed</code> å±æ€§çš„èƒ½å¤Ÿè¿›è¡Œç¼“å­˜çš„æ ¸å¿ƒã€‚</p><p><code>Computed</code> å®é™…ä¸Šè¿˜æ˜¯é€šè¿‡ <code>watch</code> å»å®ç°çš„ï¼Œåªä¸è¿‡é‡‡ç”¨çš„æ˜¯æ‡’æ‰§è¡Œçš„æ–¹å¼ã€‚ç„¶è€Œ <code>watcher</code> æ‡’æ‰§è¡Œçš„æ—¶å€™ä¼šæ‰§è¡Œ <code>evaluate</code> æ–¹æ³•ï¼Œè¿™é‡Œä¼šå°† <code>dirty</code> ç½®ä¸º <code>false</code>ã€‚ç„¶è€Œ <code>Computed</code> åœ¨åˆå§‹åŒ–çš„æ—¶å€™ä¼šåˆ›å»ºä¸€ä¸ªä¸“æœ‰çš„ <code>ComputedGetter</code>ï¼Œç±»ä¼¼æ™®é€šçš„ <code>getter</code> å‡½æ•°ï¼Œæ¯æ¬¡æ‰§è¡Œ<code>computedGetter</code>å°±ä¼šåˆ¤æ–­ <code>watcher.dirty</code> ï¼Œè‹¥ä¸º<code>true</code>æ‰§è¡Œ <code>evaluate</code>ï¼Œæœ€åè¿”å› <code>watcher.value</code>ã€‚</p><p>é‚£ä¹ˆä»€ä¹ˆæ—¶å€™ <code>dirty</code> ä¸º <code>true</code> å‘¢ï¼Ÿ</p><p>å®é™…ä¸Šæ˜¯å½“è°ƒç”¨ <code>Watcher.update</code> æ–¹æ³•çš„æ—¶å€™ä¼šå°†å…¶ç½®ä¸º <code>true</code>ã€‚æˆ‘ä»¬çŸ¥é“å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè°ƒç”¨ <code>setter</code> æ–¹æ³•ï¼Œå¹¶æ‰§è¡Œ <code>watcher.update</code> ã€‚å› æ­¤ä¹Ÿä¿è¯äº†ï¼Œåœ¨ä¸€æ¬¡æ¸²æŸ“ä¸­ï¼Œ<code>computed</code> åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
          <category> Vue2 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Source-Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vueæºç å­¦ä¹  - åˆå§‹åŒ–è¿‡ç¨‹</title>
      <link href="/2022/12/16/vue/Vue%20Resource%20Learing/2.%20%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%87%E7%A8%8B/"/>
      <url>/2022/12/16/vue/Vue%20Resource%20Learing/2.%20%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%87%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Vue-åˆå§‹åŒ–è¿‡ç¨‹"><a href="#Vue-åˆå§‹åŒ–è¿‡ç¨‹" class="headerlink" title="Vue åˆå§‹åŒ–è¿‡ç¨‹"></a>Vue åˆå§‹åŒ–è¿‡ç¨‹</h1><h2 id="å…¥å£"><a href="#å…¥å£" class="headerlink" title="å…¥å£"></a>å…¥å£</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">                                        <span class="comment">// src/core/instance/index.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Vue</span>(<span class="params">options</span>) &#123;</span><br><span class="line">  <span class="comment">// Vue.prototype._init</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">_init</span>(options)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">initMixin</span>(); <span class="comment">// å®šä¹‰ _init</span></span><br></pre></td></tr></table></figure><h2 id="initMixin"><a href="#initMixin" class="headerlink" title="initMixin"></a>initMixin</h2><ul><li>å¤„ç†ç»„ä»¶é…ç½®é¡¹ <ul><li>å­ç»„ä»¶æ€§èƒ½ä¼˜åŒ– initInternalComponent(vm, options) æ‰“å¹³é…ç½®é¡¹ï¼Œé¿å…åŸå‹é“¾æŸ¥æ‰¾ï¼Œæé«˜æ•ˆç‡</li><li>æ ¹ç»„ä»¶é€‰é¡¹åˆå¹¶</li></ul></li><li>initCycle(vm) <ul><li>å®šä¹‰å…³ç³»å±æ€§ $parent $children $root $refs</li></ul></li><li>initEvent(vm)<ul><li>åˆå§‹åŒ–è‡ªå®šä¹‰äº‹ä»¶</li></ul></li><li>initRender(vm)<ul><li>åˆå§‹åŒ–æ’æ§½ï¼Œè·å– &#96;this.$slotsï¼Œå®šä¹‰ this._cï¼Œå³ create Element æ–¹æ³•ï¼Œå¹³æ—¶ä½¿ç”¨çš„ h å‡½æ•°</li></ul></li><li>callHook(vm, â€˜beforeCreateâ€™)</li><li>initInjecttions(vm)<ul><li>é’ˆå¯¹ provide&#x2F;injectï¼Œæ•°æ®æ³¨å…¥ï¼Œä¸€èˆ¬ä½¿ç”¨åœ¨å°è£…é«˜é˜¶æ’ä»¶çš„æ—¶å€™ä½¿ç”¨ï¼Œä¸æ¨èåœ¨æ™®é€šåº”ç”¨ç¨‹åºä¸­ä½¿ç”¨</li><li>åˆå§‹åŒ– inject é€‰é¡¹ï¼Œå¾—åˆ° {key: val} å½¢å¼çš„é…ç½®å¯¹è±¡ï¼Œå¹¶åšå“åº”å¼å¤„ç†</li><li>provide å®é™…ä¸Šå¹¶éçœŸæ­£çš„æ³¨å…¥åˆ°æ¯ä¸€ä¸ªå­ä»£ï¼Œè€Œæ˜¯å­˜åœ¨ç¥–ä»£çš„ï¼Œé€šè¿‡ inject å‘ä¸ŠæŸ¥è¯¢ provide é€‰é¡¹</li></ul></li><li>initState(vm)<ul><li>å“åº”å¼åŸç†æ ¸å¿ƒï¼Œå¤„ç† propsã€methodsã€computedã€dataã€watch</li></ul></li><li>initProvide(vm) </li><li>callHook(vm, â€˜createdâ€™)</li><li>æŒ‚è½½</li></ul><h2 id="injectã€stateã€provide-é¡ºåºé—®é¢˜"><a href="#injectã€stateã€provide-é¡ºåºé—®é¢˜" class="headerlink" title="injectã€stateã€provide é¡ºåºé—®é¢˜"></a>injectã€stateã€provide é¡ºåºé—®é¢˜</h2><p>é‡ç‚¹åœ¨äº <code>state</code>ï¼š</p><ul><li><code>state</code> ä¸­éœ€è¦è®¿é—®åˆ°ä¸Šå±‚æ”¶é›†åˆ°çš„ inject æ•°æ®ã€‚</li><li><code>provide</code> ä¸­éœ€è¦è®¿é—®åˆ° state ä¸­çš„æ•°æ®</li></ul>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
          <category> Vue2 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Source-Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vueæºç å­¦ä¹  - å‰è¨€</title>
      <link href="/2022/12/15/vue/Vue%20Resource%20Learing/1.%20%E5%89%8D%E8%A8%80/"/>
      <url>/2022/12/15/vue/Vue%20Resource%20Learing/1.%20%E5%89%8D%E8%A8%80/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><ol><li><p>æºç ä¸‹è½½</p><p><code>git clone https://github.com/vuejs/vue.git</code></p></li><li><p>source mapï¼š</p><p>åœ¨ <code>package.json.script</code> ä¸­çš„ <code>dev</code> å‘½ä»¤ä¸­æ·»åŠ  <code>--sourcemap</code>ï¼Œå½¢æˆæºç æ˜ å°„ï¼Œä¾¿äºè°ƒè¯•ã€‚</p></li></ol><h2 id="æ‰«ç›²"><a href="#æ‰«ç›²" class="headerlink" title="æ‰«ç›²"></a>æ‰«ç›²</h2><blockquote><p>æ‰§è¡Œ <code>npm run build</code> å‘½ä»¤ä¹‹åä¼šå‘ç° <code>dist</code> ï¼Œç›®å½•ä¸‹ç”Ÿæˆäº†å¤šä¸ª <code>vue.*.js</code> æ–‡ä»¶ï¼Œå„æœ‰ä»€ä¹ˆå«ä¹‰å‘¢ï¼Ÿ</p></blockquote><ol><li><p>æ„å»ºæ–‡ä»¶åˆ†ç±»</p><table><thead><tr><th></th><th>UMD</th><th>CommonJS</th><th>ES Module</th></tr></thead><tbody><tr><td>Full</td><td>vue.js</td><td>vue.common.js</td><td>vue.esm.js</td></tr><tr><td>Runtime-only</td><td>vue.runtime.js</td><td>vue.runtime.common.js</td><td>vue.runtime.esm.js</td></tr><tr><td>Full (prod)</td><td>vue.min.js</td><td>vue.common.prod.js</td><td></td></tr><tr><td>Runtime-only (prod)</td><td>vue.runtime.min.js</td><td>vue.runtime.common.js</td><td></td></tr></tbody></table></li><li><p>åè¯è§£é‡Š</p><ul><li><strong>Fullï¼š</strong> å…¨é‡åŒ…ï¼ŒåŒ…å«ç¼–è¯‘å™¨<code>(complier)</code>å’Œè¿è¡Œ<code>(runtime)</code>æ—¶ã€‚</li><li><strong>Compilerï¼š</strong>ç¼–è¯‘å™¨ï¼Œè´Ÿè´£è®²æ¨¡æ¿å­—ç¬¦ä¸²ç¼–è¯‘ä¸º <code>JavaScript</code> è¯­æ³•çš„ <code>rander</code> å‡½æ•°ã€‚</li><li><strong>Runtimeï¼š</strong>è´Ÿè´£åˆ›å»º <code>Vue</code> å®ä¾‹ã€æ¸²æŸ“å‡½æ•°ã€<code>path</code> è™šæ‹Ÿ <code>DOM</code> ç­‰ï¼ŒåŸºæœ¬ä¸Šé™¤äº†ç¼–è¯‘å™¨ä¹‹å¤–çš„ä»£ç éƒ½å±äºè¿è¡Œæ—¶ä»£ç ã€‚</li><li><strong>UMDï¼š</strong>å…¼å®¹ <code>CommonJS</code> å’Œ <code>AMD</code> è§„èŒƒã€‚</li><li><strong>CommonJSï¼š</strong>ç»å…¸ <code>nodeJS</code> è§„èŒƒã€‚</li></ul></li></ol><h2 id="æºç ç›®å½•ç»“æ„"><a href="#æºç ç›®å½•ç»“æ„" class="headerlink" title="æºç ç›®å½•ç»“æ„"></a>æºç ç›®å½•ç»“æ„</h2><p>é€šè¿‡ç›®å½•ç»“æ„çš„é˜…è¯»ï¼Œå¯¹æºç æœ‰ä¸€ä¸ªå¤§è‡´çš„äº†è§£ï¼ŒçŸ¥é“å“ªäº›ä¸œè¥¿éœ€è¦å»å“ªçœ‹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ benchmarks                  æ€§èƒ½ã€åŸºå‡†æµ‹è¯•</span><br><span class="line">â”œâ”€â”€ dist                        æ„å»ºæ‰“åŒ…çš„è¾“å‡ºç›®å½•</span><br><span class="line">â”œâ”€â”€ examples                    æ¡ˆä¾‹ç›®å½•</span><br><span class="line">â”œâ”€â”€ flow                        flow è¯­æ³•çš„ç±»å‹å£°æ˜</span><br><span class="line">â”œâ”€â”€ packages                    ä¸€äº›é¢å¤–çš„åŒ…ï¼Œæ¯”å¦‚ï¼šè´Ÿè´£æœåŠ¡ç«¯æ¸²æŸ“çš„åŒ… vue-server-rendererã€é…åˆ vue-loader ä½¿ç”¨çš„çš„ vue-template-compilerï¼Œè¿˜æœ‰ weex ç›¸å…³çš„</span><br><span class="line">â”‚   â”œâ”€â”€ vue-server-renderer</span><br><span class="line">â”‚   â”œâ”€â”€ vue-template-compiler</span><br><span class="line">â”‚   â”œâ”€â”€ weex-template-compiler</span><br><span class="line">â”‚   â””â”€â”€ weex-vue-framework</span><br><span class="line">â”œâ”€â”€ scripts                     æ‰€æœ‰çš„é…ç½®æ–‡ä»¶çš„å­˜æ”¾ä½ç½®ï¼Œæ¯”å¦‚ rollup çš„é…ç½®æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ src                         vue æºç ç›®å½•</span><br><span class="line">â”‚   â”œâ”€â”€ compiler                ç¼–è¯‘å™¨</span><br><span class="line">â”‚   â”œâ”€â”€ core                    è¿è¡Œæ—¶çš„æ ¸å¿ƒåŒ…</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ components          å…¨å±€ç»„ä»¶ï¼Œæ¯”å¦‚ keep-alive</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ config.js           ä¸€äº›é»˜è®¤é…ç½®é¡¹</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ global-api          å…¨å±€ APIï¼Œæ¯”å¦‚ç†Ÿæ‚‰çš„ï¼šVue.use()ã€Vue.component() ç­‰</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ instance            Vue å®ä¾‹ç›¸å…³çš„ï¼Œæ¯”å¦‚ Vue æ„é€ å‡½æ•°å°±åœ¨è¿™ä¸ªç›®å½•ä¸‹</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ observer            å“åº”å¼åŸç†</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ util                å·¥å…·æ–¹æ³•</span><br><span class="line">â”‚   â”‚   â””â”€â”€ vdom                è™šæ‹Ÿ DOM ç›¸å…³ï¼Œæ¯”å¦‚ç†Ÿæ‚‰çš„ patch ç®—æ³•å°±åœ¨è¿™å„¿</span><br><span class="line">â”‚   â”œâ”€â”€ platforms               å¹³å°ç›¸å…³çš„ç¼–è¯‘å™¨ä»£ç </span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ web</span><br><span class="line">â”‚   â”‚   â””â”€â”€ weex</span><br><span class="line">â”‚   â”œâ”€â”€ server                  æœåŠ¡ç«¯æ¸²æŸ“ç›¸å…³</span><br><span class="line">â”œâ”€â”€ test                        æµ‹è¯•ç›®å½•</span><br><span class="line">â”œâ”€â”€ types                       TS ç±»å‹å£°æ˜</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Vue </category>
          
          <category> Vue2 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Source-Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯æ¨¡å—åŒ–</title>
      <link href="/2022/12/03/JS/%E5%89%8D%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96/"/>
      <url>/2022/12/03/JS/%E5%89%8D%E7%AB%AF%E6%A8%A1%E5%9D%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰ç«¯æ¨¡å—åŒ–"><a href="#å‰ç«¯æ¨¡å—åŒ–" class="headerlink" title="å‰ç«¯æ¨¡å—åŒ–"></a>å‰ç«¯æ¨¡å—åŒ–</h1><h2 id="æ¨¡å—åŒ–è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ"><a href="#æ¨¡å—åŒ–è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ" class="headerlink" title="æ¨¡å—åŒ–è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>æ¨¡å—åŒ–è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h2><p>åœ¨è½¯ä»¶å·¥ç¨‹çš„è®¾è®¡åŸåˆ™ä¸­ï¼Œæœ‰ä¸€ä¸ªåŸåˆ™å«â€œå•ä¸€èŒè´£â€</p><p>â€œå•ä¸€èŒè´£â€ çš„ç›®çš„å°±æ˜¯å‡å°‘åŠŸèƒ½ç»´æŠ¤å¸¦æ¥çš„é£é™©ï¼ŒæŠŠä»£ç å—çš„èŒè´£å•ä¸€åŒ–ï¼Œè®©ä»£ç çš„å¯ç»´æŠ¤æ€§æ›´é«˜ã€‚</p><p>ä¸€ä¸ªå®Œæ•´ä¸šåŠ¡çš„å†…éƒ¨å®ç°ï¼Œä¸åº”è¯¥æŠŠå„ç§ä»£ç éƒ½è€¦åˆåœ¨ä¸€èµ·ï¼Œè€Œåº”è¯¥æŒ‰ç…§èŒè´£å»åˆ’åˆ†å¥½ä»£ç å—ï¼Œå†è¿›è¡Œç»„åˆï¼Œå½¢æˆä¸€ä¸ª â€œé«˜å†…èšï¼Œä½è€¦åˆâ€ çš„å·¥ç¨‹è®¾è®¡ã€‚</p><p>æ¨¡å—åŒ–å°±æ˜¯ç”±æ­¤è€Œæ¥ï¼Œåœ¨å‰ç«¯å·¥ç¨‹é‡Œï¼Œæ¯ä¸ªå•ä¸€èŒè´£çš„ä»£ç å—ï¼Œå°±å«åšæ¨¡å—ï¼ˆ Module ï¼‰ ï¼Œæ¨¡å—æœ‰è‡ªå·±çš„ä½œç”¨åŸŸï¼ŒåŠŸèƒ½ä¸ä¸šåŠ¡è§£è€¦ï¼Œéå¸¸æ–¹ä¾¿å¤ç”¨å’Œç§»æ¤ã€‚</p><h2 id="å®ç°æ¨¡å—åŒ–çš„æ–¹å¼"><a href="#å®ç°æ¨¡å—åŒ–çš„æ–¹å¼" class="headerlink" title="å®ç°æ¨¡å—åŒ–çš„æ–¹å¼"></a>å®ç°æ¨¡å—åŒ–çš„æ–¹å¼</h2><ul><li>CommonJS</li><li>ES Module</li><li>UMD</li><li>AMD</li></ul><p>å¦‚ä»ŠåŸºæœ¬éƒ½æ˜¯ ESM å’Œ CJS çš„å¤©ä¸‹ã€‚</p><h2 id="CommonJS"><a href="#CommonJS" class="headerlink" title="CommonJS"></a>CommonJS</h2><h3 id="åŸºæœ¬è¯­æ³•"><a href="#åŸºæœ¬è¯­æ³•" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h3><p>CJS ä½¿ç”¨ <code>module.exports</code> è¯­æ³•å¯¼å‡ºæ¨¡å—ï¼Œå¯ä»¥å¯¼å‡ºä»»æ„åˆæ³•çš„ JavaScript ç±»å‹ï¼Œä¾‹å¦‚ï¼šå­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ã€å¯¹è±¡ã€æ•°ç»„ã€å‡½æ•°ç­‰ç­‰ã€‚</p><p>ä½¿ç”¨ <code>require</code> å¯¼å…¥æ¨¡å—ï¼Œåœ¨å¯¼å…¥çš„æ—¶å€™ï¼Œå½“æ–‡ä»¶æ‰©å±•åæ˜¯ <code>.js</code> æ—¶ï¼Œå¯ä»¥åªå†™æ–‡ä»¶åï¼Œè€Œæ­¤æ—¶ä½¿ç”¨çš„æ˜¯ <code>.cjs</code> æ‰©å±•åï¼Œæ‰€ä»¥éœ€è¦å®Œæ•´çš„ä¹¦å†™ã€‚</p><h3 id="é»˜è®¤å¯¼å‡º"><a href="#é»˜è®¤å¯¼å‡º" class="headerlink" title="é»˜è®¤å¯¼å‡º"></a>é»˜è®¤å¯¼å‡º</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** å¯¼å‡º */</span></span><br><span class="line">modules.<span class="property">exports</span> = <span class="string">&#x27;hello world&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** å¯¼å…¥ */</span></span><br><span class="line"><span class="keyword">const</span> h = <span class="built_in">require</span>(<span class="string">&#x27;./module.js&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(h)</span><br></pre></td></tr></table></figure><h3 id="å‘½åå¯¼å‡ºï¼ˆå¯¹è±¡ï¼‰"><a href="#å‘½åå¯¼å‡ºï¼ˆå¯¹è±¡ï¼‰" class="headerlink" title="å‘½åå¯¼å‡ºï¼ˆå¯¹è±¡ï¼‰"></a>å‘½åå¯¼å‡ºï¼ˆå¯¹è±¡ï¼‰</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** å¯¼å‡º */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bar = <span class="string">&#x27;Akira&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123; foo, bar &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** å¯¼å…¥*/</span></span><br><span class="line"><span class="keyword">const</span> h = <span class="built_in">require</span>(<span class="string">&#x27;./module.js&#x27;</span>)</span><br><span class="line"><span class="comment">/** å¯¼å…¥é€šè¿‡å¯¹è±¡è§£æ„ æ›´æ”¹å‘½å */</span></span><br><span class="line"><span class="keyword">const</span> &#123; <span class="attr">newFoo</span>: foo, <span class="attr">newBar</span>: bar &#125; = <span class="built_in">require</span>(<span class="string">&#x27;./module.js&#x27;</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(h) <span class="comment">// &#123; foo: [Function: foo], bar: &#x27;Akira&#x27; &#125;</span></span><br><span class="line">h.<span class="title function_">foo</span>() <span class="comment">// hello</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(h.<span class="property">bar</span>) <span class="comment">// Akira</span></span><br></pre></td></tr></table></figure><h2 id="ES-Module"><a href="#ES-Module" class="headerlink" title="ES Module"></a>ES Module</h2><p>ES Module æ˜¯æ–°ä¸€ä»£çš„æ¨¡å—åŒ–æ ‡å‡†ï¼Œå®ƒæ˜¯åœ¨ ES6ï¼ˆ ECMAScript 2015 ï¼‰ç‰ˆæœ¬æ¨å‡ºçš„ï¼Œæ˜¯åŸç”Ÿ JavaScript çš„ä¸€éƒ¨åˆ†ã€‚</p><h3 id="åŸºæœ¬è¯­æ³•-1"><a href="#åŸºæœ¬è¯­æ³•-1" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h3><p>ESM ä½¿ç”¨ <code>export default</code> ï¼ˆé»˜è®¤å¯¼å‡ºï¼‰å’Œ <code>export</code> ï¼ˆå‘½åå¯¼å‡ºï¼‰è¿™ä¸¤ä¸ªè¯­æ³•å¯¼å‡ºæ¨¡å—ï¼Œå’Œ CJS ä¸€æ ·ï¼Œ ESM ä¹Ÿå¯ä»¥å¯¼å‡ºä»»æ„åˆæ³•çš„ JavaScript ç±»å‹ï¼Œä¾‹å¦‚ï¼šå­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ã€å¯¹è±¡ã€æ•°ç»„ã€å‡½æ•°ç­‰ç­‰ã€‚</p><p>ä½¿ç”¨ <code>import ... from ...</code> å¯¼å…¥æ¨¡å—ï¼Œåœ¨å¯¼å…¥çš„æ—¶å€™ï¼Œå¦‚æœæ–‡ä»¶æ‰©å±•åæ˜¯ <code>.js</code> åˆ™å¯ä»¥çœç•¥æ–‡ä»¶ååç¼€ï¼Œå¦åˆ™éœ€è¦æŠŠæ‰©å±•åä¹Ÿå®Œæ•´å†™å‡ºæ¥ã€‚</p><h3 id="é»˜è®¤å¯¼å‡º-1"><a href="#é»˜è®¤å¯¼å‡º-1" class="headerlink" title="é»˜è®¤å¯¼å‡º"></a>é»˜è®¤å¯¼å‡º</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** å¯¼å‡º1 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">&#x27;hello&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** å¯¼å‡º2 */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello&#x27;</span>) &#125;</span><br><span class="line"><span class="keyword">const</span> bar = <span class="string">&#x27;Akira&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123; foo, bar &#125; <span class="comment">// è™½ç„¶é»˜è®¤å¯¼å‡ºå¯¹è±¡ï¼Œä½†ä¸èƒ½ç›´æ¥é€šè¿‡è§£æ„è·å–</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** å¯¼å…¥1 */</span></span><br><span class="line"><span class="keyword">import</span> h <span class="keyword">from</span> <span class="string">&#x27;./module.js&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(h)</span><br><span class="line"></span><br><span class="line"><span class="comment">/** å¯¼å‡º2 */</span></span><br><span class="line"><span class="keyword">import</span> h <span class="keyword">from</span> <span class="string">&#x27;./module.js&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="å‘½åå¯¼å‡º"><a href="#å‘½åå¯¼å‡º" class="headerlink" title="å‘½åå¯¼å‡º"></a>å‘½åå¯¼å‡º</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** å¯¼å‡º */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hello&#x27;</span>) &#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> bar = <span class="string">&#x27;Akira</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** å¯¼å…¥ */</span></span><br><span class="line"><span class="string">import &#123; foo, bar &#125; from &#x27;</span>./<span class="variable language_">module</span>.<span class="property">js</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">/** å‘½åå¯¼å…¥ */</span></span><br><span class="line"><span class="string">import * as h from &#x27;</span>./<span class="variable language_">module</span>.<span class="property">js</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">import &#123; foo as newFoo, bar as newB &#125; from &#x27;</span>./<span class="variable language_">module</span>.<span class="property">js</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>element-plus è¡¨å•è‡ªå®šä¹‰éªŒè¯</title>
      <link href="/2022/11/16/bugRoad/element-plus%20%E8%A1%A8%E5%8D%95%E8%87%AA%E5%AE%9A%E4%B9%89%E9%AA%8C%E8%AF%81/"/>
      <url>/2022/11/16/bugRoad/element-plus%20%E8%A1%A8%E5%8D%95%E8%87%AA%E5%AE%9A%E4%B9%89%E9%AA%8C%E8%AF%81/</url>
      
        <content type="html"><![CDATA[<h1 id="element-plus-è¡¨å•è‡ªå®šä¹‰éªŒè¯"><a href="#element-plus-è¡¨å•è‡ªå®šä¹‰éªŒè¯" class="headerlink" title="element-plus è¡¨å•è‡ªå®šä¹‰éªŒè¯"></a>element-plus è¡¨å•è‡ªå®šä¹‰éªŒè¯</h1><p>ç±»ä¼¼æˆ‘ä»¬éœ€è¦éªŒè¯åªç”± <code>æ•°å­—å’Œè‹±æ–‡å­—æ¯ç»„æˆ</code> çš„è¡¨å•ï¼š</p><h2 id="validator"><a href="#validator" class="headerlink" title="validator"></a>validator</h2><p>è¦éªŒè¯è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨ Element Plus è¡¨å•éªŒè¯ä¸­çš„è‡ªå®šä¹‰éªŒè¯å‡½æ•°æ¥å®ç°ã€‚è‡ªå®šä¹‰éªŒè¯å‡½æ•°å¯ä»¥æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œå³å½“å‰éªŒè¯å­—æ®µçš„å€¼ï¼Œç„¶åæ ¹æ®éœ€æ±‚è¿›è¡ŒéªŒè¯å¹¶è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼è¡¨ç¤ºéªŒè¯ç»“æœã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•éªŒè¯è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;form&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;rules&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;form&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;80px&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;è‹±æ–‡+æ•°å­—&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;alphanumeric&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;form.alphanumeric&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;submitForm&quot;</span>&gt;</span>æäº¤<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">form</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">alphanumeric</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">rules</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">alphanumeric</span>: [</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;è¯·è¾“å…¥è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">validator</span>: <span class="variable language_">this</span>.<span class="property">validateAlphanumeric</span>, <span class="attr">message</span>: <span class="string">&quot;è¯·è¾“å…¥è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">          ],</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">validateAlphanumeric</span>(<span class="params">rule, value, callback</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> alphanumericRegex = <span class="regexp">/^[a-zA-Z0-9]+$/</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (value &amp;&amp; !alphanumericRegex.<span class="title function_">test</span>(value)) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">callback</span>(<span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;è¯·è¾“å…¥è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹&quot;</span>));</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">callback</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">submitForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">form</span>.<span class="title function_">validate</span>(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (valid) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// è¡¨å•éªŒè¯é€šè¿‡</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;éªŒè¯é€šè¿‡&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// è¡¨å•éªŒè¯å¤±è´¥</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;éªŒè¯å¤±è´¥&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªè‡ªå®šä¹‰éªŒè¯å‡½æ•° <code>validateAlphanumeric</code>ï¼Œç”¨äºéªŒè¯è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹ã€‚åœ¨éªŒè¯å‡½æ•°ä¸­ï¼Œä½¿ç”¨äº†ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ <code>/^[a-zA-Z0-9]+$/</code> æ¥åŒ¹é…è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹ï¼Œå¦‚æœéªŒè¯å¤±è´¥åˆ™è¿”å›ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼Œå¦åˆ™è¿”å›ç©ºã€‚</p><p>åœ¨è¡¨å•éªŒè¯è§„åˆ™ä¸­ï¼Œä½¿ç”¨äº† <code>validator</code> å±æ€§æ¥æŒ‡å®šè‡ªå®šä¹‰éªŒè¯å‡½æ•°ï¼Œå¹¶å°†éªŒè¯å¤±è´¥æ—¶çš„é”™è¯¯ä¿¡æ¯è®¾ç½®ä¸ºâ€œè¯·è¾“å…¥è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹â€ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªç¤ºä¾‹ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼åªèƒ½éªŒè¯è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹ï¼Œå¦‚æœéœ€è¦éªŒè¯å…¶ä»–ç±»å‹çš„ç»„åˆï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚åŒæ—¶ï¼Œä¹Ÿå¯ä»¥æ ¹æ®éœ€æ±‚åœ¨è‡ªå®šä¹‰éªŒè¯å‡½æ•°ä¸­æ·»åŠ å…¶ä»–çš„éªŒè¯é€»è¾‘ï¼Œä¾‹å¦‚æœ€å°é•¿åº¦ã€æœ€å¤§é•¿åº¦ç­‰ç­‰ã€‚</p><h2 id="pattern"><a href="#pattern" class="headerlink" title="pattern"></a>pattern</h2><p>é™¤äº†ä½¿ç”¨è‡ªå®šä¹‰éªŒè¯å‡½æ•°ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥éªŒè¯è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹ã€‚ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å¯ä»¥æ›´åŠ çµæ´»åœ°æ§åˆ¶éªŒè¯è§„åˆ™ï¼Œä½†éœ€è¦ç†Ÿæ‚‰æ­£åˆ™è¡¨è¾¾å¼çš„è¯­æ³•å’Œç”¨æ³•ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥éªŒè¯è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;form&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;rules&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;form&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;80px&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;è‹±æ–‡+æ•°å­—&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;alphanumeric&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;form.alphanumeric&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;submitForm&quot;</span>&gt;</span>æäº¤<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">form</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">alphanumeric</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">rules</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">alphanumeric</span>: [</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;è¯·è¾“å…¥è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">            &#123; <span class="attr">pattern</span>: <span class="regexp">/^[a-zA-Z0-9]+$/</span>, <span class="attr">message</span>: <span class="string">&quot;è¯·è¾“å…¥è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">          ],</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">submitForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">form</span>.<span class="title function_">validate</span>(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (valid) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// è¡¨å•éªŒè¯é€šè¿‡</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;éªŒè¯é€šè¿‡&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// è¡¨å•éªŒè¯å¤±è´¥</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;éªŒè¯å¤±è´¥&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨äº†æ­£åˆ™è¡¨è¾¾å¼ <code>/^[a-zA-Z0-9]+$/</code> æ¥éªŒè¯è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹ã€‚åœ¨è¡¨å•éªŒè¯è§„åˆ™ä¸­ï¼Œä½¿ç”¨äº† <code>pattern</code> å±æ€§æ¥æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¹¶å°†éªŒè¯å¤±è´¥æ—¶çš„é”™è¯¯ä¿¡æ¯è®¾ç½®ä¸ºâ€œè¯·è¾“å…¥è‹±æ–‡å’Œæ•°å­—çš„ç»„åˆç±»å‹â€ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ <code>/^</code> è¡¨ç¤ºåŒ¹é…å­—ç¬¦ä¸²çš„å¼€å¤´ï¼Œ<code>[a-zA-Z0-9]</code> è¡¨ç¤ºåŒ¹é…è‹±æ–‡å’Œæ•°å­—ï¼Œ<code>+</code> è¡¨ç¤ºåŒ¹é…å‰é¢çš„å­—ç¬¦è‡³å°‘ä¸€æ¬¡ï¼Œ<code>$</code> è¡¨ç¤ºåŒ¹é…å­—ç¬¦ä¸²çš„ç»“å°¾ã€‚å› æ­¤ï¼Œè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯ä»¥ç¡®ä¿è¾“å…¥çš„å­—ç¬¦ä¸²ä»…åŒ…å«è‹±æ–‡å’Œæ•°å­—ï¼Œå¹¶ä¸”ä¸ä¸ºç©ºã€‚</p><p>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼çš„ä¼˜ç‚¹æ˜¯å¯ä»¥æ›´åŠ çµæ´»åœ°æ§åˆ¶éªŒè¯è§„åˆ™ï¼Œå¯ä»¥æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚ä½†éœ€è¦æ³¨æ„æ­£åˆ™è¡¨è¾¾å¼çš„è¯­æ³•å’Œç”¨æ³•ï¼Œé¿å…å‡ºç°é”™è¯¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BugRoad </category>
          
          <category> element-plus </category>
          
      </categories>
      
      
        <tags>
            
            <tag> FormValidator </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‰¹é‡ä»»åŠ¡æ‹†åˆ†</title>
      <link href="/2022/11/06/JS/%E6%89%B9%E9%87%8F%E4%BB%BB%E5%8A%A1%E6%8B%86%E5%88%86/"/>
      <url>/2022/11/06/JS/%E6%89%B9%E9%87%8F%E4%BB%BB%E5%8A%A1%E6%8B%86%E5%88%86/</url>
      
        <content type="html"><![CDATA[<h1 id="æ‰¹é‡ä»»åŠ¡æ‹†åˆ†"><a href="#æ‰¹é‡ä»»åŠ¡æ‹†åˆ†" class="headerlink" title="æ‰¹é‡ä»»åŠ¡æ‹†åˆ†"></a>æ‰¹é‡ä»»åŠ¡æ‹†åˆ†</h1><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * @Author: Akira</span></span><br><span class="line"><span class="comment"> * @Date: 2023-05-08 13:56:25</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2023-05-08 15:03:39</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/** id ç”Ÿæˆå™¨ */</span></span><br><span class="line"><span class="keyword">const</span> genId = (<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> id = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> ++id;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * id ç¼“å­˜</span></span><br><span class="line"><span class="comment"> * key: _requestIdleCallback è¿”å› id</span></span><br><span class="line"><span class="comment"> * value: requestAnimationFrame è¿”å› id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">idMap</span>: &#123;</span><br><span class="line">  [<span class="attr">key</span>: <span class="built_in">number</span>]: <span class="built_in">number</span>;</span><br><span class="line">&#125; = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¨¡æ‹Ÿ requestIdleCallback</span></span><br><span class="line"><span class="comment"> * ä¸»è¦åˆ©ç”¨ requestAnimationFrameã€web workers(MessageChannel)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">cb</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">options</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="attr">_requestIdleCallback</span>: <span class="function">(<span class="params">cb: (idleDeadline: IdleDeadline) =&gt; <span class="built_in">void</span>, options?: &#123; timeout: <span class="built_in">number</span> &#125;</span>) =&gt;</span> <span class="built_in">number</span> = <span class="keyword">function</span> (<span class="params">cb, options</span>) &#123;</span><br><span class="line">  <span class="comment">/** æ–°å»ºé€šé“ */</span></span><br><span class="line">  <span class="keyword">const</span> &#123; port1, port2 &#125; = <span class="keyword">new</span> <span class="title class_">MessageChannel</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** è¶…æ—¶æ—¶é—´ */</span></span><br><span class="line">  <span class="keyword">let</span> <span class="attr">deadlineTime</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="comment">/** å½“å‰å¸§çš„æˆªæ­¢æ—¶é—´ */</span></span><br><span class="line">  <span class="keyword">let</span> <span class="attr">frameDeadlineTime</span>: <span class="built_in">number</span>;</span><br><span class="line">  <span class="comment">/** requestIdleCallback æ‰§è¡Œå›è°ƒ */</span></span><br><span class="line">  <span class="keyword">let</span> <span class="attr">callback</span>: <span class="function">(<span class="params">idleDeadline: IdleDeadline</span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** ç”Ÿæˆ id */</span></span><br><span class="line">  <span class="keyword">const</span> id = <span class="title function_">genId</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** port2 è¿›ç¨‹ onmessage ç›‘å¬ */</span></span><br><span class="line">  port2.<span class="property">onmessage</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="regexp">/n** è·å–å½“å‰å¸§å‰©ä½™æ—¶é—´ */</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">frameTimeRemaining</span> = (<span class="params"></span>) =&gt; frameDeadlineTime - performance.<span class="title function_">now</span>();</span><br><span class="line">    <span class="comment">/** æ˜¯å¦è¶…æ—¶ */</span></span><br><span class="line">    <span class="keyword">const</span> didTimeout = performance.<span class="title function_">now</span>() &gt;= deadlineTime;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (didTimeout || <span class="title function_">frameTimeRemaining</span>() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="comment">/** æœ‰ç©ºé—²æ—¶é—´ */</span></span><br><span class="line">      <span class="keyword">const</span> idleDeadline = &#123;</span><br><span class="line">        <span class="attr">timeRemaining</span>: frameTimeRemaining,</span><br><span class="line">        didTimeout,</span><br><span class="line">      &#125;;</span><br><span class="line">      callback &amp;&amp; <span class="title function_">callback</span>(idleDeadline);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">/** å¸§å‰©ä½™æ—¶é—´ä¸è¶³,æ”¾åˆ°ä¸‹ä¸€å¸§ */</span></span><br><span class="line">      idMap[id] = <span class="title function_">requestAnimationFrame</span>(<span class="function">(<span class="params">timeStamp</span>) =&gt;</span> &#123;</span><br><span class="line">        frameDeadlineTime = timeStamp + <span class="number">16.7</span>;</span><br><span class="line">        port1.<span class="title function_">postMessage</span>(<span class="literal">null</span>);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**  timeStamp é»˜è®¤å‚æ•° å½“å‰å¸§æ—¶é—´æˆ³ */</span></span><br><span class="line">  idMap[id] = <span class="variable language_">window</span>.<span class="title function_">requestAnimationFrame</span>(<span class="function">(<span class="params">timeStamp</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">/** æ€»å¸§é•¿ */</span></span><br><span class="line">    frameDeadlineTime = timeStamp + <span class="number">16.7</span>;</span><br><span class="line">    <span class="comment">/** è¶…æ—¶æ—¶é—´ */</span></span><br><span class="line">    deadlineTime = options?.<span class="property">timeout</span> ? timeStamp + options.<span class="property">timeout</span> : <span class="title class_">Infinity</span>;</span><br><span class="line">    callback = cb;</span><br><span class="line">    <span class="comment">/** é€šçŸ¥ port2 æ‰§è¡Œ onmessage å›è°ƒ */</span></span><br><span class="line">    port1.<span class="title function_">postMessage</span>(<span class="literal">null</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> id;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** å–æ¶ˆé¢„æ¸²æŸ“å›è°ƒæ‰§è¡Œ */</span></span><br><span class="line"><span class="keyword">const</span> _cancelIdleCallback = <span class="keyword">function</span> (<span class="params">id: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!idMap[id]) <span class="keyword">return</span>;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">cancelAnimationFrame</span>(idMap[id]);</span><br><span class="line">  <span class="keyword">delete</span> idMap[id];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> requestIdleCallback = <span class="variable language_">window</span>.<span class="property">requestIdleCallback</span> || _requestIdleCallback;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> cancelIdleCallback = <span class="variable language_">window</span>.<span class="property">cancelIdleCallback</span> || _cancelIdleCallback;</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><p><a href="https://mp.weixin.qq.com/s/ohPLuv3C0diBwp4cTWqsHw">æ‰¹é‡ä»»åŠ¡å¯¼è‡´é¡µé¢å¡æ­»ï¼Ÿæ€ä¹ˆåŠï¼Ÿä»»åŠ¡æ‹†åˆ†ï¼Ÿ</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestIdleCallback#%E8%AF%AD%E6%B3%95">requestIdleCallback</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestAnimationFrame#%E8%A7%84%E8%8C%83">Windowï¼šrequestAnimationFrame()</a></p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/MessageChannel">MessageChannel</a></p>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯å·¥ç¨‹åŒ–</title>
      <link href="/2022/10/13/JS/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/"/>
      <url>/2022/10/13/JS/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰ç«¯å·¥ç¨‹åŒ–"><a href="#å‰ç«¯å·¥ç¨‹åŒ–" class="headerlink" title="å‰ç«¯å·¥ç¨‹åŒ–"></a>å‰ç«¯å·¥ç¨‹åŒ–</h1><h2 id="ä¼ ç»Ÿå¼€å‘çš„å¼Šç«¯"><a href="#ä¼ ç»Ÿå¼€å‘çš„å¼Šç«¯" class="headerlink" title="ä¼ ç»Ÿå¼€å‘çš„å¼Šç«¯"></a>ä¼ ç»Ÿå¼€å‘çš„å¼Šç«¯</h2><p>åœ¨ä¼ ç»Ÿçš„å¼€å‘æ¨¡å¼ä¸‹ï¼Œæ‰€éœ€è¦çš„ JavaScript ä»£ç æ—¶é€šè¿‡ script æ ‡ç­¾å¼•å…¥çš„ã€‚è™½ç„¶å¯ä»¥å°†ä»£ç åˆ†æˆå¤šä¸ªæ–‡ä»¶å¤šä¸ªæ¨¡å—æ¥ç»´æŠ¤ï¼Œè¿›è€Œé™ä½ä»£ç ç»´æŠ¤çš„æˆæœ¬ï¼Œä½†å®é™…å¼€å‘ä¸­ï¼Œä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ï¼š</p><ol><li>å¯èƒ½å­˜åœ¨åŒåçš„å˜é‡å£°æ˜ï¼Œå¼•èµ·å˜é‡å†²çª</li><li>å¼•å…¥å¤šä¸ªèµ„æºæ–‡ä»¶æ—¶ï¼Œæ¯”å¦‚æœ‰å¤šä¸ª JS æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­ä¸€ä¸ª JS æ–‡ä»¶é‡Œé¢ä½¿ç”¨äº†åœ¨åˆ«å¤„å£°æ˜çš„å˜é‡ï¼Œæ— æ³•å¿«é€Ÿæ‰¾åˆ°æ˜¯åœ¨å“ªé‡Œå£°æ˜çš„ï¼Œå¤§å‹é¡¹ç›®éš¾ä»¥ç»´æŠ¤</li><li>ç±»ä¼¼ç¬¬ 1 ã€ 2 ç‚¹æåˆ°çš„é—®é¢˜æ— æ³•è½»æ¾é¢„å…ˆæ„ŸçŸ¥ï¼Œå¾ˆä¾èµ–å¼€å‘äººå‘˜äººå·¥å®šä½åŸå› </li><li>å¤§éƒ¨åˆ†ä»£ç ç¼ºä¹åˆ†å‰²ï¼Œæ¯”å¦‚ä¸€ä¸ªå·¥å…·å‡½æ•°åº“ï¼Œå¾ˆå¤šæ—¶å€™éœ€è¦æ•´åŒ…å¼•å…¥åˆ° HTML é‡Œï¼Œæ–‡ä»¶å¾ˆå¤§ï¼Œç„¶è€Œå®é™…ä¸Šåªéœ€è¦ç”¨åˆ°å…¶ä¸­ä¸€ä¸¤ä¸ªæ–¹æ³•</li><li>ç”±ç¬¬ 4 ç‚¹å¤§æ–‡ä»¶å»¶ä¼¸å‡ºçš„é—®é¢˜ï¼Œ <code>script</code> çš„åŠ è½½ä»ä¸Šåˆ°ä¸‹ï¼Œå®¹æ˜“é˜»å¡é¡µé¢æ¸²æŸ“</li><li>ä¸åŒé¡µé¢çš„èµ„æºå¼•ç”¨éƒ½éœ€è¦æ‰‹åŠ¨ç®¡ç†ï¼Œå®¹æ˜“é€ æˆä¾èµ–æ··ä¹±ï¼Œéš¾ä»¥ç»´æŠ¤</li><li>å¦‚æœè¦å‹ç¼© CSS ã€æ··æ·† JS ä»£ç ï¼Œä¹Ÿæ˜¯è¦äººåŠ›æ“ä½œä½¿ç”¨å·¥å…·å»ä¸€ä¸ªä¸ªå¤„ç†åæ›¿æ¢ï¼Œå®¹æ˜“å‡ºé”™</li></ol><p>å½“ç„¶ï¼Œå®é™…ä¸Šè¿˜ä¼šæœ‰æ›´å¤šçš„é—®é¢˜ä¼šé‡åˆ°ã€‚</p><h2 id="å·¥ç¨‹åŒ–å¸¦æ¥çš„ä¼˜åŠ¿"><a href="#å·¥ç¨‹åŒ–å¸¦æ¥çš„ä¼˜åŠ¿" class="headerlink" title="å·¥ç¨‹åŒ–å¸¦æ¥çš„ä¼˜åŠ¿"></a>å·¥ç¨‹åŒ–å¸¦æ¥çš„ä¼˜åŠ¿</h2><p>ä¸ºäº†è§£å†³ä¼ ç»Ÿå¼€å‘çš„å¼Šç«¯ï¼Œå‰ç«¯ä¹Ÿå¼€å§‹å¼•å…¥å·¥ç¨‹åŒ–å¼€å‘çš„æ¦‚å¿µï¼Œå€ŸåŠ©å·¥å…·æ¥è§£å†³äººå·¥å±‚é¢çš„çƒ¦çäº‹æƒ…ã€‚</p><h3 id="å¼€å‘å±‚é¢çš„ä¼˜åŠ¿"><a href="#å¼€å‘å±‚é¢çš„ä¼˜åŠ¿" class="headerlink" title="å¼€å‘å±‚é¢çš„ä¼˜åŠ¿"></a>å¼€å‘å±‚é¢çš„ä¼˜åŠ¿</h3><p>åœ¨å¼€å‘å±‚é¢ï¼Œå‰ç«¯å·¥ç¨‹åŒ–æœ‰ä»¥ä¸‹è¿™äº›å¥½å¤„ï¼š</p><ol><li>å¼•å…¥äº†æ¨¡å—åŒ–å’ŒåŒ…çš„æ¦‚å¿µï¼Œä½œç”¨åŸŸéš”ç¦»ï¼Œè§£å†³äº†ä»£ç å†²çªçš„é—®é¢˜</li><li>æŒ‰éœ€å¯¼å‡ºå’Œå¯¼å…¥æœºåˆ¶ï¼Œè®©ç¼–ç è¿‡ç¨‹æ›´å®¹æ˜“å®šä½é—®é¢˜</li><li>è‡ªåŠ¨åŒ–çš„ä»£ç æ£€æµ‹æµç¨‹ï¼Œæœ‰é—®é¢˜çš„ä»£ç åœ¨å¼€å‘è¿‡ç¨‹ä¸­å°±å¯ä»¥è¢«å‘ç°</li><li>ç¼–è¯‘æ‰“åŒ…æœºåˆ¶å¯ä»¥è®©ä½¿ç”¨å¼€å‘æ•ˆç‡æ›´é«˜çš„ç¼–ç æ–¹å¼ï¼Œæ¯”å¦‚ Vue ç»„ä»¶ã€ CSS çš„å„ç§é¢„å¤„ç†å™¨</li><li>å¼•å…¥äº†ä»£ç å…¼å®¹å¤„ç†çš„æ–¹æ¡ˆï¼ˆ e.g. Babel ï¼‰ï¼Œå¯ä»¥è®©è‡ªç”±ä½¿ç”¨æ›´å…ˆè¿›çš„ JavaScript è¯­å¥ï¼Œè€Œæ— éœ€é¡¾å¿Œæµè§ˆå™¨å…¼å®¹æ€§ï¼Œå› ä¸ºæœ€ç»ˆä¼šå¸®è½¬æ¢ä¸ºæµè§ˆå™¨å…¼å®¹çš„å®ç°ç‰ˆæœ¬</li><li>å¼•å…¥äº† Tree Shaking æœºåˆ¶ï¼Œæ¸…ç†æ²¡æœ‰ç”¨åˆ°çš„ä»£ç ï¼Œå‡å°‘é¡¹ç›®æ„å»ºåçš„ä½“ç§¯</li></ol><h3 id="å›¢é˜Ÿåä½œçš„ä¼˜åŠ¿"><a href="#å›¢é˜Ÿåä½œçš„ä¼˜åŠ¿" class="headerlink" title="å›¢é˜Ÿåä½œçš„ä¼˜åŠ¿"></a>å›¢é˜Ÿåä½œçš„ä¼˜åŠ¿</h3><p>é™¤äº†å¯¹å¼€å‘è€…æœ‰æ›´å¥½çš„å¼€å‘ä½“éªŒå’Œæ•ˆç‡æå‡ï¼Œå¯¹äºå›¢é˜Ÿåä½œï¼Œå‰ç«¯å·¥ç¨‹åŒ–ä¹Ÿå¸¦æ¥äº†æ›´å¤šçš„ä¾¿åˆ©ï¼Œä¾‹å¦‚ä¸‹é¢è¿™äº›åœºæ™¯ï¼š</p><ol><li>ç»Ÿä¸€çš„é¡¹ç›®ç»“æ„</li><li>ç»Ÿä¸€çš„ä»£ç é£æ ¼</li><li>å¯å¤ç”¨çš„æ¨¡å—å’Œç»„ä»¶</li><li>ä»£ç å¥å£®æ€§ä¿éšœ ( TS )</li><li>å›¢é˜Ÿå¼€å‘æ•ˆç‡é«˜</li></ol><h3 id="æ±‚èŒç«äº‰ä¸Šçš„ä¼˜åŠ¿"><a href="#æ±‚èŒç«äº‰ä¸Šçš„ä¼˜åŠ¿" class="headerlink" title="æ±‚èŒç«äº‰ä¸Šçš„ä¼˜åŠ¿"></a>æ±‚èŒç«äº‰ä¸Šçš„ä¼˜åŠ¿</h3><p>è¿‘å‡ å¹´å‰ç«¯å¼€å‘é¢†åŸŸçš„ç›¸å…³å²—ä½ï¼Œéƒ½ä¼šåœ¨æ‹›è˜è¯¦æƒ…é‡Œå‡ºç°ç±»ä¼¼çš„æè¿°ï¼š</p><blockquote><p>ç†Ÿæ‚‰ Vue &#x2F; React ç­‰ä¸»æµæ¡†æ¶ï¼Œå¯¹å‰ç«¯ç»„ä»¶åŒ–å’Œæ¨¡å—åŒ–æœ‰æ·±å…¥çš„ç†è§£å’Œå®è·µ<br>ç†Ÿæ‚‰é¢å‘ç»„ä»¶çš„å¼€å‘æ¨¡å¼ï¼Œç†Ÿæ‚‰ Webpack &#x2F; Vite ç­‰æ„å»ºå·¥å…·<br>ç†Ÿç»ƒæŒæ¡å¾®ä¿¡å°ç¨‹åºå¼€å‘ï¼Œç†Ÿæ‚‰ Taro æ¡†æ¶æˆ– uni-app æ¡†æ¶ä¼˜å…ˆ<br>ç†Ÿæ‚‰ Scss &#x2F; Less &#x2F; Stylus ç­‰é¢„å¤„ç†å™¨çš„ä½¿ç”¨<br>ç†Ÿç»ƒæŒæ¡ TypeScript è€…ä¼˜å…ˆ<br>æœ‰è‰¯å¥½çš„ä»£ç é£æ ¼ï¼Œç»“æ„è®¾è®¡ä¸ç¨‹åºæ¶æ„è€…ä¼˜å…ˆ<br>äº†è§£æˆ–ç†Ÿæ‚‰åç«¯å¼€å‘è€…ä¼˜å…ˆï¼ˆå¦‚ Java &#x2F; Go &#x2F; Node.js ï¼‰</p></blockquote><p>çŸ¥åä¼ä¸šå¯¹ 1-3 å¹´å·¥ä½œç»éªŒçš„åˆä¸­çº§å·¥ç¨‹å¸ˆï¼Œæ›´æ˜¯æ˜ç¡®è¦æ±‚å…·å¤‡å‰ç«¯å·¥ç¨‹åŒ–å¼€å‘çš„èƒ½åŠ›ï¼š</p><p><img src="https://s2.loli.net/2023/03/10/xvZJHSXhYmUrsR5.png" alt="çŸ¥åä¼ä¸šå¯¹ 1-3 å¹´ç»éªŒçš„å‰ç«¯å·¥ç¨‹å¸ˆæ‹›è˜è¦æ±‚"></p><h2 id="ç°ä»£åŒ–çš„å¼€å‘æ¦‚å¿µ"><a href="#ç°ä»£åŒ–çš„å¼€å‘æ¦‚å¿µ" class="headerlink" title="ç°ä»£åŒ–çš„å¼€å‘æ¦‚å¿µ"></a>ç°ä»£åŒ–çš„å¼€å‘æ¦‚å¿µ</h2><h3 id="MPA-ä¸-SPA"><a href="#MPA-ä¸-SPA" class="headerlink" title="MPA ä¸ SPA"></a>MPA ä¸ SPA</h3><h4 id="å¤šé¡µé¢åº”ç”¨"><a href="#å¤šé¡µé¢åº”ç”¨" class="headerlink" title="å¤šé¡µé¢åº”ç”¨"></a>å¤šé¡µé¢åº”ç”¨</h4><p>MPA å¤šé¡µé¢åº”ç”¨æ˜¯æœ€ä¼ ç»Ÿçš„ç½‘ç«™ä½“éªŒï¼Œå½“ä¸€ä¸ªç½‘ç«™æœ‰å¤šä¸ªé¡µé¢æ—¶ï¼Œä¼šå¯¹åº”æœ‰å¤šä¸ªå®é™…å­˜åœ¨çš„ HTML æ–‡ä»¶ï¼Œè®¿é—®æ¯ä¸€ä¸ªé¡µé¢éƒ½éœ€è¦ç»å†ä¸€æ¬¡å®Œæ•´çš„é¡µé¢è¯·æ±‚è¿‡ç¨‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¼ ç»Ÿçš„é¡µé¢è·³è½¬è¿‡ç¨‹</span></span><br><span class="line"></span><br><span class="line">ä»ç”¨æˆ·ç‚¹å‡»è·³è½¬å¼€å§‹ï¼š</span><br><span class="line">---&gt; æµè§ˆå™¨æ‰“å¼€æ–°çš„é¡µé¢</span><br><span class="line">---&gt; è¯·æ±‚ã€æ‰€æœ‰ã€‘èµ„æº</span><br><span class="line">---&gt; åŠ è½½ HTML ã€CSS ã€ JS ã€ å›¾ç‰‡ç­‰èµ„æº</span><br><span class="line">---&gt; å®Œæˆæ–°é¡µé¢çš„æ¸²æŸ“</span><br></pre></td></tr></table></figure><h5 id="MPA-çš„ä¼˜ç‚¹"><a href="#MPA-çš„ä¼˜ç‚¹" class="headerlink" title="MPA çš„ä¼˜ç‚¹"></a>MPA çš„ä¼˜ç‚¹</h5><ul><li>é¦–å±åŠ è½½é€Ÿåº¦å¿«</li><li>SEO å‹å¥½</li><li>å®¹æ˜“ä¸æœåŠ¡ç«¯è¯­è¨€ç»“åˆ</li></ul><h5 id="MPA-çš„ç¼ºç‚¹"><a href="#MPA-çš„ç¼ºç‚¹" class="headerlink" title="MPA çš„ç¼ºç‚¹"></a>MPA çš„ç¼ºç‚¹</h5><ul><li>é¡µé¢ä¹‹é—´çš„è·³è½¬è®¿é—®é€Ÿåº¦æ…¢</li><li>ç”¨æˆ·ä½“éªŒä¸å¤Ÿå‹å¥½</li><li>å¼€å‘æˆæœ¬é«˜</li></ul><h3 id="CSR-ä¸-SSR"><a href="#CSR-ä¸-SSR" class="headerlink" title="CSR ä¸ SSR"></a>CSR ä¸ SSR</h3><h4 id="å®¢æˆ·ç«¯æ¸²æŸ“"><a href="#å®¢æˆ·ç«¯æ¸²æŸ“" class="headerlink" title="å®¢æˆ·ç«¯æ¸²æŸ“"></a>å®¢æˆ·ç«¯æ¸²æŸ“</h4><p>è¿™æ˜¯ä¸€ç§åˆ©ç”¨ <code>AJAX</code> æŠ€æœ¯ï¼ŒæŠŠæ¸²æŸ“å·¥ä½œä»æœåŠ¡ç«¯è½¬ç§»åˆ°å®¢æˆ·ç«¯å®Œæˆï¼Œä¸ä»…å®¢æˆ·ç«¯çš„ç”¨æˆ·ä½“éªŒæ›´å¥½ï¼Œå‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼æ›´åŠ é«˜æ•ˆã€‚</p><h4 id="æœåŠ¡ç«¯æ¸²æŸ“"><a href="#æœåŠ¡ç«¯æ¸²æŸ“" class="headerlink" title="æœåŠ¡ç«¯æ¸²æŸ“"></a>æœåŠ¡ç«¯æ¸²æŸ“</h4><p>å’Œä¼ ç»Ÿçš„ <code>MPA</code> ä½¿ç”¨ <code>PHP / JSP</code> ç­‰æŠ€æœ¯æ ˆåšæœåŠ¡ç«¯æ¸²æŸ“ä¸åŒï¼Œç°ä»£å‰ç«¯å·¥ç¨‹åŒ–é‡Œçš„ <code>SSR</code> é€šå¸¸æ˜¯æŒ‡ä½¿ç”¨ <code>Node.js</code> ä½œä¸ºæœåŠ¡ç«¯æŠ€æœ¯æ ˆã€‚</p><p>SSR æŠ€æœ¯åˆ©ç”¨çš„åŒæ„æ¸²æŸ“æ–¹æ¡ˆï¼ˆ Isomorphic Rendering ï¼‰ï¼ŒæŒ‡çš„æ˜¯ä¸€å¥—ä»£ç ä¸ä»…å¯ä»¥åœ¨å®¢æˆ·ç«¯è¿è¡Œï¼Œä¹Ÿå¯ä»¥åœ¨æœåŠ¡ç«¯è¿è¡Œï¼Œåœ¨ä¸€äº›åˆé€‚çš„æ—¶æœºå…ˆç”±æœåŠ¡ç«¯å®Œæˆæ¸²æŸ“ï¼ˆ Server-Side Rendering ï¼‰å†ç›´å‡ºç»™å®¢æˆ·ç«¯æ¿€æ´»ï¼ˆ Client-Side Hydration ï¼‰ï¼Œè¿™ç§å¼€å‘æ¨¡å¼å¸¦æ¥äº†ï¼š</p><ul><li>æ›´å¥½çš„ SEO æ”¯æŒï¼Œè§£å†³äº† SPA å•é¡µé¢åº”ç”¨çš„ç—›ç‚¹</li><li>æ›´å¿«çš„é¦–å±åŠ è½½é€Ÿåº¦ï¼Œä¿æŒäº† MPA å¤šé¡µé¢åº”ç”¨çš„ä¼˜ç‚¹</li><li>å’Œ SPA ä¸€æ ·æ”¯æŒå‰åç«¯åˆ†ç¦»ï¼Œå¼€å‘æ•ˆç‡ä¾ç„¶å¾ˆé«˜</li><li>æœ‰æ›´å¥½çš„å®¢æˆ·ç«¯ä½“éªŒï¼Œå½“ç”¨æˆ·å®Œå…¨æ‰“å¼€é¡µé¢åï¼Œæœ¬åœ°è®¿é—®è¿‡ç¨‹ä¸­ä¹Ÿå¯ä»¥ä¿æŒ SPA å•é¡µé¢åº”ç”¨çš„ä½“éªŒ</li><li>ç»Ÿä¸€çš„å¿ƒæ™ºæ¨¡å‹ï¼Œç”±äºæ”¯æŒåŒæ„ï¼Œå› æ­¤æ²¡æœ‰é¢å¤–çš„å¿ƒæ™ºè´Ÿæ‹…</li></ul><h2 id="å·¥ç¨‹åŒ–ä¸è‡³äºå‰ç«¯"><a href="#å·¥ç¨‹åŒ–ä¸è‡³äºå‰ç«¯" class="headerlink" title="å·¥ç¨‹åŒ–ä¸è‡³äºå‰ç«¯"></a>å·¥ç¨‹åŒ–ä¸è‡³äºå‰ç«¯</h2><p>éšç€å‰ç«¯å·¥ç¨‹åŒ–çš„å‘å±•ï¼Œå‰ç«¯ä¸è‡³äºå†™å‰ç«¯ï¼Œå·²ç»æœ‰å¾ˆå¤šå‰ç«¯å·¥ç¨‹å¸ˆåˆ©ç”¨å‰ç«¯å·¥ç¨‹åŒ–å¸¦æ¥çš„ä¼˜åŠ¿ï¼Œä¸ä»…ä»…åªæ˜¯åšä¸€ä¸ª Web å‰ç«¯ï¼Œå¼€å§‹é€æ­¥å‘å±•ä¸ºä¸€ä¸ªå…¨æ ˆå·¥ç¨‹å¸ˆï¼Œåœ¨ä¼ä¸šå†…éƒ¨æ‰¿æ‹…èµ·äº†æ›´å¤šçš„å²—ä½èŒè´£ï¼ŒåŒ…æ‹¬ä½œè€…ç¬”è€…ä¹Ÿæ˜¯ã€‚</p><p>ä¹‹æ‰€ä»¥èƒ½åšè¿™ä¹ˆå¤šäº‹æƒ…ï¼Œå¾—ç›Šäº Node.js åœ¨å‰ç«¯å¼€å‘å¸¦æ¥çš„ç¿»å¤©è¦†åœ°çš„å˜åŒ–ï¼Œå¯ä»¥åœ¨ä¿æŒåŸæœ‰çš„ JavaScript å’Œ TypeScript åŸºç¡€ä¸Šï¼Œå‡ ä¹æ²¡æœ‰è¿‡å¤šçš„å­¦ä¹ æˆæœ¬å°±å¯ä»¥è¿‡åº¦åˆ°å…¶ä»–ç«¯çš„å¼€å‘ã€‚</p><h3 id="æœåŠ¡ç«¯å¼€å‘"><a href="#æœåŠ¡ç«¯å¼€å‘" class="headerlink" title="æœåŠ¡ç«¯å¼€å‘"></a>æœåŠ¡ç«¯å¼€å‘</h3><p><code>express -&gt; koa -&gt; nest -&gt; egg</code></p><h3 id="æ¡Œé¢ç¨‹åºå¼€å‘"><a href="#æ¡Œé¢ç¨‹åºå¼€å‘" class="headerlink" title="æ¡Œé¢ç¨‹åºå¼€å‘"></a>æ¡Œé¢ç¨‹åºå¼€å‘</h3><p>Electron çš„åº•å±‚æ˜¯åŸºäº Chromium å’Œ Node.js ï¼Œå®ƒæä¾›äº†ä¸¤ä¸ªè¿›ç¨‹ä¾›å¼€å‘è€…ä½¿ç”¨ï¼š</p><ol><li>ä¸»è¿›ç¨‹ï¼šå®ƒæ˜¯æ•´ä¸ªåº”ç”¨çš„å…¥å£ç‚¹ï¼Œä¸»è¿›ç¨‹è¿è¡Œåœ¨ Node ç¯å¢ƒä¸­ï¼Œå¯ä»¥ä½¿ç”¨æ‰€æœ‰çš„ Node API ï¼Œç¨‹åºä¹Ÿå› æ­¤å…·å¤‡äº†å’Œç³»ç»Ÿè¿›è¡Œäº¤äº’çš„èƒ½åŠ›ï¼Œä¾‹å¦‚æ–‡ä»¶çš„è¯»å†™æ“ä½œã€‚</li><li>æ¸²æŸ“è¿›ç¨‹ï¼šè´Ÿè´£ä¸ç”¨æˆ·äº¤äº’çš„ GUI ç•Œé¢ï¼ŒåŸºäº Chromium è¿è¡Œï¼Œæ‰€ä»¥å¼€å‘è€…å¾—ä»¥ä½¿ç”¨ HTML &#x2F; CSS &#x2F; JavaScript åƒç¼–å†™ç½‘é¡µä¸€æ ·æ¥ç¼–å†™ç¨‹åºçš„ GUI ç•Œé¢ã€‚</li></ol><p>ä¸€ä¸ªç¨‹åºåº”ç”¨åªä¼šæœ‰ä¸€ä¸ªä¸»è¿›ç¨‹ï¼Œè€Œæ¸²æŸ“è¿›ç¨‹åˆ™å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚åˆ›å»ºå¤šä¸ªï¼Œæ¸²æŸ“è¿›ç¨‹å¦‚æœéœ€è¦å’Œç³»ç»Ÿäº¤äº’ï¼Œåˆ™å¿…é¡»ä¸ä¸»è¿›ç¨‹é€šä¿¡ï¼Œå€ŸåŠ©ä¸»è¿›ç¨‹çš„èƒ½åŠ›æ¥å®ç°ã€‚</p><p>åœ¨æ„å»ºçš„æ—¶å€™ï¼Œ Electron ä¼šæŠŠ Node å’Œ Chromium ä¸€èµ·æ‰“åŒ…ä¸ºä¸€ä¸ªè¯¸å¦‚ <code>.exe</code> è¿™æ ·çš„å®‰è£…æ–‡ä»¶ï¼ˆæˆ–è€…æ˜¯åŒ…å«äº†ä¸¤è€…çš„å…å®‰è£…ç‰ˆæœ¬ï¼‰ï¼Œè¿™æ ·ç”¨æˆ·ä¸éœ€è¦ Node ç¯å¢ƒä¹Ÿå¯ä»¥è¿è¡Œæ¡Œé¢ç¨‹åºã€‚</p><h3 id="åº”ç”¨è„šæœ¬å¼€å‘"><a href="#åº”ç”¨è„šæœ¬å¼€å‘" class="headerlink" title="åº”ç”¨è„šæœ¬å¼€å‘"></a>åº”ç”¨è„šæœ¬å¼€å‘</h3><p><code>pkg</code></p><p>å°† <code>node</code> é¡¹ç›®æ‰“åŒ…æˆ <code>exe</code> å¯æ‰§è¡Œæ–‡ä»¶</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://vue3.chengpeiquan.com/engineering.html">Vue3 å…¥é—¨æŒ‡å—ä¸å®æˆ˜æ¡ˆä¾‹ - äº†è§£å‰ç«¯å·¥ç¨‹åŒ–</a></p>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>reactive äºŒæ¬¡èµ‹å€¼å¯¼è‡´å“åº”å¼ä¸¢å¤±</title>
      <link href="/2022/10/12/bugRoad/reactive%20%E4%BA%8C%E6%AC%A1%E8%B5%8B%E5%80%BC%E5%AF%BC%E8%87%B4%E5%93%8D%E5%BA%94%E5%BC%8F%E4%B8%A2%E5%A4%B1/"/>
      <url>/2022/10/12/bugRoad/reactive%20%E4%BA%8C%E6%AC%A1%E8%B5%8B%E5%80%BC%E5%AF%BC%E8%87%B4%E5%93%8D%E5%BA%94%E5%BC%8F%E4%B8%A2%E5%A4%B1/</url>
      
        <content type="html"><![CDATA[<h1 id="reactive-äºŒæ¬¡èµ‹å€¼å¯¼è‡´å“åº”å¼ä¸¢å¤±"><a href="#reactive-äºŒæ¬¡èµ‹å€¼å¯¼è‡´å“åº”å¼ä¸¢å¤±" class="headerlink" title="reactive äºŒæ¬¡èµ‹å€¼å¯¼è‡´å“åº”å¼ä¸¢å¤±"></a>reactive äºŒæ¬¡èµ‹å€¼å¯¼è‡´å“åº”å¼ä¸¢å¤±</h1><h2 id="åœºæ™¯ä¸€"><a href="#åœºæ™¯ä¸€" class="headerlink" title="åœºæ™¯ä¸€"></a>åœºæ™¯ä¸€</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> h = <span class="title function_">reactive</span>(&#123; <span class="attr">m</span>: <span class="number">1</span> &#125;);</span><br><span class="line">h = &#123; <span class="attr">m</span>: <span class="number">2</span> &#125;; <span class="comment">// å“åº”å¼ä¸¢å¤±</span></span><br></pre></td></tr></table></figure><p><code>javascript</code> ä¸­æ‰€æœ‰æ•°æ®ç±»å‹éƒ½æ˜¯é€šè¿‡ <code>å€¼ä¼ é€’</code> çš„ã€‚</p><p>å½“ç„¶å¼•ç”¨æ•°æ®ç±»å‹ä¹Ÿä¸ä¾‹å¤–ï¼Œé‚£æ—¢ç„¶æ˜¯æŒ‰å€¼ä¼ é€’ï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°å“åº”å¼ä¸¢å¤±çš„é—®é¢˜å‘¢?</p><p>åŸå› å¾ˆç®€å•ï¼Œh çš„å€¼å®é™…ä¸Šæ˜¯ <code>&#123; m: 1 &#125;</code> çš„åœ°å€ã€‚ç„¶åå†æ¬¡èµ‹å€¼ï¼Œä¼šå¯¼è‡´ h çš„å€¼ï¼Œä¹Ÿå°±æ˜¯åœ°å€å‘ç”Ÿå˜åŒ–ï¼Œä»è€ŒæŒ‡å‘æ™®é€šçš„å¯¹è±¡ä¸Šï¼Œè‡ªç„¶å¤±å»äº†å“åº”å¼ã€‚</p><h2 id="åœºæ™¯äºŒ"><a href="#åœºæ™¯äºŒ" class="headerlink" title="åœºæ™¯äºŒ"></a>åœºæ™¯äºŒ</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> h = <span class="title function_">reactive</span>(&#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">m</span>: &#123; <span class="attr">n</span>: <span class="number">1</span> &#125; &#125;);</span><br><span class="line"><span class="keyword">const</span> h2 = <span class="title function_">reactive</span>(&#123; ...h &#125;);</span><br><span class="line">h2.<span class="property">a</span> = <span class="number">2</span>;</span><br><span class="line">h2.<span class="property">m</span>.<span class="property">n</span> = <span class="number">2</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(h.<span class="property">a</span>, h2.<span class="property">a</span>); <span class="comment">// 1 2</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(h.<span class="property">m</span>.<span class="property">n</span>, h2.<span class="property">m</span>.<span class="property">n</span>); <span class="comment">// 2 2</span></span><br></pre></td></tr></table></figure><blockquote><p>é€šå¸¸å­˜åœ¨çš„è¯¯åŒºï¼šé€šè¿‡è§£æ„å¯¹è±¡å¾—åˆ°çš„æ•°æ®ï¼Œå¯ä»¥ä½œä¸ºæ·±æ‹·è´çš„ä¸€ç§å½¢å¼ï¼Ÿï¼</p></blockquote><p>å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹ç¡®å®æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯å¯¹äºå¼•ç”¨æ•°æ®ç±»å‹åˆ™ä¸ç„¶ã€‚å€¼ä»ç„¶æ˜¯ä»¥åœ°å€çš„å½¢å¼å­˜åœ¨ã€‚å› æ­¤åœ¨ä¿®æ”¹çš„æ—¶å€™ï¼Œå®é™…ä¸Šè¿˜æ˜¯ä¼šä¹Ÿå½±å“åˆ°æºæ•°æ®ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å‰ç«¯è¿™å—å„¿ï¼Œå¯¹äºå¼•ç”¨æ•°æ®ç±»å‹è¦ä¸‡åˆ†å°å¿ƒã€‚ç‰¹åˆ«æ˜¯ç±»ä¼¼å¯¹äºè¡¨å•æ“ä½œæ—¶ï¼Œè¡¨å•ä¸­å­˜åœ¨å¼•ç”¨æ•°æ®ç±»å‹çš„å±æ€§ï¼Œåœ¨é‡ç½®çš„æ—¶å€™ä¸èƒ½å•å•çš„åªå°†æœ€å¤–å±‚é‡ç½®ã€‚</p><p>æˆ–è€…ä½¿ç”¨ <code>lodash</code> ä¸­å°è£…çš„æ·±æ‹·è´ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™å°±è¿›è¡Œæ·±åº¦æ‹·è´ï¼Œä»¥ä¸å½±å“æºæ•°æ®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BugRoad </category>
          
          <category> Vue3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> reactive </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Antd-Select-custom</title>
      <link href="/2022/10/08/React/antd-select/"/>
      <url>/2022/10/08/React/antd-select/</url>
      
        <content type="html"><![CDATA[<h1 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h1><p>é€‰æ‹©ä¸‹æ‹‰æ¡† -&gt; è¡¥å…¨é€‰é¡¹åçš„æ¡ä»¶ -&gt; ç”Ÿæˆ tagã€‚</p><p>æ‰‹åŠ¨æ§åˆ¶ openï¼Œé€‰æ‹©åå…³é—­ä¸‹æ‹‰ã€‚</p><h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; message, <span class="title class_">Select</span> &#125; <span class="keyword">from</span> <span class="string">&quot;antd&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useState &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">OPTIONS</span> = [<span class="string">&quot;Apples&quot;</span>, <span class="string">&quot;Nails&quot;</span>, <span class="string">&quot;Bananas&quot;</span>, <span class="string">&quot;Helicopters&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ToolMgt</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">/** å·²é€‰é¡¹ */</span></span><br><span class="line">  <span class="keyword">const</span> [selectedItems, setSelectedItems] = useState&lt;<span class="built_in">string</span>[]&gt;([]);</span><br><span class="line">  <span class="comment">/** è¾“å…¥æ¡† value */</span></span><br><span class="line">  <span class="keyword">const</span> [searchValue, setSearchValue] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> [open, setOpen] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> selectKeys = [...<span class="keyword">new</span> <span class="title class_">Set</span>(selectedItems.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item.<span class="title function_">split</span>(<span class="string">&quot;:&quot;</span>)[<span class="number">0</span>]))];</span><br><span class="line">  <span class="comment">/** ä¸‹æ‹‰æ¡† list - å‰”é™¤å·²é€‰ */</span></span><br><span class="line">  <span class="keyword">const</span> filteredOptions = <span class="variable constant_">OPTIONS</span>.<span class="title function_">filter</span>(<span class="function">(<span class="params">o</span>) =&gt;</span> !selectKeys.<span class="title function_">includes</span>(o)).<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">value</span>: item,</span><br><span class="line">    <span class="attr">label</span>: item,</span><br><span class="line">  &#125;));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleSearch</span>(<span class="params">value: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="title function_">setSearchValue</span>(value);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleSelect</span>(<span class="params">value: <span class="built_in">string</span> | <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="title function_">setSearchValue</span>(value + <span class="string">&quot;:&quot;</span>);</span><br><span class="line">    <span class="title function_">setOpen</span>(<span class="literal">false</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleEnter</span>(<span class="params">e: React.KeyboardEvent&lt;HTMLDivElement&gt;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (e.<span class="property">key</span> !== <span class="string">&quot;Enter&quot;</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">/** ä¸åŒ…å«&#x27;:&#x27; å±äºæœªé€‰æ‹©æˆ–é€‰æ‹©ååˆ é™¤&#x27;:&#x27; å±äºæ„å¤–ç»ˆæ­¢ enter */</span></span><br><span class="line">    <span class="keyword">if</span> (!searchValue.<span class="title function_">includes</span>(<span class="string">&quot;:&quot;</span>)) <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">/** æ ¡éªŒ */</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_">verifySearch</span>(searchValue, <span class="variable constant_">OPTIONS</span>)) &#123;</span><br><span class="line">      message.<span class="title function_">error</span>(<span class="string">&quot;è§„åˆ™ä¸ç¬¦åˆ&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">setSelectedItems</span>([...selectedItems, searchValue]);</span><br><span class="line">    <span class="title function_">setSearchValue</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleDeselect</span>(<span class="params">value: <span class="built_in">string</span> | <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="title function_">setSelectedItems</span>(selectedItems.<span class="title function_">filter</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item != value));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** è¾“å…¥æ ¡éªŒ */</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">verifySearch</span>(<span class="params">searchValue: <span class="built_in">string</span>, initOptions: <span class="built_in">string</span>[]</span>) &#123;</span><br><span class="line">    <span class="comment">/** åˆ†å‰²è¿æ¥ç¬¦ */</span></span><br><span class="line">    <span class="keyword">const</span> searchValueArr = searchValue.<span class="title function_">split</span>(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> isInclude = initOptions.<span class="title function_">includes</span>(searchValueArr[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (searchValueArr.<span class="property">length</span> != <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (searchValueArr[<span class="number">1</span>] == <span class="string">&quot;&quot;</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (!isInclude) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;searchValue&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Select</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">open</span>=<span class="string">&#123;open</span> &amp;&amp; !<span class="attr">searchValue.includes</span>(&quot;<span class="attr">:</span>&quot;)&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">mode</span>=<span class="string">&quot;multiple&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">placeholder</span>=<span class="string">&quot;Inserted are removed&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">value</span>=<span class="string">&#123;selectedItems&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">searchValue</span>=<span class="string">&#123;searchValue&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">autoClearSearchValue</span>=<span class="string">&#123;false&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &quot;<span class="attr">50</span>%&quot; &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">options</span>=<span class="string">&#123;filteredOptions&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onDeselect</span>=<span class="string">&#123;handleDeselect&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onSearch</span>=<span class="string">&#123;handleSearch&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onSelect</span>=<span class="string">&#123;handleSelect&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onKeyDown</span>=<span class="string">&#123;handleEnter&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onDropdownVisibleChange</span>=<span class="string">&#123;(visible)</span> =&gt;</span> setOpen(visible)&#125;</span></span><br><span class="line"><span class="language-xml">      /&gt;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ToolMgt</span>;</span><br></pre></td></tr></table></figure><h1 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h1><p><img src="https://s2.loli.net/2023/10/09/yJIkWMdV5pALquE.gif" alt="636769ef-6dc9-4de0-ae08-eed996543325.gif"></p>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>map è½¬æ¢æˆå¯¹è±¡æ•°ç»„</title>
      <link href="/2022/10/02/bugRoad/map%20%E8%BD%AC%E6%8D%A2%E6%88%90%E5%AF%B9%E8%B1%A1%E6%95%B0%E7%BB%84/"/>
      <url>/2022/10/02/bugRoad/map%20%E8%BD%AC%E6%8D%A2%E6%88%90%E5%AF%B9%E8%B1%A1%E6%95%B0%E7%BB%84/</url>
      
        <content type="html"><![CDATA[<h1 id="map-è½¬æ¢æˆå¯¹è±¡æ•°ç»„"><a href="#map-è½¬æ¢æˆå¯¹è±¡æ•°ç»„" class="headerlink" title="map è½¬æ¢æˆå¯¹è±¡æ•°ç»„"></a>map è½¬æ¢æˆå¯¹è±¡æ•°ç»„</h1><h2 id="ğŸ¤”-å‘ç°é—®é¢˜"><a href="#ğŸ¤”-å‘ç°é—®é¢˜" class="headerlink" title="ğŸ¤” å‘ç°é—®é¢˜"></a>ğŸ¤” å‘ç°é—®é¢˜</h2><p><code>map =&gt; key-value</code></p><p>é€šå¸¸ä½¿ç”¨åˆ°çš„ <code>Array.from</code> è½¬æ¢ï¼Œä¼šå¾—åˆ°<code>[[key, value],....]</code></p><h2 id="ğŸ™…â€â™‚ï¸-æ‹’ç»å¦¥åï¼ŒåšæŒè§£å†³"><a href="#ğŸ™…â€â™‚ï¸-æ‹’ç»å¦¥åï¼ŒåšæŒè§£å†³" class="headerlink" title="ğŸ™…â€â™‚ï¸ æ‹’ç»å¦¥åï¼ŒåšæŒè§£å†³"></a>ğŸ™…â€â™‚ï¸ æ‹’ç»å¦¥åï¼ŒåšæŒè§£å†³</h2><blockquote><p><code>Array.from</code> æœ‰ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå¯ä»¥è¿›ä¸€æ­¥æŠŠæ§æ•°æ®çš„æµå‘ä»¥åŠç±»å‹ã€‚</p></blockquote><p><code>Array.from(map, ([key, value]) =&gt; (&#123; key, value &#125;));</code></p>]]></content>
      
      
      <categories>
          
          <category> BugRoad </category>
          
          <category> JS </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>VueRouter ä¼ é€’ state å‚æ•°æ— æ•ˆ</title>
      <link href="/2022/09/20/bugRoad/VueRouter%20%E4%BC%A0%E9%80%92%20state%20%E5%8F%82%E6%95%B0%E6%97%A0%E6%95%88/"/>
      <url>/2022/09/20/bugRoad/VueRouter%20%E4%BC%A0%E9%80%92%20state%20%E5%8F%82%E6%95%B0%E6%97%A0%E6%95%88/</url>
      
        <content type="html"><![CDATA[<h1 id="VueRouter-ä¼ é€’-state-å‚æ•°æ— æ•ˆ"><a href="#VueRouter-ä¼ é€’-state-å‚æ•°æ— æ•ˆ" class="headerlink" title="VueRouter ä¼ é€’ state å‚æ•°æ— æ•ˆ"></a>VueRouter ä¼ é€’ state å‚æ•°æ— æ•ˆ</h1><h2 id="ä»€ä¹ˆæ˜¯-state-ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-state-ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ state ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ state ï¼Ÿ</h2><p>åœ¨æµè§ˆå™¨ä¸­ï¼Œ<code>history.state</code> æ˜¯ <code>history</code> å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨äºè®¿é—®å†å²è®°å½•ä¸­å½“å‰é¡µé¢çš„çŠ¶æ€å¯¹è±¡ã€‚å½“ä½¿ç”¨æµè§ˆå™¨çš„å‰è¿›æˆ–åé€€æŒ‰é’®æ—¶ï¼Œå¯ä»¥é€šè¿‡ <code>history.state</code> è·å–å‰ä¸€ä¸ªé¡µé¢æˆ–åä¸€ä¸ªé¡µé¢çš„çŠ¶æ€å¯¹è±¡ï¼Œä»è€Œå®ç°å‰ç«¯é¡µé¢ä¹‹é—´çŠ¶æ€çš„ä¼ é€’å’Œç®¡ç†ã€‚</p><p>è‡ªä» <code>Vue3</code> ä¸­çš„ <code>VueRouter</code> ä¸­å°† <code>params</code> å¤§å‰Šå¼±ã€‚<code>state</code> ä¾¿èµ°ä¸Šäº†é¥­æ¡Œã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="title function_">useRouter</span>();</span><br><span class="line">router.<span class="title function_">push</span>(&#123;<span class="attr">name</span>: <span class="string">&#x27;xxx&#x27;</span>, <span class="attr">state</span>: &#123; <span class="attr">user</span>: &#123;...&#125; &#125; &#125;)</span><br><span class="line"></span><br><span class="line">history.<span class="property">state</span>.<span class="property">user</span> /</span><br></pre></td></tr></table></figure><h2 id="ä¸ºä»€ä¹ˆä¼šæ— æ•ˆï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä¼šæ— æ•ˆï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šæ— æ•ˆï¼Ÿ"></a>ä¸ºä»€ä¹ˆä¼šæ— æ•ˆï¼Ÿ</h2><p><code>æŠ¥é”™ï¼šError with push/replace State DOMException: Failed to execute &#39;pushState&#39; on &#39;History&#39;: &lt;Object&gt; could not be cloned.</code></p><p>é€šå¸¸æ˜¯ä¼ é€’çš„æ•°æ®æ˜¯ å“åº”å¼æ•°æ® é€ æˆçš„ï¼Œä¹Ÿå°±æ˜¯ <code>proxy</code> ç±»å‹ã€‚</p><p>é€šè¿‡ <code>toRaw</code> è¿˜åŸå³å¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BugRoad </category>
          
          <category> Vue3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> VueRouter </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React åŸºç¡€</title>
      <link href="/2022/08/13/React/React/"/>
      <url>/2022/08/13/React/React/</url>
      
        <content type="html"><![CDATA[<h1 id="ç”Ÿå‘½å‘¨æœŸï¼š"><a href="#ç”Ÿå‘½å‘¨æœŸï¼š" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸï¼š"></a>ç”Ÿå‘½å‘¨æœŸï¼š</h1><h2 id="é‡è¦çš„ä¸‰ä¸ªé’©å­"><a href="#é‡è¦çš„ä¸‰ä¸ªé’©å­" class="headerlink" title="é‡è¦çš„ä¸‰ä¸ªé’©å­"></a>é‡è¦çš„ä¸‰ä¸ªé’©å­</h2><h3 id="render"><a href="#render" class="headerlink" title="render"></a>render</h3><p>æ‰§è¡Œ 1+n æ¬¡ã€‚</p><p>æ¯ä¸€æ¬¡ setState éƒ½ä¼š renderã€‚</p><p>æ— è®ºæ˜¯æŒ‚è½½è¿˜æ˜¯æ›´æ–°é˜¶æ®µï¼Œåœ¨<code>render</code>ä¹‹å‰çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°éƒ½ä¸ä¼šæ›´æ–°<code>this.state</code>å’Œ<code>props</code>ï¼Œç›´åˆ°<code>render</code>æ‰§è¡Œå®Œæˆåï¼Œæ•°æ®æ‰ä¼šæ›´æ–°ã€‚</p><p>render ä¹‹åæ˜¯ä¸èƒ½å¤Ÿå†æ“ä½œæ•°æ®çš„ï¼Œå¦åˆ™å°†è¿›å…¥æ­»å¾ªç¯ã€‚</p><h3 id="componentDidMount"><a href="#componentDidMount" class="headerlink" title="componentDidMount"></a>componentDidMount</h3><h3 id="componentWillUnmount"><a href="#componentWillUnmount" class="headerlink" title="componentWillUnmount"></a>componentWillUnmount</h3><p><code>ReactDOM.unmountComponentAtNode()</code></p><h2 id="Mounting"><a href="#Mounting" class="headerlink" title="Mounting"></a>Mounting</h2><ul><li><code>constructor()</code></li><li><code>componentWillMount()</code></li><li><code>render()</code></li><li><code>componentDidMount()</code></li></ul><h2 id="Updating"><a href="#Updating" class="headerlink" title="Updating"></a>Updating</h2><ul><li><code>componentWillReceiveProps()</code></li><li><code>shouldComponentUpdate()</code></li><li><code>componentWillUpdate()</code></li><li><code>render()</code></li><li><code>componentDidUpdate()</code></li></ul><h2 id="Unmounting"><a href="#Unmounting" class="headerlink" title="Unmounting"></a>Unmounting</h2><ul><li><code>componentWillUnmount()</code></li></ul><h1 id="æ•°æ®é©±åŠ¨"><a href="#æ•°æ®é©±åŠ¨" class="headerlink" title="æ•°æ®é©±åŠ¨"></a>æ•°æ®é©±åŠ¨</h1><p>å•å‘æ•°æ®æµ</p><p>state -&gt; setState -&gt; render -&gt; view</p><h1 id="å®ä¾‹æ ¸å¿ƒå±æ€§"><a href="#å®ä¾‹æ ¸å¿ƒå±æ€§" class="headerlink" title="å®ä¾‹æ ¸å¿ƒå±æ€§"></a>å®ä¾‹æ ¸å¿ƒå±æ€§</h1><h2 id="state"><a href="#state" class="headerlink" title="state"></a>state</h2><p>state -&gt; setState()</p><p>setState æ˜¯å¼‚æ­¥çš„ã€‚</p><p>setState æ˜¯åˆå¹¶ä¸æ˜¯æ›¿æ¢ã€‚å¯ä»¥é€šè¿‡å®šæ—¶å™¨æ‘†è„± react çš„æ§åˆ¶ã€‚</p><p>setState è‹¥è¦ä¾èµ–å½“å‰æ•°æ®ï¼Œå¯ä»¥é€šè¿‡å‡½æ•°å¼è¿›è¡Œæ“ä½œã€‚</p><ul><li>setState((state) &#x3D;&gt; {})</li></ul><p>setState ç”Ÿå‘½å‘¨æœŸï¼š</p><ul><li><p>getDerivedStateFromProps</p></li><li><p>shouldComponentUpdateï¼Œæ ¹æ®è¿”å›å€¼åˆ¤æ–­æ˜¯å¦è¦ç»§ç»­æ›´æ–°ã€‚</p></li><li><p>renderï¼Œæ‰§è¡ŒçœŸæ­£çš„æ›´æ–°ã€‚</p></li><li><p>getSnapshotBeforeUpdate</p></li><li><p>componentDidUpdate</p></li></ul><h2 id="props"><a href="#props" class="headerlink" title="props"></a>props</h2><p>function(props){}</p><p>class cc extends React.Component {</p><p>Â Â this.props;</p><p>Â Â constructor(props){</p><p>Â Â Â Â this.props &#x3D; props;</p><p>Â Â }</p><p>}</p><h2 id="refs"><a href="#refs" class="headerlink" title="refs"></a>refs</h2><h3 id="å­—ç¬¦ä¸²å½¢å¼"><a href="#å­—ç¬¦ä¸²å½¢å¼" class="headerlink" title="å­—ç¬¦ä¸²å½¢å¼"></a>å­—ç¬¦ä¸²å½¢å¼</h3><p>class Demo extends React.Component {</p><p>Â Â const {input} &#x3D; this.refs;</p><p>Â Â render() {</p><p>Â Â Â Â return (</p><p>Â Â Â Â Â Â &lt;&gt;</p><p>Â Â Â Â Â Â Â Â &lt;input ref&#x3D;{input}&gt;</p><p>Â Â Â Â Â Â &lt;&#x2F;&gt;</p><p>Â Â Â Â )</p><p>Â Â }</p><p>}</p><h3 id="å›è°ƒå½¢å¼"><a href="#å›è°ƒå½¢å¼" class="headerlink" title="å›è°ƒå½¢å¼"></a>å›è°ƒå½¢å¼</h3><h4 id="å†…è”å½¢å¼"><a href="#å†…è”å½¢å¼" class="headerlink" title="å†…è”å½¢å¼"></a>å†…è”å½¢å¼</h4><p>å†…è”å½¢å¼ï¼Œref å›è°ƒå›æ‰§è¡Œä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡ä¼ é€’ null ç¬¬äºŒæ¬¡ä¼ é€’ DOM</p><p>&lt;input ref&#x3D;{(c) &#x3D;&gt; {this.input &#x3D; c}&gt;</p><h4 id="éå†…è”å½¢å¼"><a href="#éå†…è”å½¢å¼" class="headerlink" title="éå†…è”å½¢å¼"></a>éå†…è”å½¢å¼</h4><p>class demo extends React.Component {</p><p>Â Â handle(c){</p><p>Â Â Â Â this.input &#x3D; c;</p><p>Â Â }</p><p>Â Â return (</p><p>Â Â Â Â &lt;&gt;</p><p>Â Â Â Â Â Â &lt;input ref&#x3D;{this.handle}&gt;</p><p>Â Â Â Â &lt;&#x2F;&gt;</p><p>Â Â )</p><p>}</p><blockquote><p>å¦‚æœÂ <code>ref</code>Â å›è°ƒå‡½æ•°æ˜¯ä»¥å†…è”å‡½æ•°çš„æ–¹å¼å®šä¹‰çš„ï¼Œåœ¨æ›´æ–°è¿‡ç¨‹ä¸­å®ƒä¼šè¢«æ‰§è¡Œä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡ä¼ å…¥å‚æ•°Â <code>null</code>ï¼Œç„¶åç¬¬äºŒæ¬¡ä¼šä¼ å…¥å‚æ•° DOM å…ƒç´ ã€‚è¿™æ˜¯å› ä¸ºåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å‡½æ•°å®ä¾‹ï¼Œæ‰€ä»¥ React æ¸…ç©ºæ—§çš„Â <code>ref</code>Â å¹¶ä¸”è®¾ç½®æ–°çš„ã€‚é€šè¿‡å°†Â <code>ref</code>Â çš„å›è°ƒå‡½æ•°å®šä¹‰æˆÂ <code>class</code>Â çš„ç»‘å®šå‡½æ•°çš„æ–¹å¼å¯ä»¥é¿å…ä¸Šè¿°é—®é¢˜ï¼Œä½†æ˜¯å¤§å¤šæ•°æƒ…å†µä¸‹å®ƒæ˜¯æ— å…³ç´§è¦çš„ã€‚</p></blockquote><h3 id="createRef"><a href="#createRef" class="headerlink" title="createRef"></a>createRef</h3><p>class demo extends React.Component {</p><p>Â Â input &#x3D; React.createRef();</p><p>Â Â return (</p><p>Â Â Â Â &lt;&gt;</p><p>Â Â Â Â Â Â &lt;input ref&#x3D;{this.input}&gt;</p><p>Â Â Â Â &lt;&#x2F;&gt;</p><p>Â Â )</p><p>}</p><h1 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h1><p>React.FC é€‚ç”¨</p><h3 id="useState"><a href="#useState" class="headerlink" title="useState"></a>useState</h3><p>const [color, setColor] &#x3D; useState(â€œâ€)</p><p>è§¦å‘ render</p><p>å¼‚æ­¥</p><p>useState -&gt; render -&gt; Effect</p><h3 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a>useEffect</h3><p>å‰¯ä½œç”¨ã€‚</p><p>useEffect(() &#x3D;&gt; {},[propsName])</p><p>ç›‘å¬ æ•°æ®å˜åŒ–ä¹‹å è¿›è¡Œæ‰§è¡Œå›è°ƒå‡½æ•°ã€‚</p><p>ä¸å†™å‚æ•°ï¼Œåœ¨æ¯æ¬¡ render çš„æ—¶å€™æ‰§è¡Œå›è°ƒã€‚</p><p>renderä¹‹åæ‰§è¡Œã€‚</p><p>Reacté‡‡ç”¨å¼‚æ­¥è°ƒç”¨çš„æ–¹å¼å¤„ç†Effectï¼Œç­‰ä¸»çº¿ç¨‹å®Œæˆã€DOMæ›´æ–°ã€jsæ‰§è¡Œå®Œæˆã€è¯•å›¾ç»˜åˆ¶å®Œæˆï¼Œæ‰æ‰§è¡Œï¼Œæ‰€ä»¥effectå›è°ƒå‡½æ•°ä¸å›é˜»å¡æµè§ˆå™¨ç»˜åˆ¶è§†å›¾ã€‚</p><h3 id="useLayoutEffect"><a href="#useLayoutEffect" class="headerlink" title="useLayoutEffect"></a>useLayoutEffect</h3><p>DOMæ›´æ–°ä¹‹åï¼Œæµè§ˆå™¨ç»˜åˆ¶è§†å›¾ä¹‹å‰ï¼Œä¸”æ¯”Effectæ‰§è¡Œæ›´æ—©ã€‚</p><p>é¿å…åœ¨Effectä¸­æ“ä½œDOMæ—¶å¯¼è‡´äºŒæ¬¡ç»˜åˆ¶ï¼Œå‡ºç°é—ªç°ç°è±¡ã€‚</p><p>å…¶å›è°ƒæ‰§è¡Œä¼šé˜»å¡æµè§ˆå™¨ç»˜åˆ¶ã€‚</p><h3 id="useInsertionEffect"><a href="#useInsertionEffect" class="headerlink" title="useInsertionEffect"></a>useInsertionEffect</h3><p>DOMæ›´æ–°ä¹‹å‰ï¼Œä¸”æ¯”LayoutEffectæ‰§è¡Œæ›´æ—©ã€‚</p><p>è§£å†³ CSS-in-JS åœ¨æ¸²æŸ“ä¸­æ³¨å…¥æ ·å¼çš„æ€§èƒ½é—®é¢˜ã€‚</p><h3 id="useContext"><a href="#useContext" class="headerlink" title="useContext"></a>useContext</h3><ol><li>æ¥æ”¶ä¸Šä¸‹æ–‡ã€‚</li></ol><ul><li>create</li></ul><p>const MyContext &#x3D; React.createContext(defaultValue);</p><p>import {createContext} from â€œreactâ€</p><p>const MyContext &#x3D; createContext(defaultValue);</p><ul><li>Provider</li></ul><p>&lt;MyContext.Provider value&#x3D;{}&gt;</p><ul><li>use</li></ul><p>const value &#x3D; this.context;</p><p>const value &#x3D; useContext(MyContext);</p><p>&lt;MyContext.Consumer&gt;<br> {value &#x3D;&gt; { }}<br>&lt;&#x2F;MyContext.Consumer&gt;</p><h3 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a>useRef</h3><ol><li>è·å–å…ƒç´ ã€ç¼“å­˜çŠ¶æ€ã€‚</li></ol><p>const count &#x3D; useRef(0)</p><p>count.current &#x3D; count.current++;</p><ol start="2"><li>ä¸è§¦å‘ render</li></ol><p>connect DOM</p><p>const inputRef &#x3D; useRef(null);</p><p>&lt;input ref&#x3D;{inputRef}&#x2F;&gt;</p><p>inputRef.current.focus();</p><h1 id="Router"><a href="#Router" class="headerlink" title="Router"></a>Router</h1><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p><code>yarn add react-router-dom</code></p><h2 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h2><p>&lt;Route exact&#x2F;&gt; exact ä¸¥æ ¼åŒ¹é…æ¨¡å¼ï¼Œå¯èƒ½å¯¼è‡´äºŒçº§è·¯ç”±æ— æ³•åŒ¹é…</p><p>&lt;Link &#x2F;&gt;</p><p>&lt;BrowserRouter&gt;</BrowserRouter></p><p>&lt;NavLink&gt;</NavLink> é«˜äº®</p><p>&lt;Switch&gt;</Switch> é«˜æ•ˆè·¯ç”±åŒ¹é…</p><p>&lt;Redirect to&#x3D;â€&#x2F;aboutâ€ &#x2F;&gt; æ‰€æœ‰éƒ½æ— æ³•åŒ¹é…æ—¶é‡å®šå‘</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Component</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Link</span>, <span class="title class_">Route</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;./components/Home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">About</span> <span class="keyword">from</span> <span class="string">&#x27;./components/About&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;list-group&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Link</span> <span class="attr">className</span>=<span class="string">&quot;list-group-item&quot;</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            About</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Link</span> <span class="attr">className</span>=<span class="string">&quot;list-group-item&quot;</span> <span class="attr">to</span>=<span class="string">&quot;/home&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            Home</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;panel-body&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/about&quot;</span> <span class="attr">component</span>=<span class="string">&#123;About&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/home&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Home&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">history:</span><br><span class="line">  go: Æ’ go(n)</span><br><span class="line">  goBack: Æ’ goBack()</span><br><span class="line">  goForward: Æ’ goForward()</span><br><span class="line">  push: Æ’ push(path, state)</span><br><span class="line">  replace: Æ’ replace(path, state)</span><br><span class="line"></span><br><span class="line">location:</span><br><span class="line">  pathname: &quot;/home/message/detail/2/hello&quot;</span><br><span class="line">  search: &quot;&quot;</span><br><span class="line">  state: undefined</span><br><span class="line"></span><br><span class="line">match:</span><br><span class="line">  params: &#123;&#125;</span><br><span class="line">  path: &quot;/home/message/detail/:id/:title&quot;</span><br><span class="line">  url: &quot;/home/message/detail/2/hello&quot;</span><br></pre></td></tr></table></figure><h2 id="å¤šçº§è·¯å¾„åˆ·æ–°é¡µé¢æ ·å¼ä¸¢å¤±"><a href="#å¤šçº§è·¯å¾„åˆ·æ–°é¡µé¢æ ·å¼ä¸¢å¤±" class="headerlink" title="å¤šçº§è·¯å¾„åˆ·æ–°é¡µé¢æ ·å¼ä¸¢å¤±"></a>å¤šçº§è·¯å¾„åˆ·æ–°é¡µé¢æ ·å¼ä¸¢å¤±</h2><p>ç›¸å¯¹è·¯å¾„ä¼šå¯¹ç…§å½“å‰è·¯ç”±åœ°å€ï¼Œå› è€Œä¼šä¸¢å¤±æ ·å¼ã€‚</p><ul><li><p>å–æ¶ˆä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œä½¿ç”¨ <code>/</code> æˆ–è€… <code>%PUBLIC_URL%</code></p></li><li><p>ä½¿ç”¨ HashRouter</p></li></ul><h2 id="åµŒå¥—è·¯ç”±"><a href="#åµŒå¥—è·¯ç”±" class="headerlink" title="åµŒå¥—è·¯ç”±"></a>åµŒå¥—è·¯ç”±</h2><p>å­è·¯ç”±éœ€è¦åŠ ä¸Šçˆ¶è·¯ç”±çš„<code>path</code></p><h2 id="å‚æ•°ä¼ é€’"><a href="#å‚æ•°ä¼ é€’" class="headerlink" title="å‚æ•°ä¼ é€’"></a>å‚æ•°ä¼ é€’</h2><ul><li><p>params</p><p><code>/home/message/detail/:age/:name</code></p><p><code>/home/message/detail/21/amos</code></p><p><code>useParams() -&gt; &#123;age: &#39;21&#39;, name: &#39;amos&#39;&#125;</code></p><p>éœ€è¦é…ç½®</p></li><li><p>search</p><p><code>/home/message/detail?name=&quot;11&quot;</code></p><p><code>useQuery().get(&#39;name&#39;)</code></p></li><li><p>state</p><p><code>useHistory().push(&#39;/user/role/detail&#39;, &#123; id: item &#125;);</code></p><p><code>useLocation().state;</code></p></li></ul><h2 id="Hooks-1"><a href="#Hooks-1" class="headerlink" title="Hooks"></a>Hooks</h2><h3 id="useHistory"><a href="#useHistory" class="headerlink" title="useHistory"></a>useHistory</h3><ul><li><p>push</p></li><li><p>replace</p></li><li><p>go</p></li><li><p>goForward</p></li><li><p>goBack</p></li></ul><h3 id="useLocation"><a href="#useLocation" class="headerlink" title="useLocation"></a>useLocation</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">function</span> <span class="title function_">useLocation</span>(<span class="params"></span>): <span class="title class_">Location</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Location</span> <span class="keyword">extends</span> <span class="title class_">Path</span> &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="built_in">unknown</span>;</span><br><span class="line">  <span class="attr">key</span>: <span class="title class_">Key</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>state</p></li><li><p>key</p></li></ul><h3 id="useParams"><a href="#useParams" class="headerlink" title="useParams"></a>useParams</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> <span class="keyword">function</span> useParams&lt;K <span class="keyword">extends</span> <span class="built_in">string</span> = <span class="built_in">string</span>&gt;(): <span class="title class_">Readonly</span>&lt;<span class="title class_">Params</span>&lt;K&gt;&gt;;</span><br></pre></td></tr></table></figure><ul><li>{}</li></ul><h3 id="useQuery"><a href="#useQuery" class="headerlink" title="useQuery"></a>useQuery</h3><ul><li>get</li></ul><h1 id="Redux"><a href="#Redux" class="headerlink" title="Redux"></a>Redux</h1><p><img src="https://brucecai55520.gitee.io/my-notes/React/images/redux.png" alt="redux å·¥ä½œæµç¨‹å›¾"></p><p><strong>reducer -&gt; createStore -&gt; store -&gt; getStateã€dispathã€subscribe</strong></p><h2 id="createStore"><a href="#createStore" class="headerlink" title="createStore"></a>createStore</h2><ul><li><code>createStore(reducer: (preState:any; action:&#123;type: &#39;string&#39;; data: any&#125;)=&gt;&#123;&#125;)</code></li></ul><h2 id="Store"><a href="#Store" class="headerlink" title="Store"></a>Store</h2><ul><li><p><code>getState()</code></p></li><li><p><code>dispath(action: &#123;type: string; data: any;&#125;)</code></p></li><li><p><code>subscribe(func: function)</code></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>keep-alive ç¼“å­˜æ»šåŠ¨æ¡</title>
      <link href="/2022/06/02/bugRoad/keep-alive%20%E7%BC%93%E5%AD%98%E6%BB%9A%E5%8A%A8%E6%9D%A1/"/>
      <url>/2022/06/02/bugRoad/keep-alive%20%E7%BC%93%E5%AD%98%E6%BB%9A%E5%8A%A8%E6%9D%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="keep-alive-ç¼“å­˜æ»šåŠ¨æ¡"><a href="#keep-alive-ç¼“å­˜æ»šåŠ¨æ¡" class="headerlink" title="keep-alive ç¼“å­˜æ»šåŠ¨æ¡"></a>keep-alive ç¼“å­˜æ»šåŠ¨æ¡</h1><h2 id="å¸¸è§„ä½¿ç”¨"><a href="#å¸¸è§„ä½¿ç”¨" class="headerlink" title="å¸¸è§„ä½¿ç”¨"></a>å¸¸è§„ä½¿ç”¨</h2><p>é€šå¸¸æ˜¯ç”¨æ¥å­˜å‚¨ç»„ä»¶çŠ¶æ€ã€‚</p><p>åœ¨ Vue3 ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>keep-alive</code> ç»„ä»¶æ¥ç¼“å­˜ç»„ä»¶çš„çŠ¶æ€å’Œæ•°æ®ï¼Œä»è€Œå®ç°åœ¨é¡µé¢åˆ‡æ¢æ—¶ä¿ç•™æ•°æ®çš„æ•ˆæœã€‚</p><p><code>keep-alive</code> ç»„ä»¶å¯ä»¥å°†éœ€è¦ç¼“å­˜çš„ç»„ä»¶åŒ…è£¹èµ·æ¥ï¼Œå¹¶æä¾›ä¸€ä¸ª <code>include</code> å±æ€§æ¥æŒ‡å®šå“ªäº›ç»„ä»¶éœ€è¦ç¼“å­˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœéœ€è¦ç¼“å­˜ä¸€ä¸ªåä¸º <code>MyComponent</code> çš„ç»„ä»¶ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// include é€šå¸¸æ˜¯ç»„ä»¶çš„åç§°</span><br><span class="line"><span class="tag">&lt;<span class="name">keep-alive</span> <span class="attr">:include</span>=<span class="string">&quot;[&#x27;MyComponent&#x27;]&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™æ ·ï¼Œå½“ <code>MyComponent</code> ç»„ä»¶è¢«åˆ‡æ¢å‡ºå»æ—¶ï¼Œå…¶çŠ¶æ€å’Œæ•°æ®å°†ä¼šè¢«ç¼“å­˜èµ·æ¥ï¼Œå¹¶åœ¨åˆ‡æ¢å›æ¥æ—¶è‡ªåŠ¨æ¢å¤ã€‚å¦‚æœéœ€è¦ç¼“å­˜æ‰€æœ‰ç»„ä»¶ï¼Œå¯ä»¥å°† <code>include</code> å±æ€§è®¾ç½®ä¸º <code>true</code>ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>keep-alive</code> ç»„ä»¶åªä¼šç¼“å­˜è¢«åŒ…è£¹çš„ç»„ä»¶çš„çŠ¶æ€å’Œæ•°æ®ï¼Œè€Œä¸ä¼šç¼“å­˜è·¯ç”±çš„çŠ¶æ€å’Œæ•°æ®ã€‚å¦‚æœéœ€è¦ç¼“å­˜æ•´ä¸ªè·¯ç”±çš„çŠ¶æ€å’Œæ•°æ®ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ <code>vuex</code> æ¥ç®¡ç†åº”ç”¨çš„çŠ¶æ€ã€‚</p><blockquote><p>æ³¨æ„åœ¨ <code>Vue3</code> ä¸­è¿™ç§æ–¹å¼ä¼š <code>warning</code>ï¼Œéœ€è¦é€šè¿‡ <code>v-slot</code> çš„å½¢å¼ä½¿ç”¨</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;keep-alive&gt;</span><br><span class="line">  // Component æ˜¯ router-view è‡ªå¸¦çš„å±æ€§</span><br><span class="line">  &lt;router-view :include=&quot;[&#x27;MyComponent&#x27;]&quot; v-slot=&quot;&#123; Component &#125;&quot;&gt;</span><br><span class="line">    &lt;component :is=&quot;Component&quot;&gt;&lt;/component&gt;</span><br><span class="line">  &lt;/router-view&gt;</span><br><span class="line">&lt;/keep-alive&gt;</span><br></pre></td></tr></table></figure><p><code>keep-alive</code> ç»„ä»¶é™¤äº† <code>include</code> å±æ€§ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªå¯¹ç«‹çš„å±æ€§ <code>exclude</code>ï¼Œå¯ä»¥ç”¨æ¥æŒ‡å®šä¸éœ€è¦ç¼“å­˜çš„ç»„ä»¶ã€‚</p><p><code>exclude</code> å±æ€§æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²æˆ–ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ï¼Œç”¨æ¥æŒ‡å®šä¸éœ€è¦ç¼“å­˜çš„ç»„ä»¶åç§°ã€‚</p><h2 id="èƒ½å¦ç¼“å­˜æ»šåŠ¨æ¡å‘¢ï¼Ÿ"><a href="#èƒ½å¦ç¼“å­˜æ»šåŠ¨æ¡å‘¢ï¼Ÿ" class="headerlink" title="èƒ½å¦ç¼“å­˜æ»šåŠ¨æ¡å‘¢ï¼Ÿ"></a>èƒ½å¦ç¼“å­˜æ»šåŠ¨æ¡å‘¢ï¼Ÿ</h2><p><code>keep-alive</code> ç»„ä»¶æ˜¯ç”¨æ¥ç¼“å­˜ç»„ä»¶çš„çŠ¶æ€å’Œæ•°æ®çš„ï¼Œå®ƒå¹¶ä¸ä¼šç¼“å­˜é¡µé¢çš„æ»šåŠ¨æ¡ä½ç½®ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨ <code>keep-alive</code> ç¼“å­˜ç»„ä»¶æ—¶ï¼Œå¦‚æœéœ€è¦åœ¨åˆ‡æ¢è·¯ç”±æ—¶ä¿æŒæ»šåŠ¨æ¡ä½ç½®ä¸å˜ï¼Œéœ€è¦æ‰‹åŠ¨è®°å½•å’Œæ¢å¤æ»šåŠ¨æ¡ä½ç½®ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ï¼Œå¯ä»¥åœ¨ç»„ä»¶çš„ <code>activated</code> å’Œ <code>deactivated</code> é’©å­å‡½æ•°ä¸­è®°å½•å’Œæ¢å¤æ»šåŠ¨æ¡ä½ç½®ã€‚ä¾‹å¦‚ï¼Œåœ¨ <code>activated</code> é’©å­å‡½æ•°ä¸­è®°å½•æ»šåŠ¨æ¡ä½ç½®ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">activated</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// è®°å½•æ»šåŠ¨æ¡ä½ç½®</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$scrollPosition</span> = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span> || <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollTop</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>activated</code> é’©å­å‡½æ•°ä¸­è®°å½•äº†æ»šåŠ¨æ¡ä½ç½®ï¼Œå°†å…¶ä¿å­˜åœ¨ç»„ä»¶çš„ <code>$scrollPosition</code> å±æ€§ä¸­ã€‚</p><p>åœ¨ <code>deactivated</code> é’©å­å‡½æ•°ä¸­æ¢å¤æ»šåŠ¨æ¡ä½ç½®ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">deactivated</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// æ¢å¤æ»šåŠ¨æ¡ä½ç½®</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span> = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollTop</span> = <span class="variable language_">this</span>.<span class="property">$scrollPosition</span> || <span class="number">0</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>deactivated</code> é’©å­å‡½æ•°ä¸­æ¢å¤äº†æ»šåŠ¨æ¡ä½ç½®ï¼Œå°†æ»šåŠ¨æ¡ä½ç½®è®¾ç½®ä¸ºç»„ä»¶çš„ <code>$scrollPosition</code> å±æ€§ä¿å­˜çš„å€¼ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºä¸åŒçš„æµè§ˆå™¨å¯èƒ½ä¼šæœ‰ä¸åŒçš„æ»šåŠ¨æ¡å®ç°æ–¹å¼ï¼Œå› æ­¤åœ¨è®°å½•å’Œæ¢å¤æ»šåŠ¨æ¡ä½ç½®æ—¶éœ€è¦è€ƒè™‘æµè§ˆå™¨çš„å…¼å®¹æ€§ã€‚åŒæ—¶ï¼Œéœ€è¦åœ¨ç»„ä»¶çš„ <code>beforeDestroy</code> é’©å­å‡½æ•°ä¸­æ¸…ç†ä¿å­˜çš„æ»šåŠ¨æ¡ä½ç½®ï¼Œä»¥é¿å…å¯¹ä¸‹æ¬¡æ¸²æŸ“äº§ç”Ÿå½±å“ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BugRoad </category>
          
          <category> Vue3 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> scroll </tag>
            
            <tag> keep-alive </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>nodeJS æ‰“åŒ…</title>
      <link href="/2022/06/02/bugRoad/nodeJS%20%E6%89%93%E5%8C%85/"/>
      <url>/2022/06/02/bugRoad/nodeJS%20%E6%89%93%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<h1 id="nodeJS-æ‰“åŒ…"><a href="#nodeJS-æ‰“åŒ…" class="headerlink" title="nodeJS æ‰“åŒ…"></a>nodeJS æ‰“åŒ…</h1><h2 id="å…¨å±€å®‰è£…"><a href="#å…¨å±€å®‰è£…" class="headerlink" title="å…¨å±€å®‰è£…"></a>å…¨å±€å®‰è£…</h2><p><code>npm i pkg -g</code></p><h2 id="é…ç½®-package-json"><a href="#é…ç½®-package-json" class="headerlink" title="é…ç½® package.json"></a>é…ç½® package.json</h2><p>(1) bin æŒ‡å®šå¯åŠ¨æ–‡ä»¶</p><p>(2) script é…ç½®å‘½ä»¤</p><p>(3) <code>pkg .</code> å¯»æ‰¾æŒ‡å®šç›®å½•ä¸‹çš„<code>package.json</code>æ–‡ä»¶ï¼Œç„¶ååœ¨æ‰¾<code>bin</code>å­—æ®µä½œä¸ºå…¥å£æ–‡ä»¶</p><p>(4) <code>-t</code> æŒ‡å®šæ‰“åŒ…å¹³å°</p><p>(5) <code>-o</code> æŒ‡å®šè¾“å‡ºæ–‡ä»¶å</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">...<span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;bin&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./app.js&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pkg . -t node12-win-x64 -o server -d&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">...</span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="æ‰“åŒ…åè·¯å¾„åŒºåˆ«"><a href="#æ‰“åŒ…åè·¯å¾„åŒºåˆ«" class="headerlink" title="æ‰“åŒ…åè·¯å¾„åŒºåˆ«"></a>æ‰“åŒ…åè·¯å¾„åŒºåˆ«</h2><p><img src="https://s2.loli.net/2023/04/01/odRy1kBJiPm4zGZ.png"></p><h2 id="node-ç¯å¢ƒä¸‹è½½æ…¢"><a href="#node-ç¯å¢ƒä¸‹è½½æ…¢" class="headerlink" title="node ç¯å¢ƒä¸‹è½½æ…¢"></a>node ç¯å¢ƒä¸‹è½½æ…¢</h2><p>pkg æ‰“åŒ…éœ€è¦ç‰¹æ®Šçš„ node ç¯å¢ƒï¼Œä¼šå» node pkg ç¼“å­˜ä¸­å»æ‰¾ï¼Œæ‰¾ä¸åˆ°å°±å» github ä¸‹è½½ã€‚</p><p>æ¯æ¬¡æ‰“åŒ…çš„æ—¶å€™ä¼šæ˜¾ç¤ºä¸‹è½½çš„ç‰ˆæœ¬ï¼Œå¯ä»¥å» github å…ˆä¸‹è½½å¥½ï¼Œç„¶åæ”¾åˆ°ç¼“å­˜å»ï¼Œç¼“å­˜å¤§è‡´ä½ç½®åœ¨ï¼š<code>C:\Users\lenovo\.pkg-cache</code>ï¼Œå¯ä»¥ç”¨ <code>everything</code> æœ <code>.pkg-cache</code>ã€‚</p><p><a href="https://github.com/vercel/pkg-fetch/releases">pkg èµ„æºä¸‹è½½</a></p><p>ä¸‹è½½ç‰ˆæœ¬çš„åå­—å¯èƒ½ä¼šæœ‰ä¸åŒï¼Œä¸‹è½½çš„æ˜¯ <code>node-v8.17.0-win-x64</code>ï¼Œä½†æ˜¯éœ€è¦çš„å¯èƒ½æ˜¯<code>fetch-v8.17.0-win-x64</code>,ä¿®æ”¹ä¸€ä¸‹åå­—å³å¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> BugRoad </category>
          
          <category> NodeJS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pkg </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ»šåŠ¨æ¡æ ·å¼</title>
      <link href="/2022/04/15/TrialYard/%E6%BB%9A%E5%8A%A8%E6%9D%A1%E6%A0%B7%E5%BC%8F/"/>
      <url>/2022/04/15/TrialYard/%E6%BB%9A%E5%8A%A8%E6%9D%A1%E6%A0%B7%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="æ»šåŠ¨æ¡æ ·å¼"><a href="#æ»šåŠ¨æ¡æ ·å¼" class="headerlink" title="æ»šåŠ¨æ¡æ ·å¼"></a>æ»šåŠ¨æ¡æ ·å¼</h1><p>ä¼ ç»Ÿæ»šåŠ¨æ¡å·²ç»è¦çœ‹çäº†ï¼Œä¸å ªå…¥ç›®å‘~</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*æ§åˆ¶æ•´ä¸ªæ»šåŠ¨æ¡*/</span></span><br><span class="line">::-webkit-scrollbar &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: transparent;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">6px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">6px</span>;</span><br><span class="line">  <span class="attribute">background-clip</span>: padding-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*æ»šåŠ¨æ¡ä¸­æ»‘å—éƒ¨åˆ†*/</span></span><br><span class="line">::-webkit-scrollbar-thumb &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">144</span>, <span class="number">147</span>, <span class="number">153</span>, <span class="number">0.5</span>);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">transition</span>: background-color <span class="number">0.3s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">::-webkit-scrollbar-thumb:hover &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#a4a4a4</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> TrialYard </category>
          
      </categories>
      
      
        <tags>
            
            <tag> scroll </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ é™¤ node_modules æ…¢</title>
      <link href="/2022/04/05/bugRoad/%E5%88%A0%E9%99%A4%20node_modules%20%E6%85%A2/"/>
      <url>/2022/04/05/bugRoad/%E5%88%A0%E9%99%A4%20node_modules%20%E6%85%A2/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆ é™¤-node-modules-æ…¢"><a href="#åˆ é™¤-node-modules-æ…¢" class="headerlink" title="åˆ é™¤ node_modules æ…¢"></a>åˆ é™¤ node_modules æ…¢</h1><p>é€šå¸¸é¡¹ç›®å‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å°† node_modules åˆ é™¤é‡æ–° yarnï¼Œæˆ–è€…éœ€è¦æ‰“åŒ…å‡ºå»çš„æ—¶å€™éœ€è¦å°† node_modules åˆ é™¤ï¼Œä½†ç›´æ¥åˆ é™¤ï¼Œæ˜¯åœ¨çš„æ…¢çš„ä¸æ˜¯ä¸€åªåŠç‚¹ã€‚</p><h2 id="rimraf"><a href="#rimraf" class="headerlink" title="rimraf"></a>rimraf</h2><p>é€šè¿‡è¿™ä¸ªåŒ… å¯ä»¥å¿«é€Ÿåˆ é™¤ node_modulesã€‚</p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p><code>yarn global add rimraf</code></p><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p><code>rimraf node_modules</code></p>]]></content>
      
      
      <categories>
          
          <category> BugRoad </category>
          
          <category> node_modules </category>
          
      </categories>
      
      
        <tags>
            
            <tag> rimraf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NodeJS åŸºç¡€</title>
      <link href="/2022/03/12/JS/NodeJS/NodeJS%20%E5%9F%BA%E7%A1%80/"/>
      <url>/2022/03/12/JS/NodeJS/NodeJS%20%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h3 id="Node-js-REPL"><a href="#Node-js-REPL" class="headerlink" title="Node.js REPL"></a>Node.js REPL</h3><blockquote><p>æ³¨æ„ï¼šREPL ä¹Ÿè¢«ç§°ä¸ºè¿è¡Œè¯„ä¼°æ‰“å°å¾ªç¯ï¼Œæ˜¯ä¸€ç§ç¼–ç¨‹è¯­è¨€ç¯å¢ƒï¼ˆä¸»è¦æ˜¯æ§åˆ¶å°çª—å£ï¼‰ï¼Œå®ƒä½¿ç”¨å•ä¸ªè¡¨è¾¾å¼ä½œä¸ºç”¨æˆ·è¾“å…¥ï¼Œå¹¶åœ¨æ‰§è¡Œåå°†ç»“æœè¿”å›åˆ°æ§åˆ¶å°ã€‚</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// Windows Terminal or cmd</span><br><span class="line">// ç»ˆç«¯è¾“å…¥node , REPL æ­£åœ¨ç­‰å¾…è¾“å…¥ä¸€äº› JavaScript ä»£ç </span><br><span class="line">&gt; node</span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line">// å¯é€šè¿‡nodeç›´æ¥æ‰§è¡Œæ–‡ä»¶</span><br><span class="line">&gt; node app.js</span><br></pre></td></tr></table></figure><h3 id="ç‚¹å‘½ä»¤"><a href="#ç‚¹å‘½ä»¤" class="headerlink" title="ç‚¹å‘½ä»¤"></a>ç‚¹å‘½ä»¤</h3><ul><li>.help: æ˜¾ç¤ºç‚¹å‘½ä»¤çš„å¸®åŠ©ã€‚</li><li>.editor: å¯ç”¨ç¼–è¾‘å™¨æ¨¡å¼ï¼Œå¯ä»¥è½»æ¾åœ°ç¼–å†™å¤šè¡Œ JavaScript ä»£ç ã€‚å½“å¤„äºæ­¤æ¨¡å¼æ—¶ï¼ŒæŒ‰ä¸‹ ctrl-D å¯ä»¥è¿è¡Œç¼–å†™çš„ä»£ç ã€‚</li><li>.break: å½“è¾“å…¥å¤šè¡Œçš„è¡¨è¾¾å¼æ—¶ï¼Œè¾“å…¥ .break å‘½ä»¤å¯ä»¥ä¸­æ­¢è¿›ä¸€æ­¥çš„è¾“å…¥ã€‚ç›¸å½“äºæŒ‰ä¸‹ ctrl-Cã€‚</li><li>.clear: å°† REPL ä¸Šä¸‹æ–‡é‡ç½®ä¸ºç©ºå¯¹è±¡ï¼Œå¹¶æ¸…é™¤å½“å‰æ­£åœ¨è¾“å…¥çš„ä»»ä½•å¤šè¡Œçš„è¡¨è¾¾å¼ã€‚</li><li>.load: åŠ è½½ JavaScript æ–‡ä»¶ï¼ˆç›¸å¯¹äºå½“å‰å·¥ä½œç›®å½•ï¼‰ã€‚</li><li>.save: å°†åœ¨ REPL ä¼šè¯ä¸­è¾“å…¥çš„æ‰€æœ‰å†…å®¹ä¿å­˜åˆ°æ–‡ä»¶ï¼ˆéœ€æŒ‡å®šæ–‡ä»¶åï¼‰ã€‚</li><li>.exit: é€€å‡º REPLï¼ˆç›¸å½“äºæŒ‰ä¸‹ä¸¤æ¬¡ ctrl-Cï¼‰ã€‚</li></ul><h3 id="å‘½ä»¤è¡Œæ¥æ”¶å‚æ•°"><a href="#å‘½ä»¤è¡Œæ¥æ”¶å‚æ•°" class="headerlink" title="å‘½ä»¤è¡Œæ¥æ”¶å‚æ•°"></a>å‘½ä»¤è¡Œæ¥æ”¶å‚æ•°</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// Terminal</span><br><span class="line">&gt; node app.js 1,2,3</span><br><span class="line">&gt; node app.js name=JOEOP</span><br><span class="line">&gt; node app.js --name=JOEOP</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="comment">// &gt; node app.js 1,2,3</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(process.<span class="property">argv</span>.<span class="title function_">slice</span>(<span class="number">2</span>)); <span class="comment">// [ &#x27;1,2,3&#x27; ]</span></span><br><span class="line"><span class="comment">// &gt; node app.js name=JOEOP</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(process.<span class="property">argv</span>.<span class="title function_">slice</span>(<span class="number">2</span>)); <span class="comment">// [ &#x27;name=JOEOP&#x27; ]</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åˆ™ args[0] æ˜¯ name&#x3D;joeï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œè§£æã€‚ æœ€å¥½çš„æ–¹æ³•æ˜¯ä½¿ç”¨ minimist åº“ï¼Œè¯¥åº“æœ‰åŠ©äºå¤„ç†å‚æ•°ï¼š</p><p><code>npm install minimist</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.js</span></span><br><span class="line"><span class="comment">// &gt; node app.js --name=JOEOP</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(args[<span class="string">&quot;name&quot;</span>]); <span class="comment">// JOEOP</span></span><br></pre></td></tr></table></figure><h3 id="console-log"><a href="#console-log" class="headerlink" title="console.log"></a>console.log</h3><p><code>console.log(&#39;æˆ‘çš„%så·²ç»%då²&#39;, &#39;çŒ«&#39;, 2)</code>æ‰“å°è¾“å‡º</p><ul><li>%s ä¼šæ ¼å¼åŒ–å˜é‡ä¸ºå­—ç¬¦ä¸²</li><li>%d ä¼šæ ¼å¼åŒ–å˜é‡ä¸ºæ•°å­—</li><li>%i ä¼šæ ¼å¼åŒ–å˜é‡ä¸ºå…¶æ•´æ•°éƒ¨åˆ†</li><li>%o ä¼šæ ¼å¼åŒ–å˜é‡ä¸ºå¯¹è±¡</li></ul><p><code>console.clear()</code>æ¸…ç©ºæ§åˆ¶å°</p><p><code>console.count()</code>count æ–¹æ³•ä¼šå¯¹æ‰“å°çš„å­—ç¬¦ä¸²çš„æ¬¡æ•°è¿›è¡Œè®¡æ•°ï¼Œå¹¶åœ¨å…¶æ—è¾¹æ‰“å°è®¡æ•°ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> oranges = [<span class="string">&quot;æ©™å­&quot;</span>, <span class="string">&quot;æ©™å­&quot;</span>];</span><br><span class="line"><span class="keyword">const</span> apples = [<span class="string">&quot;è‹¹æœ&quot;</span>];</span><br><span class="line">oranges.<span class="title function_">forEach</span>(<span class="function">(<span class="params">fruit</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">count</span>(fruit);</span><br><span class="line">&#125;);</span><br><span class="line">apples.<span class="title function_">forEach</span>(<span class="function">(<span class="params">fruit</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">count</span>(fruit);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// æ©™å­: 1</span></span><br><span class="line"><span class="comment">// æ©™å­: 2</span></span><br><span class="line"><span class="comment">// è‹¹æœ: 1</span></span><br></pre></td></tr></table></figure><p><code>console.trace()</code>æ‰“å°å †æ ˆè¸ªè¿¹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">function2</span> = (<span class="params"></span>) =&gt; <span class="variable language_">console</span>.<span class="title function_">trace</span>();</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">function1</span> = (<span class="params"></span>) =&gt; <span class="title function_">function2</span>();</span><br><span class="line"><span class="title function_">function1</span>();</span><br></pre></td></tr></table></figure><p><code>console.time() console.timeEnd()</code>è®¡ç®—è€—æ—¶</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">doSomething</span> = (<span class="params"></span>) =&gt; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;æµ‹è¯•&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">measureDoingSomething</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">time</span>(<span class="string">&quot;doSomething()&quot;</span>);</span><br><span class="line">  <span class="title function_">doSomething</span>();</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">timeEnd</span>(<span class="string">&quot;doSomething()&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">measureDoingSomething</span>();</span><br></pre></td></tr></table></figure><p><code>npm install progress</code>åˆ›å»ºè¿›åº¦æ¡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">ProgressBar</span> = <span class="built_in">require</span>(<span class="string">&quot;progress&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> bar = <span class="keyword">new</span> <span class="title class_">ProgressBar</span>(<span class="string">&quot;:bar&quot;</span>, &#123; <span class="attr">total</span>: <span class="number">10</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> timer = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  bar.<span class="title function_">tick</span>();</span><br><span class="line">  <span class="keyword">if</span> (bar.<span class="property">complete</span>) &#123;</span><br><span class="line">    <span class="built_in">clearInterval</span>(timer);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;, <span class="number">100</span>);</span><br></pre></td></tr></table></figure><hr><h3 id="NodeJS"><a href="#NodeJS" class="headerlink" title="NodeJS"></a>NodeJS</h3><ul><li>Node æ˜¯å¯¹ ES æ ‡å‡†çš„ä¸€ä¸ªå®ç°ï¼ŒNode ä¹Ÿæ˜¯ä¸€ä¸ª JS å¼•æ“</li><li>Node å¯ä»¥åœ¨åå°ç¼–å†™æœåŠ¡å™¨<ul><li>Node ç¼–å†™æœåŠ¡å™¨éƒ½æ˜¯å•çº¿ç¨‹æœåŠ¡å™¨<ul><li>è¿›ç¨‹ â€“ ä¸€ä¸ªä¸ªçš„å·¥ä½œè®¡åˆ’ï¼ˆå·¥å‚ä¸­çš„è½¦é—´ï¼‰</li><li>çº¿ç¨‹ â€“ è®¡ç®—æœºæœ€å°çš„è¿ç®—å•ä½ï¼ˆå·¥å‚ä¸­çš„å·¥äººï¼‰</li></ul></li></ul></li><li>ä¼ ç»Ÿçš„æœåŠ¡å™¨éƒ½æ˜¯å¤šçº¿ç¨‹çš„<ul><li>æ¯è¿›æ¥ä¸€ä¸ªè¯·æ±‚ï¼Œå°±åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å»å¤„ç†è¯·æ±‚</li></ul></li><li>Node çš„æœåŠ¡å™¨å•çº¿ç¨‹çš„<ul><li>Node å¤„ç†è¯·æ±‚æ—¶æ˜¯å•çº¿ç¨‹ï¼Œä½†æ˜¯åœ¨åå°æ‹¥æœ‰ä¸€ä¸ª I&#x2F;O çº¿ç¨‹æ± </li></ul></li></ul><h3 id="NodeJS-æ¨¡å—åŒ–"><a href="#NodeJS-æ¨¡å—åŒ–" class="headerlink" title="NodeJS æ¨¡å—åŒ–"></a>NodeJS æ¨¡å—åŒ–</h3><ul><li>Node verison 13.2.0 èµ·å¼€å§‹æ­£å¼æ”¯æŒ ES Modules ç‰¹æ€§</li><li>ä¹‹å‰å…¨éƒ¨é‡‡ç”¨ CommonJS è¿›è¡Œæ¨¡å—åŒ–</li><li>Node åœ¨å¼•ç”¨æ—¶ï¼Œä¼šå‘ä¸Šä¸€å±‚ä¸€å±‚çš„å¯»æ‰¾<code>node_modules</code></li><li>ES6 Modules<ul><li><code>export &amp; import</code></li></ul></li><li>CommonJS Modules<ul><li><code>module.exports &amp; require</code></li></ul></li></ul><h3 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h3><ul><li><code>npm -v</code></li><li><code>npm search packageName</code></li><li><code>npm install</code> å®‰è£…ä¾èµ–</li><li><code>npm install/i packageName</code></li><li><code>npm install/i packageName --save</code> å®‰è£…å¹¶æ·»åŠ ä¾èµ–</li><li><code>npm install/i packageName -g</code> å…¨å±€å®‰è£…</li><li><code>npm remove/r packageName</code></li></ul><h3 id="Buffer"><a href="#Buffer" class="headerlink" title="Buffer"></a>Buffer</h3><ul><li>Buffer ç»“æ„ç”¨æ³•ç±»ä¼¼æ•°ç»„</li><li>æ•°ç»„ä¸­ä¸èƒ½å­˜å‚¨äºŒè¿›åˆ¶çš„æ–‡ä»¶ï¼ŒBuffer æ˜¯ä¸“é—¨æ¥å­˜å‚¨äºŒè¿›åˆ¶æ•°æ®çš„ <code>[ 00 - ff ]</code></li><li>Buffer ä¸­å­˜å‚¨çš„éƒ½æ˜¯äºŒè¿›åˆ¶æ•°æ®ï¼Œä½†æ˜¯æ˜¾ç¤ºçš„æ—¶å€™ä¼šä»¥ 16 è¿›åˆ¶æ˜¾ç¤º</li><li><code>&lt;buffer&gt;.length</code> å ç”¨å†…å­˜å¤§å°</li><li><code>Buffer.from(str)</code> å­—ç¬¦ä¸²è½¬<code>buffer</code></li><li><del><code>new Buffer(bitSize)</code></del></li><li><code>Buffer.alloc(bitSize)</code></li><li><code>Buffer.allocUnsafe(bitSize)</code> åˆ›å»ºæŒ‡å®šå¤§å°çš„<code>buffer</code>ï¼Œä½†å…¶ä¸­å¯èƒ½å«æœ‰æ•æ„Ÿæ•°æ®</li><li><code>Buffer.compare(buf1, buf2)</code></li></ul><h3 id="FSï¼ˆFile-Systemï¼‰"><a href="#FSï¼ˆFile-Systemï¼‰" class="headerlink" title="FSï¼ˆFile Systemï¼‰"></a>FSï¼ˆFile Systemï¼‰</h3><ul><li><code>require(&quot;fs&quot;)</code></li><li><strong>åŒæ­¥</strong> æœ‰è¿”å›å€¼</li><li><code>fd = fs.openSync(path, flag[, mode])</code> åŒæ­¥æ‰“å¼€æ–‡ä»¶</li><li><code>fs.writeSync(fd, str[, startIndex[, encoding]])</code></li><li><code>fs.closeSync(fd)</code></li><li><strong>å¼‚æ­¥</strong> æ²¡æœ‰è¿”å›å€¼ï¼Œé€šè¿‡å›è°ƒå‡½æ•°è¿”å›</li><li><code>fs.open(path, flag [, mode], callback)</code><ul><li><code>callback = function(err, fd) &#123;&#125;</code></li></ul></li><li><code>fs.write(fd, string[, position[, encoding]], callback)</code></li></ul>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> NodeJS </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è‡ªå®šä¹‰ Plugin æŠ¥é”™ æ‰“åŒ…ç»ˆæ­¢</title>
      <link href="/2021/12/22/bugRoad/%E8%87%AA%E5%AE%9A%E4%B9%89%20Plugin%20%E6%8A%A5%E9%94%99%20%E6%89%93%E5%8C%85%E7%BB%88%E6%AD%A2/"/>
      <url>/2021/12/22/bugRoad/%E8%87%AA%E5%AE%9A%E4%B9%89%20Plugin%20%E6%8A%A5%E9%94%99%20%E6%89%93%E5%8C%85%E7%BB%88%E6%AD%A2/</url>
      
        <content type="html"><![CDATA[<h1 id="è‡ªå®šä¹‰-Plugin-æŠ¥é”™-æ‰“åŒ…ç»ˆæ­¢"><a href="#è‡ªå®šä¹‰-Plugin-æŠ¥é”™-æ‰“åŒ…ç»ˆæ­¢" class="headerlink" title="è‡ªå®šä¹‰ Plugin æŠ¥é”™ æ‰“åŒ…ç»ˆæ­¢"></a>è‡ªå®šä¹‰ Plugin æŠ¥é”™ æ‰“åŒ…ç»ˆæ­¢</h1><h2 id="ğŸ¤”-å‘ç°é—®é¢˜"><a href="#ğŸ¤”-å‘ç°é—®é¢˜" class="headerlink" title="ğŸ¤” å‘ç°é—®é¢˜"></a>ğŸ¤” å‘ç°é—®é¢˜</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(node:9776) [DEP_WEBPACK_COMPILATION_ASSETS] DeprecationWarning: Compilation.assets will be frozen <span class="keyword">in</span> future, all modifications are deprecated.BREAKING CHANGE: No more changes should happen to Compilation.assets after sealing the Compilation.Do changes to assets earlier, e. g. <span class="keyword">in</span> Compilation.hooks.processAssets.Make sure to an appropriate stage from Compilation.PROCESS_ASSETS_STAGE_*. Use `node --trace-deprecation ...` to show <span class="built_in">where</span> the warning was created)</span><br></pre></td></tr></table></figure><h2 id="ğŸ™…â€â™‚ï¸-æ‹’ç»å¦¥åï¼ŒåšæŒè§£å†³"><a href="#ğŸ™…â€â™‚ï¸-æ‹’ç»å¦¥åï¼ŒåšæŒè§£å†³" class="headerlink" title="ğŸ™…â€â™‚ï¸ æ‹’ç»å¦¥åï¼ŒåšæŒè§£å†³"></a>ğŸ™…â€â™‚ï¸ æ‹’ç»å¦¥åï¼ŒåšæŒè§£å†³</h2><p>æ„æ€æ˜¯ï¼š <code>Compilation.assets will be frozen in future</code> å°±æ˜¯ <code>Compilation.assets</code> å°†æ¥çš„<code>webpack</code>çš„ç‰ˆæœ¬ä¸­ä¼šè¢«å†»ç»“ï¼Œå»ºè®®åœ¨ <code>compilation</code> çš„ <code>seal</code> é˜¶æ®µå»å¤„ç†èµ„æºã€‚ï¼ˆä¹Ÿå°±æ˜¯è¯´å¯ä»¥åœ¨ï¼Œèµ„æºå‹ç¼©ä¹‹åï¼Œå†»ç»“ä¹‹å‰ï¼Œå¯¹èµ„æºè¿›è¡Œå¤„ç†ï¼Œä½†æ˜¯<code>compilation</code>å¯èƒ½ä¼šè§¦å‘å¤šæ¬¡ï¼‰</p><p><code>compiler.hooks.emit.tapAsync(&quot;pluginName&quot;, (compilation) =&gt; &#123;&#125;)</code></p><p>æ‰“åŒ…ç»ˆæ­¢åŸå› æ˜¯ å¼‚æ­¥é’©å­ï¼Œéœ€è¦è°ƒç”¨å›è°ƒï¼Œæ‰ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œ</p><ul><li>æ”¹ç”¨ <code>tap</code> å®šä¹‰é’©å­</li><li>æˆ–è€…æ·»åŠ  <code>callback</code>ï¼Œå¹¶è°ƒç”¨</li></ul><p>ä¹‹åå°±å¯ä»¥æ‰“åŒ…æˆåŠŸäº†ï¼Œä½†å¯èƒ½æ‰“åŒ…ä¹‹åä»ç„¶ä¼šæœ‰è­¦å‘Šï¼Œè¿™é‡Œå¯ä»¥æš‚æ—¶å¿½ç•¥</p>]]></content>
      
      
      <categories>
          
          <category> BugRoad </category>
          
          <category> webpack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Compilation.assets </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Promise</title>
      <link href="/2021/10/27/JS/Promise/"/>
      <url>/2021/10/27/JS/Promise/</url>
      
        <content type="html"><![CDATA[<h1 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h1><h2 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h2><ul><li>å¤„ç†å¼‚æ­¥è¯·æ±‚</li><li>å•å‘çŠ¶æ€æ›´å˜</li><li>å›è°ƒåœ°ç‹±</li></ul><h2 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h2><p>Promise æ¥è§£å†³åé¦ˆç»“æœéœ€è¦ç­‰å¾…çš„åœºæ™¯</p><h2 id="åŒæ­¥ä¸å¼‚æ­¥"><a href="#åŒæ­¥ä¸å¼‚æ­¥" class="headerlink" title="åŒæ­¥ä¸å¼‚æ­¥"></a>åŒæ­¥ä¸å¼‚æ­¥</h2><h3 id="åŒæ­¥"><a href="#åŒæ­¥" class="headerlink" title="åŒæ­¥"></a>åŒæ­¥</h3><p>åŒæ­¥æ˜¯æŒ‡å½“å‘èµ·ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œå¦‚æœæœªå¾—åˆ°è¯·æ±‚ç»“æœï¼Œä»£ç é€»è¾‘å°†ä¼šç­‰å¾…ï¼Œç›´åˆ°ç»“æœå‡ºæ¥ä¸ºæ­¢æ‰ä¼šç»§ç»­æ‰§è¡Œä¹‹åçš„ä»£ç ã€‚</p><h3 id="å¼‚æ­¥"><a href="#å¼‚æ­¥" class="headerlink" title="å¼‚æ­¥"></a>å¼‚æ­¥</h3><p>å¼‚æ­¥æ˜¯æŒ‡å½“å‘èµ·ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œä¸ä¼šç­‰å¾…è¯·æ±‚ç»“æœï¼Œç›´æ¥ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ã€‚è¯·æ±‚ç»“æœçš„å¤„ç†é€»è¾‘ï¼Œä¼šæ·»åŠ ä¸€ä¸ªç›‘å¬ï¼Œç­‰åˆ°åé¦ˆç»“æœå‡ºæ¥ä¹‹åï¼Œåœ¨å›è°ƒå‡½æ•°ä¸­å¤„ç†å¯¹åº”çš„é€»è¾‘ã€‚</p><h2 id="åŸç”ŸAJAX"><a href="#åŸç”ŸAJAX" class="headerlink" title="åŸç”ŸAJAX"></a>åŸç”ŸAJAX</h2><ul><li>åˆ›å»º xhr ( XML Http Requst )</li><li>å»ºç«‹è¿æ¥ï¼Œxhr.open()</li><li>å‘é€è¯·æ±‚ï¼Œxhr.send()</li><li>è¿›è¡Œç›‘å¬ï¼Œxhr.onReadyStateChange()</li></ul><p>å€˜è‹¥æˆ‘ä»¬åœ¨ï¼Œéœ€è¦åœ¨ç›‘å¬ä¸­ï¼Œæ‹¿åˆ°æ•°æ®ï¼Œæ¥ç€ä½œä¸ºå‚æ•°ç»§ç»­å»è¯·æ±‚ï¼Œé‚£ä¹ˆå°±å¼€å§‹å‡ºç°ï¼Œå›è°ƒçš„åµŒå¥—ï¼Œå¦‚è‹¥å›è°ƒæ„ˆåŠ æ„ˆå¤šï¼Œå°±ä¼šå½¢æˆå¯æ€•çš„å›è°ƒåœ°ç‹±ã€‚</p><p>promise ä»¥åŠå…¶ then çš„å‡ºç°å°±æ˜¯æ¥åº¦åŒ–æ­¤åŠ«çš„ã€‚</p><h2 id="æ ¸å¿ƒ"><a href="#æ ¸å¿ƒ" class="headerlink" title="æ ¸å¿ƒ"></a>æ ¸å¿ƒ</h2><p>resolveã€rejectè¿›è¡ŒçŠ¶æ€æ›´æ–°pedding â€“ resolved &#x2F; reject</p><p>resolveã€rejectÂ æ˜¯Â executorÂ å‡½æ•°ï¼ˆæ‰§è¡Œå™¨ï¼‰çš„ä¸¤ä¸ªå‚æ•°ã€‚ä»–ä»¬èƒ½å¤Ÿå°†è¯·æ±‚ç»“æœçš„å…·ä½“æ•°æ®ä¼ é€’å‡ºå»ã€‚</p><ul><li>then</li></ul><p>Promiseå®ä¾‹æ‹¥æœ‰çš„Â thenÂ æ–¹æ³•ï¼Œç”¨æ¥å¤„ç†å½“è¯·æ±‚ç»“æœçš„çŠ¶æ€å˜æˆÂ resolvedÂ æ—¶çš„é€»è¾‘ã€‚</p><p>thenÂ çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¹Ÿä¸ºä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„å‚æ•°åˆ™æ˜¯Â resolveÂ ä¼ é€’å‡ºæ¥çš„æ•°æ®ã€‚</p><p>then çš„å›è°ƒå‡½æ•°çš„è¿”å›å€¼ä¹Ÿä¼šä½œä¸ºå‚æ•°ï¼Œå‘ä¸‹ä¼ é€’ã€‚</p><ul><li>catch</li></ul><p>catchÂ æ–¹æ³•ï¼Œç”¨æ¥å¤„ç†å½“è¯·æ±‚ç»“æœçš„çŠ¶æ€å˜æˆÂ rejectedÂ æ—¶çš„é€»è¾‘ã€‚</p><p>catchÂ çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¹Ÿä¸ºä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„å‚æ•°åˆ™æ˜¯Â rejectÂ ä¼ é€’å‡ºæ¥çš„æ•°æ®ã€‚</p><ul><li>promise.all</li></ul><p>è¿›è¡Œæ‰¹å¤„ç†å¼‚æ­¥è¯·æ±‚ï¼Œå¯ä»¥æ¥å—ä¸€ä¸ª promise æ•°ç»„ã€‚</p><p>å½“æ‰€æœ‰çš„ promise å…¨éƒ¨ä¸º resolved &#x2F; rejected æ‰è¿”å› resolved &#x2F; rejectedã€‚</p><ul><li>promise.race</li></ul><p>è¿›è¡Œæ‰¹å¤„ç†å¼‚æ­¥è¯·æ±‚ï¼Œå¯ä»¥æ¥å—ä¸€ä¸ª promise æ•°ç»„ã€‚</p><p>å½“æœ‰ä¸€ä¸ªçš„ promise ä¸º resolved &#x2F; rejected å°±è¿”å› resolved &#x2F; rejectedã€‚</p><h2 id="thençš„æ‰§è¡Œæœºåˆ¶"><a href="#thençš„æ‰§è¡Œæœºåˆ¶" class="headerlink" title="thençš„æ‰§è¡Œæœºåˆ¶"></a>thençš„æ‰§è¡Œæœºåˆ¶</h2><p>then å¿…é¡»åœ¨ promise çš„çŠ¶æ€ç¡®å®šåæ‰èƒ½è¢«æ‰§è¡Œï¼Œå¹¶å°†å…¶å›è°ƒå‡½æ•°ï¼Œæ”¾å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œç­‰å¾…æ‰§è¡Œã€‚</p><p>æ³¨æ„ï¼šå½“ then è¿”å› promise æ—¶ï¼Œä¼šäº§ç”Ÿä¸¤ä¸ªå¾®ä»»åŠ¡ã€‚ä¸€æ¬¡æ˜¯å› ä¸ºè¿”å›çš„ promise ä½œä¸ºå‚æ•°ï¼Œéœ€è¦ç›´æ¥è°ƒç”¨ then å¾—åˆ°å…¶ promise çŠ¶æ€ï¼Œå¦ä¸€ä¸ªæ˜¯å…¶å†…éƒ¨è‡ªå·±äº§ç”Ÿçš„ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> p1 = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>()</span><br><span class="line"> .<span class="title function_">then</span>(<span class="keyword">function</span> <span class="title function_">f1</span>(<span class="params">v</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>) &#125;)</span><br><span class="line"> .<span class="title function_">then</span>(<span class="keyword">function</span> <span class="title function_">f2</span>(<span class="params">v</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>) &#125;)</span><br><span class="line"> .<span class="title function_">then</span>(<span class="keyword">function</span> <span class="title function_">f3</span>(<span class="params">v</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>) &#125;)</span><br><span class="line"></span><br><span class="line">p1.<span class="title function_">then</span>(<span class="keyword">function</span> <span class="title function_">f4</span>(<span class="params">v</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">4</span>) &#125;)</span><br><span class="line">p1.<span class="title function_">then</span>(<span class="keyword">function</span> <span class="title function_">f5</span>(<span class="params">v</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span>) &#125;)</span><br><span class="line"><span class="keyword">let</span> p2 = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>()</span><br><span class="line"> .<span class="title function_">then</span>(<span class="keyword">function</span> <span class="title function_">f11</span>(<span class="params">v</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">11</span>) &#125;)</span><br><span class="line"> .<span class="title function_">then</span>(<span class="keyword">function</span> <span class="title function_">f22</span>(<span class="params">v</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">22</span>) &#125;)</span><br><span class="line"> .<span class="title function_">then</span>(<span class="keyword">function</span> <span class="title function_">f33</span>(<span class="params">v</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">33</span>) &#125;)</span><br><span class="line"></span><br><span class="line">p2.<span class="title function_">then</span>(<span class="keyword">function</span> <span class="title function_">f44</span>(<span class="params">v</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">44</span>) &#125;)</span><br><span class="line">p2.<span class="title function_">then</span>(<span class="keyword">function</span> <span class="title function_">f55</span>(<span class="params">v</span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">55</span>) &#125;)</span><br><span class="line"><span class="comment">// 1 11 2 22 3 33 4 5 44 55</span></span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ol><li>Promiseçš„çŠ¶æ€ä¸€ç»æ”¹å˜å°±ä¸èƒ½å†æ”¹å˜ã€‚</li><li>.thenå’Œ.catchéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„Promiseã€‚</li><li>catchä¸ç®¡è¢«è¿æ¥åˆ°å“ªé‡Œï¼Œéƒ½èƒ½æ•è·ä¸Šå±‚æœªæ•æ‰è¿‡çš„é”™è¯¯ã€‚</li><li>åœ¨Promiseä¸­ï¼Œè¿”å›ä»»æ„ä¸€ä¸ªé promise çš„å€¼éƒ½ä¼šè¢«åŒ…è£¹æˆ promise å¯¹è±¡ï¼Œä¾‹å¦‚return 2ä¼šè¢«åŒ…è£…ä¸ºreturn Promise.resolve(2)ã€‚</li><li>Promise çš„ .then æˆ–è€… .catch å¯ä»¥è¢«è°ƒç”¨å¤šæ¬¡, ä½†å¦‚æœPromiseå†…éƒ¨çš„çŠ¶æ€ä¸€ç»æ”¹å˜ï¼Œå¹¶ä¸”æœ‰äº†ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆåç»­æ¯æ¬¡è°ƒç”¨.thenæˆ–è€….catchçš„æ—¶å€™éƒ½ä¼šç›´æ¥æ‹¿åˆ°è¯¥å€¼ã€‚</li><li>.then æˆ–è€… .catch ä¸­ return ä¸€ä¸ª error å¯¹è±¡å¹¶ä¸ä¼šæŠ›å‡ºé”™è¯¯ï¼Œæ‰€ä»¥ä¸ä¼šè¢«åç»­çš„ .catch æ•è·ã€‚</li><li>.then æˆ– .catch è¿”å›çš„å€¼ä¸èƒ½æ˜¯ promise æœ¬èº«ï¼Œå¦åˆ™ä¼šé€ æˆæ­»å¾ªç¯ã€‚</li><li>.then æˆ–è€… .catch çš„å‚æ•°æœŸæœ›æ˜¯å‡½æ•°ï¼Œä¼ å…¥éå‡½æ•°åˆ™ä¼šå‘ç”Ÿå€¼é€ä¼ ã€‚</li><li>.thenæ–¹æ³•æ˜¯èƒ½æ¥æ”¶ä¸¤ä¸ªå‚æ•°çš„ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¤„ç†æˆåŠŸçš„å‡½æ•°ï¼Œç¬¬äºŒä¸ªæ˜¯å¤„ç†å¤±è´¥çš„å‡½æ•°ï¼Œå†æŸäº›æ—¶å€™ä½ å¯ä»¥è®¤ä¸ºcatchæ˜¯.thenç¬¬äºŒä¸ªå‚æ•°çš„ç®€ä¾¿å†™æ³•ã€‚</li><li>.then æ–¹æ³•å›è°ƒå‡½æ•°ï¼Œè¿”å› promiseï¼Œä¼šé¢å¤–äº§ç”Ÿä¸¤æ¬¡å¾®ä»»åŠ¡ã€‚</li><li>.finallyæ–¹æ³•ä¹Ÿæ˜¯è¿”å›ä¸€ä¸ªPromiseï¼Œä»–åœ¨Promiseç»“æŸçš„æ—¶å€™ï¼Œæ— è®ºç»“æœä¸ºresolvedè¿˜æ˜¯rejectedï¼Œéƒ½ä¼šæ‰§è¡Œé‡Œé¢çš„å›è°ƒå‡½æ•°ã€‚</li><li>async å‡½æ•°ä¸€å®šä¼šè¿”å›ä¸€ä¸ª promise å¯¹è±¡ã€‚å¦‚æœä¸€ä¸ª async å‡½æ•°çš„è¿”å›å€¼çœ‹èµ·æ¥ä¸æ˜¯ promiseï¼Œé‚£ä¹ˆå®ƒå°†ä¼šè¢«éšå¼åœ°åŒ…è£…åœ¨ä¸€ä¸ª promise ä¸­ã€‚</li><li>åœ¨ async å‡½æ•°ä¸­æŠ›å‡ºäº†é”™è¯¯ï¼Œåˆ™ç»ˆæ­¢é”™è¯¯ç»“æœï¼Œä¸ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡ try catch æˆ–è€… .catch ä½¿å¾—é”™è¯¯çš„åœ°æ–¹ä¸å½±å“ã€‚</li><li>await åé¢çš„è¯­å¥ç›¸å½“äºæ”¾åˆ°äº† new Promise ä¸­ï¼Œä¸‹ä¸€è¡Œä¹‹åçš„ä»£ç éƒ½æ”¾åˆ° Promise.then ä¸­ï¼Œéœ€è¦ç­‰å¾… await åé¢ promise çš„å¤„ç†ã€‚</li></ol><h2 id="è¿ç”¨"><a href="#è¿ç”¨" class="headerlink" title="è¿ç”¨"></a>è¿ç”¨</h2><ul><li><p>æ‰‹å†™ promise</p><ul><li><p>executor</p><ul><li>ç»‘å®š resolve reject ä¸­çš„ this</li></ul></li><li><p>resolve çŠ¶æ€æ›´å˜</p></li><li><p>reject çŠ¶æ€æ›´å˜</p></li><li><p>then</p><ul><li><p>åˆ¤æ–­ä¼ å…¥å‚æ•°æ˜¯ä¸æ˜¯å‡½æ•°</p></li><li><p>è¿”å›æ–°çš„ promise</p><ul><li><p>åˆ›å»ºæˆåŠŸã€å¤±è´¥çš„å›è°ƒï¼Œå…¶ä¸­æ‰§è¡Œä¼ å…¥çš„å‡½æ•°ï¼ŒåŠ å…¥å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­</p></li><li><p>æ ¹æ® å‚æ•°å‡½æ•°æ‰§è¡Œçš„è¿”å›å€¼ï¼Œè¿›è¡Œæœ€åçš„ resolve</p><ul><li><p>è¿”å›å€¼æ˜¯ promise ç›´æ¥è°ƒç”¨ thenï¼Œå¾—åˆ° promise çš„ç»“æœï¼Œç»§ç»­å‘ä¸‹ä¼ é€’</p></li><li><p>è¿”å›å€¼ä¸æ˜¯ promiseï¼Œç›´æ¥ resolve</p></li></ul></li><li><p>åˆ¤æ–­å½“å‰çŠ¶æ€ï¼Œæ•´åˆ map è¿›è¡Œå¯¹</p></li></ul></li></ul></li><li><p>catch</p></li></ul></li><li><p>promise å®ç°å¾ªç¯å¼‚æ­¥äº‹ä»¶</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">index, timeout</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(index);</span><br><span class="line">      <span class="title function_">resolve</span>();</span><br><span class="line">    &#125;, timeout);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">light</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">fn</span>(<span class="number">1</span>, <span class="number">1000</span>);</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">fn</span>(<span class="number">2</span>, <span class="number">2000</span>);</span><br><span class="line">  <span class="keyword">await</span> <span class="title function_">fn</span>(<span class="number">3</span>, <span class="number">3000</span>);</span><br><span class="line">  <span class="title function_">light</span>();</span><br><span class="line">  <span class="comment">// const promise = Promise.resolve();</span></span><br><span class="line">  <span class="comment">// promise</span></span><br><span class="line">  <span class="comment">//   .then(() =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//     return fn(1, 1000);</span></span><br><span class="line">  <span class="comment">//   &#125;)</span></span><br><span class="line">  <span class="comment">//   .then(() =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//     return fn(2, 2000);</span></span><br><span class="line">  <span class="comment">//   &#125;)</span></span><br><span class="line">  <span class="comment">//   .then(() =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//     return fn(3, 3000);</span></span><br><span class="line">  <span class="comment">//   &#125;)</span></span><br><span class="line">  <span class="comment">//   .then(() =&gt; &#123;</span></span><br><span class="line">  <span class="comment">//     return light();</span></span><br><span class="line">  <span class="comment">//   &#125;);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">light</span>();</span><br></pre></td></tr></table></figure><ul><li>promise.all ç»“æœæ”¶é›†ä¸è€ƒè™‘å…¶æ˜¯å¦æˆåŠŸæˆ–å¤±è´¥</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">mergePromise</span>(<span class="params">promiseArr</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> data = [];</span><br><span class="line">  <span class="keyword">let</span> promise = <span class="title class_">Promise</span>.<span class="title function_">resolve</span>();</span><br><span class="line">  promiseArr.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    promise = promise.<span class="title function_">then</span>(item).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      data.<span class="title function_">push</span>(res);</span><br><span class="line">      <span class="keyword">return</span> data;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="äº‹ä»¶å¾ªç¯æœºåˆ¶"><a href="#äº‹ä»¶å¾ªç¯æœºåˆ¶" class="headerlink" title="äº‹ä»¶å¾ªç¯æœºåˆ¶"></a>äº‹ä»¶å¾ªç¯æœºåˆ¶</h2><ul><li><p>å‡½æ•°è°ƒç”¨æ ˆ</p></li><li><p>ä»»åŠ¡é˜Ÿåˆ—</p></li><li><p>å®ä»»åŠ¡é˜Ÿåˆ—</p><ul><li><p>script</p></li><li><p>setTimeout</p></li><li><p>setInteval</p></li><li><p>IO</p></li><li><p>render</p></li></ul></li><li><p>å¾®ä»»åŠ¡é˜Ÿåˆ—</p><ul><li><p>Promise.then</p></li><li><p>process.nextTick</p></li></ul></li></ul><h3 id="å¾ªç¯æœºåˆ¶"><a href="#å¾ªç¯æœºåˆ¶" class="headerlink" title="å¾ªç¯æœºåˆ¶"></a>å¾ªç¯æœºåˆ¶</h3><p>å®ä»»åŠ¡ x 1 â¡ï¸ å‡½æ•°è°ƒç”¨æ ˆ â¡ï¸ å¾®ä»»åŠ¡ x n â¡ï¸ å®ä»»åŠ¡ x 1 â¡ï¸Â·Â·Â·Â·</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ä»»åŠ¡ä¸€ä¸ªä¸€ä¸ªçš„å‡ºé˜Ÿåˆ—ï¼Œè¿›å…¥å‡½æ•°è°ƒç”¨æ ˆæ‰§è¡Œï¼Œç„¶ååœ¨æ‰§è¡ŒæœŸé—´äº§ç”Ÿçš„å¾®ä»»åŠ¡ï¼Œä¼šåœ¨æ­¤æ¬¡å‡½æ•°è°ƒç”¨æ ˆæ‰§è¡Œå®Œæ¯•åï¼Œå»æ¸…ç©ºå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œä»¥æ­¤å¾€å¤ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://cloud.tencent.com/developer/article/1623173">è¯¦è§£ES6ä¸­çš„async&#x2F;await - è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘</a></p><p><a href="https://juejin.cn/post/6844904077537574919">ã€å»ºè®®æ˜Ÿæ˜Ÿã€‘è¦å°±æ¥45é“Promiseé¢è¯•é¢˜ä¸€æ¬¡çˆ½åˆ°åº•(1.1wå­—ç”¨å¿ƒæ•´ç†) - æ˜é‡‘</a></p>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>call-apply-bind</title>
      <link href="/2021/10/26/JS/call-apply-bind/"/>
      <url>/2021/10/26/JS/call-apply-bind/</url>
      
        <content type="html"><![CDATA[<h3 id="call-apply-bind"><a href="#call-apply-bind" class="headerlink" title="call-apply-bind"></a>call-apply-bind</h3><h4 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h4><ul><li><p>éƒ½æ˜¯è¿›è¡Œ this ç»‘å®šçš„ã€‚</p></li><li><p>call å‚æ•°ä¸€ä¸ªä¸ªä¼ é€’ã€‚</p></li><li><p>apply å‚æ•°é€šè¿‡æ•°ç»„ä¼ é€’ã€‚</p></li><li><p>bind è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå¹¶ä¸ç«‹å³æ‰§è¡Œå‡½æ•°ã€‚</p></li></ul><h4 id="æ‰‹å†™"><a href="#æ‰‹å†™" class="headerlink" title="æ‰‹å†™"></a>æ‰‹å†™</h4><h5 id="call"><a href="#call" class="headerlink" title="call"></a>call</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * call</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">context</span></span></span><br><span class="line"><span class="comment"> * ä¸»è¦æ€è·¯å°±æ˜¯åœ¨ä¼ è¿›æ¥çš„thisä¸»ä½“ä¸­å¢åŠ  fn</span></span><br><span class="line"><span class="comment"> * åœ¨é€šè¿‡ this.fn() æ‰§è¡Œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">call</span> = <span class="keyword">function</span> (<span class="params">context</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">this</span> !== <span class="string">&quot;function&quot;</span>) <span class="keyword">return</span>;</span><br><span class="line">  that = context || <span class="variable language_">window</span>;</span><br><span class="line">  that.<span class="property">fn</span> = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="keyword">let</span> res;</span><br><span class="line">  res = that.<span class="title function_">fn</span>(...[...<span class="variable language_">arguments</span>].<span class="title function_">slice</span>(<span class="number">1</span>));</span><br><span class="line">  <span class="keyword">delete</span> that.<span class="property">fn</span>;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h5 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * apply</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">context</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">apply</span> = <span class="keyword">function</span> (<span class="params">context</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">this</span> !== <span class="string">&quot;function&quot;</span>) <span class="keyword">return</span>;</span><br><span class="line">  that = context || <span class="variable language_">window</span>;</span><br><span class="line">  that.<span class="property">fn</span> = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="keyword">let</span> res;</span><br><span class="line">  res = that.<span class="title function_">fn</span>(...<span class="variable language_">arguments</span>[<span class="number">1</span>]);</span><br><span class="line">  <span class="keyword">delete</span> that.<span class="property">fn</span>;</span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h5 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * bind</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object</span>&#125; <span class="variable">context</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> <span class="variable">Function</span></span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿”å›çš„å‡½æ•°ä¹Ÿå¯èƒ½è¢«ä½œä¸º æ„é€ å‡½æ•°æ‰§è¡Œï¼Œæ­¤æ—¶ç»‘å®šthiså°±æ²¡æœ‰ä½œç”¨äº†ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">bind</span> = <span class="keyword">function</span> (<span class="params">context</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> fn = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="keyword">const</span> newFun = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span> <span class="keyword">instanceof</span> newFun) fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, [...<span class="variable language_">arguments</span>]);</span><br><span class="line">    <span class="keyword">else</span> fn.<span class="title function_">apply</span>(context, [...<span class="variable language_">arguments</span>]);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> newFun;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">let</span> a = &#123;</span><br><span class="line">  <span class="attr">n</span>: <span class="number">1</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Es6</title>
      <link href="/2021/10/25/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%8D%81%E4%BA%94%EF%BC%89ES6%E5%9F%BA%E7%A1%80/"/>
      <url>/2021/10/25/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%8D%81%E4%BA%94%EF%BC%89ES6%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h1 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h1><p><a href="http://babeljs.io/repl/">babel åœ¨çº¿ç¼–è¯‘å·¥å…·</a></p><h3 id="let-x2F-const"><a href="#let-x2F-const" class="headerlink" title="let&#x2F;const"></a>let&#x2F;const</h3><ul><li>å—çº§ä½œç”¨åŸŸ</li><li>ä¸å…·å¤‡å˜é‡æå‡<ul><li>å¯ä»¥è¯´æˆæ˜¯å£°æ˜å¼æå‡ï¼Œèµ‹å€¼å¹¶æ²¡æœ‰æå‡ï¼Œå› æ­¤å­˜åœ¨æš‚æ—¶æ€§æ­»åŒº</li><li>å› ä¸ºèµ‹å€¼çš„æå‡å¹¶æ²¡æœ‰å®Œæˆï¼Œæ‰€ä»¥å³ä½¿å£°æ˜æå‡äº†ä¹Ÿä¸èƒ½å¤Ÿå»ä½¿ç”¨</li></ul></li><li>const å˜é‡å®šä¹‰çš„å¼•ç”¨ç±»å‹ï¼Œå¦‚å¯¹è±¡ï¼Œå¯¹è±¡çš„å¼•ç”¨ä¸å¯ä¿®æ”¹ï¼Œä½†å¯¹è±¡ä¸­çš„å±æ€§å¯ä»¥ä¿®æ”¹</li></ul><h3 id="ç®­å¤´å‡½æ•°"><a href="#ç®­å¤´å‡½æ•°" class="headerlink" title="ç®­å¤´å‡½æ•°"></a>ç®­å¤´å‡½æ•°</h3><p><code>() =&gt; &#123;&#125;</code></p><blockquote><p>ç®­å¤´å‡½æ•°å¯ä»¥æ›¿æ¢å‡½æ•°è¡¨è¾¾å¼ï¼Œä½†æ˜¯ä¸èƒ½æ›¿æ¢å‡½æ•°å£°æ˜</p></blockquote><p><strong>ç®­å¤´å‡½æ•°æ²¡æœ‰ thisï¼Œ</strong>ï¼Œå¦‚æœä½ åœ¨ç®­å¤´å‡½æ•°ä¸­ä½¿ç”¨ thisï¼Œé‚£ä¹ˆ this ä¸€å®šæ˜¯å¤–å±‚çš„ this</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;tom&quot;</span>,</span><br><span class="line">  <span class="attr">getName</span>: <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="property">name</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">person.<span class="title function_">getName</span>(); <span class="comment">// Cannot read properties of undefined (reading &#x27;name&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;tom&quot;</span>,</span><br><span class="line">  <span class="attr">getName</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line">person.<span class="title function_">getName</span>()(); <span class="comment">// tom</span></span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ ES6 ä¸­ï¼Œä¼šé»˜è®¤é‡‡ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œå› æ­¤ this ä¹Ÿä¸ä¼šè‡ªåŠ¨æŒ‡å‘ window å¯¹è±¡äº†ï¼Œè€Œç®­å¤´å‡½æ•°æœ¬èº«å¹¶æ²¡æœ‰ thisï¼Œå› æ­¤ this å°±åªèƒ½æ˜¯ undefinedï¼Œè¿™ä¸€ç‚¹ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œä¸€å®šè¦æ…é‡æ…é‡å†æ…é‡ï¼Œä¸ç„¶è¸©äº†å‘ä½ éƒ½ä¸çŸ¥é“è‡ªå·±é”™åœ¨å“ªï¼è¿™ç§æƒ…å†µï¼Œå¦‚æœä½ è¿˜æƒ³ç”¨ thisï¼Œå°±ä¸è¦ç”¨ä½¿ç”¨ç®­å¤´å‡½æ•°çš„å†™æ³•ã€‚</p></blockquote><p><strong>ç®­å¤´å‡½æ•°ä¸­æ— æ³•è®¿é—®<code>arguments</code></strong></p><h3 id="æ¨¡æ¿å­—ç¬¦ä¸²"><a href="#æ¨¡æ¿å­—ç¬¦ä¸²" class="headerlink" title="æ¨¡æ¿å­—ç¬¦ä¸²"></a>æ¨¡æ¿å­—ç¬¦ä¸²</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// es6</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">const</span> b = <span class="number">30</span>;</span><br><span class="line"><span class="keyword">const</span> string = <span class="string">`<span class="subst">$&#123;a&#125;</span>+<span class="subst">$&#123;b&#125;</span>=<span class="subst">$&#123;a + b&#125;</span>`</span>;</span><br></pre></td></tr></table></figure><h3 id="è§£æç»“æ„"><a href="#è§£æç»“æ„" class="headerlink" title="è§£æç»“æ„"></a>è§£æç»“æ„</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é¦–å…ˆæœ‰è¿™ä¹ˆä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> props = &#123;</span><br><span class="line">  <span class="attr">className</span>: <span class="string">&quot;tiger-button&quot;</span>,</span><br><span class="line">  <span class="attr">loading</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">clicked</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">disabled</span>: <span class="string">&quot;disabled&quot;</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// es5</span></span><br><span class="line"><span class="keyword">var</span> loading = props.<span class="property">loading</span>;</span><br><span class="line"><span class="keyword">var</span> clicked = props.<span class="property">clicked</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// es6</span></span><br><span class="line"><span class="keyword">const</span> &#123; loading, clicked &#125; = props;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™ä¸€ä¸ªé»˜è®¤å€¼ï¼Œå½“propså¯¹è±¡ä¸­æ‰¾ä¸åˆ°loadingæ—¶ï¼Œloadingå°±ç­‰äºè¯¥é»˜è®¤å€¼</span></span><br><span class="line"><span class="keyword">const</span> &#123; loading = <span class="literal">false</span>, clicked &#125; = props;</span><br></pre></td></tr></table></figure><p>æ•°ç»„çš„è§£æ„èµ‹å€¼</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// es6</span></span><br><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">const</span> [a, b, c] = arr;</span><br></pre></td></tr></table></figure><p>æ•°ç»„ä»¥åºåˆ—å·ä¸€ä¸€å¯¹åº”ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰åºçš„å¯¹åº”å…³ç³»<br>è€Œå¯¹è±¡æ ¹æ®å±æ€§åä¸€ä¸€å¯¹åº”ï¼Œè¿™æ˜¯ä¸€ä¸ªæ— åºçš„å¯¹åº”å…³ç³»<br>æ ¹æ®è¿™ä¸ªç‰¹æ€§ï¼Œä½¿ç”¨è§£æç»“æ„ä»å¯¹è±¡ä¸­è·å–å±æ€§å€¼æ›´åŠ å…·æœ‰å¯ç”¨æ€§</p><h3 id="å‡½æ•°é»˜è®¤å‚æ•°"><a href="#å‡½æ•°é»˜è®¤å‚æ•°" class="headerlink" title="å‡½æ•°é»˜è®¤å‚æ•°"></a>å‡½æ•°é»˜è®¤å‚æ•°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">x = <span class="number">20</span>, y = <span class="number">30</span></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>());</span><br></pre></td></tr></table></figure><h3 id="å±•å¼€è¿ç®—ç¬¦"><a href="#å±•å¼€è¿ç®—ç¬¦" class="headerlink" title="å±•å¼€è¿ç®—ç¬¦"></a>å±•å¼€è¿ç®—ç¬¦</h3><p>åœ¨ ES6 ä¸­ç”¨<code>...</code>æ¥è¡¨ç¤ºå±•å¼€è¿ç®—ç¬¦ï¼Œå®ƒå¯ä»¥å°†æ•°ç»„æ–¹æ³•æˆ–è€…å¯¹è±¡è¿›è¡Œå±•å¼€</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">const</span> arr2 = [...arr1, <span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>]; <span class="comment">// [1, 2, 3, 10, 20, 30];</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj1 = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">b</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">c</span>: <span class="number">3</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj2 = &#123;</span><br><span class="line">  ...obj1,</span><br><span class="line">  <span class="attr">d</span>: <span class="number">4</span>,</span><br><span class="line">  <span class="attr">e</span>: <span class="number">5</span>,</span><br><span class="line">  <span class="attr">f</span>: <span class="number">6</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// &#123; a: 1, b: 2, c: 3, d: 4, e: 5, f: 6 &#125;</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨å±•å¼€è¿ç®—ç¬¦æ¥å¤„ç†å‰©ä½™çš„æ•°æ®</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™ç§æ–¹å¼åœ¨reactä¸­ååˆ†å¸¸ç”¨</span></span><br><span class="line"><span class="keyword">const</span> props = &#123;</span><br><span class="line">  <span class="attr">size</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">src</span>: <span class="string">&#x27;xxxx&#x27;</span>,</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;si&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; size, ...others &#125; = props;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(others) <span class="comment">// &#123; src: &#x27;xxxx&#x27;, mode: &#x27;si&#x27; &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç„¶åå†åˆ©ç”¨æš‚å¼€è¿ç®—ç¬¦ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå†ä»¥åå°è£…reactç»„ä»¶æ—¶ä¼šå¤§é‡ä½¿ç”¨åˆ°è¿™ç§æ–¹å¼ï¼Œæ­£åœ¨å­¦ä¹ reactçš„åŒå­¦ä¸€å®šè¦ææ‡‚è¿™ç§ä½¿ç”¨æ–¹å¼</span></span><br><span class="line">&lt;button &#123;...others&#125; size=&#123;size&#125; /&gt;</span><br></pre></td></tr></table></figure><p>å¤„ç†å‡½æ•°ä¸å®šå‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‰€æœ‰å‚æ•°ä¹‹å’Œ</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">add</span> = (<span class="params">a, b, ...more</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> more.<span class="title function_">reduce</span>(<span class="function">(<span class="params">m, n</span>) =&gt;</span> m + n, a + b);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">add</span>(<span class="number">1</span>, <span class="number">23</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)); <span class="comment">// 39</span></span><br></pre></td></tr></table></figure><h3 id="å¯¹è±¡å­—é¢é‡å’Œ-class"><a href="#å¯¹è±¡å­—é¢é‡å’Œ-class" class="headerlink" title="å¯¹è±¡å­—é¢é‡å’Œ class"></a>å¯¹è±¡å­—é¢é‡å’Œ class</h3><h4 id="å¯¹è±¡å­—é¢é‡"><a href="#å¯¹è±¡å­—é¢é‡" class="headerlink" title="å¯¹è±¡å­—é¢é‡"></a>å¯¹è±¡å­—é¢é‡</h4><ul><li><p>å±æ€§å€¼åŒåçœç•¥</p></li><li><p>å¯¹è±¡ä¸­çš„å±æ€§å¯ä»¥é‡‡ç”¨<code>[params]</code>ï¼Œå®ç°<strong>å˜é‡</strong>å±æ€§å</p><ul><li><p>åœ¨ ant-design çš„æºç å®ç°ä¸­ï¼Œå°±å¤§é‡ä½¿ç”¨äº†è¿™ç§æ–¹å¼æ¥æ‹¼æ¥å½“å‰å…ƒç´ çš„ classNameï¼Œä¾‹å¦‚:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> alertCls = <span class="title function_">classNames</span>(</span><br><span class="line">  prefixCls,</span><br><span class="line">  &#123;</span><br><span class="line">    [<span class="string">`<span class="subst">$&#123;prefixCls&#125;</span>-<span class="subst">$&#123;type&#125;</span>`</span>]: <span class="literal">true</span>,</span><br><span class="line">    [<span class="string">`<span class="subst">$&#123;prefixCls&#125;</span>-close`</span>]: !<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">closing</span>,</span><br><span class="line">    [<span class="string">`<span class="subst">$&#123;prefixCls&#125;</span>-with-description`</span>]: !!description,</span><br><span class="line">    [<span class="string">`<span class="subst">$&#123;prefixCls&#125;</span>-no-icon`</span>]: !showIcon,</span><br><span class="line">    [<span class="string">`<span class="subst">$&#123;prefixCls&#125;</span>-banner`</span>]: !!banner,</span><br><span class="line">  &#125;,</span><br><span class="line">  className</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li></ul></li></ul><h4 id="class"><a href="#class" class="headerlink" title="class"></a>class</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES5</span></span><br><span class="line"><span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŸå‹æ–¹æ³•</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// åŸå‹æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>babel ä¼šå°† ES6 çš„å†™æ³•ç¼–è¯‘æˆä¸ºåˆ©ç”¨<code>object.defineProperty</code>æ–¹å¼å®ç°<br><code>Object.defineProperty()</code> æ–¹æ³•ä¼šç›´æ¥åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šå®šä¹‰ä¸€ä¸ªæ–°å±æ€§ï¼Œæˆ–è€…ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„ç°æœ‰å±æ€§ï¼Œå¹¶è¿”å›æ­¤å¯¹è±¡ã€‚</p></blockquote><p>å®é™…å¼€å‘ä¸­è¿˜æœ‰å‡ ç§å†™æ³•æ–¹å¼ä¸åŒ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// æ–¹æ³•æ·»åŠ åˆ°åŸå‹ä¸­</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> a = <span class="number">20</span>; <span class="comment">// ç›¸å½“äºç±»çš„ç§æœ‰å±æ€§</span></span><br><span class="line"></span><br><span class="line">  c = <span class="number">20</span>; <span class="comment">// å±æ€§æ·»åŠ åˆ°æ„é€ å‡½æ•°ä¸­ï¼Œç›¸å½“äº this.c = 20</span></span><br><span class="line"></span><br><span class="line">  getAge = <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="property">age</span>; <span class="comment">//æ–¹æ³•æ·»åŠ åˆ°æ„é€ å‡½æ•°ï¼Œç­‰åŒthis.getAge = function() &#123;&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®­å¤´å‡½æ•°è¿˜æ˜¯è¦æ³¨æ„<strong>this</strong>æŒ‡å‘é—®é¢˜</p><p><strong>ç»§æ‰¿ extends</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getName</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Studentç±»ç»§æ‰¿Personç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name, age, gender, classes</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(name, age); <span class="comment">// super å¿…é¡»åœ¨thiså‰é¢ä½¿ç”¨ï¼Œå¦åˆ™æŠ¥é”™</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">gender</span> = gender;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">classes</span> = classes;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getGender</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">gender</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p><code>super(name, age) === Person.call(this)</code></p><p>super è¿˜å¯ä»¥ç›´æ¥è°ƒç”¨çˆ¶çº§çš„åŸå‹æ–¹æ³•ï¼Œ<code>super.getName()</code></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Promise</title>
      <link href="/2021/10/24/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%8D%81%E5%9B%9B%EF%BC%89Promise/"/>
      <url>/2021/10/24/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%8D%81%E5%9B%9B%EF%BC%89Promise/</url>
      
        <content type="html"><![CDATA[<h1 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç®€å•çš„ajaxåŸç”Ÿå®ç°</span></span><br><span class="line"><span class="keyword">var</span> url = <span class="string">&quot;https://hq.tigerbrokers.com/fundamental/finance_calendar/getType/2017-02-26/2017-06-10&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> result;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">XHR</span> = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line"><span class="variable constant_">XHR</span>.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, url, <span class="literal">true</span>);</span><br><span class="line"><span class="variable constant_">XHR</span>.<span class="title function_">send</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable constant_">XHR</span>.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable constant_">XHR</span>.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; <span class="variable constant_">XHR</span>.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">    result = <span class="variable constant_">XHR</span>.<span class="property">response</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨ ajax çš„åŸç”Ÿå®ç°ä¸­ï¼Œåˆ©ç”¨äº† onreadystatechange äº‹ä»¶ï¼Œå½“è¯¥äº‹ä»¶è§¦å‘å¹¶ä¸”ç¬¦åˆä¸€å®šæ¡ä»¶æ—¶ï¼Œæ‰èƒ½æ‹¿åˆ°æƒ³è¦çš„æ•°æ®ï¼Œä¹‹åæ‰èƒ½å¼€å§‹å¤„ç†æ•°æ®</p><p>ä½†æ˜¯æ­¤æ—¶å¦‚æœæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–°çš„ ajax è¯·æ±‚çš„ï¼Œå¹¶ä¸”è¿™ä¸ªæ–°è¯·æ±‚éœ€è¦ï¼Œä¸Šä¸€ä¸ªè¯·æ±‚çš„ç»“æœï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è¿™æ ·ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> url = <span class="string">&#x27;https://hq.tigerbrokers.com/fundamental/finance_calendar/getType/2017-02-26/2017-06-10&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> result;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="variable constant_">XHR</span> = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line"><span class="variable constant_">XHR</span>.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, url, <span class="literal">true</span>);</span><br><span class="line"><span class="variable constant_">XHR</span>.<span class="title function_">send</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable constant_">XHR</span>.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable constant_">XHR</span>.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; <span class="variable constant_">XHR</span>.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">        result = <span class="variable constant_">XHR</span>.<span class="property">response</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¼ªä»£ç </span></span><br><span class="line">        <span class="keyword">var</span> url2 = <span class="string">&#x27;http:xxx.yyy.com/zzz?ddd=&#x27;</span> + result.<span class="property">someParams</span>;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">XHR2</span> = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">        <span class="title class_">XHR2</span>.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, url, <span class="literal">true</span>);</span><br><span class="line">        <span class="title class_">XHR2</span>.<span class="title function_">send</span>();</span><br><span class="line">        <span class="title class_">XHR2</span>.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœç»§ç»­å‘ä¸‹ï¼Œä»£ç å°±å˜æˆä¸€å¨ç‹—å±äº†ï¼Œå¾€å¾€ä¹Ÿè¢«ç§°ä¸º<strong>å›è°ƒåœ°ç‹±</strong></p><p>å±Šæ—¶ï¼ŒPromiseï¼Œç«™å‡ºæ¥è§£å†³è¿™ä¸ªé—®é¢˜äº†</p><p>é™¤äº†è§£å†³ <strong>å›è°ƒåœ°ç‹±</strong> ï¼Œè¿˜æœ‰æ›´ä¸ºæ˜¾è‘—çš„æ•ˆæœï¼Œ<strong>ä¸ºäº†ä»£ç æ›´åŠ å…·æœ‰å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®è¯·æ±‚ä¸æ•°æ®å¤„ç†æ˜ç¡®çš„åŒºåˆ†å¼€æ¥</strong></p><p>å½“ç„¶æ‰§è¡Œé¡ºåºè¿˜å¯ä»¥é€šè¿‡ å‡½æ•°è°ƒç”¨æ ˆã€ä»»åŠ¡é˜Ÿåˆ— æ¥è°ƒæ§</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸€ä¸ªç®€å•çš„å°è£…</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">want</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¿™æ˜¯ä½ æƒ³è¦æ‰§è¡Œçš„ä»£ç &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‡½æ•°è°ƒç”¨æ ˆ</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">want</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¿™é‡Œè¡¨ç¤ºæ‰§è¡Œäº†ä¸€å¤§å †å„ç§ä»£ç &quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å…¶ä»–ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œæœ€åæ‰§è¡Œå›è°ƒå‡½æ•°</span></span><br><span class="line">  want &amp;&amp; <span class="title function_">want</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>(want);</span><br><span class="line"></span><br><span class="line"><span class="comment">//é˜Ÿåˆ—</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">want</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¿™æ˜¯ä½ æƒ³è¦æ‰§è¡Œçš„ä»£ç &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">want</span>) &#123;</span><br><span class="line">  <span class="comment">// å°†æƒ³è¦æ‰§è¡Œçš„ä»£ç æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œæ ¹æ®äº‹ä»¶å¾ªç¯çš„æœºåˆ¶ï¼Œæˆ‘ä»¬å°±ä¸ç”¨éå¾—å°†å®ƒæ”¾åˆ°æœ€åé¢äº†ï¼Œç”±ä½ è‡ªç”±é€‰æ‹©</span></span><br><span class="line">  want &amp;&amp; <span class="built_in">setTimeout</span>(want, <span class="number">0</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¿™é‡Œè¡¨ç¤ºæ‰§è¡Œäº†ä¸€å¤§å †å„ç§ä»£ç &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>(want);</span><br></pre></td></tr></table></figure><p>Promise</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">want</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¿™æ˜¯ä½ æƒ³è¦æ‰§è¡Œçš„ä»£ç &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">want</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;è¿™é‡Œè¡¨ç¤ºæ‰§è¡Œäº†ä¸€å¤§å †å„ç§ä»£ç &quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿”å›Promiseå¯¹è±¡</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> want == <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(want);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">reject</span>(<span class="string">&quot;TypeError: &quot;</span> + want + <span class="string">&quot;ä¸æ˜¯ä¸€ä¸ªå‡½æ•°&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>(want).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params">want</span>) &#123;</span><br><span class="line">  <span class="title function_">want</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// é”™è¯¯å¤„ç†</span></span><br><span class="line"><span class="title function_">fn</span>(<span class="string">&quot;1234&quot;</span>).<span class="title function_">catch</span>(<span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="Promise-çš„ä¸‰ç§çŠ¶æ€"><a href="#Promise-çš„ä¸‰ç§çŠ¶æ€" class="headerlink" title="Promise çš„ä¸‰ç§çŠ¶æ€"></a>Promise çš„ä¸‰ç§çŠ¶æ€</h4><ul><li>pendingï¼šç­‰å¾…ï¼Œæˆ–è€…æ­£åœ¨è¿›è¡Œï¼Œæœªå¾—åˆ°ç»“æœ</li><li>resolvedï¼ˆFulfilledï¼‰ï¼šå·²ç»å®Œæˆï¼Œå¹¶å¾—åˆ°é¢„æœŸç»“æœï¼Œå¯ç»§ç»­æ‰§è¡Œ</li><li>rejectedï¼šå¾—åˆ°éé¢„æœŸç»“æœï¼Œæ‹’ç»æ‰§è¡Œ</li></ul><p>Promise çŠ¶æ€ä¸å—å¤–ç•Œç¯å¢ƒå½±å“ï¼Œåªèƒ½ä» peding -&gt; resolved &#x2F; rejectedï¼Œä¸”ä¸å¯é€†</p><p>ä¸€ã€åœ¨ Promise å¯¹è±¡çš„æ„é€ å‡½æ•°ä¸­ï¼Œå°†ä¸€ä¸ªå‡½æ•°ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚è€Œè¿™ä¸ªå‡½æ•°ï¼Œå°±æ˜¯ç”¨æ¥å¤„ç† Promise çš„çŠ¶æ€å˜åŒ–ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="title function_">resolve</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="title function_">reject</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>äºŒã€<code>Promise.then(resolve, reject)</code>ï¼Œæ¥å—æ„é€ å‡½æ•°ä¸­ï¼Œå¤„ç†çš„çŠ¶æ€ï¼Œåˆ†åˆ«å¯¹åº”æ‰§è¡Œ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">num</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> num == <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">      <span class="title function_">resolve</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">reject</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;).<span class="title function_">then</span>(</span><br><span class="line">    <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°æ˜¯ä¸€ä¸ªnumberå€¼&quot;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°ä¸æ˜¯ä¸€ä¸ªnumberå€¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>(<span class="string">&quot;hahha&quot;</span>);</span><br><span class="line"><span class="title function_">fn</span>(<span class="number">1234</span>);</span><br></pre></td></tr></table></figure><p>then æ–¹æ³•çš„æ‰§è¡Œç»“æœä¹Ÿä¼šè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥è¿›è¡Œ then çš„é“¾å¼æ‰§è¡Œï¼Œè¿™ä¹Ÿæ˜¯è§£å†³<strong>å›è°ƒåœ°ç‹±</strong>çš„ä¸»è¦æ–¹å¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">num</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve, reject</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> num == <span class="string">&quot;number&quot;</span>) &#123;</span><br><span class="line">      <span class="title function_">resolve</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="title function_">reject</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°æ˜¯ä¸€ä¸ªnumberå€¼&quot;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="literal">null</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å‚æ•°ä¸æ˜¯ä¸€ä¸ªnumberå€¼&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>(<span class="string">&quot;hahha&quot;</span>);</span><br><span class="line"><span class="title function_">fn</span>(<span class="number">1234</span>);</span><br></pre></td></tr></table></figure><blockquote><p>then(null, function() {}) å°±ç­‰åŒäº catch(function() {})</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>äº‹ä»¶å¾ªç¯æœºåˆ¶</title>
      <link href="/2021/10/23/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%8D%81%E4%B8%89%EF%BC%89%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%E6%9C%BA%E5%88%B6/"/>
      <url>/2021/10/23/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%8D%81%E4%B8%89%EF%BC%89%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%E6%9C%BA%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="äº‹ä»¶å¾ªç¯æœºåˆ¶"><a href="#äº‹ä»¶å¾ªç¯æœºåˆ¶" class="headerlink" title="äº‹ä»¶å¾ªç¯æœºåˆ¶"></a>äº‹ä»¶å¾ªç¯æœºåˆ¶</h1><h2 id="å…ˆçœ‹çœ‹å¤§ä½¬çš„æ–‡ç« -ğŸ‘€"><a href="#å…ˆçœ‹çœ‹å¤§ä½¬çš„æ–‡ç« -ğŸ‘€" class="headerlink" title="å…ˆçœ‹çœ‹å¤§ä½¬çš„æ–‡ç«  ğŸ‘€"></a>å…ˆçœ‹çœ‹å¤§ä½¬çš„æ–‡ç«  ğŸ‘€</h2><blockquote><p><a href="https://links.jianshu.com/go?to=https://zhuanlan.zhihu.com/p/25407758">è¿™ä¸ªå‰ç«¯é¢è¯•åœ¨æäº‹</a></p><p><a href="https://links.jianshu.com/go?to=https://juejin.im/post/58cf180b0ce4630057d6727c">80% åº”è˜è€…éƒ½ä¸åŠæ ¼çš„ JS é¢è¯•é¢˜</a></p></blockquote><h2 id="æ¶‰åŠæ¦‚å¿µ"><a href="#æ¶‰åŠæ¦‚å¿µ" class="headerlink" title="æ¶‰åŠæ¦‚å¿µ"></a>æ¶‰åŠæ¦‚å¿µ</h2><ul><li>æ‰§è¡Œä¸Šä¸‹æ–‡(Execution context)</li><li>å‡½æ•°è°ƒç”¨æ ˆ(call stack)</li><li>ä»»åŠ¡é˜Ÿåˆ—(task queue)</li><li>Promise</li></ul><p>Javascript ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ‰§è¡Œé¡ºåºä¾é  <strong>å‡½æ•°è°ƒç”¨æ ˆ</strong>ã€<strong>ä»»åŠ¡é˜Ÿåˆ—</strong>æ¥ç»´æŠ¤çš„</p><p>JavaScript çš„ä¸€å¤§ç‰¹ç‚¹å°±æ˜¯å•çº¿ç¨‹ï¼Œè€Œè¿™ä¸ªçº¿ç¨‹ä¸­æ‹¥æœ‰å”¯ä¸€çš„ä¸€ä¸ªäº‹ä»¶å¾ªç¯</p><ul><li>ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œäº‹ä»¶å¾ªç¯æ—¶å”¯ä¸€çš„ï¼Œä½†æ˜¯ä»»åŠ¡é˜Ÿåˆ—å¯ä»¥æœ‰å¤šä¸ª</li><li><strong>ä»»åŠ¡é˜Ÿåˆ—</strong>åˆ†ä¸ºï¼š<code>macro-task</code>ï¼ˆå®ä»»åŠ¡ï¼‰ã€<code>micro-task</code>ï¼ˆå¾®ä»»åŠ¡ï¼‰<ul><li>**<code>macro-task</code>**ï¼šscript(æ•´ä½“ä»£ç ), setTimeout, setInterval, setImmediate, I&#x2F;O, UI renderingã€‚</li><li><strong><code>micro-task</code></strong>: process.nextTick, Promise, Object.observe(å·²åºŸå¼ƒ), MutationObserver(html5 æ–°ç‰¹æ€§)</li></ul></li><li>setTimeout&#x2F;Promise ç­‰æˆ‘ä»¬ç§°ä¹‹ä¸º<strong>ä»»åŠ¡æº&#x2F;ä»»åŠ¡åˆ†å‘å™¨</strong>ã€‚è€Œè¿›å…¥ä»»åŠ¡é˜Ÿåˆ—çš„æ˜¯ä»–ä»¬æŒ‡å®šçš„å…·ä½“æ‰§è¡Œä»»åŠ¡ã€‚</li><li>æ¥è‡ªä¸åŒä»»åŠ¡æºçš„ä»»åŠ¡ä¼šè¿›å…¥åˆ°ä¸åŒçš„ä»»åŠ¡é˜Ÿåˆ—ã€‚å…¶ä¸­**<code>setTimeout</code><strong>ä¸</strong><code>setInterval</code>**æ˜¯åŒæºçš„</li><li>äº‹ä»¶å¾ªç¯çš„é¡ºåºï¼Œå†³å®šäº† JavaScript ä»£ç çš„æ‰§è¡Œé¡ºåºã€‚<ul><li>æ‰§è¡Œ<code>macro-task</code> ä¸­çš„ script(æ•´ä½“ä»£ç )ï¼Œå¼€å§‹ç¬¬ä¸€æ¬¡å¾ªç¯ï¼Œä¸Šä¸‹æ–‡è¿›å…¥å‡½æ•°è°ƒç”¨æ ˆï¼Œæ‰§è¡Œå¯æ‰§è¡Œä»£ç ï¼Œå°†é‡åˆ°çš„ä»»åŠ¡å…¥å¯¹åº”çš„é˜Ÿåˆ—ï¼Œç›´åˆ°è°ƒç”¨æ ˆæ¸…ç©º</li><li>æ‰§è¡Œ<code>micro-task</code>ä¸­çš„ä»»åŠ¡ï¼Œé€šè¿‡è°ƒç”¨æ ˆæ‰§è¡Œï¼Œé‡åˆ°ä»»åŠ¡å…¥å¯¹åº”çš„é˜Ÿåˆ—ï¼Œæ¸…ç©ºç”±æ‰§è¡Œå®ä»»åŠ¡äº§ç”Ÿçš„å¾®ä»»åŠ¡ï¼Œä¸€æ¬¡å¾ªç¯å®Œæˆ</li><li>æ‰§è¡Œ<code>macro-task</code>ä¸­çš„ä»»åŠ¡ï¼Œå¼€å§‹ç¬¬äºŒæ¬¡å¾ªç¯ï¼Œé€šè¿‡è°ƒç”¨æ ˆæ‰§è¡Œï¼Œé‡åˆ°ä»»åŠ¡å…¥å¯¹åº”çš„é˜Ÿåˆ—</li><li><code>micro -&gt; macro -&gt; micro -&gt; macro ....</code></li></ul></li><li>å…¶ä¸­æ¯ä¸€ä¸ªä»»åŠ¡çš„æ‰§è¡Œï¼Œæ— è®ºæ˜¯<code>macro-task</code>è¿˜æ˜¯<code>micro-task</code>ï¼Œéƒ½æ˜¯å€ŸåŠ©å‡½æ•°è°ƒç”¨æ ˆæ¥å®Œæˆ</li></ul><p><strong>æ³¨æ„ç»“æŸçš„æ—¶é—´ç‚¹</strong>â±ï¸</p><h2 id="äº‹ä»¶å¾ªç¯æ€»ç»“ï¼š"><a href="#äº‹ä»¶å¾ªç¯æ€»ç»“ï¼š" class="headerlink" title="äº‹ä»¶å¾ªç¯æ€»ç»“ï¼š"></a>äº‹ä»¶å¾ªç¯æ€»ç»“ï¼š</h2><ul><li>å…ˆæ‰§è¡Œå®ä»»åŠ¡ï¼Œåœ¨æ‰§è¡Œå®ä»»åŠ¡çš„è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿå¾®ä»»åŠ¡ä»¥åŠå®ä»»åŠ¡ï¼Œåœ¨ç»“æŸå½“å‰æ¬¡å®ä»»åŠ¡åï¼Œå»æ‰§è¡Œæ¸…ç©ºäº§ç”Ÿçš„å¾®ä»»åŠ¡ï¼Œå½“ç„¶å®ä»»åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ä¹Ÿä¼šäº§ç”Ÿå®ä»»åŠ¡ï¼Œæ’åœ¨åç»­é˜Ÿåˆ—ä¸­</li><li>æ‰§è¡Œä¸Šæ¬¡å¾ªç¯äº§ç”Ÿçš„å®ä»»åŠ¡ï¼Œå¼€å¯ä¸‹ä¸€æ¬¡å¾ªç¯</li></ul><p>æ —å­ ğŸŒ°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span> (<span class="params">resolve</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">1000</span>; i++) &#123;</span><br><span class="line">    i == <span class="number">99</span> &amp;&amp; <span class="title function_">resolve</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>);</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">4</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">5</span>);</span><br></pre></td></tr></table></figure><blockquote><p>æœ€ç»ˆè¾“å‡ºç»“æœï¼š2 3 5 4 1</p></blockquote><ul><li><p>é¦–å…ˆï¼Œ<code>macro-task</code>ä¸­åªæœ‰<code>script</code>ï¼Œå¾ªç¯å¼€å§‹</p></li><li><p>æ‰§è¡Œå¯æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œä»¥åŠå°†å…¶ä»–å®ä»»åŠ¡ã€å¾®ä»»åŠ¡å…¥é˜Ÿåˆ—</p><ul><li><code>setTimeout() -&gt; macro-task</code></li><li><code>new promise().then -&gt; micro-task</code> æ„é€ å‡½æ•°éƒ¨åˆ†æ˜¯åœ¨ new çš„æ—¶å€™æ‰§è¡Œï¼Œä¸è¿›å…¥é˜Ÿåˆ—ï¼Œç›´æ¥å…¥å‡½æ•°è°ƒç”¨æ ˆæ‰§è¡Œï¼Œæ‰€ä»¥æ­¤æ—¶ä¾æ¬¡è¾“å‡º 2ã€3</li></ul></li><li><p>ç»§ç»­æ‰§è¡Œåˆ°æœ€å<code>console.log(5)</code>ï¼Œæ­¤æ—¶è¾“å‡º 5</p></li><li><p>è‡³æ­¤å®ä»»åŠ¡ç¬¬ä¸€ä¸ªé˜Ÿåˆ—æ‰§è¡Œå®Œæ¯•ï¼Œå»æ¸…ç©ºï¼Œæ­¤æ¬¡äº§ç”Ÿçš„å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼ŒåŠ<code>promise().then</code>ï¼Œæ­¤æ—¶è¾“å‡º 4</p></li><li><p>æ¸…ç©ºå®Œæ¯•ï¼Œç»§ç»­å›åˆ°å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå†æ¬¡å¾ªç¯ï¼ŒåŠæ‰§è¡Œ<code>setTimeout</code>ï¼Œæ­¤æ—¶è¾“å‡º 1</p></li><li><p>è‡³æ­¤æ¸…ç©ºï¼Œç»“æŸå¾ªç¯</p></li></ul><hr><p>over~ğŸ‰</p>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è¯¦ç»†å›¾è§£jQueryå¯¹è±¡ï¼Œä»¥åŠå¦‚ä½•æ‰©å±•jQueryæ’ä»¶</title>
      <link href="/2021/10/22/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89%EF%BC%9A%E8%AF%A6%E7%BB%86%E5%9B%BE%E8%A7%A3jQuery%E5%AF%B9%E8%B1%A1%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E6%89%A9%E5%B1%95jQuery%E6%8F%92%E4%BB%B6/"/>
      <url>/2021/10/22/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%8D%81%E4%BA%8C%EF%BC%89%EF%BC%9A%E8%AF%A6%E7%BB%86%E5%9B%BE%E8%A7%A3jQuery%E5%AF%B9%E8%B1%A1%EF%BC%8C%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E6%89%A9%E5%B1%95jQuery%E6%8F%92%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="jQuery-å¯¹è±¡"><a href="#jQuery-å¯¹è±¡" class="headerlink" title="jQuery å¯¹è±¡"></a>jQuery å¯¹è±¡</h1><p>ä½¿ç”¨ jQuery å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬è¿™æ ·å†™ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å£°æ˜ä¸€ä¸ªjQueryå¯¹è±¡</span></span><br><span class="line">$(<span class="string">&quot;.target&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–å…ƒç´ çš„csså±æ€§</span></span><br><span class="line">$(<span class="string">&quot;.target&quot;</span>).<span class="title function_">css</span>(<span class="string">&quot;width&quot;</span>);</span><br></pre></td></tr></table></figure><h4 id="æµ…æ-Jquery-æºç "><a href="#æµ…æ-Jquery-æºç " class="headerlink" title="æµ…æ Jquery æºç "></a>æµ…æ Jquery æºç </h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params">ROOT</span>) &#123;</span><br><span class="line">  <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">  <span class="keyword">var</span> jQuery = <span class="keyword">function</span> (<span class="params">selector</span>) &#123;</span><br><span class="line">    <span class="comment">// åœ¨jQueryä¸­ç›´æ¥è¿”å›newè¿‡çš„å®ä¾‹ï¼Œinitæ˜¯jQueryçš„çœŸæ­£æ„é€ å‡½æ•°ï¼Œå­˜åœ¨JQueryåŸå‹ä¸Š</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> jQuery.<span class="property">fn</span>.<span class="title function_">init</span>(selector);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  jQuery.<span class="property">fn</span> = jQuery.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">    <span class="attr">constructor</span>: jQuery,</span><br><span class="line"></span><br><span class="line">    <span class="attr">version</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="attr">init</span>: <span class="keyword">function</span> (<span class="params">selector</span>) &#123;</span><br><span class="line">      <span class="comment">// åœ¨jqueryä¸­è¿™é‡Œæœ‰ä¸€ä¸ªå¤æ‚çš„åˆ¤æ–­ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘åšäº†ç®€åŒ–</span></span><br><span class="line">      <span class="keyword">var</span> elem, selector;</span><br><span class="line">      elem = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(selector);</span><br><span class="line">      <span class="variable language_">this</span>[<span class="number">0</span>] = elem;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// åœ¨jqueryä¸­è¿”å›ä¸€ä¸ªç”±æ‰€æœ‰åŸå‹å±æ€§æ–¹æ³•ç»„æˆçš„æ•°ç»„ï¼Œæˆ‘ä»¬è¿™é‡Œç®€åŒ–ï¼Œç›´æ¥è¿”å›thiså³å¯</span></span><br><span class="line">      <span class="comment">// return jQuery.makeArray(selector, this);</span></span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨åŸå‹ä¸Šæ·»åŠ ä¸€å †æ–¹æ³•</span></span><br><span class="line">    <span class="attr">toArray</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">get</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">each</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">ready</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">first</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">slice</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="comment">// ... ...</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  jQuery.<span class="property">fn</span>.<span class="property">init</span>.<span class="property"><span class="keyword">prototype</span></span> = jQuery.<span class="property">fn</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å®ç°jQueryçš„ä¸¤ç§æ‰©å±•æ–¹å¼</span></span><br><span class="line">  jQuery.<span class="property">extend</span> = jQuery.<span class="property">fn</span>.<span class="property">extend</span> = <span class="keyword">function</span> (<span class="params">options</span>) &#123;</span><br><span class="line">    <span class="comment">// åœ¨jqueryæºç ä¸­ä¼šæ ¹æ®å‚æ•°ä¸åŒè¿›è¡Œå¾ˆå¤šåˆ¤æ–­ï¼Œæˆ‘ä»¬è¿™é‡Œå°±ç›´æ¥èµ°ä¸€ç§æ–¹å¼ï¼Œæ‰€ä»¥å°±ä¸ç”¨åˆ¤æ–­äº†</span></span><br><span class="line">    <span class="keyword">var</span> target = <span class="variable language_">this</span>;</span><br><span class="line">    <span class="keyword">var</span> copy;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (name <span class="keyword">in</span> options) &#123;</span><br><span class="line">      copy = options[name];</span><br><span class="line">      target[name] = copy;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> target;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// jQueryä¸­åˆ©ç”¨ä¸Šé¢å®ç°çš„æ‰©å±•æœºåˆ¶ï¼Œæ·»åŠ äº†è®¸å¤šæ–¹æ³•ï¼Œå…¶ä¸­</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç›´æ¥æ·»åŠ åœ¨æ„é€ å‡½æ•°ä¸Šï¼Œè¢«ç§°ä¸ºå·¥å…·æ–¹æ³•</span></span><br><span class="line">  jQuery.<span class="title function_">extend</span>(&#123;</span><br><span class="line">    <span class="attr">isFunction</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">type</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">parseHTML</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">parseJSON</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">ajax</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ·»åŠ åˆ°åŸå‹ä¸Šï¼ŒåŠ¨æ€æ–¹æ³•</span></span><br><span class="line">  jQuery.<span class="property">fn</span>.<span class="title function_">extend</span>(&#123;</span><br><span class="line">    <span class="attr">queue</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">promise</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">attr</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">prop</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">addClass</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">removeClass</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">val</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="attr">css</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;,</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// $ç¬¦å·çš„ç”±æ¥ï¼Œå®é™…ä¸Šå®ƒå°±æ˜¯jQueryï¼Œä¸€ä¸ªç®€åŒ–çš„å†™æ³•ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬è¿˜å¯ä»¥æ›¿æ¢æˆå…¶ä»–å¯ç”¨å­—ç¬¦</span></span><br><span class="line">  <span class="variable constant_">ROOT</span>.<span class="property">jQuery</span> = <span class="variable constant_">ROOT</span>.<span class="property">$</span> = jQuery;</span><br><span class="line">&#125;)(<span class="variable language_">window</span>);</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/03/05/RlBK9ZgFsWfU4Io.webp"></p><h4 id="å¯¹è±¡å°è£…åˆ†æ"><a href="#å¯¹è±¡å°è£…åˆ†æ" class="headerlink" title="å¯¹è±¡å°è£…åˆ†æ"></a>å¯¹è±¡å°è£…åˆ†æ</h4><p><code>jQuery</code>æ„é€ å‡½æ•°é‡Œå£°æ˜ä¸€ä¸ª fn å±æ€§ï¼ŒæŒ‡å‘<code>jQuery.prototype</code>ï¼Œå¹¶åœ¨åŸå‹ä¸­æ·»åŠ <code>init()</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jQuery.<span class="property">fn</span> = jQuery.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">  <span class="attr">init</span>: &#123;&#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><code>init()</code>ä½œä¸ºå®é™…çš„æ„é€ å‡½æ•°ï¼Œå…¶<code>prototype</code>æŒ‡å‘åŸå‹<code>jQuery.prototype</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jQuery.<span class="property">fn</span>.<span class="property">init</span>.<span class="property"><span class="keyword">prototype</span></span> = jQuery.<span class="property">fn</span>;</span><br></pre></td></tr></table></figure><p>æ„é€ å‡½æ•° jQuery ä¸­ï¼Œè¿”å›äº† init çš„å®ä¾‹å¯¹è±¡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jQuery = <span class="keyword">function</span> (<span class="params">selector</span>) &#123;</span><br><span class="line">  <span class="comment">// åœ¨jQueryä¸­ç›´æ¥è¿”å›newè¿‡çš„å®ä¾‹ï¼Œè¿™é‡Œçš„initæ˜¯jQueryçš„çœŸæ­£æ„é€ å‡½æ•°</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> jQuery.<span class="property">fn</span>.<span class="title function_">init</span>(selector);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æœ€åå¯¹å¤–æš´éœ²å…¥å£æ—¶ï¼Œå°†å­—ç¬¦$ä¸ jQuery å¯¹ç­‰èµ·æ¥</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable constant_">ROOT</span>.<span class="property">jQuery</span> = <span class="variable constant_">ROOT</span>.<span class="property">$</span> = jQuery;</span><br></pre></td></tr></table></figure><p><strong>é¿å…æ— èŠ‚åˆ¶çš„ä½¿ç”¨<code>jQuery</code></strong>,æ¯æ¬¡æ‰§è¡Œ<code>$()</code>åéƒ½ä¼šé‡æ–°ç”Ÿæˆæ–°çš„å®ä¾‹ï¼Œå¯¹äºå†…å­˜çš„æ¶ˆè€—éå¸¸å¤§ã€‚æ­£ç¡®çš„åšæ³•æ˜¯æ—¢ç„¶æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå°±ç”¨ä¸€ä¸ªå˜é‡ä¿å­˜èµ·æ¥åç»­ä½¿ç”¨å³å¯</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $test = $(<span class="string">&quot;#test&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> width = <span class="built_in">parseInt</span>($test.<span class="title function_">css</span>(<span class="string">&quot;width&quot;</span>));</span><br><span class="line"><span class="keyword">if</span> (width &gt; <span class="number">20</span>) &#123;</span><br><span class="line">  $test.<span class="title function_">css</span>(<span class="string">&quot;backgroundColor&quot;</span>, <span class="string">&quot;red&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å…³äºé™æ€æ–¹æ³•ï¼Œå·¥å…·æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•"><a href="#å…³äºé™æ€æ–¹æ³•ï¼Œå·¥å…·æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•" class="headerlink" title="å…³äºé™æ€æ–¹æ³•ï¼Œå·¥å…·æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•"></a>å…³äºé™æ€æ–¹æ³•ï¼Œå·¥å…·æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•</h4><p><img src="https://s2.loli.net/2023/03/05/Sx6Y5IkjzwTFK7e.webp"></p><h4 id="jQuery-æ’ä»¶å°è£…"><a href="#jQuery-æ’ä»¶å°è£…" class="headerlink" title="jQuery æ’ä»¶å°è£…"></a>jQuery æ’ä»¶å°è£…</h4><ul><li><p>åˆ©ç”¨é—­åŒ…åˆ›å»ºè‡ªæ‰§è¡Œæ¨¡å—</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params">$</span>) &#123;&#125;)(jQuery);</span><br></pre></td></tr></table></figure></li><li><p>æŒ‚è½½æ–¹æ³•åˆ°æ„é€ å‡½æ•°ä¸Šæˆ–è€…åŸå‹ä¸Š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params">$</span>) &#123;</span><br><span class="line">  $.fn.<span class="property">myPlugin</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line">&#125;)(jQuery);</span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>é¢å‘å¯¹è±¡å®ä¾‹-å°è£…æ‹–æ‹½å¯¹è±¡</title>
      <link href="/2021/10/21/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%AE%9E%E4%BE%8B%E4%B9%8B%E5%B0%81%E8%A3%85%E6%8B%96%E6%8B%BD%E5%AF%B9%E8%B1%A1/"/>
      <url>/2021/10/21/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%AE%9E%E4%BE%8B%E4%B9%8B%E5%B0%81%E8%A3%85%E6%8B%96%E6%8B%BD%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢å‘å¯¹è±¡å®ä¾‹-å°è£…æ‹–æ‹½å¯¹è±¡"><a href="#é¢å‘å¯¹è±¡å®ä¾‹-å°è£…æ‹–æ‹½å¯¹è±¡" class="headerlink" title="é¢å‘å¯¹è±¡å®ä¾‹-å°è£…æ‹–æ‹½å¯¹è±¡"></a>é¢å‘å¯¹è±¡å®ä¾‹-å°è£…æ‹–æ‹½å¯¹è±¡</h1><p><img src="https://s2.loli.net/2023/03/05/2yjPfM9eDnAgtSh.webp"></p><ul><li>æ„é€ å‡½æ•°ä¸­ï¼š å±æ€§ä¸æ–¹æ³•ä¸ºå½“å‰å®ä¾‹å•ç‹¬æ‹¥æœ‰ï¼Œåªèƒ½è¢«å½“å‰å®ä¾‹è®¿é—®ï¼Œå¹¶ä¸”æ¯å£°æ˜ä¸€ä¸ªå®ä¾‹ï¼Œå…¶ä¸­çš„æ–¹æ³•éƒ½ä¼šè¢«é‡æ–°åˆ›å»ºä¸€æ¬¡ã€‚</li><li>åŸå‹ä¸­ï¼š å±æ€§ä¸æ–¹æ³•ä¸ºæ‰€æœ‰å®ä¾‹å…±åŒæ‹¥æœ‰ï¼Œå¯ä»¥è¢«æ‰€æœ‰å®ä¾‹è®¿é—®ï¼Œæ–°å£°æ˜å®ä¾‹ä¸ä¼šé‡å¤åˆ›å»ºæ–¹æ³•ã€‚</li><li>æ¨¡å—ä½œç”¨åŸŸä¸­ï¼šå±æ€§å’Œæ–¹æ³•ä¸èƒ½è¢«ä»»ä½•å®ä¾‹è®¿é—®ï¼Œä½†æ˜¯èƒ½è¢«å†…éƒ¨æ–¹æ³•è®¿é—®ï¼Œæ–°å£°æ˜çš„å®ä¾‹ï¼Œä¸ä¼šé‡å¤åˆ›å»ºç›¸åŒçš„æ–¹æ³•ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Drag.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">Drag</span>(<span class="params">selector</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">elem</span> = <span class="keyword">typeof</span> selector == <span class="string">&quot;Object&quot;</span> ? selector : <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(selector);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">startX</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">startY</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">sourceX</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">sourceY</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">init</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getTransform</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> transform = <span class="string">&quot;&quot;</span>,</span><br><span class="line">    divStyle = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>).<span class="property">style</span>,</span><br><span class="line">    transformArr = [<span class="string">&quot;transform&quot;</span>, <span class="string">&quot;webkitTransform&quot;</span>, <span class="string">&quot;MozTransform&quot;</span>, <span class="string">&quot;msTransform&quot;</span>, <span class="string">&quot;OTransform&quot;</span>];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; transformArr.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (transformArr[i] <span class="keyword">in</span> divStyle) &#123;</span><br><span class="line">      <span class="keyword">return</span> (transform = transformArr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> transform;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> transform = <span class="title function_">getTransform</span>();</span><br><span class="line"></span><br><span class="line"><span class="title class_">Drag</span>.<span class="property"><span class="keyword">prototype</span></span> = &#123;</span><br><span class="line">  <span class="attr">constructor</span>: <span class="title class_">Drag</span>,</span><br><span class="line">  <span class="attr">init</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setDrag</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">setDrag</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> self = <span class="variable language_">this</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">elem</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;mousedown&quot;</span>, start, <span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">start</span>(<span class="params">event</span>) &#123;</span><br><span class="line">      self.<span class="property">startX</span> = event.<span class="property">pageX</span>;</span><br><span class="line">      self.<span class="property">startY</span> = event.<span class="property">pageY</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> pos = self.<span class="title function_">getTargetPos</span>();</span><br><span class="line"></span><br><span class="line">      self.<span class="property">sourceX</span> = pos.<span class="property">x</span>;</span><br><span class="line">      self.<span class="property">sourceY</span> = pos.<span class="property">y</span>;</span><br><span class="line"></span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;mousemove&quot;</span>, move, <span class="literal">false</span>);</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;mouseup&quot;</span>, end, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">move</span>(<span class="params">event</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> currentX = event.<span class="property">pageX</span>;</span><br><span class="line">      <span class="keyword">var</span> currentY = event.<span class="property">pageY</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">var</span> distanceX = currentX - self.<span class="property">startX</span>;</span><br><span class="line">      <span class="keyword">var</span> distanceY = currentY - self.<span class="property">startY</span>;</span><br><span class="line"></span><br><span class="line">      self.<span class="title function_">setTargetPos</span>(&#123;</span><br><span class="line">        <span class="attr">x</span>: (self.<span class="property">sourceX</span> + distanceX).<span class="title function_">toFixed</span>(),</span><br><span class="line">        <span class="attr">y</span>: (self.<span class="property">sourceY</span> + distanceY).<span class="title function_">toFixed</span>(),</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">end</span>(<span class="params">event</span>) &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">removeEventListener</span>(<span class="string">&quot;mousemove&quot;</span>, move);</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">removeEventListener</span>(<span class="string">&quot;mouseup&quot;</span>, end);</span><br><span class="line">      <span class="comment">// do other things</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">getStyle</span>: <span class="keyword">function</span> (<span class="params">property</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">document</span>.<span class="property">defaultView</span>.<span class="property">getComputedStyle</span></span><br><span class="line">      ? <span class="variable language_">document</span>.<span class="property">defaultView</span>.<span class="title function_">getComputedStyle</span>(<span class="variable language_">this</span>.<span class="property">elem</span>, <span class="literal">false</span>)[property]</span><br><span class="line">      : <span class="variable language_">this</span>.<span class="property">elem</span>.<span class="property">currentStyle</span>[property];</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">getTargetPos</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> pos = &#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="keyword">let</span> elem = <span class="variable language_">this</span>.<span class="property">elem</span>;</span><br><span class="line">    <span class="keyword">if</span> (transform) &#123;</span><br><span class="line">      <span class="keyword">let</span> transformValue = <span class="variable language_">this</span>.<span class="title function_">getStyle</span>(transform);</span><br><span class="line">      <span class="keyword">if</span> (transformValue == <span class="string">&quot;none&quot;</span>) &#123;</span><br><span class="line">        elem.<span class="property">style</span>[transform] = <span class="string">&quot;translate(0, 0)&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> pos;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> temp = transformValue.<span class="title function_">match</span>(<span class="regexp">/-?\d+/g</span>);</span><br><span class="line">        <span class="keyword">return</span> (pos = &#123;</span><br><span class="line">          <span class="attr">x</span>: <span class="built_in">parseInt</span>(temp[<span class="number">4</span>].<span class="title function_">trim</span>()),</span><br><span class="line">          <span class="attr">y</span>: <span class="built_in">parseInt</span>(temp[<span class="number">5</span>].<span class="title function_">trim</span>()),</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="title function_">getStyle</span>(elem, <span class="string">&quot;position&quot;</span>) == <span class="string">&quot;static&quot;</span>) &#123;</span><br><span class="line">        elem.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&quot;relative&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> pos;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> x = <span class="built_in">parseInt</span>(<span class="title function_">getStyle</span>(elem, <span class="string">&quot;left&quot;</span>) ? <span class="title function_">getStyle</span>(elem, <span class="string">&quot;left&quot;</span>) : <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">let</span> y = <span class="built_in">parseInt</span>(<span class="title function_">getStyle</span>(elem, <span class="string">&quot;top&quot;</span>) ? <span class="title function_">getStyle</span>(elem, <span class="string">&quot;top&quot;</span>) : <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> (pos = &#123;</span><br><span class="line">          <span class="attr">x</span>: x,</span><br><span class="line">          <span class="attr">y</span>: y,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">setTargetPos</span>: <span class="keyword">function</span> (<span class="params">pos</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> elem = <span class="variable language_">this</span>.<span class="property">elem</span>;</span><br><span class="line">    <span class="keyword">if</span> (transform) &#123;</span><br><span class="line">      elem.<span class="property">style</span>[transform] = <span class="string">&quot;translate(&quot;</span> + pos.<span class="property">x</span> + <span class="string">&quot;px, &quot;</span> + pos.<span class="property">y</span> + <span class="string">&quot;px)&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      elem.<span class="property">style</span>.<span class="property">left</span> = pos.<span class="property">x</span> + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">      elem.<span class="property">style</span>.<span class="property">top</span> = pos.<span class="property">y</span> + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Drag</span> &#125; <span class="keyword">from</span> <span class="string">&quot;./drag&quot;</span>;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Drag</span>(<span class="string">&quot;target&quot;</span>);</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Drag</span>(<span class="string">&quot;target2&quot;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>é¢å‘å¯¹è±¡ã€æ„é€ å‡½æ•°ã€åŸå‹ä¸åŸå‹é“¾</title>
      <link href="/2021/10/20/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%8D%81%EF%BC%89%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E3%80%81%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E3%80%81%E5%8E%9F%E5%9E%8B%E4%B8%8E%E5%8E%9F%E5%9E%8B%E9%93%BE/"/>
      <url>/2021/10/20/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%8D%81%EF%BC%89%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E3%80%81%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E3%80%81%E5%8E%9F%E5%9E%8B%E4%B8%8E%E5%8E%9F%E5%9E%8B%E9%93%BE/</url>
      
        <content type="html"><![CDATA[<h1 id="é¢å‘å¯¹è±¡ã€æ„é€ å‡½æ•°ã€åŸå‹ä¸åŸå‹é“¾"><a href="#é¢å‘å¯¹è±¡ã€æ„é€ å‡½æ•°ã€åŸå‹ä¸åŸå‹é“¾" class="headerlink" title="é¢å‘å¯¹è±¡ã€æ„é€ å‡½æ•°ã€åŸå‹ä¸åŸå‹é“¾"></a>é¢å‘å¯¹è±¡ã€æ„é€ å‡½æ•°ã€åŸå‹ä¸åŸå‹é“¾</h1><h3 id="å·¥å‚æ¨¡å¼"><a href="#å·¥å‚æ¨¡å¼" class="headerlink" title="å·¥å‚æ¨¡å¼"></a>å·¥å‚æ¨¡å¼</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> createPerson = <span class="keyword">function</span> (<span class="params">name, age</span>) &#123;</span><br><span class="line">  <span class="comment">// å£°æ˜ä¸€ä¸ªä¸­é—´å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°±æ˜¯å·¥å‚æ¨¡å¼çš„æ¨¡å­</span></span><br><span class="line">  <span class="keyword">var</span> o = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¾æ¬¡æ·»åŠ æˆ‘ä»¬éœ€è¦çš„å±æ€§ä¸æ–¹æ³•</span></span><br><span class="line">  o.<span class="property">name</span> = name;</span><br><span class="line">  o.<span class="property">age</span> = age;</span><br><span class="line">  o.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> o;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºä¸¤ä¸ªå®ä¾‹</span></span><br><span class="line"><span class="keyword">var</span> perTom = <span class="title function_">createPerson</span>(<span class="string">&quot;TOM&quot;</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">PerJake</span> = <span class="title function_">createPerson</span>(<span class="string">&quot;Jake&quot;</span>, <span class="number">22</span>);</span><br></pre></td></tr></table></figure><p>å·¥å‚æ¨¡å¼ä¼šäº§ç”Ÿä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>æ— æ³•è¯†åˆ«å¯¹è±¡å®ä¾‹çš„ç±»å‹</li><li>é‡å¤åˆ†é…ç©ºé—´</li></ul><h3 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h3><p>new å…³é”®å­—</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Person</span> = <span class="keyword">function</span> (<span class="params">name, age</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†æ„é€ å‡½æ•°ä»¥å‚æ•°å½¢å¼ä¼ å…¥</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">New</span>(<span class="params">func</span>) &#123;</span><br><span class="line">  <span class="comment">// å£°æ˜ä¸€ä¸ªä¸­é—´å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸ºæœ€ç»ˆè¿”å›çš„å®ä¾‹</span></span><br><span class="line">  <span class="keyword">var</span> res = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//å®ä¾‹åŸå‹(__proto__)æŒ‡å‘æ„é€ å‡½æ•°åŸå‹</span></span><br><span class="line">  <span class="keyword">if</span> (func.<span class="property"><span class="keyword">prototype</span></span> !== <span class="literal">null</span>) &#123;</span><br><span class="line">    res.<span class="property">__proto__</span> = func.<span class="property"><span class="keyword">prototype</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ”¹å˜thisæŒ‡å‘</span></span><br><span class="line">  <span class="comment">// retä¸ºæ„é€ å‡½æ•°æ‰§è¡Œçš„ç»“æœï¼Œè¿™é‡Œé€šè¿‡applyï¼Œå°†æ„é€ å‡½æ•°å†…éƒ¨çš„thisæŒ‡å‘ä¿®æ”¹ä¸ºæŒ‡å‘res</span></span><br><span class="line">  <span class="keyword">var</span> ret = func.<span class="title function_">apply</span>(res, <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>, <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å½“æˆ‘ä»¬åœ¨æ„é€ å‡½æ•°ä¸­æœ‰è¿”å›å¯¹è±¡æ—¶ï¼Œé‚£ä¹ˆnewçš„æ‰§è¡Œç»“æœå°±æ˜¯è¯¥è¿”å›å¯¹è±¡</span></span><br><span class="line">  <span class="keyword">if</span> ((<span class="keyword">typeof</span> ret === <span class="string">&quot;object&quot;</span> || <span class="keyword">typeof</span> ret === <span class="string">&quot;function&quot;</span>) &amp;&amp; ret !== <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¦‚æœæ²¡æœ‰æ˜ç¡®æŒ‡å®šè¿”å›å¯¹è±¡ï¼Œåˆ™é»˜è®¤è¿”å›res</span></span><br><span class="line">  <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡newå£°æ˜åˆ›å»ºå®ä¾‹ï¼Œè¿™é‡Œçš„p1ï¼Œå®é™…æ¥æ”¶çš„æ­£æ˜¯newä¸­è¿”å›çš„res</span></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="title class_">New</span>(<span class="title class_">Person</span>, <span class="string">&quot;tom&quot;</span>, <span class="number">20</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="title function_">getName</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“ç„¶ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥åˆ¤æ–­å‡ºå®ä¾‹çš„ç±»å‹äº†</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1 <span class="keyword">instanceof</span> <span class="title class_">Person</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><blockquote><p>JavaScript å†…éƒ¨å†é€šè¿‡å…¶ä»–çš„ä¸€äº›ç‰¹æ®Šå¤„ç†ï¼Œå°† var p1 &#x3D; New(Person, â€˜tomâ€™, 20); ç­‰æ•ˆäº var p1 &#x3D; new Person(â€˜tomâ€™, 20);ã€‚å°±æ˜¯æˆ‘ä»¬è®¤è¯†çš„ new å…³é”®å­—äº†ã€‚</p></blockquote><p>new è¿‡ç¨‹ï¼š</p><ul><li>å£°æ˜ä¸€ä¸ªä¸­é—´å¯¹è±¡ï¼›</li><li>å°†è¯¥ä¸­é—´å¯¹è±¡çš„åŸå‹æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹ï¼›</li><li>å°†æ„é€ å‡½æ•°çš„ thisï¼ŒæŒ‡å‘è¯¥ä¸­é—´å¯¹è±¡ï¼›</li><li>è¿”å›è¯¥ä¸­é—´å¯¹è±¡ï¼Œå³è¿”å›å®ä¾‹å¯¹è±¡ã€‚</li></ul><h3 id="åŸå‹"><a href="#åŸå‹" class="headerlink" title="åŸå‹"></a>åŸå‹</h3><p><strong>åŸå‹ã€æ„é€ å‡½æ•°ã€å®ä¾‹ä¹‹é—´çš„å…³ç³»ï¼š</strong></p><p>æ„é€ å‡½æ•°çš„<code>prototype</code>å±æ€§æŒ‡å‘åŸå‹</p><p>æ„é€ å‡½æ•°çš„åŸå‹ä¸­çš„<code>custructor</code>æ–¹æ³•æŒ‡å‘æ„é€ å‡½æ•°</p><p>å®ä¾‹ä¸­çš„<code>__proto__</code>æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å£°æ˜æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡prototyeå±æ€§ï¼Œå°†æ–¹æ³•æŒ‚è½½åˆ°åŸå‹å¯¹è±¡ä¸Š</span></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;tim&quot;</span>, <span class="number">10</span>);</span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;jak&quot;</span>, <span class="number">22</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p1.<span class="property">getName</span> === p2.<span class="property">getName</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/03/05/1MJhaKw28B3t5mX.webp"></p><h3 id="åŸå‹é“¾"><a href="#åŸå‹é“¾" class="headerlink" title="åŸå‹é“¾"></a>åŸå‹é“¾</h3><p>æ‰€æœ‰å‡½æ•°éƒ½æœ‰<code>toString</code>æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•åˆ°åº•æ˜¯åœ¨å“ªé‡Œçš„å‘¢ï¼Ÿ</p><p><img src="https://s2.loli.net/2023/03/05/UCc47QtTnEKJqOb.webp"></p><p>Function åŸå‹æ˜¯ Object çš„å®ä¾‹ï¼Œå½¢æˆåŸå‹é“¾</p><h3 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="æ„é€ å‡½æ•°ç»§æ‰¿"><a href="#æ„é€ å‡½æ•°ç»§æ‰¿" class="headerlink" title="æ„é€ å‡½æ•°ç»§æ‰¿"></a>æ„é€ å‡½æ•°ç»§æ‰¿</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ„é€ å‡½æ•°çš„ç»§æ‰¿</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">cPerson</span>(<span class="params">name, age, job</span>) &#123;</span><br><span class="line">  <span class="title class_">Person</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name, age);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">job</span> = job;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="åŸå‹ç»§æ‰¿"><a href="#åŸå‹ç»§æ‰¿" class="headerlink" title="åŸå‹ç»§æ‰¿"></a>åŸå‹ç»§æ‰¿</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»§æ‰¿åŸå‹</span></span><br><span class="line">cPerson.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Person</span>(name, age);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ æ›´å¤šæ–¹æ³•</span></span><br><span class="line">cPerson.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getLive</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br></pre></td></tr></table></figure><h4 id="ç»“åˆç»§æ‰¿"><a href="#ç»“åˆç»§æ‰¿" class="headerlink" title="ç»“åˆç»§æ‰¿"></a>ç»“åˆç»§æ‰¿</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Person</span> = <span class="keyword">function</span> (<span class="params">name, age</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getAge</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">age</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ„é€ å‡½æ•°ç»§æ‰¿</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Student</span> = <span class="keyword">function</span> (<span class="params">name, age, grade</span>) &#123;</span><br><span class="line">  <span class="title class_">Person</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name, age);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">grade</span> = grade;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¼ å…¥è¢«ç»§æ‰¿çš„æ„é€ å‡½æ•°proto(Person)ï¼Œä»¥åŠé…ç½®å‚æ•°</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">create</span>(<span class="params">proto, options</span>) &#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡---ç»§æ‰¿çš„æ„é€ å‡½æ•°çš„åŸå‹(Student.prototype) ä¹Ÿæ˜¯ Person çš„å®ä¾‹</span></span><br><span class="line">  <span class="keyword">var</span> tmp = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è®©è¿™ä¸ªæ–°çš„ç©ºå¯¹è±¡æˆä¸ºçˆ¶ç±»å¯¹è±¡çš„å®ä¾‹</span></span><br><span class="line">  tmp.<span class="property">__proto__</span> = proto;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ä¼ å…¥çš„æ–¹æ³•éƒ½æŒ‚è½½åˆ°æ–°å¯¹è±¡ä¸Šï¼Œæ–°çš„å¯¹è±¡å°†ä½œä¸ºå­ç±»å¯¹è±¡çš„åŸå‹</span></span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">defineProperties</span>(tmp, options);</span><br><span class="line">  <span class="keyword">return</span> tmp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€å•å°è£…<code>create</code>ä¹‹åå°±å¯ä»¥å®ç°åŸå‹ç»§æ‰¿äº†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title function_">create</span>(<span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>, &#123;</span><br><span class="line">    <span class="comment">// ä¸è¦å¿˜äº†é‡æ–°æŒ‡å®šæ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="attr">constructor</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: <span class="title class_">Student</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="attr">getGrade</span>: &#123;</span><br><span class="line">        <span class="attr">value</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">grade</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>åœ¨ ECMAScript5 ä¸­ç›´æ¥æä¾›äº†ä¸€ä¸ª Object.create æ–¹æ³•æ¥å®Œæˆæˆ‘ä»¬ä¸Šé¢è‡ªå·±å°è£…çš„ create çš„åŠŸèƒ½</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getAge</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">age</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Student</span>(<span class="params">name, age, grade</span>) &#123;</span><br><span class="line">  <span class="title class_">Person</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name, age);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">grade</span> = grade;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>, &#123;</span><br><span class="line">  <span class="attr">constructor</span>: &#123;</span><br><span class="line">    <span class="attr">value</span>: <span class="title class_">Student</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">getGrade</span>: &#123;</span><br><span class="line">    <span class="attr">value</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">grade</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> s1 = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;1&quot;</span>, <span class="string">&quot;2&quot;</span>, <span class="string">&quot;3&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s1.<span class="title function_">getName</span>());</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s1.<span class="title function_">getAge</span>());</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s1.<span class="title function_">getGrade</span>());</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Object.create()</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">create</span>(<span class="params">proto, props</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> obj = &#123;&#125;;</span><br><span class="line">  obj.<span class="property">__proto__</span> = proto;</span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">defineProperties</span>(obj, props);</span><br><span class="line">  <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æŸ¯ç†åŒ–å‡½æ•°</title>
      <link href="/2021/10/19/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E4%B9%9D%EF%BC%89%E6%9F%AF%E9%87%8C%E5%8C%96%E5%87%BD%E6%95%B0/"/>
      <url>/2021/10/19/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E4%B9%9D%EF%BC%89%E6%9F%AF%E9%87%8C%E5%8C%96%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="æŸ¯é‡ŒåŒ–"><a href="#æŸ¯é‡ŒåŒ–" class="headerlink" title="æŸ¯é‡ŒåŒ–"></a>æŸ¯é‡ŒåŒ–</h1><p><strong>æŸ¯é‡ŒåŒ–ï¼šä¸€ä¸ªå‡½æ•°æ¥å— A ä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿™ä¸ªæ–°çš„å‡½æ•°èƒ½å¤Ÿå¤„ç†å‡½æ•° A çš„å‰©ä¸‹å‚æ•°</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">a, b, c</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> a + b + c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆ add å‡½æ•°çš„æŸ¯é‡ŒåŒ–å‡½æ•°_add åˆ™å¯ä»¥å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">_add</span>(<span class="params">a</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">c</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> a + b + c;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢çš„è¿ç®—æ–¹å¼æ˜¯ç­‰ä»·çš„ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">add</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="title function_">_add</span>(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>);</span><br></pre></td></tr></table></figure><h3 id="æŸ¯é‡ŒåŒ–çš„é€šç”¨å¼"><a href="#æŸ¯é‡ŒåŒ–çš„é€šç”¨å¼" class="headerlink" title="æŸ¯é‡ŒåŒ–çš„é€šç”¨å¼"></a>æŸ¯é‡ŒåŒ–çš„é€šç”¨å¼</h3><p>å°è£…å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">curry</span>(<span class="params">fn, args</span>) &#123;</span><br><span class="line">  <span class="comment">// fn å‡½æ•°ä¸­å½¢å‚ä¸ªæ•°</span></span><br><span class="line">  <span class="keyword">let</span> length = fn.<span class="property">length</span>;</span><br><span class="line">  args = args || [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ä¸Šæ¬¡å‚æ•° åˆå§‹ä¸º[]</span></span><br><span class="line">    <span class="keyword">let</span> _args = [].<span class="property">slice</span>.<span class="title function_">call</span>(args);</span><br><span class="line">    <span class="comment">// æœ¬æ¬¡å‚æ•°</span></span><br><span class="line">    <span class="keyword">let</span> arg = [].<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå¹¶ _args è‹¥å‚æ•°æœªæ”¶é›†å®Œç»§ç»­å‘ä¸‹ä¼ é€’</span></span><br><span class="line">    [].<span class="property">push</span>.<span class="title function_">apply</span>(_args, arg);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ¤æ–­å®å‚å’Œå½¢å‚çš„ä¸ªæ•°</span></span><br><span class="line">    <span class="comment">// å‚æ•°æœªæ”¶é›†å®Œå…¨ é‚£ä¹ˆå°±è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œæ¥æ”¶å‰©ä½™çš„å‚æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (_args.<span class="property">length</span> &lt; length) &#123;</span><br><span class="line">      <span class="keyword">return</span> curry.<span class="title function_">call</span>(<span class="variable language_">this</span>, fn, _args);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// å‚æ•°æ”¶é›†å®Œå…¨ï¼Œç›´æ¥æ‰§è¡Œå‡½æ•°fn</span></span><br><span class="line">      <span class="keyword">return</span> fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, _args);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fn = <span class="title function_">curry</span>(<span class="keyword">function</span> (<span class="params">a, b, c</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a + b + c);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="title function_">fn</span>(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>);</span><br><span class="line"><span class="title function_">fn</span>(<span class="number">1</span>, <span class="number">2</span>)(<span class="number">3</span>);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fn(1, 2)(3);</span><br><span class="line">------------------------------------------------</span><br><span class="line">&#123;fn&#125; &#123;_args&#125; &#123;args&#125;   =&gt;  &#123;_args&#125;</span><br><span class="line">------------------------------------------------</span><br><span class="line"></span><br><span class="line"> fn     []    [1,2]   =&gt;   [1,2]</span><br><span class="line">--åˆ¤æ–­length--å‚æ•°æ”¶é›†ä¸å…¨--è¿”å›æ–°å‡½æ•°ç»§ç»­æ”¶é›†</span><br><span class="line"></span><br><span class="line"> fn    [1,2]   [3]    =&gt;   [1,2,3]</span><br><span class="line">--åˆ¤æ–­length--å‚æ•°æ”¶é›†å®Œå…¨--ç›´æ¥æ‰§è¡Œfn</span><br></pre></td></tr></table></figure><h3 id="lodash-ä¸­ä½¿ç”¨æŸ¯é‡ŒåŒ–å‡½æ•°"><a href="#lodash-ä¸­ä½¿ç”¨æŸ¯é‡ŒåŒ–å‡½æ•°" class="headerlink" title="lodash ä¸­ä½¿ç”¨æŸ¯é‡ŒåŒ–å‡½æ•°"></a>lodash ä¸­ä½¿ç”¨æŸ¯é‡ŒåŒ–å‡½æ•°</h3><p><a href="https://www.lodashjs.com/docs/lodash.curry#_curryfunc-arityfunclength">_.curry(func)</a></p><ul><li>åŠŸèƒ½: åˆ›å»ºä¸€ä¸ªå‡½æ•°, è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªæˆ–å¤šä¸ª func çš„å‚æ•°, å¦‚æœ func æ‰€éœ€è¦çš„å‚æ•°éƒ½è¢«æä¾›,åˆ™æ‰§è¡Œ func å¹¶è¿”å›æ‰§è¡Œçš„ç»“æœ, å¦åˆ™ç»§ç»­è¿”å›è¯¥å‡½æ•°å¹¶ç­‰å¾…æ¥å—å‰©ä½™çš„å‚æ•°.</li><li>å‚æ•°: éœ€è¦æŸ¯é‡ŒåŒ–çš„å‡½æ•°è¿”å›å€¼: æŸ¯é‡ŒåŒ–åçš„å‡½æ•°</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> abc = <span class="keyword">function</span> (<span class="params">a, b, c</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> [a, b, c];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> curried = _.<span class="title function_">curry</span>(abc);</span><br><span class="line"></span><br><span class="line"><span class="title function_">curried</span>(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>);</span><br><span class="line"><span class="comment">// =&gt; [1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">curried</span>(<span class="number">1</span>, <span class="number">2</span>)(<span class="number">3</span>);</span><br><span class="line"><span class="comment">// =&gt; [1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">curried</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="comment">// =&gt; [1, 2, 3]</span></span><br></pre></td></tr></table></figure><p>æ —å­ï¼š<br>å°è£…ä¸€ä¸ªæ ¡éªŒæ–¹æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">check</span>(<span class="params">targetString, reg</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> reg.<span class="title function_">test</span>(targetString);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">check</span>(<span class="regexp">/^1[34578]\d&#123;9&#125;$/</span>, <span class="string">&quot;14900000088&quot;</span>);</span><br><span class="line"><span class="title function_">check</span>(<span class="regexp">/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/</span>, <span class="string">&quot;test@163.com&quot;</span>);</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥å€ŸåŠ©æŸ¯é‡ŒåŒ–ï¼Œç®€åŒ–ä½¿ç”¨</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _check = <span class="title function_">curry</span>(check);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> checkPhone = <span class="title function_">_check</span>(<span class="regexp">/^1[34578]\d&#123;9&#125;$/</span>);</span><br><span class="line"><span class="keyword">var</span> checkEmail = <span class="title function_">_check</span>(<span class="regexp">/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">checkPhone</span>(<span class="string">&quot;183888888&quot;</span>);</span><br><span class="line"><span class="title function_">checkEmail</span>(<span class="string">&quot;xxxxx@test.com&quot;</span>);</span><br></pre></td></tr></table></figure><p>æŸ¯é‡ŒåŒ–ï¼šæˆ‘ä»¬åœ¨å°è£…å«æœ‰å¤šä¸ªå‚æ•°çš„æ¨¡å—çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡æŸ¯é‡ŒåŒ–ï¼Œå°†å‚æ•°ç”±å¤šå…ƒè½¬ä¸ºä¸€å…ƒã€‚æ¯”å¦‚æˆ‘è¦å°è£…<code>enc_fn(fn, params)</code>ï¼Œå¯ä»¥é€šè¿‡æŸ¯é‡ŒåŒ–<code>_en_fn = curry(en_fn)</code>ï¼Œç„¶ååˆ†éƒ¨ä¼ é€’å‚æ•°å®ç°åŠŸèƒ½ï¼Œ<code>ac_fn = _en_fn(fn)</code>ï¼Œ<code>ac_fn(params)</code></p><p>æ¯”å¦‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ¨¡å—ï¼Œå¯¹æ•°ç»„çš„æ¯ä¸€é¡¹è¿›è¡Œæ“ä½œå¹¶è¿”å›</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getNewArray</span>(<span class="params">fn, array</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> array.<span class="title function_">map</span>(fn);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">getNewArray</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item * <span class="number">10</span>, [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]); <span class="comment">// [10, 20, 30]</span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨æŸ¯é‡ŒåŒ–äºŒæ¬¡å°è£…</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">_map</span>(<span class="params">fn, array</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> array.<span class="title function_">map</span>(fn);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> _getNewArray = <span class="title function_">curry</span>(_map);</span><br><span class="line"><span class="keyword">let</span> getNewArray = <span class="title function_">_getNewArray</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> item * <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">getNewArray</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]); <span class="comment">// [10, 20, 30]</span></span><br></pre></td></tr></table></figure><p>åŒæ ·<code>filter</code>ä¹Ÿå¯ä»¥è¿›è¡Œå°è£…</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">_filter</span>(<span class="params">fn, array</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> array.<span class="title function_">filter</span>(fn);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> _find = <span class="title function_">curry</span>(_filter);</span><br><span class="line"><span class="keyword">let</span> findNum = <span class="title function_">_find</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> <span class="keyword">typeof</span> item == <span class="string">&quot;number&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">findNum</span>([<span class="number">1</span>, <span class="string">&quot;2&quot;</span>, <span class="number">3</span>]);</span><br></pre></td></tr></table></figure><p><strong>æŸ¯é‡ŒåŒ–ä½¿ç”¨é€’å½’ä¸é—­åŒ…ï¼Œå› æ­¤æŸ¯é‡ŒåŒ–çš„è‡ªç”±åº¦æ˜¯ä»¥ç‰ºç‰²äº†ä¸€å®šçš„æ€§èƒ½ä¸ºä»£ä»·æ¢æ¥çš„</strong></p><p>æ— é™å‚æ•°çš„æŸ¯é‡ŒåŒ–</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®ç°ä¸€ä¸ªaddæ–¹æ³•ï¼Œä½¿è®¡ç®—ç»“æœèƒ½å¤Ÿæ»¡è¶³å¦‚ä¸‹é¢„æœŸï¼š</span></span><br><span class="line"><span class="title function_">add</span>(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>) = <span class="number">6</span>;</span><br><span class="line"><span class="title function_">add</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)(<span class="number">4</span>) = <span class="number">10</span>;</span><br><span class="line"><span class="title function_">add</span>(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>)(<span class="number">4</span>)(<span class="number">5</span>) = <span class="number">15</span>;</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä½¿ç”¨é€’å½’ä¸é—­åŒ…ï¼Œå»æ”¶é›†å‚æ•°ï¼Œä»¥åŠé‡å†™<code>toString/valueOf</code>ï¼Œå®ç°è¿™ä¸ªå‡½æ•°ç›´æ¥å‚ä¸è®¡ç®—ï¼Œå¹¶ä¸”è½¬æ¢çš„ç»“æœã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">...args</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> args.<span class="title function_">reduce</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> _args = [].<span class="property">slice</span>.<span class="title function_">apply</span>(<span class="variable language_">arguments</span>);</span><br><span class="line">  <span class="keyword">let</span> adder = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> _adder = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      [].<span class="property">push</span>.<span class="title function_">apply</span>(_args, [].<span class="property">slice</span>.<span class="title function_">apply</span>(<span class="variable language_">arguments</span>));</span><br><span class="line">      <span class="keyword">return</span> _adder;</span><br><span class="line">    &#125;;</span><br><span class="line">    _adder.<span class="property">toString</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> _args.<span class="title function_">reduce</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a + b);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> _adder;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">adder</span>(..._args);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">add</span>(<span class="number">1</span>)(<span class="number">2</span>)(<span class="number">3</span>).<span class="title function_">toString</span>(); <span class="comment">// 6</span></span><br><span class="line"><span class="title function_">add</span>(<span class="number">1</span>, <span class="number">2</span>)(<span class="number">3</span>).<span class="title function_">toString</span>(); <span class="comment">// 6</span></span><br><span class="line"><span class="title function_">add</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>).<span class="title function_">toString</span>(); <span class="comment">// 6</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">add -&gt; adder -&gt; _adder -&gt; _adder ....</span><br><span class="line">----------------------------------------------------------</span><br><span class="line">add(1,2)(3)</span><br><span class="line">add(1,2)  ---&gt;  adder(1,2)  ---&gt;  _adder(3)</span><br><span class="line">----------------------------------------------------------</span><br><span class="line">add(1)(2)(3)</span><br><span class="line">add(1)  ---&gt;  adder(1)  ---&gt;  _adder(2)  ---&gt;  _adder(3)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å‡½æ•°ä¸å‡½æ•°å¼ç¼–ç¨‹</title>
      <link href="/2021/10/18/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%85%AB%EF%BC%89%E5%87%BD%E6%95%B0%E4%B8%8E%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/"/>
      <url>/2021/10/18/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%85%AB%EF%BC%89%E5%87%BD%E6%95%B0%E4%B8%8E%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h1><h3 id="å‡½æ•°å£°æ˜ã€å‡½æ•°è¡¨è¾¾å¼ã€åŒ¿åå‡½æ•°ä¸è‡ªæ‰§è¡Œå‡½æ•°"><a href="#å‡½æ•°å£°æ˜ã€å‡½æ•°è¡¨è¾¾å¼ã€åŒ¿åå‡½æ•°ä¸è‡ªæ‰§è¡Œå‡½æ•°" class="headerlink" title="å‡½æ•°å£°æ˜ã€å‡½æ•°è¡¨è¾¾å¼ã€åŒ¿åå‡½æ•°ä¸è‡ªæ‰§è¡Œå‡½æ•°"></a>å‡½æ•°å£°æ˜ã€å‡½æ•°è¡¨è¾¾å¼ã€åŒ¿åå‡½æ•°ä¸è‡ªæ‰§è¡Œå‡½æ•°</h3><h4 id="å‡½æ•°å£°æ˜"><a href="#å‡½æ•°å£°æ˜" class="headerlink" title="å‡½æ•°å£°æ˜"></a>å‡½æ•°å£°æ˜</h4><p>JavaScript ä¸­ï¼Œæœ‰ä¸¤ç§å£°æ˜æ–¹å¼ï¼Œä¸€ä¸ªæ˜¯ä½¿ç”¨<code>var/let/const</code>çš„å˜é‡å£°æ˜ï¼Œå¦ä¸€ä¸ªæ˜¯ä½¿ç”¨<code>function</code>çš„å‡½æ•°å£°æ˜ã€‚</p><p>å˜é‡å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ä¸­ï¼Œå‡½æ•°å£°æ˜æ¯”å˜é‡çš„å£°æ˜å…·æœ‰æ›´ä¼˜å…ˆçš„æ‰§è¡Œé¡ºåº</p><h4 id="å‡½æ•°è¡¨è¾¾å¼"><a href="#å‡½æ•°è¡¨è¾¾å¼" class="headerlink" title="å‡½æ•°è¡¨è¾¾å¼"></a>å‡½æ•°è¡¨è¾¾å¼</h4><p>å‡½æ•°è¡¨è¾¾çš„æå‡æ–¹å¼ä¸å˜é‡å£°æ˜ä¸€è‡´ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">var</span> fn = <span class="keyword">function</span>(<span class="params">bar, num</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">bar</span>() + num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å˜é‡å¯¹è±¡åœ¨fnä¸Šä¸‹æ–‡æ‰§è¡Œè¿‡ç¨‹ä¸­çš„åˆ›å»ºé˜¶æ®µ</span></span><br><span class="line"><span class="title function_">VO</span>(fn) = &#123;</span><br><span class="line">    <span class="attr">arguments</span>: &#123;</span><br><span class="line">        <span class="attr">bar</span>: <span class="literal">undefined</span>,</span><br><span class="line">        <span class="attr">num</span>: <span class="literal">undefined</span>,</span><br><span class="line">        <span class="attr">length</span>: <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å˜é‡å¯¹è±¡åœ¨fnä¸Šä¸‹æ–‡æ‰§è¡Œè¿‡ç¨‹ä¸­çš„æ‰§è¡Œé˜¶æ®µ</span></span><br><span class="line"><span class="comment">// å˜é‡å¯¹è±¡å˜ä¸ºæ´»åŠ¨å¯¹è±¡ï¼Œå¹¶å®Œæˆèµ‹å€¼æ“ä½œä¸æ‰§è¡Œå¯æ‰§è¡Œä»£ç </span></span><br><span class="line"><span class="variable constant_">VO</span> -&gt; <span class="variable constant_">AO</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">AO</span>(fn) = &#123;</span><br><span class="line">    <span class="attr">arguments</span>: &#123;</span><br><span class="line">        <span class="attr">bar</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> a &#125;,</span><br><span class="line">        <span class="attr">num</span>: <span class="number">20</span>,</span><br><span class="line">        <span class="attr">length</span>: <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å‡½æ•°è‡ªæ‰§è¡Œä¸å—çº§ä½œç”¨åŸŸ"><a href="#å‡½æ•°è‡ªæ‰§è¡Œä¸å—çº§ä½œç”¨åŸŸ" class="headerlink" title="å‡½æ•°è‡ªæ‰§è¡Œä¸å—çº§ä½œç”¨åŸŸ"></a>å‡½æ•°è‡ªæ‰§è¡Œä¸å—çº§ä½œç”¨åŸŸ</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p><strong>Jquery æ¨¡å—é—­åŒ…</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨å‡½æ•°è‡ªæ‰§è¡Œçš„æ–¹å¼åˆ›å»ºæ¨¡å—</span></span><br><span class="line">(<span class="keyword">function</span>(<span class="params"><span class="variable language_">window</span>, <span class="literal">undefined</span></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜jQueryæ„é€ å‡½æ•°</span></span><br><span class="line">     <span class="keyword">var</span> jQuery = <span class="keyword">function</span>(<span class="params">name</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä¸»åŠ¨åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œè¿”å›ä¸€ä¸ªjQueryå®ä¾‹</span></span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">new</span> jQuery.<span class="property">fn</span>.<span class="title function_">init</span>(name);</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ·»åŠ åŸå‹æ–¹æ³•</span></span><br><span class="line">     jQuery.<span class="property"><span class="keyword">prototype</span></span> = jQuery.<span class="property">fn</span> = &#123;</span><br><span class="line">         <span class="attr">constructor</span>: jQuery,</span><br><span class="line">         <span class="attr">init</span>:<span class="keyword">function</span>(<span class="params"></span>) &#123; ... &#125;,</span><br><span class="line">         <span class="attr">css</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123; ... &#125;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     jQuery.<span class="property">fn</span>.<span class="property">init</span>.<span class="property"><span class="keyword">prototype</span></span> = jQuery.<span class="property">fn</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†jQueryæ”¹åä¸º$ï¼Œå¹¶å°†å¼•ç”¨ä¿å­˜åœ¨windowä¸Šï¼Œå½¢æˆé—­åŒ…ï¼Œå¯¹å¤–å¼€æ”¾jQueryæ„é€ å‡½æ•°ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è®¿é—®æ‰€æœ‰æŒ‚è½½åœ¨jQueryåŸå‹ä¸Šçš„æ–¹æ³•äº†</span></span><br><span class="line">     <span class="variable language_">window</span>.<span class="property">jQuery</span> = <span class="variable language_">window</span>.<span class="property">$</span> = jQuery;</span><br><span class="line"> &#125;)(<span class="variable language_">window</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨ä½¿ç”¨æ—¶ï¼Œç›´æ¥æ‰§è¡Œäº†æ„é€ å‡½æ•°ï¼Œå› ä¸ºåœ¨jQueryçš„æ„é€ å‡½æ•°ä¸­é€šè¿‡ä¸€äº›æ‰‹æ®µï¼Œè¿”å›çš„æ˜¯jQueryçš„å®ä¾‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ä¸ç”¨å†æ¯æ¬¡ç”¨çš„æ—¶å€™è‡ªå·±newä¸€ä¸ªå®ä¾‹</span></span><br><span class="line">$(<span class="string">&#x27;#div1&#x27;</span>);</span><br></pre></td></tr></table></figure><p>redux æ¨¡å—</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è‡ªæ‰§è¡Œåˆ›å»ºæ¨¡å—</span></span><br><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// states ç»“æ„é¢„è§ˆ</span></span><br><span class="line">  <span class="comment">// states = &#123;</span></span><br><span class="line">  <span class="comment">//     a: 1,</span></span><br><span class="line">  <span class="comment">//     b: 2,</span></span><br><span class="line">  <span class="comment">//     m: 30,</span></span><br><span class="line">  <span class="comment">//     o: &#123;&#125;</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  <span class="keyword">var</span> states = &#123;&#125;; <span class="comment">// ç§æœ‰å˜é‡ï¼Œç”¨æ¥å­˜å‚¨çŠ¶æ€ä¸æ•°æ®</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// åˆ¤æ–­æ•°æ®ç±»å‹</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">type</span>(<span class="params">elem</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (elem == <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> elem + <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> toString</span><br><span class="line">      .<span class="title function_">call</span>(elem)</span><br><span class="line">      .<span class="title function_">replace</span>(<span class="regexp">/[\[\]]/g</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">      .<span class="title function_">split</span>(<span class="string">&quot; &quot;</span>)[<span class="number">1</span>]</span><br><span class="line">      .<span class="title function_">toLowerCase</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@Param</span> name å±æ€§å</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@Description</span> é€šè¿‡å±æ€§åè·å–ä¿å­˜åœ¨statesä¸­çš„å€¼</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">get</span>(<span class="params">name</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> states[name] ? states[name] : <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">getStates</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> states;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">   * @param options &#123;object&#125; é”®å€¼å¯¹</span></span><br><span class="line"><span class="comment">   * @param target &#123;object&#125; å±æ€§å€¼ä¸ºå¯¹è±¡çš„å±æ€§ï¼Œåªåœ¨å‡½æ•°å®ç°æ—¶é€’å½’ä¸­ä¼ å…¥</span></span><br><span class="line"><span class="comment">   * @desc é€šè¿‡ä¼ å…¥é”®å€¼å¯¹çš„æ–¹å¼ä¿®æ”¹stateæ ‘ï¼Œä½¿ç”¨æ–¹å¼ä¸å°ç¨‹åºçš„dataæˆ–è€…reactä¸­çš„setStatesç±»ä¼¼</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">set</span>(<span class="params">options, target</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> keys = <span class="title class_">Object</span>.<span class="title function_">keys</span>(options);</span><br><span class="line">    <span class="keyword">var</span> o = target ? target : states;</span><br><span class="line"></span><br><span class="line">    keys.<span class="title function_">map</span>(<span class="keyword">function</span> (<span class="params">item</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> o[item] == <span class="string">&quot;undefined&quot;</span>) &#123;</span><br><span class="line">        o[item] = options[item];</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">type</span>(o[item]) == <span class="string">&quot;object&quot;</span> ? <span class="title function_">set</span>(options[item], o[item]) : (o[item] = options[item]);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> item;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¯¹å¤–æä¾›æ¥å£</span></span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">get</span> = get;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">set</span> = set;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">getStates</span> = getStates;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…·ä½“ä½¿ç”¨å¦‚ä¸‹</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">set</span>(&#123; <span class="attr">a</span>: <span class="number">20</span> &#125;); <span class="comment">// ä¿å­˜ å±æ€§a</span></span><br><span class="line"><span class="title function_">set</span>(&#123; <span class="attr">b</span>: <span class="number">100</span> &#125;); <span class="comment">// ä¿å­˜å±æ€§b</span></span><br><span class="line"><span class="title function_">set</span>(&#123; <span class="attr">c</span>: <span class="number">10</span> &#125;); <span class="comment">// ä¿å­˜å±æ€§c</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿å­˜å±æ€§o, å®ƒçš„å€¼ä¸ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="title function_">set</span>(&#123;</span><br><span class="line">  <span class="attr">o</span>: &#123;</span><br><span class="line">    <span class="attr">m</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="attr">n</span>: <span class="number">20</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹å¯¹è±¡o çš„må€¼</span></span><br><span class="line"><span class="title function_">set</span>(&#123;</span><br><span class="line">  <span class="attr">o</span>: &#123;</span><br><span class="line">    <span class="attr">m</span>: <span class="number">1000</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»™å¯¹è±¡oä¸­å¢åŠ ä¸€ä¸ªcå±æ€§</span></span><br><span class="line"><span class="title function_">set</span>(&#123;</span><br><span class="line">  <span class="attr">o</span>: &#123;</span><br><span class="line">    <span class="attr">c</span>: <span class="number">100</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">getStates</span>());</span><br></pre></td></tr></table></figure><h3 id="å‡½æ•°å‚æ•°ä¼ é€’æ–¹å¼ï¼šæŒ‰å€¼ä¼ é€’"><a href="#å‡½æ•°å‚æ•°ä¼ é€’æ–¹å¼ï¼šæŒ‰å€¼ä¼ é€’" class="headerlink" title="å‡½æ•°å‚æ•°ä¼ é€’æ–¹å¼ï¼šæŒ‰å€¼ä¼ é€’"></a>å‡½æ•°å‚æ•°ä¼ é€’æ–¹å¼ï¼šæŒ‰å€¼ä¼ é€’</h3><p>è¿˜è®°å¾—åŸºæœ¬æ•°æ®ç±»å‹ä¸å¼•ç”¨æ•°æ®ç±»å‹åœ¨å¤åˆ¶ä¸Šçš„å·®å¼‚å—ï¼ŸåŸºæœ¬æ•°æ®ç±»å‹å¤åˆ¶ï¼Œæ˜¯å€¼ç›´æ¥å‘ç”Ÿäº†å¤åˆ¶ï¼Œå› æ­¤æ”¹å˜åï¼Œå„è‡ªç›¸äº’ä¸å½±å“ã€‚ä½†æ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„å¤åˆ¶ï¼Œæ˜¯ä¿å­˜åœ¨å˜é‡å¯¹è±¡ä¸­çš„å¼•ç”¨å‘ç”Ÿäº†å¤åˆ¶ï¼Œå› æ­¤å¤åˆ¶ä¹‹åçš„è¿™ä¸¤ä¸ªå¼•ç”¨å®é™…è®¿é—®çš„å®é™…æ˜¯åŒä¸€ä¸ªå †å†…å­˜ä¸­çš„å€¼ã€‚å½“æ”¹å˜å…¶ä¸­ä¸€ä¸ªæ—¶ï¼Œå¦å¤–ä¸€ä¸ªè‡ªç„¶ä¹Ÿè¢«æ”¹å˜ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = &#123; <span class="attr">m</span>: <span class="number">10</span>, <span class="attr">n</span>: <span class="number">20</span> &#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">a</span>) &#123;</span><br><span class="line">  a.<span class="property">m</span> = <span class="number">20</span>;</span><br><span class="line">  <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>(a);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a); <span class="comment">// &#123; m: 20, n: 20 &#125;</span></span><br></pre></td></tr></table></figure><p>æ­£æ˜¯ç”±äºè¿™æ ·çš„ä¸åŒï¼Œå¯¼è‡´äº†è®¸å¤šäººåœ¨ç†è§£å‡½æ•°å‚æ•°çš„ä¼ é€’æ–¹å¼æ—¶ï¼Œå°±æœ‰è®¸å¤šå›°æƒ‘ã€‚åˆ°åº•æ˜¯æŒ‰å€¼ä¼ é€’è¿˜æ˜¯æŒ‰å¼•ç”¨ä¼ é€’ï¼Ÿå®é™…ä¸Šç»“è®ºä»ç„¶æ˜¯æŒ‰å€¼ä¼ é€’ï¼Œåªä¸è¿‡å½“æˆ‘ä»¬æœŸæœ›ä¼ é€’ä¸€ä¸ªå¼•ç”¨ç±»å‹æ—¶ï¼Œ<strong>çœŸæ­£ä¼ é€’çš„ï¼Œåªæ˜¯è¿™ä¸ªå¼•ç”¨ç±»å‹ä¿å­˜åœ¨å˜é‡å¯¹è±¡ä¸­çš„å¼•ç”¨è€Œå·²</strong>ã€‚ä¸ºäº†è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬çœ‹çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Nicholas&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">20</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setName</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="comment">// ä¼ å…¥ä¸€ä¸ªå¼•ç”¨</span></span><br><span class="line">  obj = &#123;&#125;; <span class="comment">// å°†ä¼ å…¥çš„å¼•ç”¨æŒ‡å‘å¦å¤–çš„å€¼</span></span><br><span class="line">  obj.<span class="property">name</span> = <span class="string">&quot;Greg&quot;</span>; <span class="comment">// ä¿®æ”¹å¼•ç”¨çš„nameå±æ€§</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">setName</span>(person);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person.<span class="property">name</span>); <span class="comment">// Nicholas æœªè¢«æ”¹å˜</span></span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¦‚æœ person æ˜¯æŒ‰å¼•ç”¨ä¼ é€’ï¼Œé‚£ä¹ˆ person å°±ä¼šè‡ªåŠ¨è¢«ä¿®æ”¹ä¸ºæŒ‡å‘å…¶ name å±æ€§å€¼ä¸º Gerg çš„æ–°å¯¹è±¡ã€‚ä½†æ˜¯æˆ‘ä»¬ä»ç»“æœä¸­çœ‹åˆ°ï¼Œperson å¯¹è±¡å¹¶æœªå‘ç”Ÿä»»ä½•æ”¹å˜ï¼Œå› æ­¤åªæ˜¯åœ¨å‡½æ•°å†…éƒ¨å¼•ç”¨è¢«ä¿®æ”¹è€Œå·²ã€‚</p><p><img src="https://i.bmp.ovh/imgs/2022/04/04/abde45131e6e2433.png"></p><h3 id="å‡½æ•°å¼ç¼–ç¨‹"><a href="#å‡½æ•°å¼ç¼–ç¨‹" class="headerlink" title="å‡½æ•°å¼ç¼–ç¨‹"></a>å‡½æ•°å¼ç¼–ç¨‹</h3><p>å°è£… â€“ è°ƒç”¨</p><p><strong>å‡½æ•°æ˜¯ç¬¬ä¸€ç­‰å…¬æ°‘</strong>ã€‚æŒ‡çš„æ˜¯å‡½æ•°ä¸å…¶ä»–æ•°æ®ç±»å‹ä¸€æ ·ï¼Œå¤„äºå¹³ç­‰åœ°ä½ï¼Œå¯ä»¥èµ‹å€¼ç»™å…¶ä»–å˜é‡ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå‚æ•°ï¼Œä¼ å…¥å¦ä¸€ä¸ªå‡½æ•°ï¼Œæˆ–è€…ä½œä¸ºåˆ«çš„å‡½æ•°çš„è¿”å›å€¼ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getUser</span>(<span class="params">path, callback</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> $.<span class="title function_">get</span>(path, <span class="keyword">function</span> (<span class="params">info</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">callback</span>(info);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">getUser</span>(<span class="string">&quot;/api/user&quot;</span>, <span class="keyword">function</span> (<span class="params">resp</span>) &#123;</span><br><span class="line">  <span class="comment">// respä¸ºæˆåŠŸè¯·æ±‚ä¹‹åè¿”å›çš„æ•°æ®</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(resp);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¼˜åŒ–ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> getUser = $.<span class="title function_">get</span>(path, callback);</span><br></pre></td></tr></table></figure><p>çº¯å‡½æ•°ï¼šä¸ä¿®æ”¹å‡½æ•°å¤–éƒ¨æ•°æ®</p>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>this</title>
      <link href="/2021/10/17/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E4%B8%83%EF%BC%89this/"/>
      <url>/2021/10/17/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E4%B8%83%EF%BC%89this/</url>
      
        <content type="html"><![CDATA[<h1 id="this"><a href="#this" class="headerlink" title="this"></a>this</h1><p><img src="https://s2.loli.net/2023/03/05/gAQwalibW9X1nK3.webp"></p><p><strong>this çš„æŒ‡å‘ï¼Œæ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™è¢«ç¡®å®šçš„ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œä¸Šä¸‹æ–‡è¢«åˆ›å»ºæ—¶ç¡®å®šçš„</strong></p><p>åŒä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨æ–¹å¼ä¸åŒï¼Œthis æŒ‡å‘ä¹Ÿä¸åŒ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">20</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>(); <span class="comment">// 10 windowè°ƒç”¨</span></span><br><span class="line">fn.<span class="title function_">call</span>(obj); <span class="comment">// 20 callæŒ‡å®šthisä¸ºobj</span></span><br></pre></td></tr></table></figure><p><strong>åœ¨å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œthis ä¸€æ—¦è¢«ç¡®å®šï¼Œå°±ä¸å¯æ›´æ”¹äº†</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">20</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span> = obj; <span class="comment">// è¿™å¥è¯è¯•å›¾ä¿®æ”¹thisï¼Œè¿è¡Œåä¼šæŠ¥é”™</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>();</span><br></pre></td></tr></table></figure><h3 id="å…¨å±€å¯¹è±¡ä¸­çš„-this"><a href="#å…¨å±€å¯¹è±¡ä¸­çš„-this" class="headerlink" title="å…¨å±€å¯¹è±¡ä¸­çš„ this"></a>å…¨å±€å¯¹è±¡ä¸­çš„ this</h3><p>å…¨å±€ç¯å¢ƒä¸­çš„ thisã€‚æŒ‡å‘å®ƒæœ¬èº«</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€šè¿‡thisç»‘å®šåˆ°å…¨å±€å¯¹è±¡</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">a2</span> = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡å£°æ˜ç»‘å®šåˆ°å˜é‡å¯¹è±¡ï¼Œä½†åœ¨å…¨å±€ç¯å¢ƒä¸­ï¼Œå˜é‡å¯¹è±¡å°±æ˜¯å®ƒè‡ªèº«</span></span><br><span class="line"><span class="keyword">var</span> a1 = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»…ä»…åªæœ‰èµ‹å€¼æ“ä½œï¼Œæ ‡è¯†ç¬¦ä¼šéšå¼ç»‘å®šåˆ°å…¨å±€å¯¹è±¡</span></span><br><span class="line">a3 = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºç»“æœä¼šå…¨éƒ¨ç¬¦åˆé¢„æœŸ</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a1);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a2);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a3);</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo03</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">10</span>,</span><br><span class="line">  <span class="attr">c</span>: <span class="variable language_">this</span>.<span class="property">a</span> + <span class="number">20</span>,</span><br><span class="line">  <span class="attr">fn</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">a</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">c</span>); <span class="comment">// 40</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="title function_">fn</span>()); <span class="comment">// 10</span></span><br></pre></td></tr></table></figure><p>åœ¨å‡½æ•°ä¸Šä¸‹æ–‡ä¸­ï¼Œthis ç”±è°ƒç”¨è€…æä¾›ï¼Œç”±è°ƒç”¨å‡½æ•°çš„æ–¹å¼æ¥å†³å®šã€‚<strong>ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå¦‚æœè°ƒç”¨è€…å‡½æ•°ï¼Œè¢«ä¸€ä¸ªå¯¹è±¡æ‰€æ‹¥æœ‰ï¼Œé‚£ä¹ˆè¯¥å‡½æ•°åœ¨è°ƒç”¨æ—¶ï¼Œå†…éƒ¨çš„ this æŒ‡å‘è¯¥å¯¹è±¡ã€‚å¦‚æœå‡½æ•°ç‹¬ç«‹è°ƒç”¨ï¼Œé‚£ä¹ˆè¯¥å‡½æ•°å†…éƒ¨çš„ this æŒ‡å‘ undefinedã€‚ä½†åœ¨éä¸¥æ ¼æ¨¡å¼ï¼Œå½“ this æŒ‡å‘ undefined æ—¶ï¼Œthis ä¼šæŒ‡å‘å…¨å±€å¯¹è±¡</strong></p><p>demo03</p><p>å•ç‹¬çš„<code>&#123;&#125;</code>ä¸ä¼šå½¢æˆæ–°çš„ä½œç”¨åŸŸï¼Œå› æ­¤è¿™é‡Œçš„<code>this.a</code>ï¼Œç”±äºå¹¶æ²¡æœ‰ä½œç”¨åŸŸçš„é™åˆ¶ï¼Œå®ƒä»ç„¶å¤„äºå…¨å±€ä½œç”¨åŸŸä¹‹ä¸­ã€‚æ‰€ä»¥è¿™é‡Œçš„ this å…¶å®æ˜¯æŒ‡å‘çš„ window å¯¹è±¡ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">var</span> obj = &#123;</span><br><span class="line">    <span class="attr">a</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="attr">c</span>: <span class="variable language_">this</span>.<span class="property">a</span> + <span class="number">20</span>,</span><br><span class="line">    <span class="attr">fn</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">a</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">return</span> obj.<span class="property">c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">foo</span>()); <span class="comment">// TypeError: Cannot read properties of undefined (reading &#x27;a&#x27;)</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="title function_">foo</span>()); <span class="comment">// 40</span></span><br></pre></td></tr></table></figure><p>ä¸¥æ ¼æ¨¡å¼ this æŒ‡å‘ undefined</p><p><strong>æ³¨æ„ï¼Œæ— è®ºæ˜¯å¦ä¸¥æ ¼æ¨¡å¼ï¼Œå…¨å±€å£°æ˜çš„å˜é‡éƒ½ä¼šå˜æˆ window å¯¹è±¡ä¸Šçš„å±æ€§</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">var</span> foo = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">10</span>,</span><br><span class="line">  <span class="attr">getA</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">a</span>;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="title function_">getA</span>()); <span class="comment">// 10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> test = foo.<span class="property">getA</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">test</span>()); <span class="comment">// 20</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getA</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">a</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> foo = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">10</span>,</span><br><span class="line">  <span class="attr">getA</span>: getA,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo.<span class="title function_">getA</span>()); <span class="comment">// 10</span></span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-callã€apply-æ˜¾ç¤ºæŒ‡å®š-this"><a href="#ä½¿ç”¨-callã€apply-æ˜¾ç¤ºæŒ‡å®š-this" class="headerlink" title="ä½¿ç”¨ callã€apply æ˜¾ç¤ºæŒ‡å®š this"></a>ä½¿ç”¨ callã€apply æ˜¾ç¤ºæŒ‡å®š this</h3><p><code>function.call(object, params, params, ...)</code></p><p><code>function.apply(object, [params, params, ...])</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">num1, num2</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span> + num1 + num2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">20</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">fn.<span class="title function_">call</span>(obj, <span class="number">100</span>, <span class="number">10</span>); <span class="comment">// 130</span></span><br><span class="line">fn.<span class="title function_">apply</span>(obj, [<span class="number">20</span>, <span class="number">10</span>]); <span class="comment">// 50</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨åœºæ™¯ï¼š</p><h4 id="å°†ç±»æ•°ç»„å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„"><a href="#å°†ç±»æ•°ç»„å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„" class="headerlink" title="å°†ç±»æ•°ç»„å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„"></a>å°†ç±»æ•°ç»„å¯¹è±¡è½¬æ¢ä¸ºæ•°ç»„</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">exam</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> arg = [].<span class="property">slice</span>.<span class="title function_">call</span>(<span class="variable language_">arguments</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(arg);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">exam</span>(<span class="number">2</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line"><span class="comment">// [ 2, 8, 9, 10, 3 ]</span></span><br></pre></td></tr></table></figure><h4 id="æ ¹æ®è‡ªå·±çš„éœ€è¦çµæ´»ä¿®æ”¹-this-æŒ‡å‘"><a href="#æ ¹æ®è‡ªå·±çš„éœ€è¦çµæ´»ä¿®æ”¹-this-æŒ‡å‘" class="headerlink" title="æ ¹æ®è‡ªå·±çš„éœ€è¦çµæ´»ä¿®æ”¹ this æŒ‡å‘"></a>æ ¹æ®è‡ªå·±çš„éœ€è¦çµæ´»ä¿®æ”¹ this æŒ‡å‘</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foo = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;joker&quot;</span>,</span><br><span class="line">  <span class="attr">showName</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">name</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> bar = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;rose&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line">foo.<span class="property">showName</span>.<span class="title function_">call</span>(bar);</span><br></pre></td></tr></table></figure><h4 id="å®ç°ç»§æ‰¿"><a href="#å®ç°ç»§æ‰¿" class="headerlink" title="å®ç°ç»§æ‰¿"></a>å®ç°ç»§æ‰¿</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰çˆ¶çº§çš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Person</span> = <span class="keyword">function</span> (<span class="params">name, age</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">gender</span> = [<span class="string">&quot;man&quot;</span>, <span class="string">&quot;woman&quot;</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å­ç±»çš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Student</span> = <span class="keyword">function</span> (<span class="params">name, age, high</span>) &#123;</span><br><span class="line">  <span class="title class_">Person</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, name, age);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">high</span> = high;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">Student</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">message</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;name:&quot;</span> + <span class="variable language_">this</span>.<span class="property">name</span> + <span class="string">&quot;, age:&quot;</span> + <span class="variable language_">this</span>.<span class="property">age</span> + <span class="string">&quot;, high:&quot;</span> + <span class="variable language_">this</span>.<span class="property">high</span> + <span class="string">&quot;, gender:&quot;</span> + <span class="variable language_">this</span>.<span class="property">gender</span>[<span class="number">0</span>] + <span class="string">&quot;;&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;xiaom&quot;</span>, <span class="number">12</span>, <span class="string">&quot;150cm&quot;</span>).<span class="title function_">message</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// result</span></span><br><span class="line"><span class="comment">// name:xiaom, age:12, high:150cm, gender:man;</span></span><br></pre></td></tr></table></figure><p>åœ¨ Student çš„æ„é€ å‡½æ•°ä¸­ï¼Œå€ŸåŠ© call æ–¹æ³•ï¼Œå°†çˆ¶çº§çš„æ„é€ å‡½æ•°æ‰§è¡Œäº†ä¸€æ¬¡ï¼Œç›¸å½“äºå°† Person ä¸­çš„ä»£ç ï¼Œåœ¨ Sudent ä¸­å¤åˆ¶äº†ä¸€ä»½ï¼Œå…¶ä¸­çš„ this æŒ‡å‘ä¸ºä» Student ä¸­ new å‡ºæ¥çš„å®ä¾‹å¯¹è±¡ã€‚call æ–¹æ³•ä¿è¯äº† this çš„æŒ‡å‘æ­£ç¡®ï¼Œå› æ­¤å°±ç›¸å½“äºå®ç°äº†ç»§æ‰¿ã€‚Student çš„æ„é€ å‡½æ•°ç­‰åŒäºä¸‹ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">Student</span> = <span class="keyword">function</span> (<span class="params">name, age, high</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">gender</span> = [<span class="string">&quot;man&quot;</span>, <span class="string">&quot;woman&quot;</span>];</span><br><span class="line">  <span class="comment">// Person.call(this, name, age); è¿™ä¸€å¥è¯ï¼Œç›¸å½“äºä¸Šé¢ä¸‰å¥è¯ï¼Œå› æ­¤å®ç°äº†ç»§æ‰¿</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">high</span> = high;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="åœ¨å‘å…¶ä»–æ‰§è¡Œä¸Šä¸‹æ–‡çš„ä¼ é€’ä¸­ï¼Œç¡®ä¿-this-çš„æŒ‡å‘ä¿æŒä¸å˜"><a href="#åœ¨å‘å…¶ä»–æ‰§è¡Œä¸Šä¸‹æ–‡çš„ä¼ é€’ä¸­ï¼Œç¡®ä¿-this-çš„æŒ‡å‘ä¿æŒä¸å˜" class="headerlink" title="åœ¨å‘å…¶ä»–æ‰§è¡Œä¸Šä¸‹æ–‡çš„ä¼ é€’ä¸­ï¼Œç¡®ä¿ this çš„æŒ‡å‘ä¿æŒä¸å˜"></a>åœ¨å‘å…¶ä»–æ‰§è¡Œä¸Šä¸‹æ–‡çš„ä¼ é€’ä¸­ï¼Œç¡®ä¿ this çš„æŒ‡å‘ä¿æŒä¸å˜</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">20</span>,</span><br><span class="line">  <span class="attr">getA</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span>);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">obj.<span class="title function_">getA</span>();</span><br></pre></td></tr></table></figure><p>é—­åŒ…ä¸ apply æ–¹æ³•ï¼Œå°è£…ä¸€ä¸ª bind æ–¹æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">bind</span>(<span class="params">fn, obj</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">funcrion</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> fn.<span class="title function_">apply</span>(obj,<span class="variable language_">arguments</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">20</span>,</span><br><span class="line">  <span class="attr">getA</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="title function_">bind</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span>)</span><br><span class="line">    &#125;, <span class="variable language_">this</span>), <span class="number">1000</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">obj.<span class="title function_">getA</span>();</span><br></pre></td></tr></table></figure><p>åŒ ES5 ä¸­çš„ bind æ–¹æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">a</span>: <span class="number">20</span>,</span><br><span class="line">  <span class="attr">getA</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(</span><br><span class="line">      <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">a</span>);</span><br><span class="line">      &#125;.<span class="title function_">bind</span>(<span class="variable language_">this</span>),</span><br><span class="line">      <span class="number">1000</span></span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>ES6 ä¸­ä¹Ÿå¸¸å¸¸ä½¿ç”¨ç®­å¤´å‡½æ•°çš„æ–¹å¼æ¥æ›¿ä»£è¿™ç§æ–¹æ¡ˆ</strong></p><h3 id="æ„é€ å‡½æ•°ä¸åŸå‹æ–¹æ³•ä¸Šçš„-this"><a href="#æ„é€ å‡½æ•°ä¸åŸå‹æ–¹æ³•ä¸Šçš„-this" class="headerlink" title="æ„é€ å‡½æ•°ä¸åŸå‹æ–¹æ³•ä¸Šçš„ this"></a>æ„é€ å‡½æ•°ä¸åŸå‹æ–¹æ³•ä¸Šçš„ this</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œçš„thisæŒ‡å‘äº†è°?</span></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œçš„thisåˆæŒ‡å‘äº†è°ï¼Ÿ</span></span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸Šé¢çš„2ä¸ªthisï¼Œæ˜¯åŒä¸€ä¸ªå—ï¼Œä»–ä»¬æ˜¯å¦æŒ‡å‘äº†åŸå‹å¯¹è±¡ï¼Ÿ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Nick&quot;</span>, <span class="number">20</span>);</span><br><span class="line">p1.<span class="title function_">getName</span>();</span><br></pre></td></tr></table></figure><p>é€šè¿‡ new æ“ä½œç¬¦è°ƒç”¨æ„é€ å‡½æ•°ï¼Œä¼šç»å†ä»¥ä¸‹ 4 ä¸ªé˜¶æ®µã€‚</p><ul><li>åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼›</li><li>å°†æ„é€ å‡½æ•°çš„ this æŒ‡å‘è¿™ä¸ªæ–°å¯¹è±¡ï¼›</li><li>æŒ‡å‘æ„é€ å‡½æ•°çš„ä»£ç ï¼Œä¸ºè¿™ä¸ªå¯¹è±¡æ·»åŠ å±æ€§ï¼Œæ–¹æ³•ç­‰ï¼›</li><li>è¿”å›æ–°å¯¹è±¡ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>setTimeoutä¸å¾ªç¯é—­åŒ…</title>
      <link href="/2021/10/16/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%85%AD%EF%BC%89setTimeout%E4%B8%8E%E5%BE%AA%E7%8E%AF%E9%97%AD%E5%8C%85/"/>
      <url>/2021/10/16/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%85%AD%EF%BC%89setTimeout%E4%B8%8E%E5%BE%AA%E7%8E%AF%E9%97%AD%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<p>æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œé‡‡ç”¨å‡½æ•°è°ƒç”¨æ ˆè¿™ç§ç‰¹æ®Šçš„æ•°æ®ç»“æ„çš„è°ƒç”¨ç‰¹æ€§ã€‚</p><p>setTimeout é‡‡ç”¨é˜Ÿåˆ—ç»“æ„ï¼Œé¡µé¢ä¸­æ‰€æœ‰ç”± setTimeout å®šä¹‰çš„æ“ä½œï¼Œéƒ½å°†æ”¾åœ¨åŒä¸€ä¸ªé˜Ÿåˆ—ä¸­ä¾æ¬¡æ‰§è¡Œã€‚</p><p><img src="https://s2.loli.net/2023/03/05/opT9YwiFQBy1lnG.webp"></p><p>é˜Ÿåˆ—æ‰§è¡Œï¼Œéœ€è¦ç­‰å¾…å‡½æ•°è°ƒç”¨æ ˆæ¸…ç©ºä¹‹åæ‰å¼€å§‹æ‰§è¡Œã€‚å³æ‰€æœ‰å¯æ‰§è¡Œä»£ç æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œæ‰ä¼šå¼€å§‹æ‰§è¡Œç”± setTimeout å®šä¹‰çš„æ“ä½œã€‚è€Œè¿™äº›æ“ä½œè¿›å…¥é˜Ÿåˆ—çš„é¡ºåºï¼Œåˆ™ç”±è®¾å®šçš„å»¶è¿Ÿæ—¶é—´æ¥å†³å®šã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fn);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;setTImeout 10ms.&quot;</span>);</span><br><span class="line">  &#125;, <span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fn.<span class="property">toString</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">30</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fn);</span><br><span class="line"></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;setTimeout 20ms.&quot;</span>);</span><br><span class="line">&#125;, <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>();</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/03/05/hVzmswRqXW4ONy9.webp"></p>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>é—­åŒ…</title>
      <link href="/2021/10/15/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E4%BA%94%EF%BC%89%E9%97%AD%E5%8C%85/"/>
      <url>/2021/10/15/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E4%BA%94%EF%BC%89%E9%97%AD%E5%8C%85/</url>
      
        <content type="html"><![CDATA[<h1 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h1><blockquote><p><strong>é—­åŒ…æ˜¯ä¸€ç§ç‰¹æ®Šå¯¹è±¡</strong></p><p><strong>å®ƒç”±ä¸¤éƒ¨åˆ†ç»„æˆã€‚æ‰§è¡Œä¸Šä¸‹æ–‡ Aï¼Œä»¥åŠ A ä¸­æ‰€åˆ›å»ºçš„å‡½æ•° B</strong></p><p><strong>å½“ B åœ¨æ‰§è¡Œæ—¶ï¼Œè®¿é—®äº† A ä¸­å˜é‡å¯¹è±¡çš„å€¼ï¼Œé—­åŒ…ç”±æ­¤äº§ç”Ÿ</strong></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo01</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">20</span>;</span><br><span class="line">  <span class="keyword">var</span> b = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">bar</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> bar;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bar = <span class="title function_">foo</span>();</span><br><span class="line"><span class="title function_">bar</span>();</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¾‹å­ï¼Œé¦–å…ˆæœ‰æ‰§è¡Œä¸Šä¸‹æ–‡ fooï¼Œåœ¨ foo ä¸­å®šä¹‰äº†å‡½æ•° barï¼Œè€Œé€šè¿‡å¯¹å¤–è¿”å› bar çš„æ–¹å¼è®© bar å¾—ä»¥æ‰§è¡Œã€‚å½“ bar æ‰§è¡Œæ—¶ï¼Œè®¿é—®äº† foo å†…éƒ¨çš„å˜é‡ aï¼Œbã€‚å› æ­¤è¿™ä¸ªæ—¶å€™é—­åŒ…äº§ç”Ÿã€‚</p><p>é—­åŒ…çš„äº§ç”Ÿï¼Œå¯¼è‡´å¼•ç”¨å§‹ç»ˆå­˜åœ¨ï¼Œä¼šé˜»æ­¢ JavaScript åƒåœ¾å›æ”¶ï¼Œå»¶é•¿å˜é‡çš„ç”Ÿå‘½å‘¨æœŸ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fn = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">innnerFoo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">  &#125;</span><br><span class="line">  fn = innnerFoo; <span class="comment">// å°† innnerFooçš„å¼•ç”¨ï¼Œèµ‹å€¼ç»™å…¨å±€å˜é‡ä¸­çš„fn</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bar</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">fn</span>(); <span class="comment">// æ­¤å¤„çš„ä¿ç•™çš„innerFooçš„å¼•ç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>();</span><br><span class="line"><span class="title function_">bar</span>(); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure><p>é—­åŒ… foo çš„ä½œç”¨åŸŸé“¾ï¼š</p><p><img src="https://s2.loli.net/2023/03/05/di1xyfKZC9YDS3M.webp"></p><p><strong>é€šè¿‡é—­åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶ä»–çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ï¼Œè®¿é—®åˆ°å‡½æ•°å†…éƒ¨çš„å˜é‡ï¼Œä½†æ˜¯é—­åŒ…çš„ä½œç”¨åŸŸå¹¶ä¸ä¼šå‘ç”Ÿå˜åŒ–</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fn = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">innnerFoo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(c); <span class="comment">// åœ¨è¿™é‡Œï¼Œè¯•å›¾è®¿é—®å‡½æ•°barä¸­çš„cå˜é‡ï¼Œä¼šæŠ›å‡ºé”™è¯¯</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">  &#125;</span><br><span class="line">  fn = innnerFoo; <span class="comment">// å°† innnerFooçš„å¼•ç”¨ï¼Œèµ‹å€¼ç»™å…¨å±€å˜é‡ä¸­çš„fn</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bar</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> c = <span class="number">100</span>;</span><br><span class="line">  <span class="title function_">fn</span>(); <span class="comment">// æ­¤å¤„çš„ä¿ç•™çš„innerFooçš„å¼•ç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">foo</span>();</span><br><span class="line"><span class="title function_">bar</span>();</span><br></pre></td></tr></table></figure><h3 id="é—­åŒ…çš„åº”ç”¨åœºæ™¯"><a href="#é—­åŒ…çš„åº”ç”¨åœºæ™¯" class="headerlink" title="é—­åŒ…çš„åº”ç”¨åœºæ™¯"></a>é—­åŒ…çš„åº”ç”¨åœºæ™¯</h3><ul><li><p><strong>æŸ¯é‡ŒåŒ–</strong></p></li><li><p><strong>æ¨¡å—åŒ–</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">(function () &#123;</span><br><span class="line">  var a = 10;</span><br><span class="line">  var b = 20;</span><br><span class="line"></span><br><span class="line">  function add(num1, num2) &#123;</span><br><span class="line">    var num1 = !!num1 ? num1 : a;</span><br><span class="line">    var num2 = !!num2 ? num2 : b;</span><br><span class="line"></span><br><span class="line">    return num1 + num2;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  window.add = add;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">add(10, 20);</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/03/05/pyT9x17QY3JRcEI.webp"></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾</title>
      <link href="/2021/10/15/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE/"/>
      <url>/2021/10/15/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E5%9B%9B%EF%BC%89%E4%BD%9C%E7%94%A8%E5%9F%9F%E4%B8%8E%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE/</url>
      
        <content type="html"><![CDATA[<h1 id="ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾"><a href="#ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾" class="headerlink" title="ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾"></a>ä½œç”¨åŸŸä¸ä½œç”¨åŸŸé“¾</h1><h3 id="è¯æ³•ç¯å¢ƒï¼ˆLexical-Environmentsï¼‰"><a href="#è¯æ³•ç¯å¢ƒï¼ˆLexical-Environmentsï¼‰" class="headerlink" title="è¯æ³•ç¯å¢ƒï¼ˆLexical Environmentsï¼‰"></a>è¯æ³•ç¯å¢ƒï¼ˆLexical Environmentsï¼‰</h3><blockquote><p>å®˜æ–¹è§„èŒƒè¯´æ˜ï¼šè¯æ³•ç¯å¢ƒæ˜¯ä¸€ç§è§„èŒƒç±»å‹ï¼Œç”¨äºæ ¹æ® ECMAScript ä»£ç çš„è¯æ³•åµŒå¥—ç»“æ„æ¥å®šä¹‰æ ‡è¯†ç¬¦ä¸ç‰¹å®šå˜é‡å’Œå‡½æ•°çš„å…³è”ã€‚</p></blockquote><p>é€šä¿—æ¥è¯´ï¼Œè¯æ³•ç¯å¢ƒå°±æ˜¯ä¸€å¥—çº¦å®šå¥½çš„è§„åˆ™ã€‚æˆ‘ä»¬å†™ä»£ç ï¼Œåº”è¯¥æŒ‰ç…§è¿™ä¸ªè§„åˆ™æ¥ã€‚JS å¼•æ“å¯¹ JS æºç è¿›è¡Œè¯æ³•åˆ†æï¼Œä¹Ÿæ˜¯æŒ‰ç…§è¿™ä¸ªè§„åˆ™æ¥ã€‚</p><p><strong>è¯æ³•ç¯å¢ƒï¼Œå…¶å®å°±æ˜¯ä½œç”¨åŸŸ</strong></p><p>ç»“è®ºï¼š</p><p>ä¸€ã€åœ¨ JavaScript ä¸­ï¼Œå¯ä»¥å°†ä½œç”¨åŸŸå®šä¹‰ä¸º<strong>ä¸€å¥—è§„åˆ™</strong>ï¼Œè¿™å¥—è§„åˆ™ç”¨æ¥ç®¡ç† JS å¼•æ“å¦‚ä½•åœ¨<strong>ä½œç”¨åŸŸä»¥åŠåµŒå¥—çš„å­ä½œç”¨åŸŸ</strong>ä¸­æ ¹æ®<strong>æ ‡è¯†ç¬¦å</strong>è¿›è¡Œ<strong>å˜é‡æŸ¥æ‰¾</strong></p><blockquote><p>è¿™é‡Œçš„æ ‡è¯†ç¬¦ï¼ŒæŒ‡çš„æ˜¯å˜é‡åæˆ–è€…å‡½æ•°å</p></blockquote><h3 id="ä½œç”¨åŸŸé“¾"><a href="#ä½œç”¨åŸŸé“¾" class="headerlink" title="ä½œç”¨åŸŸé“¾"></a>ä½œç”¨åŸŸé“¾</h3><p>ä½œç”¨åŸŸå’Œä½œç”¨åŸŸé“¾ä¸åŒ</p><p>ä½œç”¨åŸŸæ˜¯ä¸€å¥—è§„åˆ™</p><p>ä½œç”¨åŸŸé“¾æ˜¯ä½œç”¨åŸŸçš„å…·ä½“å®ç°</p><p><strong>ä½œç”¨åŸŸé“¾ï¼Œæ˜¯ç”±å½“å‰ç¯å¢ƒä¸ä¸Šå±‚ç¯å¢ƒçš„ä¸€ç³»åˆ—å˜é‡å¯¹è±¡ç»„æˆï¼Œä¿è¯äº†å½“å‰ç¯å¢ƒå¯¹ç¬¦åˆè®¿é—®æƒé™çš„å˜é‡å’Œå‡½æ•°çš„æœ‰åºè®¿é—®ã€‚</strong></p><p>ä½œç”¨åŸŸé“¾ï¼Œåœ¨å‡½æ•°å£°æ˜é˜¶æ®µç¡®è®¤ã€‚å¦‚æœè¦ç»“åˆ JavaScript å¼•æ“æ¥ç†è§£çš„è¯ï¼Œä½œç”¨åŸŸé“¾ï¼Œæ˜¯åœ¨ä»£ç è§£æé˜¶æ®µç¡®è®¤çš„ã€‚</p><p>æ —å­</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">var a = 20;</span><br><span class="line"></span><br><span class="line">function test() &#123;</span><br><span class="line">  var b = a + 10;</span><br><span class="line"></span><br><span class="line">  function innerTest() &#123;</span><br><span class="line">    var c = 10;</span><br><span class="line">    return b + c;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  return innerTest();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test();</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å˜é‡å¯¹è±¡</title>
      <link href="/2021/10/14/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E4%B8%89%EF%BC%89%E5%8F%98%E9%87%8F%E5%AF%B9%E8%B1%A1/"/>
      <url>/2021/10/14/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E4%B8%89%EF%BC%89%E5%8F%98%E9%87%8F%E5%AF%B9%E8%B1%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="å˜é‡å¯¹è±¡"><a href="#å˜é‡å¯¹è±¡" class="headerlink" title="å˜é‡å¯¹è±¡"></a>å˜é‡å¯¹è±¡</h1><h3 id="æ‰§è¡Œä¸Šä¸‹æ–‡ç”Ÿå‘½å‘¨æœŸ"><a href="#æ‰§è¡Œä¸Šä¸‹æ–‡ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="æ‰§è¡Œä¸Šä¸‹æ–‡ç”Ÿå‘½å‘¨æœŸ"></a>æ‰§è¡Œä¸Šä¸‹æ–‡ç”Ÿå‘½å‘¨æœŸ</h3><ul><li><p><strong>åˆ›å»ºé˜¶æ®µ</strong></p><p>æ‰§è¡Œä¸Šä¸‹æ–‡åˆ›å»ºå˜é‡å¯¹è±¡ï¼Œç¡®å®š this æŒ‡å‘ï¼Œä»¥åŠå…¶ä»–æ‰€è¦ç¡®å®šçš„çŠ¶æ€</p></li><li><p><strong>ä»£ç æ‰§è¡Œé˜¶æ®µ</strong></p><p>å¼€å§‹æ‰§è¡Œä»£ç ï¼Œå®Œæˆå˜é‡èµ‹å€¼ï¼Œä»¥åŠæ‰§è¡Œå…¶ä»–ä»£ç </p></li><li><p><strong>é”€æ¯é˜¶æ®µ</strong></p><p>å¯æ‰§è¡Œä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡å‡ºæ ˆï¼Œå¯¹åº”å†…å­˜ç©ºé—´å¤±å»å¼•ç”¨ï¼Œç­‰å¾…è¢«å›æ”¶</p></li></ul><h3 id="å˜é‡å¯¹è±¡-VO"><a href="#å˜é‡å¯¹è±¡-VO" class="headerlink" title="å˜é‡å¯¹è±¡ VO"></a>å˜é‡å¯¹è±¡ VO</h3><ul><li><p><strong>å»ºç«‹ arguments å¯¹è±¡</strong></p><p>æ£€æŸ¥å½“å‰ä¸Šä¸‹æ–‡ä¸­çš„å‚æ•°ï¼Œå»ºç«‹è¯¥å¯¹è±¡ä¸‹çš„å±æ€§ä¸å±æ€§å€¼</p><blockquote><p><strong>å‡½æ•°å‚æ•°</strong></p></blockquote></li><li><p><strong>æ£€æŸ¥å‡½æ•°å£°æ˜</strong></p><p>åœ¨å˜é‡å¯¹è±¡ä¸­ä»¥å‡½æ•°åå»ºç«‹ä¸€ä¸ªå±æ€§ï¼Œå±æ€§å€¼ä¸ºæŒ‡å‘è¯¥å‡½æ•°æ‰€åœ¨å†…å­˜åœ°å€çš„å¼•ç”¨</p></li><li><p><strong>æ£€æŸ¥å˜é‡å£°æ˜</strong></p><p>æ¯æ‰¾åˆ°ä¸€ä¸ªå˜é‡å£°æ˜ï¼Œå°±åœ¨å˜é‡å¯¹è±¡ä¸­ä»¥å˜é‡åå»ºç«‹ä¸€ä¸ªå±æ€§ï¼Œå±æ€§å€¼ä¸º undefinedï¼Œconst&#x2F;let å£°æ˜çš„å˜é‡æ²¡æœ‰èµ‹å€¼ï¼Œä¸èƒ½æå‰ä½¿ç”¨</p><blockquote><p>å¦‚æœ var å˜é‡ä¸å‡½æ•°åŒåï¼Œåˆ™åœ¨è¿™ä¸ªé˜¶æ®µï¼Œä»¥å‡½æ•°å€¼ä¸ºå‡†ï¼Œåœ¨ä¸‹ä¸€ä¸ªé˜¶æ®µ[<strong>æ‰§è¡Œ</strong>]ï¼Œå‡½æ•°å€¼ä¼šè¢«å˜é‡å€¼è¦†ç›–ã€‚ï¼ˆå‡½æ•°å£°æ˜çš„ä¼˜å…ˆçº§é«˜äºå˜é‡å£°æ˜ï¼‰</p></blockquote></li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo); <span class="comment">// function foo</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;function foo&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> foo = <span class="number">20</span>;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸Šæ —çš„æ‰§è¡Œé¡ºåºä¸º</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é¦–å…ˆå°†æ‰€æœ‰å‡½æ•°å£°æ˜æ”¾å…¥å˜é‡å¯¹è±¡ä¸­</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;function foo&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¶æ¬¡å°†æ‰€æœ‰å˜é‡å£°æ˜æ”¾å…¥å˜é‡å¯¹è±¡ä¸­ï¼Œä½†æ˜¯å› ä¸ºfooå·²ç»å­˜åœ¨åŒåå‡½æ•°ï¼Œæ­¤æ—¶ä»¥å‡½æ•°å€¼ä¸ºå‡†ï¼Œè€Œä¸ä¼šè¢«undefinedè¦†ç›–</span></span><br><span class="line"><span class="comment">// var foo = undefined;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç„¶åå¼€å§‹æ‰§è¡Œé˜¶æ®µä»£ç çš„æ‰§è¡Œ</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(foo); <span class="comment">// function foo</span></span><br><span class="line">foo = <span class="number">20</span>;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2023/03/05/9qUB3izpGeWQ4jV.webp" alt="J7ADX.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// demo01</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">foo</span>());</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>();</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºè¿‡ç¨‹</span></span><br><span class="line">testEC = &#123;</span><br><span class="line">    <span class="comment">// å˜é‡å¯¹è±¡</span></span><br><span class="line">    <span class="attr">VO</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">scopeChain</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å› ä¸ºæœ¬æ–‡æš‚æ—¶ä¸è¯¦ç»†è§£é‡Šä½œç”¨åŸŸé“¾ï¼Œæ‰€ä»¥æŠŠå˜é‡å¯¹è±¡ä¸“é—¨æå‡ºæ¥è¯´æ˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// VO ä¸º Variable Objectçš„ç¼©å†™ï¼Œå³å˜é‡å¯¹è±¡</span></span><br><span class="line"><span class="variable constant_">VO</span> = &#123;</span><br><span class="line">    <span class="attr">arguments</span>: &#123;...&#125;,  <span class="comment">//æ³¨ï¼šåœ¨æµè§ˆå™¨çš„å±•ç¤ºä¸­ï¼Œå‡½æ•°çš„å‚æ•°å¯èƒ½å¹¶ä¸æ˜¯æ”¾åœ¨argumentså¯¹è±¡ä¸­ï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œæˆ‘åšäº†è¿™æ ·çš„å¤„ç†</span></span><br><span class="line">    <span class="attr">foo</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">foo</span> <span class="attr">reference</span>&gt;</span>  // è¡¨ç¤ºfooçš„åœ°å€å¼•ç”¨</span></span><br><span class="line"><span class="language-xml">    a: undefined</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="æ´»åŠ¨å¯¹è±¡-AO"><a href="#æ´»åŠ¨å¯¹è±¡-AO" class="headerlink" title="æ´»åŠ¨å¯¹è±¡ AO"></a>æ´»åŠ¨å¯¹è±¡ AO</h3><p><strong>æœªè¿›å…¥æ‰§è¡Œé˜¶æ®µä¹‹å‰ï¼Œå˜é‡å¯¹è±¡ä¸­çš„å±æ€§éƒ½ä¸èƒ½è®¿é—®ï¼</strong></p><p>ä½†æ˜¯è¿›å…¥æ‰§è¡Œé˜¶æ®µä¹‹åï¼Œå˜é‡å¯¹è±¡è½¬å˜ä¸ºäº†æ´»åŠ¨å¯¹è±¡ï¼Œé‡Œé¢çš„å±æ€§éƒ½èƒ½è¢«è®¿é—®äº†ï¼Œç„¶åå¼€å§‹è¿›è¡Œæ‰§è¡Œé˜¶æ®µçš„æ“ä½œã€‚</p><blockquote><p>å˜é‡å¯¹è±¡å’Œæ´»åŠ¨å¯¹è±¡ä»–ä»¬å…¶å®éƒ½æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œåªæ˜¯å¤„äºæ‰§è¡Œä¸Šä¸‹æ–‡çš„ä¸åŒç”Ÿå‘½å‘¨æœŸã€‚ä¸è¿‡åªæœ‰å¤„äºå‡½æ•°è°ƒç”¨æ ˆæ ˆé¡¶çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„å˜é‡å¯¹è±¡ï¼Œæ‰ä¼šå˜æˆæ´»åŠ¨å¯¹è±¡ã€‚</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‰§è¡Œé˜¶æ®µ</span></span><br><span class="line"><span class="variable constant_">VO</span> -&gt;  <span class="variable constant_">AO</span>   <span class="comment">// Active Object</span></span><br><span class="line"><span class="variable constant_">AO</span> = &#123;</span><br><span class="line">    <span class="attr">arguments</span>: &#123;...&#125;,</span><br><span class="line">    <span class="attr">foo</span>: <span class="language-xml"><span class="tag">&lt;<span class="name">foo</span> <span class="attr">reference</span>&gt;</span>,</span></span><br><span class="line"><span class="language-xml">    a: 1,</span></span><br><span class="line"><span class="language-xml">    this: Window</span></span><br><span class="line"><span class="language-xml">&#125;</span></span><br></pre></td></tr></table></figure><p>demo1 æ‰§è¡Œé¡ºåºï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> a;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">foo</span>());</span><br><span class="line">  a = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">test</span>();</span><br></pre></td></tr></table></figure><h3 id="å…¨å±€ä¸Šä¸‹æ–‡çš„å˜é‡å¯¹è±¡"><a href="#å…¨å±€ä¸Šä¸‹æ–‡çš„å˜é‡å¯¹è±¡" class="headerlink" title="å…¨å±€ä¸Šä¸‹æ–‡çš„å˜é‡å¯¹è±¡"></a>å…¨å±€ä¸Šä¸‹æ–‡çš„å˜é‡å¯¹è±¡</h3><p>å…¨å±€ä¸Šä¸‹æ–‡æœ‰ä¸€ä¸ªç‰¹æ®Šçš„åœ°æ–¹ï¼Œå®ƒçš„å˜é‡å¯¹è±¡ï¼Œå°±æ˜¯ window å¯¹è±¡ã€‚è€Œè¿™ä¸ªç‰¹æ®Šï¼Œåœ¨ this æŒ‡å‘ä¸Šä¹ŸåŒæ ·é€‚ç”¨ï¼Œthis ä¹Ÿæ˜¯æŒ‡å‘ windowã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä»¥æµè§ˆå™¨ä¸­ä¸ºä¾‹ï¼Œå…¨å±€å¯¹è±¡ä¸ºwindow</span></span><br><span class="line"><span class="comment">// å…¨å±€ä¸Šä¸‹æ–‡</span></span><br><span class="line">windowEC = &#123;</span><br><span class="line">  <span class="attr">VO</span>: <span class="title class_">Window</span>,</span><br><span class="line">  <span class="attr">scopeChain</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">this</span>: <span class="title class_">Window</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="let-x2F-const"><a href="#let-x2F-const" class="headerlink" title="let&#x2F;const"></a>let&#x2F;const</h3><p><strong>let&#x2F;const å£°æ˜çš„å˜é‡ï¼Œæ˜¯å¦è¿˜ä¼šå˜é‡æå‡ï¼Ÿ</strong></p><p>ç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬ç›´æ¥ä½¿ç”¨ä¸€ä¸ªæœªå®šä¹‰çš„å˜é‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br></pre></td></tr></table></figure><p>æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2023/03/05/ajqSVy6FIt4TEXl.webp" alt="J7cL0.png"></p><p>ç¬¬äºŒæ­¥ï¼Œæˆ‘ä»¬åœ¨ let ä¹‹å‰è°ƒç”¨å˜é‡</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a);</span><br><span class="line"><span class="keyword">let</span> a = <span class="number">10</span>;</span><br></pre></td></tr></table></figure><p>æŠ¥é”™ä¿¡æ¯å¦‚ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2023/03/05/OiKbLBcafvVIgjz.webp" alt="J7Yvv.png"></p><p><strong>ä¸èƒ½åœ¨åˆå§‹åŒ–ä¹‹å‰è®¿é—® a</strong></p><blockquote><p>let&#x2F;const å£°æ˜çš„å˜é‡ï¼Œä»ç„¶ä¼šæå‰è¢«æ”¶é›†åˆ°å˜é‡å¯¹è±¡ä¸­ï¼Œä½†å’Œ var ä¸åŒçš„æ˜¯ï¼Œlet&#x2F;const å®šä¹‰çš„å˜é‡ï¼Œä¸ä¼šåœ¨è¿™ä¸ªæ—¶å€™ç»™ä»–èµ‹å€¼ undefinedã€‚</p><p>å› ä¸ºå®Œå…¨æ²¡æœ‰èµ‹å€¼ï¼Œå³ä½¿å˜é‡æå‡äº†ï¼Œæˆ‘ä»¬ä¹Ÿä¸èƒ½åœ¨èµ‹å€¼ä¹‹å‰è°ƒç”¨ä»–ã€‚è¿™å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„<strong>æš‚æ—¶æ€§æ­»åŒº</strong>ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ‰§è¡Œä¸Šä¸‹æ–‡è¯¦ç»†å›¾è§£</title>
      <link href="/2021/10/13/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E4%BA%8C%EF%BC%89%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87%E8%AF%A6%E7%BB%86%E5%9B%BE%E8%A7%A3/"/>
      <url>/2021/10/13/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E4%BA%8C%EF%BC%89%E6%89%A7%E8%A1%8C%E4%B8%8A%E4%B8%8B%E6%96%87%E8%AF%A6%E7%BB%86%E5%9B%BE%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="æ‰§è¡Œä¸Šä¸‹æ–‡"><a href="#æ‰§è¡Œä¸Šä¸‹æ–‡" class="headerlink" title="æ‰§è¡Œä¸Šä¸‹æ–‡"></a>æ‰§è¡Œä¸Šä¸‹æ–‡</h1><p><strong>æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆExecution Contextï¼‰</strong>ï¼šæ¯æ¬¡å½“æ§åˆ¶å™¨è½¬åˆ°<strong>å¯æ‰§è¡Œ</strong>ä»£ç çš„æ—¶å€™ï¼Œå°±ä¼šè¿›å…¥ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ã€‚æ‰§è¡Œä¸Šä¸‹æ–‡å¯ä»¥ç†è§£æˆä»£ç çš„<strong>æ‰§è¡Œç¯å¢ƒ</strong>ï¼Œä¼šå½¢æˆ<strong>ä½œç”¨åŸŸ</strong>ã€‚JavaScript ä¸­çš„ä¸‰å¤§ è¿è¡Œç¯å¢ƒå¤§æ¦‚åŒ…æ‹¬ä¸‰ç§æƒ…å†µã€‚</p><ul><li><strong>å…¨å±€ç¯å¢ƒ</strong>ï¼šJavaScript ä»£ç è¿è¡Œèµ·æ¥é¦–å…ˆè¿›å…¥çš„ç¯å¢ƒ</li><li><strong>å‡½æ•°ç¯å¢ƒ</strong>ï¼šå½“å‡½æ•°è¢«è°ƒç”¨æ‰§è¡Œæ—¶ï¼Œä¼šè¿›å…¥å½“å‰å‡½æ•°ä¸­çš„æ‰§è¡Œä»£ç </li><li>evalï¼ˆä¸è¦å»ºè®®ä½¿ç”¨ï¼Œå¯å¿½ç•¥ï¼‰</li></ul><p>ä¸€ä¸ª JavaScript ç¨‹åºä¸­ä¼šäº§ç”Ÿå¤šä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ï¼ŒJavaScript å¼•æ“ä»¥<strong>æ ˆ</strong>çš„å½¢å¼æ¥å¤„ç†ä»–ä»¬ã€‚è¿™ä¸ªæ ˆï¼Œæˆ‘ä»¬ç§°å…¶ä¸º<strong>å‡½æ•°è°ƒç”¨æ ˆ</strong>ï¼ˆcall stackï¼‰<strong>æ ˆåº•æ°¸è¿œéƒ½æ˜¯å…¨å±€ä¸Šä¸‹æ–‡ï¼Œè€Œæ ˆé¡¶å°±æ˜¯å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä¸Šä¸‹æ–‡</strong>ã€‚</p><p>ä»£ç æ‰§è¡Œè¿‡ç¨‹ï¼šç”Ÿæˆæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå…¥æ ˆï¼Œå¤„äºæ ˆé¡¶çš„ä¸Šä¸‹æ–‡æ‰§è¡Œå®Œæ¯•åï¼Œè‡ªåŠ¨å‡ºæ ˆ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> color = <span class="string">&quot;blue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">changeColor</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> anotherColor = <span class="string">&quot;red&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">swapColors</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> tempColor = anotherColor;</span><br><span class="line">    anotherColor = color;</span><br><span class="line">    color = tempColor;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">swapColors</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">changeColor</span>();</span><br></pre></td></tr></table></figure><p><strong>æ‰§è¡Œä¸Šä¸‹æ–‡æ€»ç»“</strong></p><ul><li>å•çº¿ç¨‹</li><li>åŒæ­¥æ‰§è¡Œï¼Œåªæœ‰æ ˆé¡¶çš„ä¸Šä¸‹æ–‡å¤„äºæ‰§è¡Œä¸­ï¼Œå…¶ä»–ä¸Šä¸‹æ–‡éœ€è¦ç­‰å¾…</li><li>å…¨å±€ä¸Šä¸‹æ–‡åªæœ‰å”¯ä¸€çš„ä¸€ä¸ªï¼Œå®ƒåœ¨æµè§ˆå™¨å…³é—­æ—¶å‡ºæ ˆ</li><li>å‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡çš„ä¸ªæ•°æ²¡æœ‰é™åˆ¶</li><li>æ¯æ¬¡æŸä¸ªå‡½æ•°è¢«è°ƒç”¨ï¼Œå°±ä¼šæœ‰ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸ºå…¶åˆ›å»ºï¼Œå³ä½¿æ˜¯è°ƒç”¨çš„è‡ªèº«å‡½æ•°ï¼Œä¹Ÿæ˜¯å¦‚æ­¤ã€‚</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">f1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> n = <span class="number">999</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">f2</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(n);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> f2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> result = <span class="title function_">f1</span>();</span><br><span class="line"><span class="title function_">result</span>(); <span class="comment">// 999</span></span><br></pre></td></tr></table></figure><p>å› ä¸º f1 ä¸­çš„å‡½æ•° f2 åœ¨ f1 çš„å¯æ‰§è¡Œä»£ç ä¸­ï¼Œå¹¶æ²¡æœ‰è¢«è°ƒç”¨æ‰§è¡Œï¼Œå› æ­¤æ‰§è¡Œ f1 æ—¶ï¼Œf2 ä¸ä¼šåˆ›å»ºæ–°çš„ä¸Šä¸‹æ–‡ï¼Œè€Œç›´åˆ° result æ‰§è¡Œæ—¶ï¼Œæ‰åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ã€‚å…·ä½“æ¼”å˜è¿‡ç¨‹å¦‚ä¸‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å†…å­˜ç©ºé—´è¯¦ç»†å›¾è§£</title>
      <link href="/2021/10/12/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E4%B8%80%EF%BC%89%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4%E8%AF%A6%E7%BB%86%E5%9B%BE%E8%A7%A3/"/>
      <url>/2021/10/12/JS/%E6%A0%B8%E5%BF%83/%EF%BC%88%E4%B8%80%EF%BC%89%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4%E8%AF%A6%E7%BB%86%E5%9B%BE%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h1 id="å†…å­˜ç©ºé—´è¯¦ç»†å›¾è§£"><a href="#å†…å­˜ç©ºé—´è¯¦ç»†å›¾è§£" class="headerlink" title="å†…å­˜ç©ºé—´è¯¦ç»†å›¾è§£"></a>å†…å­˜ç©ºé—´è¯¦ç»†å›¾è§£</h1><p>JavaScript å…·æœ‰è‡ªåŠ¨åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œå‘¨æœŸæ€§è¿è¡Œï¼Œè¿›è¡Œå›æ”¶å†…å­˜ç©ºé—´ä¸­ä¸åœ¨è¢«ä½¿ç”¨çš„å˜é‡ä»¥åŠèµ„æº</p><p>å†…å­˜ç©ºé—´ å…³ç³»ç€ <strong>å¼•ç”¨æ•°æ®ç±»å‹ã€å¼•ç”¨ä¼ é€’ã€æµ…å¤åˆ¶ã€æ·±å¤åˆ¶ä»¥åŠé—­åŒ…ç­‰ç­‰</strong></p><p>è¯´åˆ°å†…å­˜å¿…è¦æåŠçš„ä¾¿æ˜¯ ä¸‰ç§æ•°æ®ç»“æ„ <strong>æ ˆï¼ˆstackï¼‰ã€é˜Ÿåˆ—ï¼ˆqueueï¼‰ã€å †ï¼ˆheapï¼‰</strong></p><h3 id="ä¸€ã€æ ˆ"><a href="#ä¸€ã€æ ˆ" class="headerlink" title="ä¸€ã€æ ˆ"></a>ä¸€ã€æ ˆ</h3><p>JavaScript ä¸­æ²¡æœ‰ä¸¥æ ¼æ„ä¹‰ä¸ŠåŒºåˆ†<strong>æ ˆå†…å­˜</strong>å’Œ<strong>å †å†…å­˜</strong></p><blockquote><p>æ ˆå†…å­˜ç»´æŠ¤<strong>åŸºç¡€æ•°æ®ç±»å‹</strong>ï¼Œå †å†…å­˜ç»´æŠ¤<strong>å¼•ç”¨æ•°æ®ç±»å‹</strong></p><p>æ ˆå†…å­˜æ˜¯ä»<strong>åœ°å€é«˜ä½</strong>å¼€å§‹åˆ†é…ï¼Œå †å†…å­˜ä»<strong>åœ°å€ä½ä½</strong>å¼€å§‹åˆ†é…</p></blockquote><p>JavaScript çš„æ‰§è¡Œä¸Šä¸‹æ–‡çš„æ‰§è¡Œé¡ºåºå€Ÿç”¨äº†æ ˆæ•°æ®ç»“æ„çš„å­˜å–æ–¹å¼ï¼ˆå‡½æ•°è°ƒç”¨æ ˆï¼‰</p><p><strong>å…ˆè¿›åå‡º</strong></p><h3 id="äºŒã€å †"><a href="#äºŒã€å †" class="headerlink" title="äºŒã€å †"></a>äºŒã€å †</h3><p><strong>æ ‘çŠ¶ç»“æ„</strong></p><h3 id="ä¸‰ã€é˜Ÿåˆ—"><a href="#ä¸‰ã€é˜Ÿåˆ—" class="headerlink" title="ä¸‰ã€é˜Ÿåˆ—"></a>ä¸‰ã€é˜Ÿåˆ—</h3><p><strong>å…ˆè¿›å…ˆå‡º</strong></p><p>äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰</p><h3 id="å››ã€å˜é‡å¯¹è±¡ï¼ˆç¯å¢ƒè®°å½•å¯¹è±¡ï¼‰"><a href="#å››ã€å˜é‡å¯¹è±¡ï¼ˆç¯å¢ƒè®°å½•å¯¹è±¡ï¼‰" class="headerlink" title="å››ã€å˜é‡å¯¹è±¡ï¼ˆç¯å¢ƒè®°å½•å¯¹è±¡ï¼‰"></a>å››ã€å˜é‡å¯¹è±¡ï¼ˆç¯å¢ƒè®°å½•å¯¹è±¡ï¼‰</h3><p>JavaScript çš„æ‰§è¡Œä¸Šä¸‹æ–‡ç”Ÿæˆä¹‹åï¼Œä¼šåˆ›å»ºä¸€ä¸ªå«åšå˜é‡å¯¹è±¡çš„ç‰¹æ®Šå¯¹è±¡ï¼Œå›Šæ‹¬ä¸Šä¸‹æ–‡ä¸­æ‰€æœ‰çš„å˜é‡ä»¥åŠå‡½æ•°</p><h3 id="äº”ã€å¼•ç”¨æ•°æ®ç±»å‹ä¸å †å†…å­˜"><a href="#äº”ã€å¼•ç”¨æ•°æ®ç±»å‹ä¸å †å†…å­˜" class="headerlink" title="äº”ã€å¼•ç”¨æ•°æ®ç±»å‹ä¸å †å†…å­˜"></a>äº”ã€å¼•ç”¨æ•°æ®ç±»å‹ä¸å †å†…å­˜</h3><p>ä¾‹å¦‚ä¸€äº› æ•°ç»„ã€å¯¹è±¡ç±»å‹çš„å˜é‡ åœ¨ å˜é‡å¯¹è±¡ ä¸­ä»¥åœ°å€ï¼ˆæ¨å†…å­˜ä¸­å®é™…å­˜å‚¨åœ°å€ï¼‰çš„å½¢ä¿å­˜</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a1 = <span class="number">0</span>; <span class="comment">// å˜é‡å¯¹è±¡</span></span><br><span class="line"><span class="keyword">var</span> a2 = <span class="string">&quot;this is string&quot;</span>; <span class="comment">// å˜é‡å¯¹è±¡</span></span><br><span class="line"><span class="keyword">var</span> a3 = <span class="literal">null</span>; <span class="comment">// å˜é‡å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = &#123; <span class="attr">m</span>: <span class="number">20</span> &#125;; <span class="comment">// å˜é‡bå­˜åœ¨äºå˜é‡å¯¹è±¡ä¸­ï¼Œ&#123;m: 20&#125; ä½œä¸ºå¯¹è±¡å­˜åœ¨äºå †å†…å­˜ä¸­</span></span><br><span class="line"><span class="keyword">var</span> c = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]; <span class="comment">// å˜é‡cå­˜åœ¨äºå˜é‡å¯¹è±¡ä¸­ï¼Œ[1, 2, 3] ä½œä¸ºå¯¹è±¡å­˜åœ¨äºå †å†…å­˜ä¸­</span></span><br></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬å»è®¿é—®å¼•ç”¨æ•°æ®ç±»å‹æ—¶ï¼Œå®é™…ä¸Šæ˜¯å…ˆä»å˜é‡å¯¹è±¡ä¸­è·å–åœ°å€å¼•ç”¨ï¼ˆæˆ–è€…åœ°å€æŒ‡é’ˆï¼‰å†ä»å †å†…å­˜ä¸­å–æ•°æ®</p><h3 id="å…­ã€å†…å­˜ç©ºé—´ç®¡ç†"><a href="#å…­ã€å†…å­˜ç©ºé—´ç®¡ç†" class="headerlink" title="å…­ã€å†…å­˜ç©ºé—´ç®¡ç†"></a>å…­ã€å†…å­˜ç©ºé—´ç®¡ç†</h3><p>JavaScript çš„å†…å­˜ç”Ÿå‘½å‘¨æœŸ</p><ul><li>åˆ†é…ä½ æ‰€éœ€è¦çš„å†…å­˜</li><li>ä½¿ç”¨åˆ†é…åˆ°çš„å†…å­˜ï¼ˆè¯»ã€å†™ï¼‰</li><li>ä¸éœ€è¦æ—¶å°†å…¶é‡Šæ”¾ã€å½’è¿˜</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">20</span>; <span class="comment">// åœ¨å†…å­˜ä¸­ç»™æ•°å€¼å˜é‡åˆ†é…ç©ºé—´</span></span><br><span class="line"><span class="title function_">alert</span>(a + <span class="number">100</span>); <span class="comment">// ä½¿ç”¨å†…å­˜</span></span><br><span class="line">a = <span class="literal">null</span>; <span class="comment">// ä½¿ç”¨å®Œæ¯•ä¹‹åï¼Œé‡Šæ”¾å†…å­˜ç©ºé—´</span></span><br></pre></td></tr></table></figure><p>JavaScript è‡ªåŠ¨åƒåœ¾æ”¶é›†æœºåˆ¶çš„åŸç†ï¼šå°±æ˜¯æ‰¾å‡ºé‚£äº›ä¸å†ç»§ç»­ä½¿ç”¨çš„å€¼ï¼Œç„¶åé‡Šæ”¾å…¶å ç”¨çš„å†…å­˜ã€‚åƒåœ¾æ”¶é›†å™¨ä¼šæ¯éš”å›ºå®šçš„æ—¶é—´æ®µå°±æ‰§è¡Œä¸€æ¬¡é‡Šæ”¾æ“ä½œã€‚</p><p>æœ€å¸¸ç”¨çš„æ˜¯é€šè¿‡<strong>æ ‡è®°æ¸…é™¤</strong>çš„ç®—æ³•</p><p><code>a = null</code> å®é™…å°±æ˜¯é‡Šæ”¾å¼•ç”¨ï¼Œé€‚å½“çš„é‡Šæ”¾å¼•ç”¨å¯ä»¥æé«˜æ€§èƒ½</p>]]></content>
      
      
      <categories>
          
          <category> JavaScript </category>
          
          <category> æ ¸å¿ƒ </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
