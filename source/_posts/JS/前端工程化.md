---
title: 前端工程化

categories:
  - [JavaScript]
tags: 
  - JavaScript
---

# 前端工程化

## 传统开发的弊端

在传统的开发模式下，所需要的 JavaScript 代码时通过 script 标签引入的。虽然可以将代码分成多个文件多个模块来维护，进而降低代码维护的成本，但实际开发中，会存在一些问题：

1. 可能存在同名的变量声明，引起变量冲突
2. 引入多个资源文件时，比如有多个 JS 文件，在其中一个 JS 文件里面使用了在别处声明的变量，无法快速找到是在哪里声明的，大型项目难以维护
3. 类似第 1 、 2 点提到的问题无法轻松预先感知，很依赖开发人员人工定位原因
4. 大部分代码缺乏分割，比如一个工具函数库，很多时候需要整包引入到 HTML 里，文件很大，然而实际上只需要用到其中一两个方法
5. 由第 4 点大文件延伸出的问题， `script` 的加载从上到下，容易阻塞页面渲染
6. 不同页面的资源引用都需要手动管理，容易造成依赖混乱，难以维护
7. 如果要压缩 CSS 、混淆 JS 代码，也是要人力操作使用工具去一个个处理后替换，容易出错

当然，实际上还会有更多的问题会遇到。

## 工程化带来的优势

为了解决传统开发的弊端，前端也开始引入工程化开发的概念，借助工具来解决人工层面的烦琐事情。

### 开发层面的优势

在开发层面，前端工程化有以下这些好处：

1. 引入了模块化和包的概念，作用域隔离，解决了代码冲突的问题
2. 按需导出和导入机制，让编码过程更容易定位问题
3. 自动化的代码检测流程，有问题的代码在开发过程中就可以被发现
4. 编译打包机制可以让使用开发效率更高的编码方式，比如 Vue 组件、 CSS 的各种预处理器
5. 引入了代码兼容处理的方案（ e.g. Babel ），可以让自由使用更先进的 JavaScript 语句，而无需顾忌浏览器兼容性，因为最终会帮转换为浏览器兼容的实现版本
6. 引入了 Tree Shaking 机制，清理没有用到的代码，减少项目构建后的体积

### 团队协作的优势

除了对开发者有更好的开发体验和效率提升，对于团队协作，前端工程化也带来了更多的便利，例如下面这些场景：

1. 统一的项目结构
2. 统一的代码风格
3. 可复用的模块和组件
4. 代码健壮性保障 ( TS )
5. 团队开发效率高

### 求职竞争上的优势

近几年前端开发领域的相关岗位，都会在招聘详情里出现类似的描述：

> 熟悉 Vue / React 等主流框架，对前端组件化和模块化有深入的理解和实践
> 熟悉面向组件的开发模式，熟悉 Webpack / Vite 等构建工具
> 熟练掌握微信小程序开发，熟悉 Taro 框架或 uni-app 框架优先
> 熟悉 Scss / Less / Stylus 等预处理器的使用
> 熟练掌握 TypeScript 者优先
> 有良好的代码风格，结构设计与程序架构者优先
> 了解或熟悉后端开发者优先（如 Java / Go / Node.js ）

知名企业对 1-3 年工作经验的初中级工程师，更是明确要求具备前端工程化开发的能力：

![知名企业对 1-3 年经验的前端工程师招聘要求](https://s2.loli.net/2023/03/10/xvZJHSXhYmUrsR5.png)

## 现代化的开发概念

### MPA 与 SPA

#### 多页面应用

MPA 多页面应用是最传统的网站体验，当一个网站有多个页面时，会对应有多个实际存在的 HTML 文件，访问每一个页面都需要经历一次完整的页面请求过程：

```bash
# 传统的页面跳转过程

从用户点击跳转开始：
---> 浏览器打开新的页面
---> 请求【所有】资源
---> 加载 HTML 、CSS 、 JS 、 图片等资源
---> 完成新页面的渲染
```

##### MPA 的优点

- 首屏加载速度快
- SEO友好
- 容易与服务端语言结合

##### MPA 的缺点

- 页面之间的跳转访问速度慢
- 用户体验不够友好
- 开发成本高

### CSR 与 SSR

#### 客户端渲染

这是一种利用 `AJAX` 技术，把渲染工作从服务端转移到客户端完成，不仅客户端的用户体验更好，前后端分离的开发模式更加高效。

#### 服务端渲染

和传统的 `MPA` 使用 `PHP / JSP` 等技术栈做服务端渲染不同，现代前端工程化里的 `SSR` 通常是指使用 `Node.js` 作为服务端技术栈。

SSR 技术利用的同构渲染方案（ Isomorphic Rendering ），指的是一套代码不仅可以在客户端运行，也可以在服务端运行，在一些合适的时机先由服务端完成渲染（ Server-Side Rendering ）再直出给客户端激活（ Client-Side Hydration ），这种开发模式带来了：

- 更好的 SEO 支持，解决了 SPA 单页面应用的痛点
- 更快的首屏加载速度，保持了 MPA 多页面应用的优点
- 和 SPA 一样支持前后端分离，开发效率依然很高
- 有更好的客户端体验，当用户完全打开页面后，本地访问过程中也可以保持 SPA 单页面应用的体验
- 统一的心智模型，由于支持同构，因此没有额外的心智负担

## 工程化不至于前端

随着前端工程化的发展，前端不至于写前端，已经有很多前端工程师利用前端工程化带来的优势，不仅仅只是做一个 Web 前端，开始逐步发展为一个全栈工程师，在企业内部承担起了更多的岗位职责，包括作者笔者也是。

之所以能做这么多事情，得益于 Node.js 在前端开发带来的翻天覆地的变化，可以在保持原有的 JavaScript 和 TypeScript 基础上，几乎没有过多的学习成本就可以过度到其他端的开发。

### 服务端开发

`express -> koa -> nest -> egg`

### 桌面程序开发

Electron 的底层是基于 Chromium 和 Node.js ，它提供了两个进程供开发者使用：

1. 主进程：它是整个应用的入口点，主进程运行在 Node 环境中，可以使用所有的 Node API ，程序也因此具备了和系统进行交互的能力，例如文件的读写操作。
2. 渲染进程：负责与用户交互的 GUI 界面，基于 Chromium 运行，所以开发者得以使用 HTML / CSS / JavaScript 像编写网页一样来编写程序的 GUI 界面。

一个程序应用只会有一个主进程，而渲染进程则可以根据实际需求创建多个，渲染进程如果需要和系统交互，则必须与主进程通信，借助主进程的能力来实现。

在构建的时候， Electron 会把 Node 和 Chromium 一起打包为一个诸如 `.exe` 这样的安装文件（或者是包含了两者的免安装版本），这样用户不需要 Node 环境也可以运行桌面程序。

### 应用脚本开发

`pkg`

将 `node` 项目打包成 `exe` 可执行文件

## 参考

[Vue3 入门指南与实战案例 - 了解前端工程化](https://vue3.chengpeiquan.com/engineering.html)
